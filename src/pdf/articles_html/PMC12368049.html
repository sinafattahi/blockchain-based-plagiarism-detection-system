
<!DOCTYPE html>
<html lang="en" >
    <head >

        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="HandheldFriendly" content="True" />
        <meta name="MobileOptimized" content="320" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        
        

        
        
  <link rel="stylesheet" href="/static/assets/style-8258669d.css" />
<script type="module" crossorigin="" src="/static/assets/base_style-f4a99799.js"></script>

  <link rel="stylesheet" href="/static/assets/style-ef962842.css" />
<link rel="stylesheet" href="/static/assets/style-3ade8b5c.css" />
<script type="module" crossorigin="" src="/static/assets/article_style-d757a0dd.js"></script>

  
  
    <style>
  
  
  @media screen and (min-width: 64em) {
    div.pmc-wm {
      background: repeat-y;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='350' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cdefs%3E%3Cfilter x='-.02' y='0' width='1.05' height='1' id='c'%3E%3CfeFlood flood-color='%23FFF'/%3E%3CfeComposite in='SourceGraphic'/%3E%3C/filter%3E%3Ctext id='b' font-family='Helvetica' font-size='11pt' style='opacity:1;fill:%23005ea2;stroke:none;text-anchor:middle' x='175' y='14'%3E%3C/text%3E%3Cpath id='a' style='fill:%23005ea2' d='M0 8h350v3H0z'/%3E%3C/defs%3E%3Cuse xlink:href='%23a' transform='rotate(90 10 10)'/%3E%3Cuse xlink:href='%23b' transform='rotate(90 10 10)' filter='url(%23c)'/%3E%3C/svg%3E");
      padding-left: 3rem;
    }
  }
</style>

  



        
            <link rel="apple-touch-icon"
                  sizes="180x180"
                  href="/static/img/favicons/apple-touch-icon.png" />
            <link rel="icon"
                  type="image/png"
                  sizes="48x48"
                  href="/static/img/favicons/favicon-48x48.png" />
            <link rel="icon"
                  type="image/png"
                  sizes="32x32"
                  href="/static/img/favicons/favicon-32x32.png" />
            <link rel="icon"
                  type="image/png"
                  sizes="16x16"
                  href="/static/img/favicons/favicon-16x16.png" />
            <link rel="manifest" href="/static/img/favicons/site.webmanifest" />
            <link rel="mask-icon"
                  href="/static/img/favicons/safari-pinned-tab.svg"
                  color="#0071bc" />
            <meta name="msapplication-config"
                  content="/static/img/favicons/browserconfig.xml" />
            <meta name="theme-color" content="#ffffff" />
        

        <title>
            Using transcripts to refine image based cell segmentation with FastReseg - PMC
        </title>

        
        
  
  <!-- Logging params: Pinger defaults -->
<meta name="ncbi_app" content="cloudpmc-viewer" />
<meta name="ncbi_db" content="pmc" />
<meta name="ncbi_phid" content="D2E4AB8C8AF2C62305AB8C00485C5E8F.m_1" />
<meta name="ncbi_pinger_stat_url" content="https://pmc.ncbi.nlm.nih.gov/stat" />
<!-- Logging params: Pinger custom -->
<meta name="ncbi_pdid" content="article" />
  
    <link rel="preconnect" href="https://www.google-analytics.com" />

    
        <link rel="preconnect" href="https://cdn.ncbi.nlm.nih.gov" />
    

    <!-- Include USWDS Init Script -->
    <script src="/static/assets/uswds-init.js"></script>


    <meta name="ncbi_domain" content="scirep">
<meta name="ncbi_type" content="fulltext">
<meta name="ncbi_pcid" content="journal">
<meta name="ncbi_feature" content="associated_data">
<link rel="canonical" href="https://pmc.ncbi.nlm.nih.gov/articles/PMC12368049/">
<meta name="robots" content="INDEX,NOFOLLOW,NOARCHIVE">
<meta name="citation_journal_title" content="Scientific Reports">
<meta name="citation_title" content="Using transcripts to refine image based cell segmentation with FastReseg">
<meta name="citation_author" content="Lidan Wu">
<meta name="citation_author_institution" content="Bruker Spatial Biology, Seattle, WA 98105 USA">
<meta name="citation_author" content="Joseph M Beechem">
<meta name="citation_author_institution" content="Bruker Spatial Biology, Seattle, WA 98105 USA">
<meta name="citation_author" content="Patrick Danaher">
<meta name="citation_author_institution" content="Bruker Spatial Biology, Seattle, WA 98105 USA">
<meta name="citation_publication_date" content="2025 Aug 20">
<meta name="citation_volume" content="15">
<meta name="citation_firstpage" content="30508">
<meta name="citation_doi" content="10.1038/s41598-025-08733-5">
<meta name="citation_pmid" content="40835864">
<meta name="citation_abstract_html_url" content="https://pmc.ncbi.nlm.nih.gov/articles/PMC12368049/">
<meta name="citation_fulltext_html_url" content="https://pmc.ncbi.nlm.nih.gov/articles/PMC12368049/">
<meta name="citation_pdf_url" content="https://pmc.ncbi.nlm.nih.gov/articles/PMC12368049/pdf/41598_2025_Article_8733.pdf">
<meta name="description" content="Spatial transcriptomics (ST) faces persistent challenges in cell segmentation accuracy, which can bias biological interpretations in a spatial-dependent way. FastReseg introduces a novel algorithm that refines inaccuracies in existing image-based ...">
<meta name="og:title" content="Using transcripts to refine image based cell segmentation with FastReseg">
<meta name="og:type" content="article">
<meta name="og:site_name" content="PubMed Central (PMC)">
<meta name="og:description" content="Spatial transcriptomics (ST) faces persistent challenges in cell segmentation accuracy, which can bias biological interpretations in a spatial-dependent way. FastReseg introduces a novel algorithm that refines inaccuracies in existing image-based ...">
<meta name="og:url" content="https://pmc.ncbi.nlm.nih.gov/articles/PMC12368049/">
<meta name="og:image" content="https://cdn.ncbi.nlm.nih.gov/pmc/cms/images/pmc-card-share.jpg?_=0">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ncbi">
    
    

    </head>
    <body >
        
    <a class="usa-skipnav " href="#main-content">
      Skip to main content
    </a>


        
            

<section class="usa-banner " aria-label="Official website of the United States government" >
    <div class="usa-accordion">
        <header class="usa-banner__header">
            <div class="usa-banner__inner">
                <div class="grid-col-auto">
                    <img aria-hidden="true"
                         class="usa-banner__header-flag"
                         src="/static/img/us_flag.svg"
                         alt="" />
                </div>

                <div class="grid-col-fill tablet:grid-col-auto" aria-hidden="true">
                    <p class="usa-banner__header-text">
                        An official website of the United States government
                    </p>
                    <span class="usa-banner__header-action">Here's how you know</span>
                </div>

                



















    
        <button
            type="button"
        
    
    class="usa-accordion__button usa-banner__button
           

           
               
               
               
               
            

           
           
           
           "
    aria-expanded="false"
    aria-controls="gov-banner-default"
    
    data-testid="storybook-django-banner"
    
    >
    
        

        
                    <span class="usa-banner__button-text">Here's how you know</span>
                

        
    
        
            </button>
        


            </div>
        </header>

        <div class="usa-banner__content usa-accordion__content"
             id="gov-banner-default"
             hidden>
            <div class="grid-row grid-gap-lg">
                <div class="usa-banner__guidance tablet:grid-col-6">
                    <img class="usa-banner__icon usa-media-block__img"
                         src="/static/img/icon-dot-gov.svg"
                         alt=""
                         aria-hidden="true" />
                    <div class="usa-media-block__body">
                        <p>
                            <strong>Official websites use .gov</strong>
                            <br />
                            A
                            <strong>.gov</strong> website belongs to an official
                            government organization in the United States.
                        </p>
                    </div>
                </div>

                <div class="usa-banner__guidance tablet:grid-col-6">
                    <img class="usa-banner__icon usa-media-block__img"
                         src="/static/img/icon-https.svg"
                         alt=""
                         aria-hidden="true" />

                    <div class="usa-media-block__body">
                        <p>
                            <strong>Secure .gov websites use HTTPS</strong>
                            <br />
                            A <strong>lock</strong> (
                            <span class="icon-lock">
                                <svg xmlns="http://www.w3.org/2000/svg"
                                     width="52"
                                     height="64"
                                     viewBox="0 0 52 64"
                                     class="usa-banner__lock-image"
                                     role="graphics-symbol"
                                     aria-labelledby="banner-lock-description"
                                     focusable="false">
                                    <title id="banner-lock-title">Lock</title>
                                    <desc id="banner-lock-description">
                                    Locked padlock icon
                                    </desc>
                                    <path fill="#000000"
                                          fill-rule="evenodd"
                                          d="M26 0c10.493 0 19 8.507 19 19v9h3a4 4 0 0 1 4 4v28a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V32a4 4 0 0 1 4-4h3v-9C7 8.507 15.507 0 26 0zm0 8c-5.979 0-10.843 4.77-10.996 10.712L15 19v9h22v-9c0-6.075-4.925-11-11-11z" />
                                </svg>
</span>) or <strong>https://</strong> means you've safely
                                connected to the .gov website. Share sensitive
                                information only on official, secure websites.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

        

        
    
    
    

<div class="usa-overlay">
</div>



<header class="usa-header usa-header--extended usa-header--wide" data-header data-testid="header"    >
    <div class="ncbi-header">
        <div class="ncbi-header__container">
            <a class="ncbi-header__logo-container"
               href="https://www.ncbi.nlm.nih.gov/">
                <img alt="NCBI home page"
                     class="ncbi-header__logo-image"
                     src="/static/img/ncbi-logos/nih-nlm-ncbi--white.svg"
                     width="410"
                     height="100" />
            </a>

            <!-- Mobile menu hamburger button -->
            



















    
        <button
            type="button"
        
    
    class="usa-menu-btn ncbi-header__hamburger-button
           

           
               
               
               
               
            

           
           
           
           "
    
    
    aria-label="Show menu"
    data-testid="navMenuButton"
    
    >
    
        

        
                <svg aria-hidden="true"
                     class="ncbi-hamburger-icon"
                     fill="none"
                     focusable="false"
                     height="21"
                     viewBox="0 0 31 21"
                     width="31"
                     xmlns="http://www.w3.org/2000/svg">
                    <path clip-rule="evenodd"
                          d="M0.125 20.75H30.875V17.3333H0.125V20.75ZM0.125 12.2083H30.875V8.79167H0.125V12.2083ZM0.125 0.25V3.66667H30.875V0.25H0.125Z"
                          fill="#F1F1F1"
                          fill-rule="evenodd" />
                </svg>
            

        
    
        
            </button>
        



            
                <!-- Desktop buttons-->
                <div class="ncbi-header__desktop-buttons">
                    
                        <!-- Desktop search button -->
                        



















    
        <button
            type="button"
        
    
    class="usa-button
           

           
               
               
               
               
            

           
           
           usa-button--unstyled ncbi-header__desktop-button
           "
    aria-expanded="false"
    aria-controls="search-field-desktop-navigation"
    aria-label="Show search overlay"
    data-testid="toggleSearchPanelButton"
    data-toggle-search-panel-button
    >
    
        

        
                            



    <svg class="usa-icon " role="graphics-symbol" aria-hidden="true" >
        
        <use xlink:href="/static/img/sprite.svg#search" />
    </svg>


                            Search
                        

        
    
        
            </button>
        


                    

                    <!-- Desktop login dropdown -->
                    
                        <div class="ncbi-header__login-dropdown">
                            



















    
        <button
            type="button"
        
    
    class="usa-button
           

           
               
               
               
               
            

           
           
           usa-button--unstyled ncbi-header__desktop-button ncbi-header__login-dropdown-button
           "
    aria-expanded="false"
    aria-controls="login-dropdown-menu"
    aria-label="Show login menu"
    data-testid="toggleLoginMenuDropdown"
    data-desktop-login-button
    >
    
        

        
                                



    <svg class="usa-icon " role="graphics-symbol" aria-hidden="true" >
        
        <use xlink:href="/static/img/sprite.svg#person" />
    </svg>



                                <span data-login-dropdown-text>Log in</span>

                                <!-- Dropdown icon pointing up -->
                                



    <svg class="usa-icon ncbi-header__login-dropdown-icon ncbi-header__login-dropdown-icon--expand-less ncbi-header__login-dropdown-icon--hidden" role="graphics-symbol" aria-hidden="true" data-login-dropdown-up-arrow>
        
        <use xlink:href="/static/img/sprite.svg#expand_less" />
    </svg>



                                <!-- Dropdown icon pointing down -->
                                



    <svg class="usa-icon ncbi-header__login-dropdown-icon ncbi-header__login-dropdown-icon--expand-more ncbi-header__login-dropdown-icon--hidden" role="graphics-symbol" aria-hidden="true" data-login-dropdown-down-arrow>
        
        <use xlink:href="/static/img/sprite.svg#expand_more" />
    </svg>


                            

        
    
        
            </button>
        



                            <!-- Login dropdown menu -->
                            <ul class="usa-nav__submenu ncbi-header__login-dropdown-menu"
                                id="login-dropdown-menu"
                                data-desktop-login-menu-dropdown
                                hidden>
                                
                                    <li class="usa-nav__submenu-item">
                                        <!-- Uses custom style overrides to render external and document links. -->
                                        









    <a href="https://www.ncbi.nlm.nih.gov/myncbi/" class="usa-link  "  >
        

        
            Dashboard
        

        
    </a>


                                    </li>
                                
                                    <li class="usa-nav__submenu-item">
                                        <!-- Uses custom style overrides to render external and document links. -->
                                        









    <a href="https://www.ncbi.nlm.nih.gov/myncbi/collections/bibliography/" class="usa-link  "  >
        

        
            Publications
        

        
    </a>


                                    </li>
                                
                                    <li class="usa-nav__submenu-item">
                                        <!-- Uses custom style overrides to render external and document links. -->
                                        









    <a href="https://www.ncbi.nlm.nih.gov/account/settings/" class="usa-link  "  >
        

        
            Account settings
        

        
    </a>


                                    </li>
                                
                                <li class="usa-nav__submenu-item">
                                    



















    
        <button
            type="button"
        
    
    class="usa-button
           

           
               
               
               
               
            

           
           
           usa-button--outline ncbi-header__login-dropdown-logout-button
           "
    
    
    
    data-testid="desktopLogoutButton"
    data-desktop-logout-button
    >
    
        

        Log out

        
    
        
            </button>
        


                                </li>
                            </ul>
                        </div>
                    
                </div>
            
        </div>
    </div>

    <!-- Search panel -->
    
        <div class="ncbi-search-panel ncbi--show-only-at-desktop"
             data-header-search-panel
             hidden>
            <div class="ncbi-search-panel__container">
                <form action="https://www.ncbi.nlm.nih.gov/search/all/"
                      
                      autocomplete="off"
                      class="usa-search usa-search--big ncbi-search-panel__form"
                      data-testid="desktop-navigation-search-form"
                      method="GET"
                      role="search">
                    <label class="usa-sr-only" for="search-field-desktop-navigation">
                        Search…
                    </label>
                    <input class="usa-input"
                           id="search-field-desktop-navigation"
                           name="term"
                           
                               placeholder="Search NCBI"
                           
                           type="search"
                           value="" />
                    



















    
        <button
            type="submit"
        
    
    class="usa-button
           

           
               
               
               
               
            

           
           
           
           "
    
    
    
    
    
    >
    
        

        
                        <span class="usa-search__submit-text">
                            Search NCBI
                        </span>
                    

        
    
        
            </button>
        


                </form>

                
            </div>
        </div>
    

    <nav aria-label="Primary navigation" class="usa-nav">
        <p class="usa-sr-only" id="primary-navigation-sr-only-title">
            Primary site navigation
        </p>

        <!-- Mobile menu close button -->
        



















    
        <button
            type="button"
        
    
    class="usa-nav__close ncbi-nav__close-button
           

           
               
               
               
               
            

           
           
           
           "
    
    
    aria-label="Close navigation menu"
    data-testid="navCloseButton"
    
    >
    
        

        
            <img src="/static/img/usa-icons/close.svg" alt="Close" />
        

        
    
        
            </button>
        



        
            <!-- Mobile search component -->
            <form class="usa-search usa-search--small ncbi--hide-at-desktop margin-top-6"
                  action="https://www.ncbi.nlm.nih.gov/search/all/"
                  
                  autocomplete="off"
                  data-testid="mobile-navigation-search-form"
                  method="GET"
                  role="search">
                <label class="usa-sr-only" for="search-field-mobile-navigation">
                    Search
                </label>

                <input class="usa-input"
                       id="search-field-mobile-navigation"
                       type="search"
                       
                           placeholder="Search NCBI"
                       
                       name="term" />

                



















    
        <button
            type="submit"
        
    
    class="usa-button
           

           
               
               
               
               
            

           
           
           
           "
    
    
    
    
    
    >
    
        

        
                    <!-- This SVG should be kept inline and not replaced with a link to the icon as otherwise it will render in the wrong color -->
                    <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0Ij48cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+PHBhdGggZmlsbD0iI2ZmZiIgZD0iTTE1LjUgMTRoLS43OWwtLjI4LS4yN0E2LjQ3MSA2LjQ3MSAwIDAgMCAxNiA5LjUgNi41IDYuNSAwIDEgMCA5LjUgMTZjMS42MSAwIDMuMDktLjU5IDQuMjMtMS41N2wuMjcuMjh2Ljc5bDUgNC45OUwyMC40OSAxOWwtNC45OS01em0tNiAwQzcuMDEgMTQgNSAxMS45OSA1IDkuNVM3LjAxIDUgOS41IDUgMTQgNy4wMSAxNCA5LjUgMTEuOTkgMTQgOS41IDE0eiIvPjwvc3ZnPg=="
                         class="usa-search__submit-icon"
                         alt="Search" />
                

        
    
        
            </button>
        


            </form>

            
        

        <!-- Primary navigation menu items -->
        <!-- This usa-nav__inner wrapper is required to correctly style the navigation items on Desktop -->
        

        
            <div class="ncbi-nav__mobile-login-menu ncbi--hide-at-desktop"
                 data-mobile-login-menu
                 hidden>
                <p class="ncbi-nav__mobile-login-menu-status">
                    Logged in as:
                    <strong class="ncbi-nav__mobile-login-menu-email"
                            data-mobile-login-email-text></strong>
                </p>
                <ul class="usa-nav__primary usa-accordion">
                    
                        <li class="usa-nav__primary-item">
                            









    <a href="https://www.ncbi.nlm.nih.gov/myncbi/" class="usa-link  "  >
        

        
            Dashboard
        

        
    </a>


                        </li>
                    
                        <li class="usa-nav__primary-item">
                            









    <a href="https://www.ncbi.nlm.nih.gov/myncbi/collections/bibliography/" class="usa-link  "  >
        

        
            Publications
        

        
    </a>


                        </li>
                    
                        <li class="usa-nav__primary-item">
                            









    <a href="https://www.ncbi.nlm.nih.gov/account/settings/" class="usa-link  "  >
        

        
            Account settings
        

        
    </a>


                        </li>
                    
                </ul>
            </div>
        

        



















    
        <button
            type="button"
        
    
    class="usa-button
           

           
               
               
               
               
            

           
           
           ncbi-nav__mobile-login-button ncbi--hide-at-desktop
           "
    
    
    
    data-testid="mobileLoginButton"
    data-mobile-login-button
    >
    
        

        Log in

        
    
        
            </button>
        


    </nav>
</header>

    
    
        

<section class="pmc-header pmc-header--basic" aria-label="PMC Header with search box">
    <div class="pmc-nav-container">
        <div class="pmc-header__bar">
           <div class="pmc-header__logo">
               <a href="/" title="Home" aria-label="PMC Home"></a>
           </div>
            <button
                    type="button"
                    class="usa-button usa-button--unstyled pmc-header__search__button"
                    aria-label="Open search"
                    data-ga-category="search"
                    data-ga-action="PMC"
                    data-ga-label="pmc_search_panel_mobile"
            >
                <svg class="usa-icon width-4 height-4 pmc-icon__open" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#search"></use>
                </svg>
                <svg class="usa-icon width-4 height-4 pmc-icon__close" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#close"></use>
                </svg>
            </button>
        </div>
        <div class="pmc-header__search">
            


<form class="usa-search usa-search--extra usa-search--article-right-column  pmc-header__search__form" id="pmc-search-form" autocomplete="off" role="search">
<label class="usa-sr-only" for="pmc-search">Search PMC Full-Text Archive</label>
<span class="autoComplete_wrapper flex-1">
<input class="usa-input width-full maxw-none" required="required" placeholder="Search PMC Full-Text Archive" id="pmc-search"  type="search" name="term" data-autocomplete-url="https://pmc.ncbi.nlm.nih.gov/autocomp/search/autocomp/"/>
</span>
<button
class="usa-button"
type="submit"
formaction="https://www.ncbi.nlm.nih.gov/pmc/"
data-ga-category="search"
data-ga-action="PMC"
data-ga-label="PMC_search_button"
>
<span class="usa-search__submit-text">Search in PMC</span>
<img
src="/static/img/usa-icons-bg/search--white.svg"
class="usa-search__submit-icon"
alt="Search"
/>
</button>
</form>
            <div class="display-flex flex-column tablet:flex-row tablet:flex-justify flex-justify-center flex-align-center width-full desktop:maxw-44">
                <ul class="pmc-header__search__menu">
                    <li>
                        
                            <a class="usa-link" href="/journals/" data-ga-action="featured_link" data-ga-label="journal list">
                                Journal List
                            </a>
                        
                    </li>
                    <li>
                        
                            <a class="usa-link" href="/about/userguide/" data-ga-action="featured_link"
                            data-ga-label="user guide">
                                User Guide
                            </a>
                        
                    </li>
                </ul>
                
                    <button form="pmc-search-form" formaction="https://pmc.ncbi.nlm.nih.gov/search/" type="submit" class="usa-button usa-button--unstyled hover:text-no-underline text-no-underline width-auto margin-top-1 tablet:margin-top-0">
     <span class="bg-green-label padding-05 text-white">New</span><span class="text-underline text-primary">Try this search in PMC Beta Search</span>
</button>
                
            </div>
        </div>
    </div>
</section>

    


        
        

       
  <div class="usa-section padding-top-0 desktop:padding-top-6 pmc-article-section" data-article-db="pmc" data-article-id="12368049">

    

   



<div class="grid-container pmc-actions-bar" aria-label="Actions bar" role="complementary">
    <div class="grid-row">
        <div class="grid-col-fill display-flex">
             <div class="display-flex">
                <ul class="usa-list usa-list--unstyled usa-list--horizontal">
                    <li class="margin-right-2 mobile-lg:margin-right-4 display-flex mob">
                        <button
                                type="button"
                                class="usa-button pmc-sidenav__container__open usa-button--unstyled width-auto display-flex"
                                aria-label="Open resources"
                                data-extra-class="is-visible-resources"
                                data-ga-category="resources_accordion"
                                data-ga-action="click"
                                data-ga-label="mobile_icon"
                        >
                            <svg class="usa-icon width-4 height-4" aria-hidden="true" focusable="false" role="img">
                                <use xlink:href="/static/img/sprite.svg#more_vert"></use>
                            </svg>
                        </button>
                    </li>
                    
                    <li class="margin-right-2 mobile-lg:margin-right-4 display-flex mob">
                        <a
                                href="https://doi.org/10.1038/s41598-025-08733-5"
                                class="usa-link display-flex usa-tooltip"
                                role="button"
                                target="_blank"
                                rel="noreferrer noopener"
                                title="View on publisher site"
                                data-position="bottom"
                                aria-label="View on publisher site"
                                data-ga-category="actions"
                                data-ga-action="click"
                                data-ga-label="publisher_link_mobile"
                        >
                                <svg class="usa-icon width-4 height-4" aria-hidden="true" focusable="false" role="img">
                                    <use xlink:href="/static/img/sprite.svg#launch"></use>
                                </svg>
                        </a>
                    </li>
                    
                    
                        <li class="margin-right-2 mobile-lg:margin-right-4 display-flex">
                             <a
                                     href="pdf/41598_2025_Article_8733.pdf"
                                     class="usa-link display-flex usa-tooltip"
                                     role="button"
                                     title="Download PDF"
                                     data-position="bottom"
                                     aria-label="Download PDF"
                                     data-ga-category="actions"
                                     data-ga-action="click"
                                     data-ga-label="pdf_download_mobile"
                             >
                                <svg class="usa-icon width-4 height-4" aria-hidden="true" focusable="false" role="img">
                                    <use xlink:href="/static/img/sprite.svg#file_download"></use>
                                </svg>
                            </a>
                        </li>
                    
                    <li class="margin-right-2 mobile-lg:margin-right-4 display-flex">
                        <button
                            class="usa-button usa-button--unstyled  usa-tooltip collections-dialog-trigger collections-button display-flex collections-button-empty"
                            title="Add to Collections"
                            data-position="bottom"
                            aria-label="Save article in MyNCBI collections."
                            data-ga-category="actions"
                            data-ga-action="click"
                            data-ga-label="collections_button_mobile"
                            data-collections-open-dialog-enabled="false"
                            data-collections-open-dialog-url="https://account.ncbi.nlm.nih.gov/?back_url=https%3A%2F%2Fpmc.ncbi.nlm.nih.gov%2Farticles%2FPMC12368049%2F%3Freport%3Dclassic%23open-collections-dialog"
                            data-in-collections="false"
                        >
                            <svg class="usa-icon width-4 height-4 usa-icon--bookmark-full" aria-hidden="true" focusable="false" role="img" hidden>
                                <use xlink:href="/static/img/action-bookmark-full.svg#icon"></use>
                            </svg>
                            <svg class="usa-icon width-4 height-4 usa-icon--bookmark-empty" aria-hidden="true" focusable="false" role="img" hidden>
                                <use xlink:href="/static/img/action-bookmark-empty.svg#icon"></use>
                            </svg>
                        </button>
                    </li>
                    
                    <li class="margin-right-2 mobile-lg:margin-right-4 display-flex">
                        <button role="button" class="usa-button usa-button--unstyled usa-tooltip citation-dialog-trigger display-flex"
                            aria-label="Open dialog with citation text in different styles"
                            title="Cite"
                            data-position="bottom"
                            data-ga-category="actions"
                            data-ga-action="open"
                            data-ga-label="cite_mobile"
                            data-all-citations-url="/resources/citations/12368049/"
                            data-citation-style="nlm"
                            data-download-format-link="/resources/citations/12368049/export/"
                        >
                            <svg class="usa-icon width-4 height-4 usa-icon--bookmark-empty" aria-hidden="true" focusable="false" role="img" hidden>
                                <use xlink:href="/static/img/sprite.svg#format_quote"></use>
                            </svg>
                        </button>
                    </li>
                    
                    <li class="pmc-permalink display-flex" >
                         <button
                                 type="button"
                                 title="Permalink"
                                 data-position="bottom"
                                 class="usa-button usa-button--unstyled display-flex usa-tooltip"
                                 aria-label="Show article permalink"
                                 aria-expanded="false"
                                 aria-haspopup="true"
                                 data-ga-category="actions"
                                 data-ga-action="open"
                                 data-ga-label="permalink_mobile"
                         >
                            <svg class="usa-icon width-4 height-4" aria-hidden="true" focusable="false" role="img">
                                <use xlink:href="/static/img/sprite.svg#share"></use>
                            </svg>
                        </button>
                        

<div class="pmc-permalink__dropdown" hidden>
    <div class="pmc-permalink__dropdown__container">
          <h2 class="usa-modal__heading margin-top-0 margin-bottom-2 text-uppercase font-sans-xs">PERMALINK</h2>
          <div class="pmc-permalink__dropdown__content">
              <input type="text" class="usa-input" value="https://pmc.ncbi.nlm.nih.gov/articles/PMC12368049/" aria-label="Article permalink">
              <button class="usa-button display-inline-flex pmc-permalink__dropdown__copy__btn margin-right-0" title="Copy article permalink" data-ga-category="save_share" data-ga-action="link" data-ga-label="copy_link">
                  <svg class="usa-icon" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#content_copy"></use>
                  </svg>
                  <span class="margin-left-1">Copy</span>
              </button>
          </div>
    </div>
</div>
                    </li>
                </ul>
            </div>
            <button
                    type="button"
                    class="usa-button pmc-sidenav__container__open usa-button--unstyled width-auto display-flex"
                    aria-label="Open article navigation"
                    data-extra-class="is-visible-in-page"
                    data-ga-category="actions"
                    data-ga-action="open"
                    data-ga-label="article_nav_mobile"
            >
                <svg class="usa-icon width-4 height-4" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#list"></use>
                </svg>
            </button>
        </div>
    </div>
</div>
    <div class="grid-container desktop:padding-left-6">
      <div id="article-container" class="grid-row grid-gap">
        <div class="grid-col-12 desktop:grid-col-8 order-2 pmc-layout__content">
            <div class="grid-container padding-left-0 padding-right-0">
                <div class="grid-row desktop:margin-left-neg-6">
                    <div class="grid-col-12">
                        <div class="pmc-layout__disclaimer" role="complementary" aria-label="Disclaimer note">
    As a library, NLM provides access to scientific literature. Inclusion in an NLM database does not imply endorsement of, or agreement with,
    the contents by NLM or the National Institutes of Health.<br/>
    Learn more:
    <a class="usa-link" data-ga-category="Link click" data-ga-action="Disclaimer" data-ga-label="New disclaimer box" href="/about/disclaimer/">PMC Disclaimer</a>
    |
    <a class="usa-link" data-ga-category="Link click" data-ga-action="PMC Copyright Notice" data-ga-label="New disclaimer box" href="/about/copyright/">
        PMC Copyright Notice
    </a>
</div>
                    </div>
                </div>
                <div class="grid-row pmc-wm desktop:margin-left-neg-6">
                    <!-- Main content -->
                    <main
                      id="main-content"
                      class="usa-layout-docs__main usa-layout-docs grid-col-12 pmc-layout pmc-prose padding-0"
                    >

                      
                        <section class="pmc-journal-banner text-center line-height-none" aria-label="Journal banner"><img src="https://cdn.ncbi.nlm.nih.gov/pmc/banners/logo-scirep.jpg" alt="Scientific Reports logo" usemap="#pmc-banner-imagemap" width="500" height="75"><map name="pmc-banner-imagemap"><area alt="Link to Scientific Reports" title="Link to Scientific Reports" shape="default" href="http://www.nature.com/srep" target="_blank" rel="noopener noreferrer"></map></section><article lang="en"><section aria-label="Article citation and metadata"><section class="pmc-layout__citation font-secondary font-xs"><div>
<div class="display-inline-block"><button type="button" class="cursor-pointer text-no-underline bg-transparent border-0 padding-0 text-left margin-0 text-normal text-primary" aria-controls="journal_context_menu">Sci Rep</button></div>. 2025 Aug 20;15:30508. doi: <a href="https://doi.org/10.1038/s41598-025-08733-5" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">10.1038/s41598-025-08733-5</a>
</div>
<nav id="journal_context_menu" hidden="hidden"><ul class="menu-list font-family-ui" role="menu">
<li role="presentation"><a href="https://www.ncbi.nlm.nih.gov/pmc/?term=%22Sci%20Rep%22%5Bjour%5D" class="usa-link" role="menuitem">Search in PMC</a></li>
<li role="presentation"><a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Sci%20Rep%22%5Bjour%5D" lang="en" class="usa-link" role="menuitem">Search in PubMed</a></li>
<li role="presentation"><a href="https://www.ncbi.nlm.nih.gov/nlmcatalog?term=%22Sci%20Rep%22%5BTitle%20Abbreviation%5D" class="usa-link" role="menuitem">View in NLM Catalog</a></li>
<li role="presentation"><a href="?term=%22Sci%20Rep%22%5Bjour%5D" class="usa-link" role="menuitem" data-add-to-search="true">Add to search</a></li>
</ul></nav></section><section class="front-matter"><div class="ameta p font-secondary font-xs">
<hgroup><h1>Using transcripts to refine image based cell segmentation with FastReseg</h1></hgroup><div class="cg p">
<a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Wu%20L%22%5BAuthor%5D" class="usa-link" aria-describedby="id1"><span class="name western">Lidan Wu</span></a><div hidden="hidden" id="id1">
<h3><span class="name western">Lidan Wu</span></h3>
<div class="p">
<sup>1</sup>Bruker Spatial Biology, Seattle, WA 98105 USA</div>
<div class="p">Find articles by <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Wu%20L%22%5BAuthor%5D" class="usa-link"><span class="name western">Lidan Wu</span></a>
</div>
</div>
<sup>1</sup>, <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Beechem%20JM%22%5BAuthor%5D" class="usa-link" aria-describedby="id2"><span class="name western">Joseph M Beechem</span></a><div hidden="hidden" id="id2">
<h3><span class="name western">Joseph M Beechem</span></h3>
<div class="p">
<sup>1</sup>Bruker Spatial Biology, Seattle, WA 98105 USA</div>
<div class="p">Find articles by <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Beechem%20JM%22%5BAuthor%5D" class="usa-link"><span class="name western">Joseph M Beechem</span></a>
</div>
</div>
<sup>1</sup>, <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Danaher%20P%22%5BAuthor%5D" class="usa-link" aria-describedby="id3"><span class="name western">Patrick Danaher</span></a><div hidden="hidden" id="id3">
<h3><span class="name western">Patrick Danaher</span></h3>
<div class="p">
<sup>1</sup>Bruker Spatial Biology, Seattle, WA 98105 USA</div>
<div class="p">Find articles by <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Danaher%20P%22%5BAuthor%5D" class="usa-link"><span class="name western">Patrick Danaher</span></a>
</div>
</div>
<sup>1,</sup><sup>✉</sup>
</div>
<ul class="d-buttons inline-list">
<li><button class="d-button" aria-controls="aip_a" aria-expanded="false">Author information</button></li>
<li><button class="d-button" aria-controls="anp_a" aria-expanded="false">Article notes</button></li>
<li><button class="d-button" aria-controls="clp_a" aria-expanded="false">Copyright and License information</button></li>
</ul>
<div class="d-panels font-secondary-light">
<div id="aip_a" class="d-panel p" style="display: none">
<div class="p" id="Aff1">
<sup>1</sup>Bruker Spatial Biology, Seattle, WA 98105 USA</div>
<div class="author-notes p"><div class="fn" id="_fncrsp93pmc__">
<sup>✉</sup><p class="display-inline">Corresponding author.</p>
</div></div>
</div>
<div id="anp_a" class="d-panel p" style="display: none"><div class="notes p"><section id="historyarticle-meta1" class="history"><p>Received 2025 Mar 5; Accepted 2025 Jun 23; Collection date 2025.</p></section></div></div>
<div id="clp_a" class="d-panel p" style="display: none">
<div>© The Author(s) 2025</div>
<p><strong>Open Access</strong> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <a href="https://creativecommons.org/licenses/by/4.0/" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">http://creativecommons.org/licenses/by/4.0/</a>.</p>
<div class="p"><a href="/about/copyright/" class="usa-link">PMC Copyright notice</a></div>
</div>
</div>
<div>PMCID: PMC12368049  PMID: <a href="https://pubmed.ncbi.nlm.nih.gov/40835864/" class="usa-link">40835864</a>
</div>
</div></section></section><section aria-label="Article content"><section class="body main-article-body"><section class="abstract" id="Abs1"><h2>Abstract</h2>
<p id="Par1">Spatial transcriptomics (ST) faces persistent challenges in cell segmentation accuracy, which can bias biological interpretations in a spatial-dependent way. FastReseg introduces a novel algorithm that refines inaccuracies in existing image-based segmentations using transcriptomic data, without radically redefining cell boundaries. By combining image-based information with 3D transcriptomic precision, FastReseg enhances segmentation accuracy. Its key innovation, a transcript scoring system based on log-likelihood ratios, facilitates the quick identification and correction of spatial doublets caused by cell proximity or overlap in 2D. FastReseg reduces circularity in boundary derivation, and addresses computational challenges with a modular workflow designed for large datasets. The algorithm’s modularity allows for seamless optimization and integration of advancements in segmentation technology. FastReseg provides a scalable, efficient solution to improve the quality and interpretability of ST data, ensuring compatibility with evolving segmentation methods and enabling more accurate biological insights.</p>
<section id="sec1"><h3 class="pmc_sec_title">Supplementary Information</h3>
<p>The online version contains supplementary material available at 10.1038/s41598-025-08733-5.</p></section><section id="kwd-group1" class="kwd-group"><p><strong>Subject terms:</strong> Bioinformatics, Quality control</p></section></section><section id="Sec1"><h2 class="pmc_sec_title">Introduction</h2>
<p id="Par2">Accurate cell segmentation is foundational in spatial transcriptomics, as it delineates individual cells and assigns transcript molecules to their cellular origins, influencing all subsequent analyses. Segmentation errors can contaminate single-cell expression profiles with neighboring cell transcripts, introducing spatially dependent bias that confounds analyses. For instance, differential expression analyses of a given cell type across spatial domains may be skewed by errors that arise from poorly segmented cells, overshadowing genuine biological signals<sup><a href="#CR1" class="usa-link" aria-describedby="CR1">1</a></sup>.</p>
<p id="Par3">Most spatial transcriptomics studies (Fig. <a href="#Fig1" class="usa-link">1</a>A) employ image-based cell segmentation, which involves immunofluorescence (IF) staining of cellular morphological markers like the nucleus and membrane to identify cell boundaries. Classical methods like the watershed algorithm<sup><a href="#CR2" class="usa-link" aria-describedby="CR2">2</a></sup> and nucleus expansion have been largely superseded by more advanced deep-learning techniques such as Cellpose<sup><a href="#CR3" class="usa-link" aria-describedby="CR3">3</a></sup> and Mesmer<sup><a href="#CR4" class="usa-link" aria-describedby="CR4">4</a></sup>. However, limitations in image quality of real-world tissue samples (Fig. <a href="#Fig1" class="usa-link">1</a>B) —such as weak staining, ambiguous boundaries, or poor 3D resolution—can lead to segmentation inaccuracies that propagate downstream.</p>
<figure class="fig xbox font-sm" id="Fig1"><h3 class="obj_head">Fig. 1.</h3>
<p class="img-box line-height-none margin-x-neg-2 tablet:margin-x-0 text-center"><a class="tileshop" target="_blank" href="https://www.ncbi.nlm.nih.gov/core/lw/2.0/html/tileshop_pmc/tileshop_pmc_inline.html?title=Click%20on%20image%20to%20zoom&amp;p=PMC3&amp;id=12368049_41598_2025_8733_Fig1_HTML.jpg"><img class="graphic zoom-in" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/f09c311e7224/41598_2025_8733_Fig1_HTML.jpg" loading="lazy" id="d33e213" height="851" width="758" alt="Fig. 1"></a></p>
<div class="p text-right font-secondary"><a href="figure/Fig1/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div>
<figcaption><p>FastReseg, an algorithm for improved cell segmentation in spatial transcriptomics. (<strong>A</strong>) Visualization of typical spatial transcriptomics data showing morphology stains for nucleus and membrane alongside transcript distribution (dots colored by gene identities), providing context for segmentation. (<strong>B</strong>) Common challenges in image-based cell segmentation, including limited resolution to resolve overlapping cells in the z-axis, weak or incomplete membrane stain in real-world tissue samples (yellow arrows), and lateral spillage of optical signals in densely packed tissues. Example images in (<strong>A</strong>) &amp; (<strong>B</strong>) are from a melanoma dataset, where morphology is visualized using antibodies against protein markers (CD298: Blue, PanCK: Green, CD45: Red) and nuclear stain (DAPI: gray). (<strong>C</strong>) Spatial pattern of transcriptional scores (right) based on each gene’s log-likelihood expression under reference cell types (Epithelial, NK, Mast cells) could help identify the presence of different cell types spatially, while validated by the orthogonal antibody staining (left, CD298: blue, CD45: red, DAPI: gray). Different color hues and intensities of the dots indicate the goodness-of-fit of each transcript (dot) under a given reference cell type as shown in the color bar, ranging from good (blue) to poor (red/yellow). See Methods section for calculation of tLLR scores plotted here. (<strong>D</strong>) Overview of the FastReseg workflow. Starting with initial cell segmentation and cluster-specific reference expression profiles, FastReseg scores each transcript based on its goodness-of-fit with respect to most probable cell type given the expression profiles of corresponding host cells and then flags cells with high spatial dependency in the spatial pattern of their transcript scores as having putative segmentation errors (i). Within the flagged cells, FastReseg can further identify the transcripts with poor fit, segregate them into spatially distinct groups and flag them as contaminating transcripts from different neighboring cells (ii). In the correction phase (iii), FastReseg evaluates each flagged transcript group’s expression and physical spatial context, deciding refinement actions such as trimming transcripts to extracellular space, merging with neighboring cells, or reassigning them to newly created cells based on a set of heuristic rules, which aims to resolve cell segmentation errors and improve transcript assignment accuracy. See Fig. <a href="#Fig4" class="usa-link">4</a> and Methods section for the detailed process.</p></figcaption></figure><p id="Par5">Transcript-based methods offer an alternative by segmenting regions of distinct local expression profiles<sup><a href="#CR5" class="usa-link" aria-describedby="CR5">5</a>,<a href="#CR6" class="usa-link" aria-describedby="CR6">6</a></sup>. But they can face difficulties at the borders of closely related cell types or in low-transcript-density regions, limiting their usage in many cell-driven biological studies. Baysor<sup><a href="#CR7" class="usa-link" aria-describedby="CR7">7</a></sup>, JSTA<sup><a href="#CR8" class="usa-link" aria-describedby="CR8">8</a></sup> and Proseg<sup><a href="#CR9" class="usa-link" aria-describedby="CR9">9</a></sup> represent a new class of hybrid approach which combine transcript data with image priors. However, in practice the image priors are usually limited to the nuclear segmentation results, and the transcriptomic data frequently dominates the final segmentation outcome. This strong dependence on transcript data risks introducing circularity to analyses, with the gene expression patterns we wish to study influencing how the single cell expression matrix is defined in the first place. Moreover, the existing hybrid methods often require substantial computational resources<sup><a href="#CR7" class="usa-link" aria-describedby="CR7">7</a>–<a href="#CR10" class="usa-link" aria-describedby="CR10">10</a></sup> due to the volume of transcript data and sophisticated modeling involved, and thus struggle to generate satisfactory cell-level segmentation for densely packed tissue samples.</p>
<p id="Par6">To address these challenges, we introduce FastReseg, an R package designed to enhance the precision of cell segmentation by leveraging transcriptomic data to correct and refine initial image-based segmentation results. FastReseg processes spatial transcriptomic datasets, along with their initial cell assignment provided by image-based cell segmentation, through a three-tiered modular approach: it first assesses cells for potential segmentation inaccuracies, then identifies misassigned transcript groups within those likely erroneous cells, and finally reassigns these mislocated transcripts to their appropriate cellular origins. This stepwise progression allows users the flexibility to halt the process after any stage to examine intermediate results, adapting the workflow to suit specific research needs at various analytical depths. The modular structure also simplifies the parameter optimization for each module, facilitating the adaptation of this tool in diverse research contexts.</p>
<p id="Par7">FastReseg’s benefits are multifold: it preserves the integrity of initial image-based segmentation, using transcript evidence for correction only where warranted. This strategy ensures that gene expression data used to study cell functions downstream is not directly compromised by the very methods intended to define cell boundaries. Besides, as image-based segmentation methods continue to evolve, FastReseg remains a relevant tool, complementing these advancements with its additional layer of transcript-based refinement. Moreover, FastReseg is designed to be fast and memory-efficient, handling computations on a cell-by-cell basis which allows saving the most expensive computations for the cells flagged as high likelihood of segmentation error. Recognizing the three-dimensional nature of tissue structures, FastReseg considers transcripts’ full 3D positions during modeling, making it particularly suited to modern, high-resolution spatial transcriptomics datasets.</p>
<p id="Par8">Through FastReseg, we offer a novel and practical solution to one of the most pressing challenges in the field of spatial transcriptomics, propose a framework that could significantly improve the accuracy and reliability of cell segmentation and thereby enhance the overall quality of biological insights derived from spatial data.</p></section><section id="Sec2"><h2 class="pmc_sec_title">Results</h2>
<section id="Sec3"><h3 class="pmc_sec_title">Concept of transcript scoring</h3>
<p id="Par9">FastReseg works on the premise that each RNA transcript offers evidence supporting or refuting the presence of a particular cell type at its location. For example, a CD68 transcript suggests the presence of a macrophage, while simultaneously arguing against the cell being a T cell. This foundational idea is encapsulated by deriving a log-likelihood ratio (<span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq1"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/e93cf3b1100b/d33e255.gif" loading="lazy" id="d33e255" alt="Inline graphic"></span>) for each gene under each expected cell type against the most probable cell type of given gene across the reference expression profiles for the dataset of interest. These log-likelihood ratios, which we term tLLR scores, are used to score every transcript in every cell and serve as the foundation of FastReseg’s operations. While one could obtain reference profiles from either external single-cell RNA sequencing (scRNA-seq) dataset or query data itself (see Methods section), the primary requirement is that they accurately represent the expressional centroids of the major cell types present in the query dataset. Capturing fine cell types, on the other hand, is less critical for FastReseg, as the differentiation between closely related subtypes often offers limited resolution in transcript-based local evidence and thus is of minimal utility in detecting and correcting segmentation errors.</p>
<p id="Par10">These “transcript scores” form the core operating mechanism of FastReseg and quantify how well each transcript’s expression profile matches the expected profile of its designated cell type. This involves assessing the consistency of transcripts within a neighborhood defined by initial image-based cell segmentation—ensuring they align in terms of log-likelihood ratios against the same cell type—and examining their spatial distribution. Such scores not only represent the goodness-of-fit of the transcript to the cell type but also highlight any spatially dependent patterns that may indicate the presence of contaminating source cell and thus segmentation inaccuracies (Fig. <a href="#Fig1" class="usa-link">1</a>C). This dual approach ensures that both expression and physical space are considered, enhancing the accuracy of detecting and correcting segmentation errors.</p></section><section id="Sec4"><h3 class="pmc_sec_title">FastReseg framework</h3>
<p id="Par11">FastReseg’s workflow (Fig. <a href="#Fig1" class="usa-link">1</a>D) is a three-tiered process which begins with two essential inputs: the initial results of cell segmentation, typically derived from morphology images with transcript-level cell assignment, and a matrix detailing transcript scores across all genes and cell types (Fig. <a href="#Fig2" class="usa-link">2</a>A-B). The first tier of the process evaluates each cell’s transcriptional spatial pattern with a “spatial doublet test”, which analyzes transcript scores under each cell’s most probable cell type given its overall single-cell expression profiles to detect spatial dependencies. Cells enriched with poorly fitting transcripts in localized areas are flagged for potential segmentation errors (Fig. <a href="#Fig2" class="usa-link">2</a>C). This test, which can be performed very rapidly and massively in parallel, lets us redact cells with no evidence of segmentation error from more computationally intensive downstream operations. The second tier of the process focuses on cells flagged from the spatial doublet test and attempts to segregate high-score transcripts (well-aligned with the cell type) from low-score transcripts (poor fits) via a spatial model trained for each flagged cell (Fig. <a href="#Fig3" class="usa-link">3</a>). Regions enriched in low-score transcripts are considered candidates for contaminating transcripts due to segmentation errors. Depending on analytical needs, these erroneous regions can either be excised to clean up the dataset or subjected to further refinement in third tier. In the final tier, FastReseg applies a series of heuristics to determine the corrective actions (Fig. <a href="#Fig4" class="usa-link">4</a>) for cells with identified misassigned transcript groups: trimming these areas from the dataset, merging them into an existing neighboring cell, or establishing them as new, independent cells. These decisions are guided by the spatial and expression context of the transcript groups to ensure corrections respect both the physical and expressional landscapes of the tissue. By integrating sophisticated transcript scoring with practical segmentation refinement in a modular pipeline, FastReseg offers a powerful tool for researchers seeking to delve deeper into the cellular complexities of biological tissues.</p>
<figure class="fig xbox font-sm" id="Fig2"><h4 class="obj_head">Fig. 2.</h4>
<p class="img-box line-height-none margin-x-neg-2 tablet:margin-x-0 text-center"><a class="tileshop" target="_blank" href="https://www.ncbi.nlm.nih.gov/core/lw/2.0/html/tileshop_pmc/tileshop_pmc_inline.html?title=Click%20on%20image%20to%20zoom&amp;p=PMC3&amp;id=12368049_41598_2025_8733_Fig2_HTML.jpg"><img class="graphic zoom-in" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/5e619d647480/41598_2025_8733_Fig2_HTML.jpg" loading="lazy" id="d33e308" height="595" width="751" alt="Fig. 2"></a></p>
<div class="p text-right font-secondary"><a href="figure/Fig2/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div>
<figcaption><p>Detection of cells with putative segmentation errors based on local transcriptional profiles in both expression and physical space. (<strong>A</strong>) Flowchart of how FastReseg identifies cells with potential segmentation errors. Cluster-specific reference profiles are utilized to calculate the centered log-likelihood ratio (tLLR score) for each gene under each reference cell cluster/type, where tLLR (i, k) is derived by subtracting the maximum log likelihood of gene i across all clusters from its log likelihood under cluster k. A linear regression model is then trained to simulate the spatial pattern of each cell’s transcriptional score under its best-fit cluster given the overall expression profiles of query cell observed in current cell borders. FastReseg would further evaluate the degree of spatial dependency of the transcript score pattern of each query cell via log-likelihood ratio test between the spatial-dependent model and the invariant null model. Cells with high spatial dependency are flagged as cells with putative segmentation errors. (<strong>B</strong>) Heatmap of transcript tLLR score for top marker genes (rows) across different reference cell types (columns). The reference cluster-specific profiles (see “example_refProfiles” object inside the package) were derived from an example spatial transcriptomics dataset for melanoma tissue section whose cell types were assigned based on semi-supervised cell typing algorithm with novel clusters using “a” to “f” letters as names. The color scale, matching (<strong>C</strong>), illustrates the range from good to bad fit, highlighting the variability of score for classic marker genes in different reference cell types. (<strong>C</strong>) XY scatter plots of transcript tLLR scores within example cells with varying likelihood of segmentation error, as determined by the degree of spatial dependency (defined as –log<sub>10</sub>(p), and annotated on top of each cell) of their tLLR patterns under their most probable cell types. Cells with spatial dependency scores higher than the provided cutoff (default to 5, shown as the vertical line above) are flagged as improperly segmented cells.</p></figcaption></figure><figure class="fig xbox font-sm" id="Fig3"><h4 class="obj_head">Fig. 3.</h4>
<p class="img-box line-height-none margin-x-neg-2 tablet:margin-x-0 text-center"><a class="tileshop" target="_blank" href="https://www.ncbi.nlm.nih.gov/core/lw/2.0/html/tileshop_pmc/tileshop_pmc_inline.html?title=Click%20on%20image%20to%20zoom&amp;p=PMC3&amp;id=12368049_41598_2025_8733_Fig3_HTML.jpg"><img class="graphic zoom-in" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/1c74f8f2b093/41598_2025_8733_Fig3_HTML.jpg" loading="lazy" id="d33e341" height="599" width="657" alt="Fig. 3"></a></p>
<div class="p text-right font-secondary"><a href="figure/Fig3/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div>
<figcaption><p>Detection and segregation of misassigned transcript groups. (<strong>A</strong>) XYZ scatter plots of transcript tLLR scores for a flagged example cell with spatial dependency score of 50.54, visualized both in 3D (left) and across multiple 2D Z-slices (right). Each point represents a transcript, colored by transcriptional score under the most probable cell type given the cell’s overall gene expression profile. This visualization highlights the spatial distribution of potentially misassigned transcripts within the cell. (<strong>B</strong>) XYZ scatter plots of the decision values produced by a Support Vector Machine (SVM) model trained to predict whether a given transcript would have transcript score below the − 2 cutoff given its spatial coordinate within the same cell shown in (A). Negative decision values correspond to below-cutoff poor-fit prediction by the SVM model. In both (<strong>A</strong>) and (<strong>B</strong>), the shape of the points corresponds to the classification predicted by the SVM-based spatial modeling of the given cell. Transcripts predicted to have transcript score below cutoff are treated as flagged misassigned transcripts and depicted as hollow diamond points in the XY scatter plots for multiple Z-slices on the right of (<strong>A</strong>) and (<strong>B</strong>). The difference in the spatial pattern of transcript tLLR scores and SVM decision values of same cell provides insights into the spatial constraints on predicting misassigned transcripts. (<strong>C</strong>) Additional examples of cells with varying degrees of spatial dependency on their transcript scores (5.06, 9.01, 12.11, 28.68). For each cell, transcripts predicted as poor-fit with negative decision values by the SVM are further segregated into spatially distinct groups, shown in different colors at bottom panel. These groups indicate the likely origins of those flagged misassigned transcripts from different neighboring source cells, providing a basis for further targeted reassignment and refinement of cell segmentation.</p></figcaption></figure><figure class="fig xbox font-sm" id="Fig4"><h4 class="obj_head">Fig. 4.</h4>
<p class="img-box line-height-none margin-x-neg-2 tablet:margin-x-0 text-center"><a class="tileshop" target="_blank" href="https://www.ncbi.nlm.nih.gov/core/lw/2.0/html/tileshop_pmc/tileshop_pmc_inline.html?title=Click%20on%20image%20to%20zoom&amp;p=PMC3&amp;id=12368049_41598_2025_8733_Fig4_HTML.jpg"><img class="graphic zoom-in" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/be682656c367/41598_2025_8733_Fig4_HTML.jpg" loading="lazy" id="d33e361" height="590" width="738" alt="Fig. 4"></a></p>
<div class="p text-right font-secondary"><a href="figure/Fig4/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div>
<figcaption><p>Heuristic-based approach to evaluate and reassign poorly fitted transcript groups. (<strong>A</strong>) High-level workflow for transcript reassignment, involving the identification of direct neighboring cells or groups in space, assessing total transcript tLLR scores under the most probable cell types of both the cell/group itself and its neighbors, and determining refinement actions such as creating new cells, trimming, or merging. (<strong>B</strong>) Decision tree and detailed criteria for deciding refinement actions based on the analysis of physical and expression contexts with respect to baseline distribution of transcript number and total transcript score of relevant reference cell types observed in the query dataset under the original cell segmentations. The inset plot at lower left corner in (<strong>B</strong>) shows the XY scatter plot of transcripts within an example pair of merging candidates, where Leiden clustering is performed on transcripts’ spatial coordinates to segregate them into different spatial clusters shown in different colors. The merging interface, as defined by the fraction of query transcripts sharing the same spatial clusters as the transcripts in its merging candidate partner, is used to evaluate whether sufficient physical contact exists between the pair of merging candidates, emphasizing the necessity of spatial constraint on a valid merging event.</p></figcaption></figure></section><section id="Sec5"><h3 class="pmc_sec_title">Spatial doublet test</h3>
<p id="Par15">FastReseg’s “spatial doublet test” is designed to identify cells whose expression profiles might erroneously include transcripts from adjacent cells, a situation we term “spatial doublets”. This concept extends traditional doublet detection from scRNA-seq by incorporating spatial context. Unlike scRNA-seq doublets which merge entire cellular transcripts, spatial doublets often involve direction-dependent contamination from fragments of adjacent cells. The precise transcript locations in spatial transcriptomics enables detection of such asymmetric patterns of inconsistency, going beyond the capabilities of traditional “bag-of-RNA” approach.</p>
<p id="Par16">Among various techniques appropriate for detecting spatial doublets, FastReseg uses polynomial regression to efficiently tackle this issue, making the assessment of millions of cells amenable. Specifically, FastReseg employs a quadratic model that predicts transcript scores based on the three-dimensional positions of transcripts within a cell (Fig. <a href="#Fig2" class="usa-link">2</a>A). For each cell, the algorithm compares the fit of this quadratic model to a null model, where the position is assumed not to influence transcript score. The p-values of likelihood ratio test between these two models serve as a metric to evaluate the presence of spatial doublets. Cells exhibiting small p-value suggest significant spatial dependencies in their transcript distributions and are flagged as potentially suffering from segmentation errors (Fig. <a href="#Fig2" class="usa-link">2</a>C). This approach not only highlights the cells with likely errors but also effectively filters out those with no apparent issues. With a reasonable cutoff (<span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq2"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/376bfe91695f/d33e375.gif" loading="lazy" id="d33e375" alt="Inline graphic"></span>), FastReseg excludes 80-90% of cells with no strong evidence of segmentation errors from further analysis (Fig. <a href="#Fig5" class="usa-link">5</a>A), substantially reducing unnecessary computational workload in subsequent steps of the pipeline.</p>
<figure class="fig xbox font-sm" id="Fig5"><h4 class="obj_head">Fig. 5.</h4>
<p class="img-box line-height-none margin-x-neg-2 tablet:margin-x-0 text-center"><a class="tileshop" target="_blank" href="https://www.ncbi.nlm.nih.gov/core/lw/2.0/html/tileshop_pmc/tileshop_pmc_inline.html?title=Click%20on%20image%20to%20zoom&amp;p=PMC3&amp;id=12368049_41598_2025_8733_Fig5_HTML.jpg"><img class="graphic zoom-in" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/16a078ff61fa/41598_2025_8733_Fig5_HTML.jpg" loading="lazy" id="d33e421" height="549" width="750" alt="Fig. 5"></a></p>
<div class="p text-right font-secondary"><a href="figure/Fig5/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div>
<figcaption><p>Performance evaluation of FastReseg on an example kidney dataset. (<strong>A</strong>) Bar plots on the composition of actions taken at cell level throughout the FastReseg workflow. While majority of cells (98.24%) with misassigned transcript groups identified by SVM modeling have received trimming during the transcript refinement stage, the bar plot at the center highlights the different refinement actions applied to the original host cells on top of trimming some transcripts to extracellular space, including merging those misassigned transcripts to neighboring cells (“merged”), designating them as new cells (“split_to_new”), or returning back to the host cell (“none”, <em>n</em> = 2 cells). Color legend of “with_trim” and “no_trim” indicates whether the host cells received more than one refinement actions. (<strong>B</strong>) Bar plots on the breakdown of operations conducted at the transcript level, illustrating the extent of transcript reassignment across the dataset. (<strong>C</strong>) Scatter plots of transcript number of each gene for each cell type. Only cells that received transcript trimming are included in this before-vs-removed comparison to show the impact of FastReseg refinement on original host cells under different cell types. The cell number included in each subplot is noted in the subtitle next to the cell type of interest. Dots for each gene are colored based on whether they are on-target or off-target marker genes for the cell type of interest. Genes that are not considered as mutually exclusive markers are colored in gray as “non-marker”. See Methods section (Table <a href="#Tab1" class="usa-link">1</a>) for the mutually exclusive marker genes used in this analysis. The solid, dotted and dashed lines indicate trimming at different percentages (0.1%, 1%, 10%). (<strong>D</strong>) Runtime and (<strong>E</strong>) peak memory usage of two FastReseg pipelines (flag-only and full-pipeline) along with other transcript-based cell segmentation methods (Proseg and Baysor) on datasets containing different transcript numbers. The statistics reported are based on processing using 75% cores of an Amazon r5b.4xlarge instance (16 vCPU, 128GB memory) unless otherwise noted in Methods section. The input spatial datasets were subsets of the CosMx kidney dataset either with different numbers of fields of view (Table <a href="#Tab2" class="usa-link">2</a>) or from different tissue sections (Table <a href="#Tab3" class="usa-link">3</a>), each containing varying cell numbers in their original cell segmentation.</p></figcaption></figure></section><section id="Sec6"><h3 class="pmc_sec_title">Detecting misassigned transcripts via support vector machine</h3>
<p id="Par18">For cells flagged by the spatial doublet test, the next crucial step involves identifying and isolating misassigned transcripts within these flagged cells. Given the fact that transcripts belong to the same source cell would stay in proximity to each other in physical space, FastReseg looks for spatially contiguous regions enriched with molecules of low transcript scores and considers transcripts residing in those regions to be the contaminants due to segmentation error irrespective to their individual transcript scores. Frameworks used in earlier works, such as hidden Markov random fields or building of molecular nearest-neighbor networks, are theoretically appealing but computationally expensive. FastReseg utilizes a more efficient strategy: a support vector machine (SVM)<sup><a href="#CR11" class="usa-link" aria-describedby="CR11">11</a></sup> with a radial kernel is fitted to the spatial distribution of the assigned transcript scores within each flagged cell under each cell’s most probable cell type. The trained SVM model can effectively predict low versus high transcript scores based on their 3D positions within the query cell (Fig. <a href="#Fig3" class="usa-link">3</a>A-B). The radial kernel is particularly suited for this task as it accommodates non-linear boundaries shaped by the physical contours of cells and can identify multiple, spatially distinct groups of low-score regions (Fig. <a href="#Fig3" class="usa-link">3</a>C) that may emanate from different source cells in the neighborhood of the query cell.</p>
<p id="Par19">The threshold defining low vs. high transcript scores is a critical turning parameter of the SVM-mediated detection of misassigned transcripts. FastReseg employs a default threshold of -2, which corresponds to a p-value of ~ 0.046 under the interpretation of transcript score as a log-likelihood ratio between two competing hypotheses about its cell type origin (see Supplementary Information). Adjusting this threshold higher can lead to a more aggressive approach which flags more molecules with intermediate evidence of poor fitting. Moreover, FastReseg offers the flexibility to modify SVM parameters, such as the gamma and cost, for fine control on the responsiveness of misassignment detection with respect to singlet transcript molecules. While the default value of SVM parameters set by the FastReseg package offers a commendable baseline for analyzing any new spatial dataset, users are free to explore and tailor their setup to the characteristics of the dataset of interest, such as the data richness—in terms of physical molecular density and gene content diversity—and the anticipated cellular morphology, whether it be round or exhibiting elongated protrusions. The impact of these parameter adjustments on FastReseg’s performance is illustrated in Supplementary Fig. <a href="#MOESM1" class="usa-link">S1</a>, which serves as a guideline for parameter optimization.</p></section><section id="Sec7"><h3 class="pmc_sec_title">Heuristic-based reassignment of flagged transcripts</h3>
<p id="Par20">After isolating misassigned transcripts and segregating them into spatially distinct groups, FastReseg can proceed to reassign those flagged transcript groups to their appropriate source cells. We opted to employ heuristic rules rather than more computationally intensive, algorithmically complex models such as the Markov Random Fields (MRFs) employed by Baysor<sup><a href="#CR7" class="usa-link" aria-describedby="CR7">7</a></sup>, or the training-required tandem deep neural networks (DNNs) utilized by JSTA<sup><a href="#CR8" class="usa-link" aria-describedby="CR8">8</a></sup>, or the Monte Carlo based inference approach adopted by Proseg<sup><a href="#CR9" class="usa-link" aria-describedby="CR9">9</a></sup>. Although these sophisticated models are theoretically appealing, they often do not offer proportional benefits in the context of sparse or fragmented datasets and might give spurious results disagreeing with morphological stain because of insufficient data points. Instead, the heuristic approach is chosen to strike an optimal balance between computational efficiency and the accuracy of segmentation refinement in spatial transcriptomics datasets which frequently comprise thin tissue sections harboring many partial cells. These partial cells typically contain limited transcriptional information, reducing the utility of applying complex models. The heuristic rules guiding FastReseg’s refinement process are grounded in a mechanistic understanding of cellular biology and the realistic distribution of transcripts within and across cells (see Methods section). As depicted in Fig. <a href="#Fig4" class="usa-link">4</a>, these rules pragmatically evaluate factors such as the distribution of transcript number and score for each cell type within the query dataset, the consistency of transcript profiles post-merging, the extent of spatial connection between merging candidates, and the feasibility of trimming transcripts to extracellular spaces when evidence suggests no presence of valid new-cell or merging event. In the next section, we will discuss the segmentation refinement outcomes generated with real-world spatial transcriptomics dataset.</p></section><section id="Sec8"><h3 class="pmc_sec_title">Evaluation of FastReseg performance</h3>
<p id="Par21">We evaluated FastReseg using a spatial transcriptomics dataset published by previous study<sup><a href="#CR12" class="usa-link" aria-describedby="CR12">12</a></sup>. This dataset was generated from archived clinical biopsies of human kidney samples at various stages of lupus nephritis and was collected using NanoString CosMx<sup>®</sup> platform and a 960-plex RNA panel. The cell segmentation coming with this dataset was performed using pretrained Cellpose models on 2D projected IF images of several morphological markers (DAPI, CD45, PanCK, CD20 and CD298). Thanks to the advanced machine-learning cell segmentation models, cell borders defined in the original cell segmentation results show strong agreement with the rich information encoded in the morphological images but fail to capture the 3D volumes of cells properly and suffer from border error in regions with weak or incomplete staining, an inevitable issue observed in real-world tissue samples. With these segmentation results, the original study has performed supervised cell typing against a reference expression matrix constructed based on external scRNA-seq datasets from Human Cell Atlas and other publications. While different cell clustering approaches could be used without significant impact, we leveraged the existing cell typing results for simplicity to generate the cluster-mean profiles observed in this CosMx kidney dataset and use them as reference profiles to derive transcript score for each gene under each expected cell type.</p>
<p id="Par22">In Fig. <a href="#Fig5" class="usa-link">5</a>A-B, we quantify the FastReseg outcomes across its modular process at both transcript and cell level when processing the entire kidney dataset through full pipeline. In first-tier process, FastReseg’s spatial doublet test flagged 22.07% of cells from the original segmentation results due to significant spatial dependency (p<span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq3"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/e76bd0a92545/d33e476.gif" loading="lazy" id="d33e476" alt="Inline graphic"></span>) in their transcript scores patterns. In second-tier process, 78.19% of those flagged cells were further identified by SVM spatial modeling to contain localized zones enriched of low-score transcripts (“SVM hits”). These zones, containing 0.64% of total intracellular transcripts, underwent further evaluation in the third-tier process of segmentation refinement. In this final tier, the heuristic-driven decision-making process led to over 98% of cells with SVM hits having their misassigned transcripts removed to extracellular space, impacting 78.09% of flagged transcripts. Additionally, 21.68% of all misassigned molecules were merged into neighboring cells that showed consistent transcriptional profiles in expression domain, affecting 1.74% of flagged cells. Notably, 10 original cells with SVM hits gave rise to new cells, representing 0.23% of identified misassigned transcripts. A very small subset of flagged cells (<em>n</em> = 2), despite showing SVM hits, received no refinement action; this typically occurred when the particular group of identified misassigned transcripts was best matched with its original host cell, possibly due to only marginal spatial dependency from only a handful of source molecules. This nuance emphasizes the stringency and robustness of transcript reassignment within FastReseg. Noticeably, some host cells in original segmentation could receive multiple types of refinement action (Fig. <a href="#Fig5" class="usa-link">5</a>A, center panel), illustrating the diverse outcomes possible with FastReseg’s refinement process. For detailed examples of the refinement actions undertaken by FastReseg across various stages of the full pipeline, refer to Supplementary Fig. S2.</p>
<p id="Par23">While it’s challenging to establish ground-truth segmentation for large spatial transcriptomics dataset, we sought to track the transcript reassignment for major cell types via a list of canonical mutually exclusive markers (Table <a href="#Tab1" class="usa-link">1</a>). Figure <a href="#Fig5" class="usa-link">5</a>C compares the number of transcripts originally observed within cell borders to the ones removed by FastReseg for different subpopulations of host cells that have received transcript reassignment. The on-target marker genes for major cell types showed a minimal trimming rate around 1%, confirming their relevance to the cells of interest. Conversely, transcripts from off-target marker genes, which are unlikely to be present in the host cells, were removed at higher rate, often exceeding 10%. The remaining genes (“non-marker”) exhibited a binary distribution in their trimming rate, as genes with high likelihood to be expressed within the cell type of interest tend to have low trimming rate within same bin as that of the canonical on-target markers. This selective behavior demonstrates the integrity of the FastReseg’s choice of transcript reassignment and helps to reduce the ambiguity of the resulting single-cell expression profiles, offering a clearer insight into the cellular biology within the sampled tissue.</p>
<section class="tw xbox font-sm" id="Tab1"><h4 class="obj_head">Table 1.</h4>
<div class="caption p"><p>Cell-type-specific on-target marker genes used in Figs. <a href="#Fig5" class="usa-link">5</a>C and <a href="#Fig6" class="usa-link">6</a>D-E.</p></div>
<div class="tbl-box p" tabindex="0"><table class="content" frame="hsides" rules="groups">
<thead><tr>
<th align="left" colspan="1" rowspan="1">Cell type</th>
<th align="left" colspan="1" rowspan="1">On-target markers</th>
</tr></thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">Fibroblast</td>
<td align="left" colspan="1" rowspan="1">LUM, COL1A1, COL3A1</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Macrophage</td>
<td align="left" colspan="1" rowspan="1">CD163, C1QA, C1QC</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Plasma (B-cell &amp; Plasmablast)</td>
<td align="left" colspan="1" rowspan="1">IGHG2, IGKC, JCHAIN</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Podocyte</td>
<td align="left" colspan="1" rowspan="1">SPOCK2, PLA2R1, PTGDS, VEGFA</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">PCT (Proximal.tubule)</td>
<td align="left" colspan="1" rowspan="1">DDC, IL17RB, GPX3</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Myofibroblast</td>
<td align="left" colspan="1" rowspan="1">MYH11, ACTA2</td>
</tr>
</tbody>
</table></div>
<div class="p text-right font-secondary"><a href="table/Tab1/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div></section></section><section id="Sec9"><h3 class="pmc_sec_title">Processing efficiency and scalability</h3>
<p id="Par24">The whole CosMx kidney dataset comprises over 79 million transcripts across 123 fields of view (FOVs) each covering a 0.985 mm x 0.657 mm area with 0.4 ~ 1.2 million transcripts. All transcripts for each FOV are consolidated into one single file. The size of this large dataset poses a significant challenge for existing transcript-dominant cell segmentation methods, whose runtime and peak memory usage typically scale linearly with transcript quantity. For context (Fig. <a href="#Fig5" class="usa-link">5</a>D-E; Table <a href="#Tab3" class="usa-link">3</a>), we have observed 93 min runtime and 15.17 GB peak memory consumption for Proseg processing on a subset of the CosMx kidney dataset containing 19 million transcripts, while Baysor took &gt; 23 h and 142 GB peak memory on the same data subset.</p>
<section class="tw xbox font-sm" id="Tab3"><h4 class="obj_head">Table 3.</h4>
<div class="caption p"><p>Number of fovs, cells with positive RNA counts and RNA transcripts in each subset of CosMx kidney dataset used in Proseg and Baysor processing in Figs. <a href="#Fig5" class="usa-link">5</a>D-E and <a href="#Fig6" class="usa-link">6</a>.</p></div>
<div class="tbl-box p" tabindex="0"><table class="content" frame="hsides" rules="groups">
<thead><tr>
<th align="left" colspan="1" rowspan="1">Tissue Sample ID</th>
<th align="left" colspan="1" rowspan="1">FOV #</th>
<th align="left" colspan="1" rowspan="1">Cell #</th>
<th align="left" colspan="1" rowspan="1">RNA Transcript #</th>
</tr></thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">1</td>
<td align="center" colspan="1" rowspan="1">13</td>
<td align="center" colspan="1" rowspan="1">31,568</td>
<td align="center" colspan="1" rowspan="1">7,437,310</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">2</td>
<td align="center" colspan="1" rowspan="1">16</td>
<td align="center" colspan="1" rowspan="1">23,646</td>
<td align="center" colspan="1" rowspan="1">4,923,804</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">3</td>
<td align="center" colspan="1" rowspan="1">12</td>
<td align="center" colspan="1" rowspan="1">30,515</td>
<td align="center" colspan="1" rowspan="1">9,245,155</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">4</td>
<td align="center" colspan="1" rowspan="1">8</td>
<td align="center" colspan="1" rowspan="1">14,970</td>
<td align="center" colspan="1" rowspan="1">3,173,182</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">5</td>
<td align="center" colspan="1" rowspan="1">18</td>
<td align="center" colspan="1" rowspan="1">61,336</td>
<td align="center" colspan="1" rowspan="1">19,085,473</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">6</td>
<td align="center" colspan="1" rowspan="1">8</td>
<td align="center" colspan="1" rowspan="1">17,799</td>
<td align="center" colspan="1" rowspan="1">4,593,633</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">7</td>
<td align="center" colspan="1" rowspan="1">7</td>
<td align="center" colspan="1" rowspan="1">14,063</td>
<td align="center" colspan="1" rowspan="1">2,568,850</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">8</td>
<td align="center" colspan="1" rowspan="1">17</td>
<td align="center" colspan="1" rowspan="1">39,754</td>
<td align="center" colspan="1" rowspan="1">7,077,431</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">9</td>
<td align="center" colspan="1" rowspan="1">11</td>
<td align="center" colspan="1" rowspan="1">36,546</td>
<td align="center" colspan="1" rowspan="1">6,011,584</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">10</td>
<td align="center" colspan="1" rowspan="1">13</td>
<td align="center" colspan="1" rowspan="1">49,772</td>
<td align="center" colspan="1" rowspan="1">15,489,886</td>
</tr>
</tbody>
</table></div>
<div class="p text-right font-secondary"><a href="table/Tab3/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div></section><p id="Par25">In contrast, FastReseg is designed with maximizing computational efficiency in mind and engineered to handle big datasets that are often required for studying complex biological problems. FastReseg’s workflow processes transcriptional data on a per-input-file basis, markedly reducing the memory footprint required for large dataset and facilitating effective parallelization across multiple CPU cores. On an Amazon r5b.4xlarge instance (16 vCPUs, 128GB total memory) using 75% available cores (i.e. 12 cores), FastReseg maintained a stable peak memory usage at 32 ~ 37 GB across input size from 20 ~ 79 million transcripts during flag-only processing that evaluates and separates misassigned transcripts (Fig. <a href="#Fig5" class="usa-link">5</a>E). The full pipeline, which adds more computationally demanding steps of segmentation refinement, used just 2 ~ 5 GB more peak memory on the same input. This relatively constant peak memory usage was observed when the number of per-FOV input files exceeded the number of usable CPU cores, and originated from FastReseg’s per-file data ingestion and its architecture of parallelized computation. When input files are fewer than the usable cores (e.g. the first 2 data subsets with 5 or 10 FOVs, Table <a href="#Tab2" class="usa-link">2</a>), FastReseg’s peak memory usage scales linearly with the transcript number. If reducing peak memory consumption is a priority, further optimizations can be achieved by splitting transcripts into smaller image tiles with fewer data per input file or adjusting the percentage of cores utilized by FastReseg via its `percentCores` argument.</p>
<section class="tw xbox font-sm" id="Tab2"><h4 class="obj_head">Table 2.</h4>
<div class="caption p"><p>Number of FOV, cells with ≥ 50 counts/cell and Raw transcripts in each subset of CosMx kidney dataset used in Fastreseg processing in Figs. <a href="#Fig5" class="usa-link">5</a>D-E and <a href="#Fig6" class="usa-link">6</a>.</p></div>
<div class="tbl-box p" tabindex="0"><table class="content" frame="hsides" rules="groups">
<thead><tr>
<th align="left" colspan="1" rowspan="1">FOV #</th>
<th align="left" colspan="1" rowspan="1">Cell #</th>
<th align="left" colspan="1" rowspan="1">Transcript #</th>
</tr></thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">5</td>
<td align="center" colspan="1" rowspan="1">16,157</td>
<td align="center" colspan="1" rowspan="1">4,846,125</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">10</td>
<td align="center" colspan="1" rowspan="1">33,793</td>
<td align="center" colspan="1" rowspan="1">10,104,717</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">20</td>
<td align="center" colspan="1" rowspan="1">65,408</td>
<td align="center" colspan="1" rowspan="1">19,691,814</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">50</td>
<td align="center" colspan="1" rowspan="1">161,547</td>
<td align="center" colspan="1" rowspan="1">44,376,396</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">100</td>
<td align="center" colspan="1" rowspan="1">249,910</td>
<td align="center" colspan="1" rowspan="1">68,422,200</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">123</td>
<td align="center" colspan="1" rowspan="1">296,838</td>
<td align="center" colspan="1" rowspan="1">79,392,002</td>
</tr>
</tbody>
</table></div>
<div class="p text-right font-secondary"><a href="table/Tab2/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div></section><p id="Par26">FastReseg’s modular, tiered design targets intensive computation only to the cells that mostly need segmentation correction, resulting in similar runtimes between flag-only and full pipeline with only 2 ~ 26 min difference depending on the number of transcripts involved. When processing a typical benchmarking load of 4.8 million transcripts, FastReseg completed the flagging in just 3.11 min and the full pipeline in 5.76 min, making it ~ 24x faster than Baysor (138.8 min) and 3x faster than Proseg (19.28 min). For the full 79 million transcript dataset, which are unmanageable by both Baysor and Proseg due to their prohibitive peak memory consumption, FastReseg adeptly completed the full pipeline within 45.5 min, maintaining a peak memory usage of only 45 GB. This blend of speed and efficiency makes FastReseg a feasible tool for processing large-scale spatial transcriptomics datasets, enabling complex biological research on big sample collections to proceed smoothly.</p></section><section id="Sec10"><h3 class="pmc_sec_title">Comparison with transcript-dominant approaches</h3>
<p id="Par27">Transcript-based segmentation methods differ fundamentally in how they incorporate prior cell boundaries. FastReseg follows a “revision-based” strategy which selectively adjusts cell boundaries only when supported by local transcript evidence. In contrast, Proseg and Baysor adopt more aggressive “reassignment-based” approaches where transcript assignment is primarily driven by local pattern, with penalties applied based on distance from the initial cell centroids.</p>
<p id="Par28">As shown in Fig. <a href="#Fig6" class="usa-link">6</a>A, both Proseg and Baysor assign significantly more transcripts as intracellular than the original segmentation. Much of this increase arises from regions that have spatially diffusive transcript patterns but lack clear morphological evidence of cell presence. At the single-cell level (Fig. <a href="#Fig6" class="usa-link">6</a>B), Proseg recovers fewer cells but generates a small population (~ 0.6%) of extreme outliers with &gt; 2000 RNA transcripts per cell and 2 ~ 3.6x larger volume. These outliers occur near tissue edges, where image-based segmentation leaves large cell-free regions nearby. Besides, Proseg results also exhibit a systematic rightward skew in the RNA count distribution (Fig. <a href="#Fig6" class="usa-link">6</a>C) with more cells containing elevated transcript levels. Baysor, by contrast, over-segmented cells, resulting in ~ 5.5x more cells, each with fewer transcripts due to its emphasis on expression purity. These characteristics behaviors are further illustrated in Supplementary Fig. S3, which provides visual examples of segmentation outcomes.</p>
<figure class="fig xbox font-sm" id="Fig6"><h4 class="obj_head">Fig. 6.</h4>
<p class="img-box line-height-none margin-x-neg-2 tablet:margin-x-0 text-center"><a class="tileshop" target="_blank" href="https://www.ncbi.nlm.nih.gov/core/lw/2.0/html/tileshop_pmc/tileshop_pmc_inline.html?title=Click%20on%20image%20to%20zoom&amp;p=PMC3&amp;id=12368049_41598_2025_8733_Fig6_HTML.jpg"><img class="graphic zoom-in" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/298ebda8b66b/41598_2025_8733_Fig6_HTML.jpg" loading="lazy" id="d33e574" height="719" width="763" alt="Fig. 6"></a></p>
<div class="p text-right font-secondary"><a href="figure/Fig6/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div>
<figcaption><p>Comparison of segmentation outcomes across different segmentation methods. (<strong>A</strong>) RNA transcript assignment composition across 10 tissue samples from the CosMx kidney dataset using different segmentation methods: original image-based segmentation, FastReseg full-pipeline, Proseg and Baysor. All transcript-based segmentation methods were provided with the image-based segmentation outcomes as prior. Transcripts labeled as “background” include those marked as “background” by Proseg or with reported assignment confidence &lt; 0.9 by Baysor. (<strong>B</strong>) Bar plots showing the number of RNA-containing cells identified by different methods on the full CosMx kidney dataset. Red labels indicate the percentage of cells containing over 2000 RNA transcript counts. (<strong>C</strong>) Histogram of RNA count per cell across methods. The original image-based segmentation is shown as a blue line, while transcript-based methods are displayed as filled curves in separate subplots. Vertical dashed lines mark threshold at 20 and 2000 RNA counts per cell. (<strong>D</strong>,<strong> E</strong>) Per-sample average off-target correlation between marker groups (Table <a href="#Tab1" class="usa-link">1</a>), computed from single-cell expression profiles of all 10 individual CosMx kidney samples (Table <a href="#Tab3" class="usa-link">3</a>). Correlation was measured using the Pearson correlation of single-cell metagene scores between mutually exclusive marker groups. (<strong>D</strong>) includes all cells with at least one RNA transcript, while (<strong>E</strong>) includes only cells with 20 ~ 2000 RNA transcripts. Each subplot shows a query marker group’s correlation with other groups as stacked bar plots, with values &gt; 0.05 labeled. Each bar along the x-axis corresponds to one segmentation method, while each color corresponds to one marker group. The color legend for marker groups is shared between (<strong>D</strong>) and (<strong>E</strong>).</p></figcaption></figure><p id="Par30">These segmentation behaviors directly influence downstream single-cell expression profiles. When analyzing off-target correlation across all cells (Fig. <a href="#Fig6" class="usa-link">6</a>D), Proseg exhibits inflated correlation values driven by its high-count outlier cells. But when filtering for cells with 20 ~ 2000 transcripts (Fig. <a href="#Fig6" class="usa-link">6</a>E), all transcript-based methods reduce off-target correlation from the original values, with Baysor showing the largest drop owing to its smaller, lower-count cells. FastReseg, meanwhile, preserves the original transcript count distribution while offering a modest yet consistent reduction in off-target correlation. Crucially, Fig. <a href="#Fig5" class="usa-link">5</a>C reveals that FastReseg’s conservative approach still achieves meaning biological refinement as it trims off-target markers far more than on-target ones, enhancing the interpretability and purity of expression profiles without overhauling the segmentation landscape.</p></section></section><section id="Sec11"><h2 class="pmc_sec_title">Discussion</h2>
<p id="Par31">We introduce a novel category of cell segmentation algorithm with FastReseg, which employs transcriptomic data to rectify apparent errors in prior image-based segmentation, rather than defining cell segmentation boundaries dominantly from transcriptional data. This methodology distinguishes itself from other transcript-based segmentation algorithms by reducing the risk of analytical circularity and enhancing computational efficiency. FastReseg’s adept integration of 3D cellular structures through transcriptional data into its analysis framework enables it to pinpoint segmentation inaccuracies that evade detection in conventional 2D imaging approaches. Since it functions to evaluate and refine the output of existing cell segmentation, FastReseg will remain relevant and valuable even as image-based segmentation techniques continue to advance.</p>
<p id="Par32">The workflow of FastReseg consists of four distinct steps: scoring transcripts with respect to their initial host cells, identifying cells with putative segmentation errors through the “spatial doublet” test, flagging misassigned transcripts, and decisively managing the fate of these transcripts. We present this methodology as a versatile and easily extensible framework, with FastReseg being its first instantiation. This modular design allows independent enhancement of each component and easy integration of future improvements. Additionally, FastReseg’s architecture excels in processing large datasets, a common challenge in transcript-based segmentation. Its ability to manage extensive data efficiently positions it as a practical solution for large-scale spatial transcriptomics studies.</p>
<p id="Par33">FastReseg’s core methodology involves scoring each transcript for its fit within its respective cell, effectively transforming the discrete gene identities into interpretable likelihood ratios. This simplification facilitates broader applicability across diverse gene panels and enables rapid detection of segmentation errors with minimal overhead when coupled with the spatial doublet test. We anticipate this scoring system to be a valuable tool for other applications in transcript-driven segmentation analysis.</p>
<p id="Par34">FastReseg employs a conservative strategy for flagging potentially misassigned transcripts, requiring both poor transcriptomic fit based on gene identity, and spatial inconsistency with the shape of the host cell. This dual constraint minimizes the risk of circularity—where the same transcript data can unduly influence both the correction and resulting expression profiles. The current SVM model within FastReseg effectively identifies the most apparent errors, thereby improving the accuracy of single-cell expression profiles. Users can adjust parameters such as gamma and cost to fine-tune the model’s sensitivity to spatial versus expression-based discrepancies, allowing adaptation to different tissue types or data quality. While effective for clear-cut cases, further improvements could target subtle misassignments.</p>
<p id="Par35">In datasets derived from thin tissue sections, partial cells are common. Removing all flagged transcripts based on FastReseg’s criteria typically results in cleaner and more reliable data for downstream analyses, while reducing the needs for extensive computation to segment cells with sparse transcriptional content. For more complex refinement scenarios, FastReseg applies a heuristic strategy to rapidly reassign flagged transcripts. This approach assumes that the initial image-based segmentation provides a high-confidence identification of cells, despite imprecision in exact boundary location or occasional errors caused by poor staining or limited 3D resolution. While FastReseg can generate new cells from localized misassigned transcript clusters within existing segmentation, it does not currently detect cells composed entirely of extracellular transcripts unassigned in the original segmentation. This reflects FastReseg’s design as a refinement tool that operates on the results of image-based segmentation. As a result, cells that are severely fragmented across multiple neighbors without a sufficient anchor transcript group may be missed. However, such cases are unlikely to yield reliable single-cell profiles due to low transcript abundance and ambiguity in morphological images. FastReseg’s conservative design ensures that these ambiguous transcripts are removed rather than misassigned, helping preserve the integrity of downstream analysis. If the foundational image-based segmentation is severely flawed, its error-detection features can still be used to evaluate segmentation quality; however, re-running image-based cell segmentation using modern machine learning techniques<sup><a href="#CR13" class="usa-link" aria-describedby="CR13">13</a></sup> is recommended prior to apply FastReseg’s refinement process.</p>
<p id="Par36">Because FastReseg’s workflow focuses its segmentation refinement actions exclusively on cells identified as spatial doublets, it currently does not target minor boundary inaccuracies that affect just one or two transcripts. Such small discrepancies typically have limited downstream impact but may introduce subtle artifacts in differential expression analysis on narrowly defined subpopulations. Enhancing FastReseg to support finer-grained boundary refinement is a valuable direction for future work.</p>
<p id="Par37">In summary, FastReseg marks a pivotal development in the field of spatial transcriptomics, offering key innovations and advantages for the detection and correction of cell segmentation errors. Its powers in processing massive datasets efficiently, along with its modular and extensible framework, positions FastReseg as a vital tool for future research. As image-based segmentation technologies advance, FastReseg’s ability to refine segmentation outputs through the integration of transcriptional data ensures that it will continue to provide valuable insights and improvements in cell segmentation accuracy. Moving forward, the continuous enhancement of FastReseg’s capabilities, particularly in addressing cells in initial extracellular space and minor segmentation errors, will further cement its role as a crucial asset for researchers exploring the intricate landscape of spatial transcriptomics.</p></section><section id="Sec12"><h2 class="pmc_sec_title">Methods</h2>
<section id="Sec13"><h3 class="pmc_sec_title">Reference transcript profile generation</h3>
<p id="Par38">The cluster-specific reference expression profiles represent the expected expression patterns of genes for distinct cell types within the sample and could be generated either from external sources or derived from the query dataset of interest. To get reference profiles from external sources, one can use previous single-cell RNA sequencing (scRNA-seq) or spatial transcriptomics datasets of similar tissue type and disease condition. Public databases for various cell atlas programs could be a good resource for such datasets. With the external dataset of choice, one can then calculate the average expression of each cell type in that dataset to be used as reference profiles. Alternatively, one could do cell typing on query dataset based on existing initial cell segmentation using any sensible clustering strategy, such as unsupervised Leiden clustering, reference-based supervised cell typing, or embedding-based label transfer. The initial cell segmentation, which could be based on the 2D morphological images of given query dataset, often has errors on the exact cell borders but is typically sufficient to capture the general gene expression differences across major cell types present in the sample. FastReseg package could then take the cell clusters assigned to query dataset and calculate the cluster-mean profiles for all provided clusters and use that as reference profiles.</p></section><section id="Sec14"><h3 class="pmc_sec_title">Scoring transcripts within cells</h3>
<p id="Par39">Using the reference profiles provided, FastReseg assigns every transcript an expression-based goodness-of-fit score, <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq4"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/e93cf3b1100b/d33e617.gif" loading="lazy" id="d33e617" alt="Inline graphic"></span> (for “transcript log likelihood ratio”). The scoring process starts by scoring each gene under each cell type. FastReseg calculates the likelihood of gene <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq5"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/c4ddf470d238/d33e623.gif" loading="lazy" id="d33e623" alt="Inline graphic"></span> given cell type <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq6"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/10c81be4a07d/d33e629.gif" loading="lazy" id="d33e629" alt="Inline graphic"></span> based on the provided cluster-mean reference profiles <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq7"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/fb3974834ce0/d33e635.gif" loading="lazy" id="d33e635" alt="Inline graphic"></span>:</p>
<table class="disp-formula p" id="Equa"><tr><td class="formula"><img class="graphic" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/3e39535fdf44/d33e641.gif" loading="lazy" id="d33e641" alt="graphic file with name d33e641.gif"></td></tr></table>
<p id="Par40">where <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq8"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/eddba3aea424/d33e648.gif" loading="lazy" id="d33e648" alt="Inline graphic"></span> is the count of gene <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq9"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/a086866e2160/d33e654.gif" loading="lazy" id="d33e654" alt="Inline graphic"></span> under cell type <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq10"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/10c81be4a07d/d33e660.gif" loading="lazy" id="d33e660" alt="Inline graphic"></span> in cluster-mean reference profiles.</p>
<p id="Par41">From these likelihood scores, we compute log-likelihood ratios for the cell type in question relative to the best-fitting cell type across all expected cell types in given query dataset:</p>
<table class="disp-formula p" id="Equb"><tr><td class="formula"><img class="graphic" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/af48af847ca0/d33e668.gif" loading="lazy" id="d33e668" alt="graphic file with name d33e668.gif"></td></tr></table>
<p id="Par42">For a derivation of how tLLR scores act as a likelihood ratio test, see Supplementary Information.</p>
<p id="Par43">Secondly, FastReseg would identify the most probable cell type for each individual cell in query dataset based on which reference cell type gives the maximum total <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq11"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/e93cf3b1100b/d33e677.gif" loading="lazy" id="d33e677" alt="Inline graphic"></span> score given the cell’s gene expression profile in initial cell segmentation. Then each transcript has an assigned <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq12"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/e93cf3b1100b/d33e683.gif" loading="lazy" id="d33e683" alt="Inline graphic"></span> score, <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq13"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/78c09d586c3e/d33e689.gif" loading="lazy" id="d33e689" alt="Inline graphic"></span> based on its gene <em>j</em> and assigned cell type <em>k</em>. This score quantifies the alignment of the transcript’s profile with the known characteristics of its most likely cell type <em>k</em>, facilitating the initial screening for potential outliers or misclassified transcripts.</p></section><section id="Sec15"><h3 class="pmc_sec_title">Scoring cells for putative segmentation error</h3>
<p id="Par44">Cells with segmentation errors—especially those located at the boundaries between distinct cell types—are expected to exhibit high spatial dependency in their <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq14"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/e93cf3b1100b/d33e709.gif" loading="lazy" id="d33e709" alt="Inline graphic"></span> transcript score profiles. This assumption could be validated by overlaying <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq15"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/e93cf3b1100b/d33e715.gif" loading="lazy" id="d33e715" alt="Inline graphic"></span> score profiles on membrane-stained images to confirm discrepancies between segmentation boundaries used for score calculation and the underlying biological structure. FastReseg uses linear regression model to simulate the spatial pattern of <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq16"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/e93cf3b1100b/d33e721.gif" loading="lazy" id="d33e721" alt="Inline graphic"></span> score profiles within a given cell and use likelihood ratio test `lrtest()` from `lmtest` R package<sup><a href="#CR14" class="usa-link" aria-describedby="CR14">14</a></sup> to compare it against a null spatial-invariant model to evaluate the degree of spatial dependency:</p>
<table class="disp-formula p" id="Equc"><tr><td class="formula"><img class="graphic" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/f6460bcd4e66/d33e733.gif" loading="lazy" id="d33e733" alt="graphic file with name d33e733.gif"></td></tr></table>
<table class="disp-formula p" id="Equd"><tr><td class="formula"><img class="graphic" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/06a7baecf9d4/d33e739.gif" loading="lazy" id="d33e739" alt="graphic file with name d33e739.gif"></td></tr></table>
<p id="Par47">where <em>score</em> is the <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq19"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/e93cf3b1100b/d33e750.gif" loading="lazy" id="d33e750" alt="Inline graphic"></span> score of each transcript under the most probable cell type of the query cell and <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq20"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/fdfff813a087/d33e756.gif" loading="lazy" id="d33e756" alt="Inline graphic"></span>, <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq21"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/efcc4ad69ea7/d33e762.gif" loading="lazy" id="d33e762" alt="Inline graphic"></span>, <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq22"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/26532f24c49a/d33e768.gif" loading="lazy" id="d33e768" alt="Inline graphic"></span> are the spatial coordinates of the transcript. For transcript data with only 2D coordinates, terms associated with <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq23"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/26532f24c49a/d33e775.gif" loading="lazy" id="d33e775" alt="Inline graphic"></span> are removed from the alternative model.</p>
<p id="Par48">The spatial dependency score of each cell is then defined as the negative log<sub>10</sub> value of the p-value from a likelihood ratio test comparing the two models. Cells with scores above a designated threshold are flagged as putative spatial doublets. Of note, FastReseg does not evaluate cells with very few intracellular transcripts due to low statistical power to detect spatial dependency in their transcript scores. The values used in this paper are set to 50 for minimal transcript number allowed in spatial modeling and 3 for minimal spatial dependency score of a cell flagged with putative segmentation error.</p></section><section id="Sec16"><h3 class="pmc_sec_title">Identification of transcript groups susceptible to segmentation errors</h3>
<p id="Par49">To flag misassigned transcripts, FastReseg first separates transcripts within flagged cells based on the provided cutoff on <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq24"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/e93cf3b1100b/d33e789.gif" loading="lazy" id="d33e789" alt="Inline graphic"></span> scores into two classes and then trains a support vector machine (SVM)<sup><a href="#CR11" class="usa-link" aria-describedby="CR11">11</a></sup> to discern the optimal physical boundary that separates well-aligned (score above cutoff) transcripts from poorly aligned (score below cutoff) transcripts in each query cell.</p>
<table class="disp-formula p" id="Eque"><tr><td class="formula"><img class="graphic" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/dd01c87a49be/d33e799.gif" loading="lazy" id="d33e799" alt="graphic file with name d33e799.gif"></td></tr></table>
<p id="Par51">where <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq26"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/26532f24c49a/d33e806.gif" loading="lazy" id="d33e806" alt="Inline graphic"></span> term would be removed for 2D transcript data and additional arguments<sup><a href="#CR15" class="usa-link" aria-describedby="CR15">15</a></sup>, like <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq27"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/8d187b26fcf8/d33e816.gif" loading="lazy" id="d33e816" alt="Inline graphic"></span> and <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq28"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/3328d8d24c42/d33e822.gif" loading="lazy" id="d33e822" alt="Inline graphic"></span>, could be used to control the margin between the two classes of transcripts, adjusting the tightness of decision boundary around the hot spots of the poorly aligned transcripts (Supplementary Fig. <a href="#MOESM1" class="usa-link">S1</a>). A critical tuning parameter is the threshold for calling transcript scores as low versus high: setting this threshold higher produces a much more aggressive flagging of transcripts. FastReseg defaults to a threshold of -2, corresponding to a p-value of 0.046 under the interpretation of transcript score as a log-likelihood ratio between two hypotheses (see Supplementary Information section).</p>
<p id="Par52">The SVM-based classification approach assumes that misassigned transcripts originate from physically neighboring cells in space and thus transcripts within a physically contiguous low-score region likely belong to the same neighboring cell regardless of their individual <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq29"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/e93cf3b1100b/d33e833.gif" loading="lazy" id="d33e833" alt="Inline graphic"></span> scores. Therefore, transcripts predicted by SVM to have low scores are flagged as misassigned transcripts. This approach not only allows for the identification of misassigned cell-type-specific marker transcripts but also extends their impact to neighboring transcripts that may not exhibit strong cell-type-specific expression profiles. In the context of thin tissue sections, one could clean up the current single-cell expression matrix simply by trimming those transcripts, since majority of those misassigned transcripts come from the vertical overlapping of source cells with minor insertions into the assayed tissue section.</p>
<p id="Par53">Once misassigned transcripts are identified via SVM, FastReseg could further divide them into spatially distinct groups for downstream re-segmentation process if the complete refinement of segmentation is desired. FastReseg offers two methods to segregate those misassigned transcripts in space: density-based spatial clustering (DBSCAN) and Delaunay-based spatial network analysis. The former method uses `dbscan` package<sup><a href="#CR16" class="usa-link" aria-describedby="CR16">16</a></sup> to identify clusters of physically packed transcripts based on their local density at fast speed. The later method leverages `GiottoClass` package<sup><a href="#CR17" class="usa-link" aria-describedby="CR17">17</a></sup> to create a Delaunay network<sup><a href="#CR18" class="usa-link" aria-describedby="CR18">18</a></sup> of those misassigned transcripts and identifies the transcript groups with higher accuracy based on the spatial connectivity between neighboring transcripts, facilitating the detection of potentially separate sources of misassigned molecules. The results used in this paper were generated with density-based method unless noted otherwise.</p></section><section id="Sec17"><h3 class="pmc_sec_title">Cell segmentation refinement</h3>
<p id="Par54">Each spatially distinct group of misassigned transcripts is considered as potentially originating from different neighboring source cells. To correct those putative segmentation errors, we developed a heuristic-based approach for reassigning groups of transcripts to their correct cellular origins. The process is systematically outlined in the accompanying schematic (Fig. <a href="#Fig4" class="usa-link">4</a>), which serves as the foundation for our segmentation refinement methodology. This section details the step-by-step process utilized in our analysis to determine the appropriate refinement action for each transcript group based on their spatial and transcriptomic context.</p>
<section id="Sec18"><h4 class="pmc_sec_title">A. Defining heuristic thresholds</h4>
<p id="Par55">Initially, we established specific cutoffs for the number of transcripts and the transcript <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq30"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/e93cf3b1100b/d33e864.gif" loading="lazy" id="d33e864" alt="Inline graphic"></span> score for each reference cell type. These thresholds were determined based on the baseline distribution of these metrics across all identified cell types in the query dataset under original cell segmentation. This initial step ensures that subsequent decisions are tailored to the specific characteristics and variability inherent in the dataset for that given cell type.</p></section><section id="Sec19"><h4 class="pmc_sec_title">B. Spatial and transcriptomic analysis</h4>
<p id="Par56">The refinement process begins with the identification of each transcript group’s direct neighbors within the tissue’s spatial context. FastReseg constructs a Delaunay network between transcript group and its neighboring cells or groups using their spatial coordinates and defines a direct neighbor based on its minimum molecule-to-molecule distance to transcripts within query group. The distance cutoff used in this paper is 2.7 μm and one can adjust this cutoff based on the observed transcript density, which could be calculated using `FastReseg::runPreprocess()` function. For each group of misassigned transcripts, we assess their <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq31"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/5efa87bb6cf3/d33e874.gif" loading="lazy" id="d33e874" alt="Inline graphic"></span>scores under the most probable cell types of itself and its direct neighbors. This dual assessment helps determine the most suitable refinement action based on local transcriptomic profiles.</p></section><section id="Sec20"><h4 class="pmc_sec_title">C. Decision-Making for transcript reassignment</h4>
<p id="Par57">The decision tree detailed in our schematic (Fig. <a href="#Fig4" class="usa-link">4</a>B) directs the transcript reassignment process, employing a combination of criteria based on transcript number and total <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq32"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/e93cf3b1100b/d33e887.gif" loading="lazy" id="d33e887" alt="Inline graphic"></span> score under relevant cell types. Here is a clarified and concise description of this process:</p>
<ul class="list" style="list-style-type:disc">
<li><p id="Par59"><strong>New Cell</strong>: A query transcript group is classified as a new cell if it has sufficient number of transcript molecules and a high enough total <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq33"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/e93cf3b1100b/d33e901.gif" loading="lazy" id="d33e901" alt="Inline graphic"></span> score under its most probable cell type. This ensures that the new cell is identified based on robust and distinct transcriptomic evidence.</p></li>
<li><p id="Par60"><strong>Merging</strong>: Transcript groups that do not meet the criteria for a new cell are assessed for potential merging. This assessment considers their highest <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq34"><img class="inline" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/5331/12368049/5efa87bb6cf3/d33e912.gif" loading="lazy" id="d33e912" alt="Inline graphic"></span>score under the most probable cell type of their direct neighbors. A merging event is considered valid if the transcript group aligns transcriptionally with a neighboring cell or group and exhibits a substantial physical merging interface. Specifically, at least 50% of the transcripts within the query group must share the same spatial clusters as those in its adjacent merging candidate. This criterion not only confirms a strong spatial connection between the query cell and its potential merging partner but also maintains the geometric properties of the resulting merged cells. This spatial constraint for merging may be adjusted for tissue samples known to contain elongated cells or cells with protrusions, by modifying the threshold for the minimal fraction of transcripts under shared spatial clusters.</p></li>
<li><p id="Par61"><strong>Trimming</strong>: Transcript groups that fail to meet the criteria for either a new cell or merging are considered as extracellular. These groups typically contain only a few transcripts and are either transcriptionally distinct from all direct neighbors or lack sufficient spatial clustering overlap with any transcriptionally aligned neighbor. Such groups are likely derived from source cells that were vertically overlapping with the query cell in the original intact tissue but do not retain enough material in the thin tissue section used for the dataset.</p></li>
</ul>
<p id="Par62">These criteria ensure that each transcript group is evaluated based on both quantitative and spatial metrics, providing a systematic approach to accurately reassign those poorly fitted transcript groups in a context-sensitive way in spatial transcriptomics dataset.</p></section></section><section id="Sec21"><h3 class="pmc_sec_title">Spatial transcriptomics datasets</h3>
<p id="Par63">The `FastReseg` package (<a href="https://github.com/Nanostring-Biostats/FastReseg" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://github.com/Nanostring-Biostats/FastReseg</a>) contains a small example dataset on FFPE melanoma tissue samples collected on CosMx Spatial Molecular Imager platform. The cell segmentation of this melanoma dataset was conducted with Cellpose models and derived from tissue images with DAPI nuclear stain and immunofluorescence stains against PanCK, CD45, CD298 and DAPI. This dataset al.so includes semi-supervised cell typing results which were generated using `InSituType` package<sup><a href="#CR19" class="usa-link" aria-describedby="CR19">19</a></sup> and a scRNA-seq derived SafeTME matrix published for tumor-immune deconvolution in solid tumors<sup><a href="#CR20" class="usa-link" aria-describedby="CR20">20</a></sup>. Six novel clusters were identified in this example dataset and have cluster names as “a” to “f” letters. We use this melanoma dataset to generate figures illustrating the FastReseg workflow. See the manual of package for more information regarding this melanoma example.</p>
<p id="Par64">The spatial transcriptomics dataset used in Figs. <a href="#Fig5" class="usa-link">5</a> and <a href="#Fig6" class="usa-link">6</a> and Supplementary Fig. <a href="#MOESM1" class="usa-link">S1</a>-S3 to demonstrate the performance of FastReseg algorithm is published by previous study<sup><a href="#CR12" class="usa-link" aria-describedby="CR12">12</a></sup> and could be downloaded from 10.6084/m9.figshare.c.7373860. FFPE sections of clinical biopsy kidney samples were profiled using CosMx Spatial Molecular Imager and the 960-plex CosMx Human Universal Cell Characterization RNA panel. Cell typing and initial cell segmentation was taken as it is from previous study and used to derive reference profiles for FastReseg processing. More than 79 million transcript molecules collected from 123 fields of view (FOVs) covering 76.64 mm<sup>2</sup> area are included in the kidney dataset and processed by the FastReseg flag-only and full pipelines, both of which ingest the transcriptional data by FOV for small memory footprint and efficient parallel computation. For processing with either Proseg or Baysor transcript-based segmentation methods, the input transcriptional data were split into different files based on their source tissue sections instead.</p></section><section id="Sec22"><h3 class="pmc_sec_title">Evaluation of marker gene distribution</h3>
<p id="Par65">We use a list of mutually exclusive marker genes of chosen cell types to evaluate the impact of FastReseg’s segmentation refinement step. Cells are grouped by their cell types in the original dataset and included for analysis if they receive trimming of misassigned transcripts. The table below shows the cell-type-specific on-target marker genes used to evaluate the kidney spatial dataset in Figs. <a href="#Fig5" class="usa-link">5</a>C and <a href="#Fig6" class="usa-link">6</a>D-E.</p>
<p id="Par67">For each cell type, on-target genes are defined as the cell-type-specific marker genes that are characteristic of that particular cell type. Conversely, off-target genes are defined as marker genes that are typically associated with other cell types and thus are the on-target genes of all other cell types in the table above. The “non-marker” category includes all the other genes present in the dataset but not included in the table above. Each subplot in Fig. <a href="#Fig5" class="usa-link">5</a>C displays the transcripts number of each gene within cells of the corresponding type in original dataset in x axis and the corresponding transcripts number removed by FastReseg refinement in y axis, providing a clear visual representation of the algorithm’s impact on correcting transcript misassignment in complex tissue samples.</p>
<p id="Par68">To compare off-target correlation across segmentation methods, we first computed a single-cell metagene score for each cell-type-specific marker group. This score was defined as the sum of transcript counts from all genes associated with the on-target markers of a given cell type group (as listed in Table <a href="#Tab1" class="usa-link">1</a>) within each cell. For each tissue section, we then calculated pairwise Pearson correlations between the single-cell metagene score profiles of different marker groups. These inter-group correlations were used as a measure of off-target correlation for each segmentation method within each tissue sample. Figure <a href="#Fig6" class="usa-link">6</a>D-E presents the average off-target correlation values between all marker group pairs across all the 10 tissue samples within the CosMx kidney dataset described in Table <a href="#Tab3" class="usa-link">3</a>. Each subplot represents a query marker group, showing its correlation with other marker mark groups as stacked bars in distinct filled colors. Segmentation methods are indicated along the x-axis. Figure <a href="#Fig6" class="usa-link">6</a>D includes all cells with one or more RNA transcripts in correlation measurement, while Fig. <a href="#Fig6" class="usa-link">6</a>E restricts the analysis to cells with 20 ~ 2000 total RNA counts.</p></section><section id="Sec23"><h3 class="pmc_sec_title">FastReseg processing and computation efficiency characterization</h3>
<p id="Par69">To assess the computation efficiency of FastReseg processing, we subset the CosMx kidney dataset<sup><a href="#CR12" class="usa-link" aria-describedby="CR12">12</a></sup> to contain different number of fields of view (FOVs) with varying number of transcripts and cells in their original cell segmentation, as shown in table below.</p>
<p id="Par71">Transcriptional data including their gene identity, 3D spatial coordinates and original cell ID assignment come as multiple files in one-file-per-FOV format from the original CosMx assay platform. We found this to be beneficial to keep memory footprint small and speed up the processing since FastReseg workflow does parallel computation at per input file level. Thus, we recommend splitting transcriptional data into image tiles for any spatial datasets collected from other platforms. We then processed those subsets through either the full pipeline or up to the point of isolating misassigned transcripts using `FastReseg:: fastReseg_full_pipeline()` and `FastReseg:: fastReseg_flag_all_errors()` functions, respectively. All the processing included in this study was conducted on an Amazon r5b.4xlarge instance containing 16 vCPU and 128GB memory and set to use 75% of available cores (i.e. 12 cores). The runtime was measured using `time` package in Linux. For peak memory monitoring, we wrapped the FastReseg processing in a single R script, launched it as command line and then used `ps aux` command in Linux to monitor the memory usage of all processes (PIDs) associated with the R script at 10 s interval. The real-time memory usage of FastReseg processes was calculated as the sum of RSS (Resident Set Size, the non-swapped physical memory) across all the relevant processes and the maximum value of the real-time memory usage throughput the pipeline was then reported as the peak memory usage of the entire pipeline in Fig. <a href="#Fig5" class="usa-link">5</a>E.</p></section><section id="Sec24"><h3 class="pmc_sec_title">Processing with Proseg and Baysor</h3>
<p id="Par72">For benchmarking, we processed the same CosMx kidney dataset using 2 additional transcript-based segmentation methods, Proseg (v2.0.4)<sup><a href="#CR21" class="usa-link" aria-describedby="CR21">21</a></sup> and Baysor (v0.7.1)<sup><a href="#CR22" class="usa-link" aria-describedby="CR22">22</a></sup>, via the command line provided by the corresponding package. Per recommendations by these 2 algorithms, the input transcriptional data with 3D spatial coordinates in micron units were split into different files based on their source tissue sections and the transcripts from non-RNA probes were excluded from processing by providing the filter pattern on gene names. The original image-based cell segmentation results were fed to the algorithms as prior segmentation results via a transcriptional data column for the original cell ID, whose “0” values indicate extracellular assignment. Proseg processing also receives a column indicating nuclear compartment assignment at transcript level in the original cell segmentation. For Baysor processing, we set 20 as the minimal number of molecules for a cell to be considered as real (`min_molecules_per_cell`), and disabled generation of polygons and associated plots to focus on the primary segmentation alone. The values for all remaining arguments in processing with either algorithm were set to use the default values provided by the corresponding algorithm.</p>
<p id="Par74">We conducted all the Proseg and Baysor processing on an Amazon r5b.4xlarge instance containing 16 vCPU and 128GB memory, except for one sample (sample #5) containing 19 million RNA transcripts whose Baysor processing was done on an r5bx12large instance containing 48 vCPU and 384 memory due to its memory consumption exceed the limits allowed by r5b.4xlarge instance. Same as FastReseg characterization, we measured the runtime using Linux `time` package for Proseg and Baysor processing. The time-lapsed memory usage was monitor using Linux `ps aux` command line at 10 s interval and used to calculate the peak memory usage of each process.</p></section></section><section id="Sec25"><h2 class="pmc_sec_title">Electronic supplementary material</h2>
<p>Below is the link to the electronic supplementary material.</p>
<section class="sm xbox font-sm" id="MOESM1"><div class="media p"><div class="caption">
<a href="/articles/instance/12368049/bin/41598_2025_8733_MOESM1_ESM.pdf" data-ga-action="click_feat_suppl" class="usa-link">Supplementary Material 1</a><sup> (1.8MB, pdf) </sup>
</div></div></section></section><section id="notes1"><h2 class="pmc_sec_title">Author contributions</h2>
<p>L.W. undertook conception and design of the work, developed the code base, performed the data analysis and drafted the manuscript. J.M.B. advised on the concept and helped with manuscript writing/editing. P.D. conceived the project, contributed to the design of the work, supported the statistical justifications and data interpretation, writing and editing of manuscript.</p></section><section id="notes2"><h2 class="pmc_sec_title">Data availability</h2>
<p>The raw datasets analyzed during the current study are published by previous study<sup><a href="#CR12" class="usa-link" aria-describedby="CR12">12</a></sup>, Danaher P, et al. <em>Sci Transl Med.</em> 2024;16(775):eadl1666 and available at figshare, 10.6084/m9.figshare.c.7373860.</p></section><section id="notes3"><h2 class="pmc_sec_title">Code availability</h2>
<p>Source code of `FastReseg` package is available at <a href="https://github.com/Nanostring-Biostats/FastReseg" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://github.com/Nanostring-Biostats/FastReseg</a>. The tutorial vignette of the package (<a href="https://nanostring-biostats.github.io/FastReseg/articles/tutorial.html" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://nanostring-biostats.github.io/FastReseg/articles/tutorial.html</a>) could be used to generate the data for reproducing figures in this study. The processing of example dataset was performed using default configurations unless otherwise noted.</p></section><section id="notes4"><h2 class="pmc_sec_title">Declarations</h2>
<section id="FPar1"><h3 class="pmc_sec_title">Competing interests</h3>
<p id="Par75">All authors are employees of Bruker Spatial Biology, Inc. J.M.B. is also a shareholder of Bruker Spatial Biology, Inc.</p></section></section><section id="fn-group1" class="fn-group"><h2 class="pmc_sec_title">Footnotes</h2>
<div class="fn-group p font-secondary-light font-sm"><div class="fn p" id="fn1">
<p><strong>Publisher’s note</strong></p>
<p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
</div></div></section><section id="Bib1" class="ref-list"><h2 class="pmc_sec_title">References</h2>
<section id="Bib1_sec2"><ul class="ref-list font-sm" style="list-style-type:none">
<li id="CR1">
<span class="label">1.</span><cite>Vasconcelos, A. G., McGuire, D., Simon, N., Danaher, P. &amp; Shojaie, A. Differential Expression Analysis for Spatially Correlated Data, <em>bioRxiv</em>, p. 2024.08.02.606405, 1 1 2024.</cite>
</li>
<li id="CR2">
<span class="label">2.</span><cite>Vincent, L. &amp; Soille, P. Watersheds in digital spaces: an efficient algorithm based on immersion simulations. <em>IEEE Trans. Pattern Anal. Mach. Intell.</em><strong>13</strong> (6), 583–598 (1991).</cite> [<a href="https://scholar.google.com/scholar_lookup?Vincent,%20L.%20&amp;%20Soille,%20P.%20Watersheds%20in%20digital%20spaces:%20an%20efficient%20algorithm%20based%20on%20immersion%20simulations.%20IEEE%20Trans.%20Pattern%20Anal.%20Mach.%20Intell.13%20(6),%20583%E2%80%93598%20(1991)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR3">
<span class="label">3.</span><cite>Stringer, C., Wang, T., Michaelos, M. &amp; Pachitariu, M. Cellpose: a generalist algorithm for cellular segmentation. <em>Nat. Methods</em>. <strong>18</strong> (1), 100–106. 10.1038/s41592-020-01018-x (2021).</cite> [<a href="https://doi.org/10.1038/s41592-020-01018-x" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/33318659/" class="usa-link">PubMed</a>]</li>
<li id="CR4">
<span class="label">4.</span><cite>Greenwald, N. F. et al. Whole-cell segmentation of tissue images with human-level performance using large-scale data annotation and deep learning. <em>Nature Biotechnology</em>, <strong>40</strong> (4), 555–565. 10.1038/s41587-021-01094-0 (2022).</cite> [<a href="https://doi.org/10.1038/s41587-021-01094-0" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC9010346/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/34795433/" class="usa-link">PubMed</a>]</li>
<li id="CR5">
<span class="label">5.</span><cite>Si, Y. et al. FICTURE: Scalable segmentation-free analysis of submicron resolution spatial transcriptomics, <em>bioRxiv</em>, p. 11.04.565621, 1 1 2023. (2023).</cite> [<a href="https://doi.org/10.1038/s41592-024-02415-2" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC11466694/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/39266749/" class="usa-link">PubMed</a>]</li>
<li id="CR6">
<span class="label">6.</span><cite>Park, J. et al. Cell segmentation-free inference of cell types from in situ transcriptomics data. <em>Nat. Commun.</em><strong>12</strong> (1), 6 (2021).
</cite> [<a href="https://doi.org/10.1038/s41467-021-23807-4" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC8192952/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/34112806/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?Park,%20J.%20et%20al.%20Cell%20segmentation-free%20inference%20of%20cell%20types%20from%20in%20situ%20transcriptomics%20data.%20Nat.%20Commun.12%20(1),%206%20(2021)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR7">
<span class="label">7.</span><cite>Petukhov, V. et al. Cell segmentation in imaging-based Spatial transcriptomics. <em>Nat. Biotechnol.</em><strong>40</strong> (3), 345–354 (2022).
</cite> [<a href="https://doi.org/10.1038/s41587-021-01044-w" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/34650268/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?Petukhov,%20V.%20et%20al.%20Cell%20segmentation%20in%20imaging-based%20Spatial%20transcriptomics.%20Nat.%20Biotechnol.40%20(3),%20345%E2%80%93354%20(2022)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR8">
<span class="label">8.</span><cite>Littman, R. et al. Joint cell segmentation and cell type annotation for spatial transcriptomics, <em>Molecular Systems Biology</em>, vol. 17, no. 6, p. e10108, 1 6 (2021).</cite> [<a href="https://doi.org/10.15252/msb.202010108" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC8166214/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/34057817/" class="usa-link">PubMed</a>]</li>
<li id="CR9">
<span class="label">9.</span><cite>Jones, D. C. et al. Cell Simulation as Cell Segmentation, <em>bioRxiv</em>, p. 2024.04.25.591218, 1 1 2024.</cite>
</li>
<li id="CR10">
<span class="label">10.</span><cite>10x Genomics. [Online]. Using Baysor to Perform Xenium Cell Segmentation, 16 02 (2023). Available: <a href="https://www.10xgenomics.com/analysis-guides/using-baysor-to-perform-xenium-cell-segmentation" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://www.10xgenomics.com/analysis-guides/using-baysor-to-perform-xenium-cell-segmentation</a>. [Accessed 31 10 2024].</cite>
</li>
<li id="CR11">
<span class="label">11.</span><cite>Cortes, C. &amp; Vapnik, V. Support-vector networks. <em>Mach. Learn.</em><strong>20</strong> (3), 273–297 (1995).</cite> [<a href="https://scholar.google.com/scholar_lookup?Cortes,%20C.%20&amp;%20Vapnik,%20V.%20Support-vector%20networks.%20Mach.%20Learn.20%20(3),%20273%E2%80%93297%20(1995)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR12">
<span class="label">12.</span><cite>Danaher, P. et al. Childhood-onset lupus nephritis is characterized by complex interactions between kidney stroma and infiltrating immune cells, <em>Science Translational Medicine</em>, vol. 16, no. 775, p. eadl1666, 27 11 (2024).</cite> [<a href="https://doi.org/10.1126/scitranslmed.adl1666" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC11708815/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/39602512/" class="usa-link">PubMed</a>]</li>
<li id="CR13">
<span class="label">13.</span><cite>Ma, J. et al. X. Yang and Labagn, The multimodality cell segmentation challenge: toward universal solutions, <em>Nature Methods</em>, vol. 21, no. 6, pp. 1103–1113, 1 6 2024.</cite> [<a href="https://doi.org/10.1038/s41592-024-02233-6" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC11210294/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/38532015/" class="usa-link">PubMed</a>]</li>
<li id="CR14">
<span class="label">14.</span><cite>Zeileis, A. &amp; Hothorn, T. Diagnostic checking in regression relationships. <em>R News</em>. <strong>2</strong> (3), 7–10 (2002).</cite> [<a href="https://scholar.google.com/scholar_lookup?Zeileis,%20A.%20&amp;%20Hothorn,%20T.%20Diagnostic%20checking%20in%20regression%20relationships.%20R%20News.%202%20(3),%207%E2%80%9310%20(2002)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR15">
<span class="label">15.</span><cite>Meyer, D., Dimitriadou, E., Hornik, K., Weingessel, A. &amp; Leisch, F. e1071: Misc Functions of the Department of Statistics, Probability Theory Group (Formerly: E1071), TU Wien, 2019. [Online]. Available: <a href="https://CRAN.R-project.org/package=e1071" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://CRAN.R-project.org/package=e1071</a></cite>
</li>
<li id="CR16">
<span class="label">16.</span><cite>Ester, M., Kriegel, H. P., Sander, J. &amp; Xu, X. A density-based algorithm for discovering clusters in large spatial databases with noise, in <em>Proceedings of the Second International Conference on Knowledge Discovery and Data Mining</em>, Portland, Oregon, (1996).</cite>
</li>
<li id="CR17">
<span class="label">17.</span><cite>Dries, R. et al. Giotto: a toolbox for integrative analysis and visualization of Spatial expression data. <em>Genome Biol.</em><strong>22</strong> (1), 3 (2021).
</cite> [<a href="https://doi.org/10.1186/s13059-021-02286-2" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC7938609/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/33685491/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?Dries,%20R.%20et%20al.%20Giotto:%20a%20toolbox%20for%20integrative%20analysis%20and%20visualization%20of%20Spatial%20expression%20data.%20Genome%20Biol.22%20(1),%203%20(2021)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR18">
<span class="label">18.</span><cite>Delaunay, B. On the empty sphere, <em>Bulletin of the Academy of Sciences of the USSR. Class of mathematical and na sciences</em>, vol. 1934, no. pp. 793–800, 1934. (1934).</cite>
</li>
<li id="CR19">
<span class="label">19.</span><cite>Danaher, P. et al. Insitutype: likelihood-based cell typing for single cell spatial transcriptomics, <em>bioRxiv</em>, p. 10.19.512902, 1 1 2022. (2022).</cite>
</li>
<li id="CR20">
<span class="label">20.</span><cite>Danaher, P. et al. Advances in mixed cell Deconvolution enable quantification of cell types in Spatial transcriptomic data. <em>Nat. Commun.</em><strong>13</strong> (1), 1 (2022).
</cite> [<a href="https://doi.org/10.1038/s41467-022-28020-5" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC8770643/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/35046414/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?Danaher,%20P.%20et%20al.%20Advances%20in%20mixed%20cell%20Deconvolution%20enable%20quantification%20of%20cell%20types%20in%20Spatial%20transcriptomic%20data.%20Nat.%20Commun.13%20(1),%201%20(2022)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR21">
<span class="label">21.</span><cite>Jones, D. C. Proseg, 23 04 2025. [Online]. Available: <a href="https://github.com/dcjones/proseg.git" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://github.com/dcjones/proseg.git</a>. [Accessed 25 04 2025].</cite>
</li>
<li id="CR22">
<span class="label">22.</span><cite>Petukhov, V. Baysor, 19 11 2024. [Online]. Available: <a href="https://github.com/kharchenkolab/Baysor.git" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://github.com/kharchenkolab/Baysor.git</a>. [Accessed 24 04 2025].</cite>
</li>
</ul></section></section><section id="_ad93_" lang="en" class="associated-data"><h2 class="pmc_sec_title">Associated Data</h2>
<p class="font-secondary"><em>This section collects any data citations, data availability statements, or supplementary materials included in this article.</em></p>
<section id="_adsm93_" lang="en" class="supplementary-materials"><h3 class="pmc_sec_title">Supplementary Materials</h3>
<section class="sm xbox font-sm" id="db_ds_supplementary-material1_reqid_"><div class="media p"><div class="caption">
<a href="/articles/instance/12368049/bin/41598_2025_8733_MOESM1_ESM.pdf" data-ga-action="click_feat_suppl" class="usa-link">Supplementary Material 1</a><sup> (1.8MB, pdf) </sup>
</div></div></section></section><section id="_adda93_" lang="en" class="data-availability-statement"><h3 class="pmc_sec_title">Data Availability Statement</h3>
<p>The raw datasets analyzed during the current study are published by previous study<sup><a href="#CR12" class="usa-link" aria-describedby="CR12">12</a></sup>, Danaher P, et al. <em>Sci Transl Med.</em> 2024;16(775):eadl1666 and available at figshare, 10.6084/m9.figshare.c.7373860.</p>
<p>Source code of `FastReseg` package is available at <a href="https://github.com/Nanostring-Biostats/FastReseg" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://github.com/Nanostring-Biostats/FastReseg</a>. The tutorial vignette of the package (<a href="https://nanostring-biostats.github.io/FastReseg/articles/tutorial.html" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://nanostring-biostats.github.io/FastReseg/articles/tutorial.html</a>) could be used to generate the data for reproducing figures in this study. The processing of example dataset was performed using default configurations unless otherwise noted.</p></section></section></section><footer class="p courtesy-note font-secondary font-sm text-center"><hr class="headless">
<p>Articles from Scientific Reports are provided here courtesy of <strong>Nature Publishing Group</strong></p></footer></section></article>

                      

                    </main>
                </div>
            </div>
        </div>

        



<!-- Secondary navigation placeholder -->
<div class="pmc-sidenav desktop:grid-col-4 display-flex">
    <section class="pmc-sidenav__container" aria-label="Article resources and navigation">
        <button type="button" class="usa-button pmc-sidenav__container__close usa-button--unstyled">
            <img src="/static/img/usa-icons/close.svg" role="img" alt="Close" />
        </button>
    <div class="display-none desktop:display-block">
       <section class="margin-top-4 desktop:margin-top-0">
              <h2 class="margin-top-0">ACTIONS</h2>
           <ul class="usa-list usa-list--unstyled usa-list--actions">
               
               <li>
                     <a
                             href="https://doi.org/10.1038/s41598-025-08733-5"
                             class="usa-button usa-button--outline width-24 font-xs display-inline-flex flex-align-center flex-justify-start padding-left-1"
                             target="_blank"
                             rel="noreferrer noopener"
                             data-ga-category="actions"
                             data-ga-action="click"
                             data-ga-label="publisher_link_desktop"
                     >
                         <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img" hidden>
                            <use xlink:href="/static/img/sprite.svg#launch"></use>
                         </svg>
                         <span class="display-inline-flex flex-justify-center flex-1 padding-right-2">View on publisher site</span>
                     </a>
               </li>
               
               
               <li>
                    <a
                            href="pdf/41598_2025_Article_8733.pdf"
                            class="usa-button usa-button--outline width-24 display-inline-flex flex-align-center flex-justify-start padding-left-1"
                            data-ga-category="actions"
                            data-ga-action="click"
                            data-ga-label="pdf_download_desktop"
                    >
                         <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img" hidden>
                            <use xlink:href="/static/img/sprite.svg#file_download"></use>
                        </svg>
                        <span class="display-inline-flex flex-justify-center flex-1">PDF (5.2 MB)</span>
                    </a>
               </li>
               
                
               <li>
                   <button role="button" class="usa-button width-24 citation-dialog-trigger display-inline-flex flex-align-center flex-justify-start padding-left-1"
                        aria-label="Open dialog with citation text in different styles"
                        data-ga-category="actions"
                        data-ga-action="open"
                        data-ga-label="cite_desktop"
                        data-all-citations-url="/resources/citations/12368049/"
                        data-citation-style="nlm"
                        data-download-format-link="/resources/citations/12368049/export/"
                    >
                        <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img" hidden>
                            <use xlink:href="/static/img/sprite.svg#format_quote"></use>
                        </svg>
                       <span class="display-inline-flex flex-justify-center flex-1 button-label">Cite</span>
                    </button>
               </li>
                
               <li>

                        <button class="usa-button width-24 collections-dialog-trigger collections-button display-inline-flex flex-align-center flex-justify-start padding-left-1 collections-button-empty"
                              aria-label="Save article in MyNCBI collections."
                              data-ga-category="actions"
                              data-ga-action="click"
                              data-ga-label="collections_button_desktop"
                              data-collections-open-dialog-enabled="false"
                              data-collections-open-dialog-url="https://account.ncbi.nlm.nih.gov/?back_url=https%3A%2F%2Fpmc.ncbi.nlm.nih.gov%2Farticles%2FPMC12368049%2F%3Freport%3Dclassic%23open-collections-dialog"
                              data-in-collections="false">
                            <svg class="usa-icon width-3 height-3 usa-icon--bookmark-full" aria-hidden="true" focusable="false" role="img" hidden>
                                <use xlink:href="/static/img/action-bookmark-full.svg#icon"></use>
                            </svg>
                            <svg class="usa-icon width-3 height-3 usa-icon--bookmark-empty" aria-hidden="true" focusable="false" role="img" hidden>
                                <use xlink:href="/static/img/action-bookmark-empty.svg#icon"></use>
                            </svg>
                            <span class="display-inline-flex flex-justify-center flex-1">Collections</span>
                       </button>
               </li>
               <li class="pmc-permalink">
                    <button
                            type="button"
                            class="usa-button width-24 display-inline-flex flex-align-center flex-justify padding-left-1 shadow-none"
                            aria-label="Show article permalink"
                            aria-expanded="false"
                            aria-haspopup="true"
                            data-ga-category="actions"
                            data-ga-action="open"
                            data-ga-label="permalink_desktop"
                    >
                         <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img" hidden>
                            <use xlink:href="/static/img/sprite.svg#share"></use>
                        </svg>
                        <span class="display-inline-flex flex-justify-center flex-1 button-label">Permalink</span>
                    </button>
                   

<div class="pmc-permalink__dropdown" hidden>
    <div class="pmc-permalink__dropdown__container">
          <h2 class="usa-modal__heading margin-top-0 margin-bottom-2 text-uppercase font-sans-xs">PERMALINK</h2>
          <div class="pmc-permalink__dropdown__content">
              <input type="text" class="usa-input" value="https://pmc.ncbi.nlm.nih.gov/articles/PMC12368049/" aria-label="Article permalink">
              <button class="usa-button display-inline-flex pmc-permalink__dropdown__copy__btn margin-right-0" title="Copy article permalink" data-ga-category="save_share" data-ga-action="link" data-ga-label="copy_link">
                  <svg class="usa-icon" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#content_copy"></use>
                  </svg>
                  <span class="margin-left-1">Copy</span>
              </button>
          </div>
    </div>
</div>
               </li>
           </ul>
       </section>
     </div>

        <section class="pmc-resources margin-top-6 desktop:margin-top-4" data-page-path="/articles/PMC12368049/">
            <h2 class="margin-top-0">RESOURCES</h2>
            
                <div class="usa-accordion usa-accordion--multiselectable" data-allow-multiple>
                    <h3 class="usa-accordion__heading">
                        <button
                        type="button"
                        class="usa-accordion__button"
                        aria-expanded="false"
                        aria-controls="resources-similar-articles"
                        data-ga-category="resources_accordion"
                        data-ga-action="open_similar_articles"
                        data-ga-label="/articles/PMC12368049/"
                        data-action-open="open_similar_articles"
                        data-action-close="close_similar_articles"
                        >
                            Similar articles
                        </button>
                    </h3>
                    <div
                            id="resources-similar-articles"
                            class="usa-accordion__content usa-prose"
                            
                                data-source-url="/resources/similar-article-links/40835864/"
                            
                    >
                        
                    </div>
                    <h3 class="usa-accordion__heading">
                        <button
                        type="button"
                        class="usa-accordion__button"
                        aria-expanded="false"
                        aria-controls="resources-cited-by-other-articles"
                        data-ga-category="resources_accordion"
                        data-ga-action="open_cited_by"
                        data-ga-label="/articles/PMC12368049/"
                        data-action-open="open_cited_by"
                        data-action-close="close_cited_by"
                        >
                             Cited by other articles
                        </button>
                    </h3>
                    <div
                            id="resources-cited-by-other-articles"
                            class="usa-accordion__content usa-prose"
                            
                                data-source-url="/resources/cited-by-links/40835864/"
                            
                    >
                          
                    </div>
                    
                        <h3 class="usa-accordion__heading">
                            <button
                            type="button"
                            class="usa-accordion__button"
                            aria-expanded="false"
                            aria-controls="resources-links-to-ncbi-databases"
                            data-ga-category="resources_accordion"
                            data-ga-action="open_NCBI_links"
                            data-ga-label="/articles/PMC12368049/"
                            data-action-open="open_NCBI_links"
                            data-action-close="close_NCBI_link"
                            >
                                 Links to NCBI Databases
                            </button>
                        </h3>
                        <div
                                id="resources-links-to-ncbi-databases"
                                class="usa-accordion__content usa-prose"
                                data-source-url="/resources/db-links/12368049/"
                        >
                        </div>
                    
                    
                </div>
            
        </section>


        <section
        class="usa-in-page-nav usa-in-page-nav--wide margin-top-6 desktop:margin-top-4"
        data-title-text="On this page"
        data-title-heading-level="h2"
        data-scroll-offset="0"
        data-root-margin="-10% 0px -80% 0px"
        data-main-content-selector="main"
        data-threshold="1"
        hidden
        ></section>
    </section>
</div>


        

<div class="overlay" role="dialog" aria-label="Citation Dialog" hidden>
    <div class="dialog citation-dialog" aria-hidden="true">
        <div class="display-inline-flex flex-align-center flex-justify width-full margin-bottom-2">
            <h2 class="usa-modal__heading margin-0">Cite</h2>
             <button type="button" class="usa-button usa-button--unstyled close-overlay text-black width-auto"  tabindex="1">
                <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#close"></use>
                </svg>
             </button>
        </div>

        

<div class="citation-text-block">
  <div class="citation-text margin-bottom-2"></div>
  <ul class="usa-list usa-list--unstyled display-inline-flex flex-justify width-full flex-align-center">
      <li>
        <button
          class="usa-button usa-button--unstyled text-no-underline display-flex flex-align-center copy-button dialog-focus"
          data-ga-category="save_share"
          data-ga-action="cite"
          data-ga-label="copy"
          tabindex="2">
            <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img">
                <use xlink:href="/static/img/sprite.svg#content_copy"></use>
            </svg>
            <span>Copy</span>
        </button>
      </li>
      <li>
          <a
              href="#"
              role="button"
              class="usa-button usa-button--unstyled text-no-underline display-flex flex-align-center export-button"
              data-ga-category="save_share"
              data-ga-action="cite"
              data-ga-label="download"
              title="Download a file for external citation management software"
              tabindex="3">
                <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#file_download"></use>
                </svg>
                <span class="display-none mobile-lg:display-inline">Download .nbib</span>
                <span class="display-inline mobile-lg:display-none">.nbib</span>
            </a>
      </li>
      <li>
          

<div class="display-inline-flex flex-align-center">
  <label class="usa-label margin-top-0">Format:</label>
  <select aria-label="Format" class="usa-select citation-style-selector padding-1 margin-top-0 border-0 padding-right-4" tabindex="4" >
    
      <option data-style-url-name="ama"
              value="AMA"
              >
        AMA
      </option>
    
      <option data-style-url-name="apa"
              value="APA"
              >
        APA
      </option>
    
      <option data-style-url-name="mla"
              value="MLA"
              >
        MLA
      </option>
    
      <option data-style-url-name="nlm"
              value="NLM"
              selected="selected">
        NLM
      </option>
    
  </select>
</div>
      </li>
  </ul>
</div>
    </div>
</div>

        <div class="overlay" role="dialog" hidden>
  <div id="collections-action-dialog" class="dialog collections-dialog" aria-hidden="true">
   <div class="display-inline-flex flex-align-center flex-justify width-full margin-bottom-2">
        <h2 class="usa-modal__heading margin-0">Add to Collections</h2>
    </div>
    <div class="collections-action-panel action-panel">
      


<form id="collections-action-dialog-form"
      class="usa-form maxw-full collections-action-panel-form action-panel-content action-form action-panel-smaller-selectors"
      data-existing-collections-url="/list-existing-collections/"
      data-add-to-existing-collection-url="/add-to-existing-collection/"
      data-create-and-add-to-new-collection-url="/create-and-add-to-new-collection/"
      data-myncbi-max-collection-name-length="100"
      data-collections-root-url="https://www.ncbi.nlm.nih.gov/myncbi/collections/">

    <input type="hidden" name="csrfmiddlewaretoken" value="S2VEsldwrjJOqYxnECUENSXuW6zJCjwZ1MOZPAFGqVQU8ZELM0QMA9LYW7OUc0VU">

    <fieldset class="usa-fieldset margin-bottom-2">
        <div class="usa-radio">
            <input type="radio"
            id="collections-action-dialog-new"
            class="usa-radio__input usa-radio__input--tile collections-new  margin-top-0"
            name="collections"
            value="new"
            data-ga-category="collections_button"
            data-ga-action="click"
            data-ga-label="collections_radio_new" />
            <label class="usa-radio__label" for="collections-action-dialog-new">Create a new collection</label>
        </div>
        <div class="usa-radio">
            <input type="radio"
            id="collections-action-dialog-existing"
            class="usa-radio__input usa-radio__input--tile collections-existing"
            name="collections"
            value="existing"
            checked="true"
            data-ga-category="collections_button"
            data-ga-action="click"
            data-ga-label="collections_radio_existing" />
            <label class="usa-radio__label" for="collections-action-dialog-existing">Add to an existing collection</label>
        </div>
    </fieldset>

    <fieldset class="usa-fieldset margin-bottom-2">
        <div class="action-panel-control-wrap new-collections-controls">
           <label for="collections-action-dialog-add-to-new" class="usa-label margin-top-0">
                Name your collection
               <abbr title="required" class="usa-hint usa-hint--required text-no-underline">*</abbr>
          </label>
          <input
            type="text"
            name="add-to-new-collection"
            id="collections-action-dialog-add-to-new"
            class="usa-input collections-action-add-to-new"
            pattern="[^&quot;&amp;=&lt;&gt;/]*" title="The following characters are not allowed in the Name field: &quot;&amp;=&lt;&gt;/"
            maxlength=""
            data-ga-category="collections_button"
            data-ga-action="create_collection"
            data-ga-label="non_favorties_collection"
            required
          />
        </div>
        <div class="action-panel-control-wrap existing-collections-controls">
             <label for="collections-action-dialog-add-to-existing" class="usa-label margin-top-0">
                Choose a collection
              </label>
              <select id="collections-action-dialog-add-to-existing"
                      class="usa-select collections-action-add-to-existing"
                      data-ga-category="collections_button"
                      data-ga-action="select_collection"
                      data-ga-label="($('.collections-action-add-to-existing').val() === 'Favorites') ? 'Favorites' : 'non_favorites_collection'">
              </select>
              <div class="collections-retry-load-on-error usa-input-error-message selection-validation-message">
                Unable to load your collection due to an error<br>
                <a href="#">Please try again</a>
              </div>
        </div>
    </fieldset>

    <div class="display-inline-flex">
        <button class="usa-button margin-top-0 action-panel-submit"
            type="submit"
            data-loading-label="Adding..."
            data-pinger-ignore
            data-ga-category="collections_button"
            data-ga-action="click"
            data-ga-label="add">
          Add
        </button>
        <button class="usa-button usa-button--outline margin-top-0 action-panel-cancel"
                aria-label="Close 'Add to Collections' panel"
                ref="linksrc=close_collections_panel"
                data-ga-category="collections_button"
                data-ga-action="click"
                data-ga-label="cancel">
          Cancel
        </button>
    </div>
</form>
    </div>
  </div>
</div>

        

      </div>
    </div>
  </div>



        
    
    

<footer class="ncbi-footer ncbi-dark-background " >
    
        <div class="ncbi-footer__icon-section">
            <div class="ncbi-footer__social-header">
                Follow NCBI
            </div>

            <div class="grid-container ncbi-footer__ncbi-social-icons-container">
                
                    <a href="https://twitter.com/ncbi"
                       class="ncbi-footer__social-icon ncbi-footer__social-icon--gray"
                       target="_blank"
                       rel="noreferrer noopener">
                        <svg width="40"
                             height="40"
                             viewBox="0 0 40 40"
                             fill="none"
                             xmlns="http://www.w3.org/2000/svg"
                             focusable="false"
                             aria-hidden="true">
                            <path d="m6.067 8 10.81 13.9L6 33.2h4.2l8.4-9.1 7.068 9.1H34L22.8 18.5 31.9 8h-3.5l-7.7 8.4L14.401 8H6.067Zm3.6 1.734h3.266l16.8 21.732H26.57L9.668 9.734Z">
                            </path>
                        </svg>
                        <span class="usa-sr-only">NCBI on X (formerly known as Twitter)</span>
                    </a>
                

                
                    <a href="https://www.facebook.com/ncbi.nlm"
                       class="ncbi-footer__social-icon ncbi-footer__social-icon--gray"
                       target="_blank"
                       rel="noreferrer noopener">
                        <svg width="16"
                             height="29"
                             focusable="false"
                             aria-hidden="true"
                             viewBox="0 0 16 29"
                             fill="none"
                             xmlns="http://www.w3.org/2000/svg">
                            <path d="M3.8809 21.4002C3.8809 19.0932 3.8809 16.7876 3.8809 14.478C3.8809 14.2117 3.80103 14.1452 3.54278 14.1492C2.53372 14.1638 1.52334 14.1492 0.514288 14.1598C0.302626 14.1598 0.248047 14.0972 0.248047 13.8936C0.256034 12.4585 0.256034 11.0239 0.248047 9.58978C0.248047 9.37013 0.302626 9.30224 0.528931 9.3049C1.53798 9.31688 2.54837 9.3049 3.55742 9.31555C3.80103 9.31555 3.8809 9.26097 3.87957 9.00272C3.87158 8.00565 3.85428 7.00592 3.90753 6.00884C3.97142 4.83339 4.31487 3.73115 5.04437 2.78467C5.93095 1.63318 7.15699 1.09005 8.56141 0.967577C10.5582 0.79319 12.555 0.982221 14.5518 0.927641C14.7102 0.927641 14.7462 0.99287 14.7449 1.13664C14.7449 2.581 14.7449 4.02668 14.7449 5.47104C14.7449 5.67604 14.6517 5.68669 14.4946 5.68669C13.4523 5.68669 12.4113 5.68669 11.3703 5.68669C10.3506 5.68669 9.92057 6.10868 9.90593 7.13904C9.89661 7.7647 9.91525 8.39303 9.89794 9.01869C9.88995 9.26364 9.96583 9.31822 10.2015 9.31688C11.7204 9.30623 13.2393 9.31688 14.7595 9.3049C15.0257 9.3049 15.0723 9.3728 15.0444 9.62439C14.89 10.9849 14.7515 12.3467 14.6144 13.7085C14.5691 14.1571 14.5785 14.1585 14.1458 14.1585C12.8386 14.1585 11.5313 14.1665 10.2254 14.1518C9.95119 14.1518 9.89794 14.2317 9.89794 14.4899C9.90593 19.0799 9.89794 23.6752 9.91125 28.2612C9.91125 28.5674 9.8407 28.646 9.53186 28.6433C7.77866 28.6273 6.02414 28.6366 4.27094 28.634C3.82499 28.634 3.87158 28.6992 3.87158 28.22C3.87602 25.9472 3.87913 23.6739 3.8809 21.4002Z">
                            </path>
                        </svg>
                        <span class="usa-sr-only">NCBI on Facebook</span>
                    </a>
                

                
                    <a href="https://www.linkedin.com/company/ncbinlm"
                       class="ncbi-footer__social-icon ncbi-footer__social-icon--gray"
                       target="_blank"
                       rel="noreferrer noopener">
                        <svg width="25"
                             height="23"
                             viewBox="0 0 26 24"
                             fill="none"
                             xmlns="http://www.w3.org/2000/svg"
                             focusable="false"
                             aria-hidden="true">
                            <path d="M14.6983 9.98423C15.6302 9.24808 16.5926 8.74754 17.6762 8.51991C19.673 8.09126 21.554 8.30824 23.1262 9.7526C24.2351 10.7723 24.7529 12.1115 25.0165 13.5612C25.1486 14.3363 25.2105 15.1218 25.2015 15.9081C25.2015 18.3043 25.2015 20.6898 25.2082 23.0806C25.2082 23.3468 25.1549 23.444 24.8621 23.4414C23.1297 23.4272 21.3992 23.4272 19.6704 23.4414C19.4041 23.4414 19.3429 23.3588 19.3442 23.1019C19.3535 20.5194 19.3442 17.9368 19.3442 15.3543C19.3442 14.0005 18.3258 12.9448 17.0266 12.9488C15.7273 12.9528 14.6983 14.0071 14.6983 15.361C14.6983 17.9328 14.6917 20.5047 14.6983 23.0753C14.6983 23.3708 14.6198 23.444 14.3296 23.4427C12.6185 23.4294 10.9079 23.4294 9.19779 23.4427C8.93155 23.4427 8.86099 23.3735 8.86232 23.1086C8.8783 19.7619 8.88628 16.4144 8.88628 13.066C8.88628 11.5688 8.87874 10.0708 8.86365 8.57182C8.86365 8.3575 8.90758 8.27896 9.14054 8.28029C10.9048 8.29094 12.6687 8.29094 14.4321 8.28029C14.6464 8.28029 14.6983 8.34818 14.6983 8.54653C14.6903 9.00047 14.6983 9.45441 14.6983 9.98423Z">
                            </path>
                            <path d="M6.55316 15.8443C6.55316 18.2564 6.55316 20.6699 6.55316 23.082C6.55316 23.3629 6.48127 23.4388 6.19906 23.4374C4.47737 23.4241 2.75568 23.4241 1.03399 23.4374C0.767751 23.4374 0.69986 23.3629 0.701191 23.1006C0.709178 18.2648 0.709178 13.4281 0.701191 8.59053C0.701191 8.34026 0.765089 8.27237 1.01669 8.2737C2.74991 8.28435 4.48048 8.28435 6.20838 8.2737C6.47462 8.2737 6.5465 8.33627 6.54517 8.6065C6.54783 11.0186 6.55316 13.4308 6.55316 15.8443Z">
                            </path>
                            <path d="M3.65878 0.243898C5.36804 0.243898 6.58743 1.45529 6.58743 3.1406C6.58743 4.75801 5.32145 5.95742 3.60819 5.96807C3.22177 5.97614 2.83768 5.90639 2.47877 5.76299C2.11985 5.61959 1.79344 5.40546 1.51897 5.13334C1.24449 4.86123 1.02755 4.53668 0.881058 4.17902C0.734563 3.82136 0.661505 3.43788 0.666231 3.05141C0.67555 1.42601 1.9362 0.242566 3.65878 0.243898Z">
                            </path>
                        </svg>
                        <span class="usa-sr-only">NCBI on LinkedIn</span>
                    </a>
                

                
                    <a href="https://github.com/ncbi"
                       class="ncbi-footer__social-icon ncbi-footer__social-icon--gray"
                       target="_blank"
                       rel="noreferrer noopener">
                        <svg width="28"
                             height="27"
                             viewBox="0 0 28 28"
                             fill="none"
                             xmlns="http://www.w3.org/2000/svg"
                             focusable="false"
                             aria-hidden="true">
                            <path d="M16.7228 20.6334C17.5057 20.5527 18.2786 20.3944 19.0301 20.1608C21.3108 19.4193 22.5822 17.8259 22.963 15.4909C23.1228 14.5112 23.1814 13.5287 22.9883 12.5437C22.8106 11.6423 22.4013 10.8028 21.8007 10.1076C21.7526 10.0605 21.7197 10 21.7064 9.934C21.6931 9.86799 21.7 9.79952 21.7262 9.73748C22.0856 8.6206 21.9711 7.51969 21.601 6.42677C21.582 6.3497 21.5345 6.2827 21.468 6.23923C21.4016 6.19577 21.3211 6.17906 21.2429 6.19248C20.7329 6.21649 20.2313 6.33051 19.7611 6.52928C19.1103 6.7908 18.4899 7.12198 17.9104 7.51703C17.84 7.56996 17.7581 7.60551 17.6713 7.62078C17.5846 7.63605 17.4954 7.6306 17.4112 7.60489C15.2596 7.05882 13.0054 7.06203 10.8554 7.61421C10.7806 7.63586 10.7018 7.63967 10.6253 7.62534C10.5487 7.611 10.4766 7.57892 10.4148 7.53167C9.64788 7.03247 8.85171 6.58918 7.96368 6.33359C7.65781 6.24338 7.34123 6.19458 7.02239 6.18849C6.94879 6.17986 6.87462 6.19893 6.81432 6.242C6.75402 6.28507 6.71191 6.34904 6.69621 6.42145C6.32342 7.51437 6.2209 8.61527 6.56307 9.73348C6.59635 9.84264 6.64694 9.93316 6.54177 10.0516C5.47666 11.2604 5.09988 12.6834 5.19574 14.2676C5.2663 15.4244 5.46201 16.5466 6.01454 17.5769C6.84399 19.1171 8.21664 19.9119 9.85158 20.3352C10.3938 20.4706 10.9444 20.5698 11.4998 20.632C11.5384 20.7492 11.4506 20.7798 11.408 20.8291C11.1734 21.1179 10.9894 21.4441 10.8634 21.7942C10.7622 22.0458 10.8315 22.4039 10.6065 22.5516C10.263 22.7766 9.83827 22.8485 9.42421 22.8871C8.17936 23.0056 7.26471 22.4877 6.6283 21.4348C6.25552 20.8184 5.76956 20.3325 5.08523 20.0663C4.76981 19.9325 4.42139 19.8967 4.08537 19.9638C3.7898 20.029 3.73788 20.1901 3.93891 20.4111C4.03639 20.5234 4.14989 20.6207 4.27575 20.6999C4.9796 21.1318 5.51717 21.7884 5.80152 22.5636C6.37002 23.9973 7.48039 24.5697 8.93825 24.6323C9.43741 24.6575 9.93768 24.615 10.4254 24.5058C10.5892 24.4672 10.6531 24.4872 10.6517 24.6762C10.6451 25.4936 10.6637 26.3123 10.6517 27.131C10.6517 27.6635 10.1684 27.9297 9.58663 27.7393C8.17396 27.2671 6.84977 26.5631 5.66838 25.656C2.59555 23.2891 0.720966 20.1861 0.217704 16.3376C-0.357453 11.9127 0.911353 8.00824 3.98551 4.73881C6.11909 2.42656 8.99932 0.939975 12.1203 0.540191C16.5351 -0.0601815 20.4347 1.14323 23.7232 4.16373C26.2449 6.47869 27.724 9.37672 28.1048 12.7726C28.5828 17.0325 27.3686 20.7945 24.4768 23.9827C22.9762 25.6323 21.0956 26.8908 18.9982 27.6488C18.8783 27.6927 18.7585 27.738 18.636 27.7726C18.0356 27.9404 17.6189 27.6395 17.6189 27.0098C17.6189 25.7452 17.6308 24.4806 17.6295 23.2159C17.6329 22.9506 17.6128 22.6856 17.5696 22.4238C17.4325 21.6664 17.3419 21.484 16.7228 20.6334Z">
                            </path>
                        </svg>
                        <span class="usa-sr-only">NCBI on GitHub</span>
                    </a>
                

                
                    <a href="https://ncbiinsights.ncbi.nlm.nih.gov/"
                       class="ncbi-footer__social-icon ncbi-footer__social-icon--gray"
                       target="_blank"
                       rel="noreferrer noopener">
                        <svg width="26"
                             height="26"
                             viewBox="0 0 27 27"
                             fill="none"
                             xmlns="http://www.w3.org/2000/svg"
                             focusable="false"
                             aria-hidden="true">
                            <path d="M23.7778 26.4574C23.1354 26.3913 22.0856 26.8024 21.636 26.3087C21.212 25.8444 21.4359 24.8111 21.324 24.0347C19.9933 14.8323 14.8727 8.80132 6.09057 5.85008C4.37689 5.28406 2.58381 4.99533 0.779072 4.99481C0.202773 4.99481 -0.0229751 4.83146 0.00455514 4.21479C0.0660406 3.08627 0.0660406 1.95525 0.00455514 0.826734C-0.0413285 0.0815827 0.259669 -0.0193618 0.896534 0.00266238C6.96236 0.222904 12.3693 2.24179 16.9889 6.16209C22.9794 11.2478 26.1271 17.7688 26.4372 25.648C26.4629 26.294 26.3179 26.5271 25.6609 26.4684C25.0827 26.417 24.4991 26.4574 23.7778 26.4574Z">
                            </path>
                            <path d="M14.8265 26.441C14.0924 26.441 13.2371 26.6795 12.6626 26.3786C12.0092 26.0372 12.3781 25.0644 12.246 24.378C11.1154 18.5324 6.6849 14.5497 0.74755 14.1001C0.217135 14.0615 -0.0104482 13.9422 0.0134113 13.3659C0.0519536 12.1454 0.0482829 10.9213 0.0134113 9.69524C-0.00127145 9.14464 0.196946 9.03268 0.703502 9.04736C9.21217 9.27128 16.5994 16.2511 17.2804 24.7231C17.418 26.4446 17.418 26.4446 15.6579 26.4446H14.832L14.8265 26.441Z">
                            </path>
                            <path d="M3.58928 26.4555C2.64447 26.4618 1.73584 26.0925 1.06329 25.4289C0.39073 24.7653 0.00933763 23.8617 0.0030097 22.9169C-0.00331824 21.9721 0.365937 21.0635 1.02954 20.3909C1.69315 19.7184 2.59675 19.337 3.54156 19.3306C4.48637 19.3243 5.39499 19.6936 6.06755 20.3572C6.7401 21.0208 7.1215 21.9244 7.12782 22.8692C7.13415 23.814 6.7649 24.7226 6.10129 25.3952C5.43768 26.0677 4.53409 26.4491 3.58928 26.4555Z">
                            </path>
                        </svg>
                        <span class="usa-sr-only">NCBI RSS feed</span>
                    </a>
                
            </div>
        </div>
    

    <div data-testid="gridContainer"
         class="grid-container ncbi-footer__container">
        <div class="grid-row ncbi-footer__main-content-container"
             data-testid="grid">
            
                <div class="ncbi-footer__column">
                    
                        <p class="ncbi-footer__circled-icons-heading">
                            Connect with NLM
                        </p>
                    

                    <div class="ncbi-footer__circled-icons-list">
                        
                            <a href=https://twitter.com/nlm_nih class="ncbi-footer__social-icon ncbi-footer__social-icon--circled" target="_blank" rel="noreferrer noopener">
                                <svg width="32"
                                     height="32"
                                     viewBox="0 0 40 40"
                                     fill="none"
                                     xmlns="http://www.w3.org/2000/svg"
                                     focusable="false"
                                     aria-hidden="true">
                                    <path d="m6.067 8 10.81 13.9L6 33.2h4.2l8.4-9.1 7.068 9.1H34L22.8 18.5 31.9 8h-3.5l-7.7 8.4L14.401 8H6.067Zm3.6 1.734h3.266l16.8 21.732H26.57L9.668 9.734Z">
                                    </path>
                                </svg>
                                <span class="usa-sr-only">NLM on X (formerly known as Twitter)</span>
                            </a>
                        

                        
                            <a href=https://www.facebook.com/nationallibraryofmedicine class="ncbi-footer__social-icon ncbi-footer__social-icon--circled" target="_blank" rel="noreferrer noopener">
                                <svg width="13"
                                     height="24"
                                     viewBox="0 0 13 24"
                                     fill="none"
                                     xmlns="http://www.w3.org/2000/svg"
                                     focusable="false"
                                     aria-hidden="true">
                                    <path d="M4.11371 23.1369C4.11371 23.082 4.11371 23.0294 4.11371 22.9745V12.9411H0.817305C0.6709 12.9411 0.670898 12.9411 0.670898 12.8016C0.670898 11.564 0.670898 10.3287 0.670898 9.09341C0.670898 8.97903 0.705213 8.95158 0.815017 8.95158C1.8673 8.95158 2.91959 8.95158 3.97417 8.95158H4.12057V8.83263C4.12057 7.8055 4.12057 6.7738 4.12057 5.74897C4.1264 4.92595 4.31387 4.11437 4.66959 3.37217C5.12916 2.38246 5.94651 1.60353 6.95717 1.1921C7.64827 0.905008 8.3913 0.764035 9.13953 0.778051C10.0019 0.791777 10.8644 0.830666 11.7268 0.860404C11.8869 0.860404 12.047 0.894717 12.2072 0.90158C12.2964 0.90158 12.3261 0.940469 12.3261 1.02968C12.3261 1.5421 12.3261 2.05452 12.3261 2.56465C12.3261 3.16857 12.3261 3.7725 12.3261 4.37642C12.3261 4.48165 12.2964 4.51367 12.1912 4.51138C11.5369 4.51138 10.8804 4.51138 10.2261 4.51138C9.92772 4.51814 9.63058 4.5526 9.33855 4.61433C9.08125 4.6617 8.84537 4.78881 8.66431 4.97766C8.48326 5.16652 8.3662 5.40755 8.32972 5.66661C8.28476 5.89271 8.26027 6.1224 8.25652 6.35289C8.25652 7.19014 8.25652 8.02969 8.25652 8.86923C8.25652 8.89439 8.25652 8.91955 8.25652 8.95615H12.0219C12.1797 8.95615 12.182 8.95616 12.1614 9.10714C12.0768 9.76596 11.9876 10.4248 11.9029 11.0813C11.8312 11.6319 11.7626 12.1824 11.697 12.733C11.6719 12.9434 11.6787 12.9434 11.4683 12.9434H8.26338V22.899C8.26338 22.979 8.26338 23.0591 8.26338 23.1392L4.11371 23.1369Z">
                                    </path>
                                </svg>
                                <span class="usa-sr-only">NLM on Facebook</span>
                            </a>
                        

                        
                            <a href=https://www.youtube.com/user/NLMNIH class="ncbi-footer__social-icon ncbi-footer__social-icon--circled" target="_blank" rel="noreferrer noopener">
                                <svg width="21"
                                     height="15"
                                     viewBox="0 0 21 15"
                                     fill="none"
                                     xmlns="http://www.w3.org/2000/svg"
                                     focusable="false"
                                     aria-hidden="true">
                                    <path d="M19.2561 1.47914C18.9016 1.15888 18.5699 0.957569 17.2271 0.834039C15.5503 0.678484 13.2787 0.655608 11.563 0.65332H9.43556C7.71987 0.65332 5.4483 0.678484 3.77151 0.834039C2.43098 0.957569 2.097 1.15888 1.74242 1.47914C0.813665 2.32097 0.619221 4.62685 0.598633 6.89384C0.598633 7.31781 0.598633 7.74101 0.598633 8.16345C0.626084 10.4121 0.827391 12.686 1.74242 13.521C2.097 13.8412 2.4287 14.0425 3.77151 14.1661C5.4483 14.3216 7.71987 14.3445 9.43556 14.3468H11.563C13.2787 14.3468 15.5503 14.3216 17.2271 14.1661C18.5676 14.0425 18.9016 13.8412 19.2561 13.521C20.1712 12.6929 20.3725 10.451 20.3999 8.22064C20.3999 7.74025 20.3999 7.25986 20.3999 6.77946C20.3725 4.54907 20.1689 2.30724 19.2561 1.47914ZM8.55942 10.5311V4.65201L13.5601 7.50005L8.55942 10.5311Z"
                                          fill="white" />
                                </svg>
                                <span class="usa-sr-only">NLM on YouTube</span>
                            </a>
                        
                    </div>
                </div>
            

            
                <address class="ncbi-footer__address ncbi-footer__column">
                    
        <p>
            <a class="usa-link usa-link--external"
            href="https://www.google.com/maps/place/8600+Rockville+Pike,+Bethesda,+MD+20894/%4038.9959508,
            -77.101021,17z/data%3D!3m1!4b1!4m5!3m4!1s0x89b7c95e25765ddb%3A0x19156f88b27635b8!8m2!3d38.9959508!
            4d-77.0988323"
            rel="noopener noreferrer" target="_blank">National Library of Medicine
            <br/> 8600 Rockville Pike<br/> Bethesda, MD 20894</a>
        </p>
    
                </address>
            

            
                <ul class="usa-list usa-list--unstyled ncbi-footer__vertical-list ncbi-footer__column">
                    
                        <li class="ncbi-footer__vertical-list-item">
                            









    <a href="https://www.nlm.nih.gov/web_policies.html" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            Web Policies
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__vertical-list-item">
                            









    <a href="https://www.nih.gov/institutes-nih/nih-office-director/office-communications-public-liaison/freedom-information-act-office" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            FOIA
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__vertical-list-item">
                            









    <a href="https://www.hhs.gov/vulnerability-disclosure-policy/index.html" class="usa-link usa-link--external usa-link--alt ncbi-footer__link" rel="noreferrer noopener" target='_blank' >
        

        
            HHS Vulnerability Disclosure
        

        
    </a>


                        </li>
                    
                </ul>
            

            
                <ul class="usa-list usa-list--unstyled ncbi-footer__vertical-list ncbi-footer__column">
                    
                        <li class="ncbi-footer__vertical-list-item">
                            









    <a href="https://support.nlm.nih.gov/" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            Help
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__vertical-list-item">
                            









    <a href="https://www.nlm.nih.gov/accessibility.html" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            Accessibility
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__vertical-list-item">
                            









    <a href="https://www.nlm.nih.gov/careers/careers.html" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            Careers
        

        
    </a>


                        </li>
                    
                </ul>
            
        </div>

        
            <div class="grid-row grid-col-12" data-testid="grid">
                <ul class="ncbi-footer__bottom-links-list">
                    
                        <li class="ncbi-footer__bottom-list-item">
                            









    <a href="https://www.nlm.nih.gov/" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            NLM
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__bottom-list-item">
                            









    <a href="https://www.nih.gov/" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            NIH
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__bottom-list-item">
                            









    <a href="https://www.hhs.gov/" class="usa-link usa-link--external usa-link--alt ncbi-footer__link" rel="noreferrer noopener" target='_blank' >
        

        
            HHS
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__bottom-list-item">
                            









    <a href="https://www.usa.gov/" class="usa-link usa-link--external usa-link--alt ncbi-footer__link" rel="noreferrer noopener" target='_blank' >
        

        
            USA.gov
        

        
    </a>


                        </li>
                    
                </ul>
            </div>
        
    </div>
</footer>

    


        
        
    
  <script  type="text/javascript" src="https://cdn.ncbi.nlm.nih.gov/core/pinger/pinger.js"> </script>


    
        

<button class="back-to-top" data-ga-category="pagination" data-ga-action="back_to_top">
    <label>Back to Top</label>
    <svg class="usa-icon order-0" aria-hidden="true" focusable="false" role="img">
        <use xlink:href="/static/img/sprite.svg#arrow_upward"></use>
    </svg>
</button>
    


        
    
    
    
        
    <script type="application/javascript">
    window.ncbi = window.ncbi || {};
    window.ncbi.pmc = window.ncbi.pmc || {};
    window.ncbi.pmc.options = {
        logLevel: 'INFO',
        
        staticEndpoint: '/static/',
        
        citeCookieName: 'pmc-cf',
    };
</script>
    <script type="module" crossorigin="" src="/static/assets/base-133c6271.js"></script>
    
    <script type="text/javascript" src="https://cdn.ncbi.nlm.nih.gov/core/jquery/jquery-3.6.0.min.js">&#xA0;</script>
    <script type="text/javascript">
        jQuery.getScript("https://cdn.ncbi.nlm.nih.gov/core/alerts/alerts.js", function () {
            galert(['div.nav_and_browser', 'div.header', '#universal_header', '.usa-banner', 'body > *:nth-child(1)'])
        });
    </script>


    <script type="text/javascript">var exports = {};</script>
     <script src="/static/CACHE/js/output.13b077bc3ffd.js"></script>

    <script type="module" crossorigin="" src="/static/assets/article-44d04358.js"></script>
    
    

    </body>
</html>
