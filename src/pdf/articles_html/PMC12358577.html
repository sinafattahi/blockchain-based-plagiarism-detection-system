
<!DOCTYPE html>
<html lang="en" >
    <head >

        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="HandheldFriendly" content="True" />
        <meta name="MobileOptimized" content="320" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        
        

        
        
  <link rel="stylesheet" href="/static/assets/style-8258669d.css" />
<script type="module" crossorigin="" src="/static/assets/base_style-f4a99799.js"></script>

  <link rel="stylesheet" href="/static/assets/style-ef962842.css" />
<link rel="stylesheet" href="/static/assets/style-3ade8b5c.css" />
<script type="module" crossorigin="" src="/static/assets/article_style-d757a0dd.js"></script>

  
  
    <style>
  
  
  @media screen and (min-width: 64em) {
    div.pmc-wm {
      background: repeat-y;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='350' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cdefs%3E%3Cfilter x='-.02' y='0' width='1.05' height='1' id='c'%3E%3CfeFlood flood-color='%23FFF'/%3E%3CfeComposite in='SourceGraphic'/%3E%3C/filter%3E%3Ctext id='b' font-family='Helvetica' font-size='11pt' style='opacity:1;fill:%23005ea2;stroke:none;text-anchor:middle' x='175' y='14'%3E%3C/text%3E%3Cpath id='a' style='fill:%23005ea2' d='M0 8h350v3H0z'/%3E%3C/defs%3E%3Cuse xlink:href='%23a' transform='rotate(90 10 10)'/%3E%3Cuse xlink:href='%23b' transform='rotate(90 10 10)' filter='url(%23c)'/%3E%3C/svg%3E");
      padding-left: 3rem;
    }
  }
</style>

  



        
            <link rel="apple-touch-icon"
                  sizes="180x180"
                  href="/static/img/favicons/apple-touch-icon.png" />
            <link rel="icon"
                  type="image/png"
                  sizes="48x48"
                  href="/static/img/favicons/favicon-48x48.png" />
            <link rel="icon"
                  type="image/png"
                  sizes="32x32"
                  href="/static/img/favicons/favicon-32x32.png" />
            <link rel="icon"
                  type="image/png"
                  sizes="16x16"
                  href="/static/img/favicons/favicon-16x16.png" />
            <link rel="manifest" href="/static/img/favicons/site.webmanifest" />
            <link rel="mask-icon"
                  href="/static/img/favicons/safari-pinned-tab.svg"
                  color="#0071bc" />
            <meta name="msapplication-config"
                  content="/static/img/favicons/browserconfig.xml" />
            <meta name="theme-color" content="#ffffff" />
        

        <title>
            AI-powered spatiotemporal imputation and prediction of chlorophyll-a concentration in coastal ecosystems - PMC
        </title>

        
        
  
  <!-- Logging params: Pinger defaults -->
<meta name="ncbi_app" content="cloudpmc-viewer" />
<meta name="ncbi_db" content="pmc" />
<meta name="ncbi_phid" content="D2E4BA508AF4113305BA50003EDF0BCD.m_1" />
<meta name="ncbi_pinger_stat_url" content="https://pmc.ncbi.nlm.nih.gov/stat" />
<!-- Logging params: Pinger custom -->
<meta name="ncbi_pdid" content="article" />
  
    <link rel="preconnect" href="https://www.google-analytics.com" />

    
        <link rel="preconnect" href="https://cdn.ncbi.nlm.nih.gov" />
    

    <!-- Include USWDS Init Script -->
    <script src="/static/assets/uswds-init.js"></script>


    <meta name="ncbi_domain" content="ncomms">
<meta name="ncbi_type" content="fulltext">
<meta name="ncbi_pcid" content="journal">
<meta name="ncbi_feature" content="associated_data">
<link rel="canonical" href="https://pmc.ncbi.nlm.nih.gov/articles/PMC12358577/">
<meta name="robots" content="INDEX,NOFOLLOW,NOARCHIVE">
<meta name="citation_journal_title" content="Nature Communications">
<meta name="citation_title" content="AI-powered spatiotemporal imputation and prediction of chlorophyll-a concentration in coastal ecosystems">
<meta name="citation_author" content="Fan Zhang">
<meta name="citation_author_institution" content="Department of Mathematics, The Hong Kong University of Science and Technology, Hong Kong SAR, China">
<meta name="citation_author_institution" content="Center for Ocean Research in Hong Kong and Macau, The Hong Kong University of Science and Technology, Hong Kong SAR, China">
<meta name="citation_author" content="Hiusuet Kung">
<meta name="citation_author_institution" content="Center for Ocean Research in Hong Kong and Macau, The Hong Kong University of Science and Technology, Hong Kong SAR, China">
<meta name="citation_author_institution" content="Department of Ocean Science, The Hong Kong University of Science and Technology, Hong Kong SAR, China">
<meta name="citation_author" content="Fa Zhang">
<meta name="citation_author_institution" content="Department of Mathematics, The Hong Kong University of Science and Technology, Hong Kong SAR, China">
<meta name="citation_author" content="Can Yang">
<meta name="citation_author_institution" content="Department of Mathematics, The Hong Kong University of Science and Technology, Hong Kong SAR, China">
<meta name="citation_author_institution" content="Center for Ocean Research in Hong Kong and Macau, The Hong Kong University of Science and Technology, Hong Kong SAR, China">
<meta name="citation_author" content="Jianping Gan">
<meta name="citation_author_institution" content="Department of Mathematics, The Hong Kong University of Science and Technology, Hong Kong SAR, China">
<meta name="citation_author_institution" content="Center for Ocean Research in Hong Kong and Macau, The Hong Kong University of Science and Technology, Hong Kong SAR, China">
<meta name="citation_author_institution" content="Department of Ocean Science, The Hong Kong University of Science and Technology, Hong Kong SAR, China">
<meta name="citation_publication_date" content="2025 Aug 18">
<meta name="citation_volume" content="16">
<meta name="citation_firstpage" content="7656">
<meta name="citation_doi" content="10.1038/s41467-025-62901-9">
<meta name="citation_pmid" content="40820013">
<meta name="citation_abstract_html_url" content="https://pmc.ncbi.nlm.nih.gov/articles/PMC12358577/">
<meta name="citation_fulltext_html_url" content="https://pmc.ncbi.nlm.nih.gov/articles/PMC12358577/">
<meta name="citation_pdf_url" content="https://pmc.ncbi.nlm.nih.gov/articles/PMC12358577/pdf/41467_2025_Article_62901.pdf">
<meta name="description" content="Predicting spatiotemporal Chlorophyll-a (Chl_a) distributions is essential for diagnosing and analysing productivity and ecosystem health of coastal oceans. Yet, current tools remain inadequate for prognosing marine ecosystems through predicting ...">
<meta name="og:title" content="AI-powered spatiotemporal imputation and prediction of chlorophyll-a concentration in coastal ecosystems">
<meta name="og:type" content="article">
<meta name="og:site_name" content="PubMed Central (PMC)">
<meta name="og:description" content="Predicting spatiotemporal Chlorophyll-a (Chl_a) distributions is essential for diagnosing and analysing productivity and ecosystem health of coastal oceans. Yet, current tools remain inadequate for prognosing marine ecosystems through predicting ...">
<meta name="og:url" content="https://pmc.ncbi.nlm.nih.gov/articles/PMC12358577/">
<meta name="og:image" content="https://cdn.ncbi.nlm.nih.gov/pmc/cms/images/pmc-card-share.jpg?_=0">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ncbi">
    
    

    </head>
    <body >
        
    <a class="usa-skipnav " href="#main-content">
      Skip to main content
    </a>


        
            

<section class="usa-banner " aria-label="Official website of the United States government" >
    <div class="usa-accordion">
        <header class="usa-banner__header">
            <div class="usa-banner__inner">
                <div class="grid-col-auto">
                    <img aria-hidden="true"
                         class="usa-banner__header-flag"
                         src="/static/img/us_flag.svg"
                         alt="" />
                </div>

                <div class="grid-col-fill tablet:grid-col-auto" aria-hidden="true">
                    <p class="usa-banner__header-text">
                        An official website of the United States government
                    </p>
                    <span class="usa-banner__header-action">Here's how you know</span>
                </div>

                



















    
        <button
            type="button"
        
    
    class="usa-accordion__button usa-banner__button
           

           
               
               
               
               
            

           
           
           
           "
    aria-expanded="false"
    aria-controls="gov-banner-default"
    
    data-testid="storybook-django-banner"
    
    >
    
        

        
                    <span class="usa-banner__button-text">Here's how you know</span>
                

        
    
        
            </button>
        


            </div>
        </header>

        <div class="usa-banner__content usa-accordion__content"
             id="gov-banner-default"
             hidden>
            <div class="grid-row grid-gap-lg">
                <div class="usa-banner__guidance tablet:grid-col-6">
                    <img class="usa-banner__icon usa-media-block__img"
                         src="/static/img/icon-dot-gov.svg"
                         alt=""
                         aria-hidden="true" />
                    <div class="usa-media-block__body">
                        <p>
                            <strong>Official websites use .gov</strong>
                            <br />
                            A
                            <strong>.gov</strong> website belongs to an official
                            government organization in the United States.
                        </p>
                    </div>
                </div>

                <div class="usa-banner__guidance tablet:grid-col-6">
                    <img class="usa-banner__icon usa-media-block__img"
                         src="/static/img/icon-https.svg"
                         alt=""
                         aria-hidden="true" />

                    <div class="usa-media-block__body">
                        <p>
                            <strong>Secure .gov websites use HTTPS</strong>
                            <br />
                            A <strong>lock</strong> (
                            <span class="icon-lock">
                                <svg xmlns="http://www.w3.org/2000/svg"
                                     width="52"
                                     height="64"
                                     viewBox="0 0 52 64"
                                     class="usa-banner__lock-image"
                                     role="graphics-symbol"
                                     aria-labelledby="banner-lock-description"
                                     focusable="false">
                                    <title id="banner-lock-title">Lock</title>
                                    <desc id="banner-lock-description">
                                    Locked padlock icon
                                    </desc>
                                    <path fill="#000000"
                                          fill-rule="evenodd"
                                          d="M26 0c10.493 0 19 8.507 19 19v9h3a4 4 0 0 1 4 4v28a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V32a4 4 0 0 1 4-4h3v-9C7 8.507 15.507 0 26 0zm0 8c-5.979 0-10.843 4.77-10.996 10.712L15 19v9h22v-9c0-6.075-4.925-11-11-11z" />
                                </svg>
</span>) or <strong>https://</strong> means you've safely
                                connected to the .gov website. Share sensitive
                                information only on official, secure websites.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

        

        
    
    
    

<div class="usa-overlay">
</div>



<header class="usa-header usa-header--extended usa-header--wide" data-header data-testid="header"    >
    <div class="ncbi-header">
        <div class="ncbi-header__container">
            <a class="ncbi-header__logo-container"
               href="https://www.ncbi.nlm.nih.gov/">
                <img alt="NCBI home page"
                     class="ncbi-header__logo-image"
                     src="/static/img/ncbi-logos/nih-nlm-ncbi--white.svg"
                     width="410"
                     height="100" />
            </a>

            <!-- Mobile menu hamburger button -->
            



















    
        <button
            type="button"
        
    
    class="usa-menu-btn ncbi-header__hamburger-button
           

           
               
               
               
               
            

           
           
           
           "
    
    
    aria-label="Show menu"
    data-testid="navMenuButton"
    
    >
    
        

        
                <svg aria-hidden="true"
                     class="ncbi-hamburger-icon"
                     fill="none"
                     focusable="false"
                     height="21"
                     viewBox="0 0 31 21"
                     width="31"
                     xmlns="http://www.w3.org/2000/svg">
                    <path clip-rule="evenodd"
                          d="M0.125 20.75H30.875V17.3333H0.125V20.75ZM0.125 12.2083H30.875V8.79167H0.125V12.2083ZM0.125 0.25V3.66667H30.875V0.25H0.125Z"
                          fill="#F1F1F1"
                          fill-rule="evenodd" />
                </svg>
            

        
    
        
            </button>
        



            
                <!-- Desktop buttons-->
                <div class="ncbi-header__desktop-buttons">
                    
                        <!-- Desktop search button -->
                        



















    
        <button
            type="button"
        
    
    class="usa-button
           

           
               
               
               
               
            

           
           
           usa-button--unstyled ncbi-header__desktop-button
           "
    aria-expanded="false"
    aria-controls="search-field-desktop-navigation"
    aria-label="Show search overlay"
    data-testid="toggleSearchPanelButton"
    data-toggle-search-panel-button
    >
    
        

        
                            



    <svg class="usa-icon " role="graphics-symbol" aria-hidden="true" >
        
        <use xlink:href="/static/img/sprite.svg#search" />
    </svg>


                            Search
                        

        
    
        
            </button>
        


                    

                    <!-- Desktop login dropdown -->
                    
                        <div class="ncbi-header__login-dropdown">
                            



















    
        <button
            type="button"
        
    
    class="usa-button
           

           
               
               
               
               
            

           
           
           usa-button--unstyled ncbi-header__desktop-button ncbi-header__login-dropdown-button
           "
    aria-expanded="false"
    aria-controls="login-dropdown-menu"
    aria-label="Show login menu"
    data-testid="toggleLoginMenuDropdown"
    data-desktop-login-button
    >
    
        

        
                                



    <svg class="usa-icon " role="graphics-symbol" aria-hidden="true" >
        
        <use xlink:href="/static/img/sprite.svg#person" />
    </svg>



                                <span data-login-dropdown-text>Log in</span>

                                <!-- Dropdown icon pointing up -->
                                



    <svg class="usa-icon ncbi-header__login-dropdown-icon ncbi-header__login-dropdown-icon--expand-less ncbi-header__login-dropdown-icon--hidden" role="graphics-symbol" aria-hidden="true" data-login-dropdown-up-arrow>
        
        <use xlink:href="/static/img/sprite.svg#expand_less" />
    </svg>



                                <!-- Dropdown icon pointing down -->
                                



    <svg class="usa-icon ncbi-header__login-dropdown-icon ncbi-header__login-dropdown-icon--expand-more ncbi-header__login-dropdown-icon--hidden" role="graphics-symbol" aria-hidden="true" data-login-dropdown-down-arrow>
        
        <use xlink:href="/static/img/sprite.svg#expand_more" />
    </svg>


                            

        
    
        
            </button>
        



                            <!-- Login dropdown menu -->
                            <ul class="usa-nav__submenu ncbi-header__login-dropdown-menu"
                                id="login-dropdown-menu"
                                data-desktop-login-menu-dropdown
                                hidden>
                                
                                    <li class="usa-nav__submenu-item">
                                        <!-- Uses custom style overrides to render external and document links. -->
                                        









    <a href="https://www.ncbi.nlm.nih.gov/myncbi/" class="usa-link  "  >
        

        
            Dashboard
        

        
    </a>


                                    </li>
                                
                                    <li class="usa-nav__submenu-item">
                                        <!-- Uses custom style overrides to render external and document links. -->
                                        









    <a href="https://www.ncbi.nlm.nih.gov/myncbi/collections/bibliography/" class="usa-link  "  >
        

        
            Publications
        

        
    </a>


                                    </li>
                                
                                    <li class="usa-nav__submenu-item">
                                        <!-- Uses custom style overrides to render external and document links. -->
                                        









    <a href="https://www.ncbi.nlm.nih.gov/account/settings/" class="usa-link  "  >
        

        
            Account settings
        

        
    </a>


                                    </li>
                                
                                <li class="usa-nav__submenu-item">
                                    



















    
        <button
            type="button"
        
    
    class="usa-button
           

           
               
               
               
               
            

           
           
           usa-button--outline ncbi-header__login-dropdown-logout-button
           "
    
    
    
    data-testid="desktopLogoutButton"
    data-desktop-logout-button
    >
    
        

        Log out

        
    
        
            </button>
        


                                </li>
                            </ul>
                        </div>
                    
                </div>
            
        </div>
    </div>

    <!-- Search panel -->
    
        <div class="ncbi-search-panel ncbi--show-only-at-desktop"
             data-header-search-panel
             hidden>
            <div class="ncbi-search-panel__container">
                <form action="https://www.ncbi.nlm.nih.gov/search/all/"
                      
                      autocomplete="off"
                      class="usa-search usa-search--big ncbi-search-panel__form"
                      data-testid="desktop-navigation-search-form"
                      method="GET"
                      role="search">
                    <label class="usa-sr-only" for="search-field-desktop-navigation">
                        Search…
                    </label>
                    <input class="usa-input"
                           id="search-field-desktop-navigation"
                           name="term"
                           
                               placeholder="Search NCBI"
                           
                           type="search"
                           value="" />
                    



















    
        <button
            type="submit"
        
    
    class="usa-button
           

           
               
               
               
               
            

           
           
           
           "
    
    
    
    
    
    >
    
        

        
                        <span class="usa-search__submit-text">
                            Search NCBI
                        </span>
                    

        
    
        
            </button>
        


                </form>

                
            </div>
        </div>
    

    <nav aria-label="Primary navigation" class="usa-nav">
        <p class="usa-sr-only" id="primary-navigation-sr-only-title">
            Primary site navigation
        </p>

        <!-- Mobile menu close button -->
        



















    
        <button
            type="button"
        
    
    class="usa-nav__close ncbi-nav__close-button
           

           
               
               
               
               
            

           
           
           
           "
    
    
    aria-label="Close navigation menu"
    data-testid="navCloseButton"
    
    >
    
        

        
            <img src="/static/img/usa-icons/close.svg" alt="Close" />
        

        
    
        
            </button>
        



        
            <!-- Mobile search component -->
            <form class="usa-search usa-search--small ncbi--hide-at-desktop margin-top-6"
                  action="https://www.ncbi.nlm.nih.gov/search/all/"
                  
                  autocomplete="off"
                  data-testid="mobile-navigation-search-form"
                  method="GET"
                  role="search">
                <label class="usa-sr-only" for="search-field-mobile-navigation">
                    Search
                </label>

                <input class="usa-input"
                       id="search-field-mobile-navigation"
                       type="search"
                       
                           placeholder="Search NCBI"
                       
                       name="term" />

                



















    
        <button
            type="submit"
        
    
    class="usa-button
           

           
               
               
               
               
            

           
           
           
           "
    
    
    
    
    
    >
    
        

        
                    <!-- This SVG should be kept inline and not replaced with a link to the icon as otherwise it will render in the wrong color -->
                    <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0Ij48cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+PHBhdGggZmlsbD0iI2ZmZiIgZD0iTTE1LjUgMTRoLS43OWwtLjI4LS4yN0E2LjQ3MSA2LjQ3MSAwIDAgMCAxNiA5LjUgNi41IDYuNSAwIDEgMCA5LjUgMTZjMS42MSAwIDMuMDktLjU5IDQuMjMtMS41N2wuMjcuMjh2Ljc5bDUgNC45OUwyMC40OSAxOWwtNC45OS01em0tNiAwQzcuMDEgMTQgNSAxMS45OSA1IDkuNVM3LjAxIDUgOS41IDUgMTQgNy4wMSAxNCA5LjUgMTEuOTkgMTQgOS41IDE0eiIvPjwvc3ZnPg=="
                         class="usa-search__submit-icon"
                         alt="Search" />
                

        
    
        
            </button>
        


            </form>

            
        

        <!-- Primary navigation menu items -->
        <!-- This usa-nav__inner wrapper is required to correctly style the navigation items on Desktop -->
        

        
            <div class="ncbi-nav__mobile-login-menu ncbi--hide-at-desktop"
                 data-mobile-login-menu
                 hidden>
                <p class="ncbi-nav__mobile-login-menu-status">
                    Logged in as:
                    <strong class="ncbi-nav__mobile-login-menu-email"
                            data-mobile-login-email-text></strong>
                </p>
                <ul class="usa-nav__primary usa-accordion">
                    
                        <li class="usa-nav__primary-item">
                            









    <a href="https://www.ncbi.nlm.nih.gov/myncbi/" class="usa-link  "  >
        

        
            Dashboard
        

        
    </a>


                        </li>
                    
                        <li class="usa-nav__primary-item">
                            









    <a href="https://www.ncbi.nlm.nih.gov/myncbi/collections/bibliography/" class="usa-link  "  >
        

        
            Publications
        

        
    </a>


                        </li>
                    
                        <li class="usa-nav__primary-item">
                            









    <a href="https://www.ncbi.nlm.nih.gov/account/settings/" class="usa-link  "  >
        

        
            Account settings
        

        
    </a>


                        </li>
                    
                </ul>
            </div>
        

        



















    
        <button
            type="button"
        
    
    class="usa-button
           

           
               
               
               
               
            

           
           
           ncbi-nav__mobile-login-button ncbi--hide-at-desktop
           "
    
    
    
    data-testid="mobileLoginButton"
    data-mobile-login-button
    >
    
        

        Log in

        
    
        
            </button>
        


    </nav>
</header>

    
    
        

<section class="pmc-header pmc-header--basic" aria-label="PMC Header with search box">
    <div class="pmc-nav-container">
        <div class="pmc-header__bar">
           <div class="pmc-header__logo">
               <a href="/" title="Home" aria-label="PMC Home"></a>
           </div>
            <button
                    type="button"
                    class="usa-button usa-button--unstyled pmc-header__search__button"
                    aria-label="Open search"
                    data-ga-category="search"
                    data-ga-action="PMC"
                    data-ga-label="pmc_search_panel_mobile"
            >
                <svg class="usa-icon width-4 height-4 pmc-icon__open" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#search"></use>
                </svg>
                <svg class="usa-icon width-4 height-4 pmc-icon__close" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#close"></use>
                </svg>
            </button>
        </div>
        <div class="pmc-header__search">
            


<form class="usa-search usa-search--extra usa-search--article-right-column  pmc-header__search__form" id="pmc-search-form" autocomplete="off" role="search">
<label class="usa-sr-only" for="pmc-search">Search PMC Full-Text Archive</label>
<span class="autoComplete_wrapper flex-1">
<input class="usa-input width-full maxw-none" required="required" placeholder="Search PMC Full-Text Archive" id="pmc-search"  type="search" name="term" data-autocomplete-url="https://pmc.ncbi.nlm.nih.gov/autocomp/search/autocomp/"/>
</span>
<button
class="usa-button"
type="submit"
formaction="https://www.ncbi.nlm.nih.gov/pmc/"
data-ga-category="search"
data-ga-action="PMC"
data-ga-label="PMC_search_button"
>
<span class="usa-search__submit-text">Search in PMC</span>
<img
src="/static/img/usa-icons-bg/search--white.svg"
class="usa-search__submit-icon"
alt="Search"
/>
</button>
</form>
            <div class="display-flex flex-column tablet:flex-row tablet:flex-justify flex-justify-center flex-align-center width-full desktop:maxw-44">
                <ul class="pmc-header__search__menu">
                    <li>
                        
                            <a class="usa-link" href="/journals/" data-ga-action="featured_link" data-ga-label="journal list">
                                Journal List
                            </a>
                        
                    </li>
                    <li>
                        
                            <a class="usa-link" href="/about/userguide/" data-ga-action="featured_link"
                            data-ga-label="user guide">
                                User Guide
                            </a>
                        
                    </li>
                </ul>
                
                    <button form="pmc-search-form" formaction="https://pmc.ncbi.nlm.nih.gov/search/" type="submit" class="usa-button usa-button--unstyled hover:text-no-underline text-no-underline width-auto margin-top-1 tablet:margin-top-0">
     <span class="bg-green-label padding-05 text-white">New</span><span class="text-underline text-primary">Try this search in PMC Beta Search</span>
</button>
                
            </div>
        </div>
    </div>
</section>

    


        
        

       
  <div class="usa-section padding-top-0 desktop:padding-top-6 pmc-article-section" data-article-db="pmc" data-article-id="12358577">

    

   



<div class="grid-container pmc-actions-bar" aria-label="Actions bar" role="complementary">
    <div class="grid-row">
        <div class="grid-col-fill display-flex">
             <div class="display-flex">
                <ul class="usa-list usa-list--unstyled usa-list--horizontal">
                    <li class="margin-right-2 mobile-lg:margin-right-4 display-flex mob">
                        <button
                                type="button"
                                class="usa-button pmc-sidenav__container__open usa-button--unstyled width-auto display-flex"
                                aria-label="Open resources"
                                data-extra-class="is-visible-resources"
                                data-ga-category="resources_accordion"
                                data-ga-action="click"
                                data-ga-label="mobile_icon"
                        >
                            <svg class="usa-icon width-4 height-4" aria-hidden="true" focusable="false" role="img">
                                <use xlink:href="/static/img/sprite.svg#more_vert"></use>
                            </svg>
                        </button>
                    </li>
                    
                    <li class="margin-right-2 mobile-lg:margin-right-4 display-flex mob">
                        <a
                                href="https://doi.org/10.1038/s41467-025-62901-9"
                                class="usa-link display-flex usa-tooltip"
                                role="button"
                                target="_blank"
                                rel="noreferrer noopener"
                                title="View on publisher site"
                                data-position="bottom"
                                aria-label="View on publisher site"
                                data-ga-category="actions"
                                data-ga-action="click"
                                data-ga-label="publisher_link_mobile"
                        >
                                <svg class="usa-icon width-4 height-4" aria-hidden="true" focusable="false" role="img">
                                    <use xlink:href="/static/img/sprite.svg#launch"></use>
                                </svg>
                        </a>
                    </li>
                    
                    
                        <li class="margin-right-2 mobile-lg:margin-right-4 display-flex">
                             <a
                                     href="pdf/41467_2025_Article_62901.pdf"
                                     class="usa-link display-flex usa-tooltip"
                                     role="button"
                                     title="Download PDF"
                                     data-position="bottom"
                                     aria-label="Download PDF"
                                     data-ga-category="actions"
                                     data-ga-action="click"
                                     data-ga-label="pdf_download_mobile"
                             >
                                <svg class="usa-icon width-4 height-4" aria-hidden="true" focusable="false" role="img">
                                    <use xlink:href="/static/img/sprite.svg#file_download"></use>
                                </svg>
                            </a>
                        </li>
                    
                    <li class="margin-right-2 mobile-lg:margin-right-4 display-flex">
                        <button
                            class="usa-button usa-button--unstyled  usa-tooltip collections-dialog-trigger collections-button display-flex collections-button-empty"
                            title="Add to Collections"
                            data-position="bottom"
                            aria-label="Save article in MyNCBI collections."
                            data-ga-category="actions"
                            data-ga-action="click"
                            data-ga-label="collections_button_mobile"
                            data-collections-open-dialog-enabled="false"
                            data-collections-open-dialog-url="https://account.ncbi.nlm.nih.gov/?back_url=https%3A%2F%2Fpmc.ncbi.nlm.nih.gov%2Farticles%2FPMC12358577%2F%3Freport%3Dclassic%23open-collections-dialog"
                            data-in-collections="false"
                        >
                            <svg class="usa-icon width-4 height-4 usa-icon--bookmark-full" aria-hidden="true" focusable="false" role="img" hidden>
                                <use xlink:href="/static/img/action-bookmark-full.svg#icon"></use>
                            </svg>
                            <svg class="usa-icon width-4 height-4 usa-icon--bookmark-empty" aria-hidden="true" focusable="false" role="img" hidden>
                                <use xlink:href="/static/img/action-bookmark-empty.svg#icon"></use>
                            </svg>
                        </button>
                    </li>
                    
                    <li class="margin-right-2 mobile-lg:margin-right-4 display-flex">
                        <button role="button" class="usa-button usa-button--unstyled usa-tooltip citation-dialog-trigger display-flex"
                            aria-label="Open dialog with citation text in different styles"
                            title="Cite"
                            data-position="bottom"
                            data-ga-category="actions"
                            data-ga-action="open"
                            data-ga-label="cite_mobile"
                            data-all-citations-url="/resources/citations/12358577/"
                            data-citation-style="nlm"
                            data-download-format-link="/resources/citations/12358577/export/"
                        >
                            <svg class="usa-icon width-4 height-4 usa-icon--bookmark-empty" aria-hidden="true" focusable="false" role="img" hidden>
                                <use xlink:href="/static/img/sprite.svg#format_quote"></use>
                            </svg>
                        </button>
                    </li>
                    
                    <li class="pmc-permalink display-flex" >
                         <button
                                 type="button"
                                 title="Permalink"
                                 data-position="bottom"
                                 class="usa-button usa-button--unstyled display-flex usa-tooltip"
                                 aria-label="Show article permalink"
                                 aria-expanded="false"
                                 aria-haspopup="true"
                                 data-ga-category="actions"
                                 data-ga-action="open"
                                 data-ga-label="permalink_mobile"
                         >
                            <svg class="usa-icon width-4 height-4" aria-hidden="true" focusable="false" role="img">
                                <use xlink:href="/static/img/sprite.svg#share"></use>
                            </svg>
                        </button>
                        

<div class="pmc-permalink__dropdown" hidden>
    <div class="pmc-permalink__dropdown__container">
          <h2 class="usa-modal__heading margin-top-0 margin-bottom-2 text-uppercase font-sans-xs">PERMALINK</h2>
          <div class="pmc-permalink__dropdown__content">
              <input type="text" class="usa-input" value="https://pmc.ncbi.nlm.nih.gov/articles/PMC12358577/" aria-label="Article permalink">
              <button class="usa-button display-inline-flex pmc-permalink__dropdown__copy__btn margin-right-0" title="Copy article permalink" data-ga-category="save_share" data-ga-action="link" data-ga-label="copy_link">
                  <svg class="usa-icon" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#content_copy"></use>
                  </svg>
                  <span class="margin-left-1">Copy</span>
              </button>
          </div>
    </div>
</div>
                    </li>
                </ul>
            </div>
            <button
                    type="button"
                    class="usa-button pmc-sidenav__container__open usa-button--unstyled width-auto display-flex"
                    aria-label="Open article navigation"
                    data-extra-class="is-visible-in-page"
                    data-ga-category="actions"
                    data-ga-action="open"
                    data-ga-label="article_nav_mobile"
            >
                <svg class="usa-icon width-4 height-4" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#list"></use>
                </svg>
            </button>
        </div>
    </div>
</div>
    <div class="grid-container desktop:padding-left-6">
      <div id="article-container" class="grid-row grid-gap">
        <div class="grid-col-12 desktop:grid-col-8 order-2 pmc-layout__content">
            <div class="grid-container padding-left-0 padding-right-0">
                <div class="grid-row desktop:margin-left-neg-6">
                    <div class="grid-col-12">
                        <div class="pmc-layout__disclaimer" role="complementary" aria-label="Disclaimer note">
    As a library, NLM provides access to scientific literature. Inclusion in an NLM database does not imply endorsement of, or agreement with,
    the contents by NLM or the National Institutes of Health.<br/>
    Learn more:
    <a class="usa-link" data-ga-category="Link click" data-ga-action="Disclaimer" data-ga-label="New disclaimer box" href="/about/disclaimer/">PMC Disclaimer</a>
    |
    <a class="usa-link" data-ga-category="Link click" data-ga-action="PMC Copyright Notice" data-ga-label="New disclaimer box" href="/about/copyright/">
        PMC Copyright Notice
    </a>
</div>
                    </div>
                </div>
                <div class="grid-row pmc-wm desktop:margin-left-neg-6">
                    <!-- Main content -->
                    <main
                      id="main-content"
                      class="usa-layout-docs__main usa-layout-docs grid-col-12 pmc-layout pmc-prose padding-0"
                    >

                      
                        <section class="pmc-journal-banner text-center line-height-none" aria-label="Journal banner"><img src="https://cdn.ncbi.nlm.nih.gov/pmc/banners/logo-ncomms.gif" alt="Nature Communications logo" usemap="#pmc-banner-imagemap" width="500" height="75"><map name="pmc-banner-imagemap"><area alt="Link to Nature Communications" title="Link to Nature Communications" shape="default" href="http://www.nature.com/ncomms/index.html" target="_blank" rel="noopener noreferrer"></map></section><article lang="en"><section aria-label="Article citation and metadata"><section class="pmc-layout__citation font-secondary font-xs"><div>
<div class="display-inline-block"><button type="button" class="cursor-pointer text-no-underline bg-transparent border-0 padding-0 text-left margin-0 text-normal text-primary" aria-controls="journal_context_menu">Nat Commun</button></div>. 2025 Aug 18;16:7656. doi: <a href="https://doi.org/10.1038/s41467-025-62901-9" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">10.1038/s41467-025-62901-9</a>
</div>
<nav id="journal_context_menu" hidden="hidden"><ul class="menu-list font-family-ui" role="menu">
<li role="presentation"><a href="https://www.ncbi.nlm.nih.gov/pmc/?term=%22Nat%20Commun%22%5Bjour%5D" class="usa-link" role="menuitem">Search in PMC</a></li>
<li role="presentation"><a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Nat%20Commun%22%5Bjour%5D" lang="en" class="usa-link" role="menuitem">Search in PubMed</a></li>
<li role="presentation"><a href="https://www.ncbi.nlm.nih.gov/nlmcatalog?term=%22Nat%20Commun%22%5BTitle%20Abbreviation%5D" class="usa-link" role="menuitem">View in NLM Catalog</a></li>
<li role="presentation"><a href="?term=%22Nat%20Commun%22%5Bjour%5D" class="usa-link" role="menuitem" data-add-to-search="true">Add to search</a></li>
</ul></nav></section><section class="front-matter"><div class="ameta p font-secondary font-xs">
<hgroup><h1>AI-powered spatiotemporal imputation and prediction of chlorophyll-a concentration in coastal ecosystems</h1></hgroup><div class="cg p">
<a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Zhang%20F%22%5BAuthor%5D" class="usa-link" aria-describedby="id1"><span class="name western">Fan Zhang</span></a><div hidden="hidden" id="id1">
<h3><span class="name western">Fan Zhang</span></h3>
<div class="p">
<sup>1</sup>Department of Mathematics, The Hong Kong University of Science and Technology, Hong Kong SAR, China </div>
<div class="p">
<sup>2</sup>Center for Ocean Research in Hong Kong and Macau, The Hong Kong University of Science and Technology, Hong Kong SAR, China </div>
<div class="p">Find articles by <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Zhang%20F%22%5BAuthor%5D" class="usa-link"><span class="name western">Fan Zhang</span></a>
</div>
</div>
<sup>1,</sup><sup>2</sup>, <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Kung%20H%22%5BAuthor%5D" class="usa-link" aria-describedby="id2"><span class="name western">Hiusuet Kung</span></a><div hidden="hidden" id="id2">
<h3><span class="name western">Hiusuet Kung</span></h3>
<div class="p">
<sup>2</sup>Center for Ocean Research in Hong Kong and Macau, The Hong Kong University of Science and Technology, Hong Kong SAR, China </div>
<div class="p">
<sup>3</sup>Department of Ocean Science, The Hong Kong University of Science and Technology, Hong Kong SAR, China </div>
<div class="p">Find articles by <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Kung%20H%22%5BAuthor%5D" class="usa-link"><span class="name western">Hiusuet Kung</span></a>
</div>
</div>
<sup>2,</sup><sup>3</sup>, <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Zhang%20F%22%5BAuthor%5D" class="usa-link" aria-describedby="id3"><span class="name western">Fa Zhang</span></a><div hidden="hidden" id="id3">
<h3><span class="name western">Fa Zhang</span></h3>
<div class="p">
<sup>1</sup>Department of Mathematics, The Hong Kong University of Science and Technology, Hong Kong SAR, China </div>
<div class="p">Find articles by <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Zhang%20F%22%5BAuthor%5D" class="usa-link"><span class="name western">Fa Zhang</span></a>
</div>
</div>
<sup>1</sup>, <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Yang%20C%22%5BAuthor%5D" class="usa-link" aria-describedby="id4"><span class="name western">Can Yang</span></a><div hidden="hidden" id="id4">
<h3><span class="name western">Can Yang</span></h3>
<div class="p">
<sup>1</sup>Department of Mathematics, The Hong Kong University of Science and Technology, Hong Kong SAR, China </div>
<div class="p">
<sup>2</sup>Center for Ocean Research in Hong Kong and Macau, The Hong Kong University of Science and Technology, Hong Kong SAR, China </div>
<div class="p">Find articles by <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Yang%20C%22%5BAuthor%5D" class="usa-link"><span class="name western">Can Yang</span></a>
</div>
</div>
<sup>1,</sup><sup>2,</sup><sup>✉</sup>, <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Gan%20J%22%5BAuthor%5D" class="usa-link" aria-describedby="id5"><span class="name western">Jianping Gan</span></a><div hidden="hidden" id="id5">
<h3><span class="name western">Jianping Gan</span></h3>
<div class="p">
<sup>1</sup>Department of Mathematics, The Hong Kong University of Science and Technology, Hong Kong SAR, China </div>
<div class="p">
<sup>2</sup>Center for Ocean Research in Hong Kong and Macau, The Hong Kong University of Science and Technology, Hong Kong SAR, China </div>
<div class="p">
<sup>3</sup>Department of Ocean Science, The Hong Kong University of Science and Technology, Hong Kong SAR, China </div>
<div class="p">Find articles by <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Gan%20J%22%5BAuthor%5D" class="usa-link"><span class="name western">Jianping Gan</span></a>
</div>
</div>
<sup>1,</sup><sup>2,</sup><sup>3,</sup><sup>✉</sup>
</div>
<ul class="d-buttons inline-list">
<li><button class="d-button" aria-controls="aip_a" aria-expanded="false">Author information</button></li>
<li><button class="d-button" aria-controls="anp_a" aria-expanded="false">Article notes</button></li>
<li><button class="d-button" aria-controls="clp_a" aria-expanded="false">Copyright and License information</button></li>
</ul>
<div class="d-panels font-secondary-light">
<div id="aip_a" class="d-panel p" style="display: none">
<div class="p" id="Aff1">
<sup>1</sup>Department of Mathematics, The Hong Kong University of Science and Technology, Hong Kong SAR, China </div>
<div id="Aff2">
<sup>2</sup>Center for Ocean Research in Hong Kong and Macau, The Hong Kong University of Science and Technology, Hong Kong SAR, China </div>
<div id="Aff3">
<sup>3</sup>Department of Ocean Science, The Hong Kong University of Science and Technology, Hong Kong SAR, China </div>
<div class="author-notes p"><div class="fn" id="_fncrsp93pmc__">
<sup>✉</sup><p class="display-inline">Corresponding author.</p>
</div></div>
</div>
<div id="anp_a" class="d-panel p" style="display: none"><div class="notes p"><section id="historyarticle-meta1" class="history"><p>Received 2025 Feb 19; Accepted 2025 Aug 4; Collection date 2025.</p></section></div></div>
<div id="clp_a" class="d-panel p" style="display: none">
<div>© The Author(s) 2025</div>
<p><strong>Open Access</strong> This article is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License, which permits any non-commercial use, sharing, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if you modified the licensed material. You do not have permission under this licence to share adapted material derived from this article or parts of it. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">http://creativecommons.org/licenses/by-nc-nd/4.0/</a>.</p>
<div class="p"><a href="/about/copyright/" class="usa-link">PMC Copyright notice</a></div>
</div>
</div>
<div>PMCID: PMC12358577  PMID: <a href="https://pubmed.ncbi.nlm.nih.gov/40820013/" class="usa-link">40820013</a>
</div>
</div></section></section><section aria-label="Article content"><section class="body main-article-body"><section class="abstract" id="Abs1"><h2>Abstract</h2>
<p id="Par1">Predicting spatiotemporal Chlorophyll-a (Chl_a) distributions is essential for diagnosing and analysing productivity and ecosystem health of coastal oceans. Yet, current tools remain inadequate for prognosing marine ecosystems through predicting spatiotemporal Chl_a distributions, particularly in the dynamic coastal ocean. Coupled physics-biogeochemical models struggle to resolve complex trophic interactions, while data-driven approaches are limited by incomplete satellite observations. We developed an advanced AI-powered spatiotemporal imputation and prediction (STIMP) model for predicting Chl_a in coastal ocean. STIMP adopts a novel paradigm that first imputes and subsequently predicts Chl_a across a broad spatiotemporal scale, resolving difficulties arising from incompletion, nonstationary temporal variations, and spatial heterogeneity of data through integrating specially designed modules. We demonstrated the STIMP’s robust imputation and prediction of Chl_a in four representative global coastal oceans. STIMP reduced the imputation mean absolute error (MAE) by 45.90–81.39% compared with the data interpolating empirical orthogonal function method in geoscience and by 8.92–43.04% against leading AI methods. With accurate imputation, STIMP demonstrated superior predictive accuracy, achieving MAE reductions of 58.99% over biogeophysical models and 6.54–13.68% over AI benchmarks. STIMP offers a new approach for predicting oceans’ Chl_a that typically have spatiotemporally limited data.</p>
<section id="kwd-group1" class="kwd-group"><p><strong>Subject terms:</strong> Marine biology, Natural hazards, Marine chemistry</p></section></section><section class="abstract" id="Abs2"><hr class="headless">
<p id="Par2">An AI-powered spatiotemporal imputation and prediction model (STIMP) is designed to predict Chlorophyll-a distributions in coastal oceans. STIMP reduces imputation mean absolute error and improves predictability compared to traditional and current leading AI methods.</p></section><section id="Sec1"><h2 class="pmc_sec_title">Introduction</h2>
<p id="Par3">Coastal oceans are the world’s most productive marine ecosystems<sup><a href="#CR1" class="usa-link" aria-describedby="CR1">1</a></sup> because terrestrial nutrient input and active hydrodynamics produce high biological productivity and biodiversity<sup><a href="#CR2" class="usa-link" aria-describedby="CR2">2</a>,<a href="#CR3" class="usa-link" aria-describedby="CR3">3</a></sup>. The ecosystems of coastal oceans, however, are vulnerable to frequent and severe eutrophication<sup><a href="#CR4" class="usa-link" aria-describedby="CR4">4</a></sup>, biogeochemical extremes<sup><a href="#CR5" class="usa-link" aria-describedby="CR5">5</a></sup>, and hypoxia<sup><a href="#CR6" class="usa-link" aria-describedby="CR6">6</a></sup> that substantially threaten the sustainability of these coastal environments<sup><a href="#CR7" class="usa-link" aria-describedby="CR7">7</a>,<a href="#CR8" class="usa-link" aria-describedby="CR8">8</a></sup> and the blue economies of the coastal zones<sup><a href="#CR9" class="usa-link" aria-describedby="CR9">9</a>,<a href="#CR10" class="usa-link" aria-describedby="CR10">10</a></sup>.</p>
<p id="Par4">The concentration of chlorophyll-a (Chl_a) is a key indicator of the overall health of marine environments<sup><a href="#CR11" class="usa-link" aria-describedby="CR11">11</a>,<a href="#CR12" class="usa-link" aria-describedby="CR12">12</a></sup>. An increasing number of studies have diagnosed and predicted Chl_a concentration in marine ecosystems. These studies can be broadly classified into two categories: coupled physics-biogeochemistry numerical simulations and data-driven predictions. Simulations predict the concentrations by integrating a suit of physical and biogeochemical equations<sup><a href="#CR13" class="usa-link" aria-describedby="CR13">13</a>–<a href="#CR15" class="usa-link" aria-describedby="CR15">15</a></sup>. Unfortunately, complex and unknown trophic transfers in ocean ecosystems pose qualitative and quantitative challenges<sup><a href="#CR16" class="usa-link" aria-describedby="CR16">16</a></sup> in these coupled physical and biogeochemical models so that factors such as energy fluxes and biomass are not represented well because of simplified biogeochemical cycles. Unlike open ocean, Chl_a identification and prediction are even more challenge in the coastal waters under controls of multiple forcings from terrestrial, active coupled hydrodynamic-biogeochemical processes and influx from open ocean. These errors accumulate<sup><a href="#CR17" class="usa-link" aria-describedby="CR17">17</a></sup> continuously during the long-term integration of nonlinear systems, ultimately affecting the accuracy of the simulation results. Many works<sup><a href="#CR18" class="usa-link" aria-describedby="CR18">18</a>,<a href="#CR19" class="usa-link" aria-describedby="CR19">19</a></sup> intend to integrate observation of Chl_a and coupled physics-biogeochemistry numerical simulation model to mitigate error accumulations. By calibrating the state variables, these methods enhance the forecasting capability of ocean numerical simulations. However, error accumulations are inevitable in coupled physics-biogeochemistry numerical simulations<sup><a href="#CR20" class="usa-link" aria-describedby="CR20">20</a>,<a href="#CR21" class="usa-link" aria-describedby="CR21">21</a></sup>.</p>
<p id="Par5">In contrast, data-driven approaches that use historic observations allow discovery of underlying dynamic patterns by analysing spatiotemporal variations of Chl_a. Without requiring extensive oceanic knowledge, computational-friendly data-driven approaches, such as mechanistic<sup><a href="#CR22" class="usa-link" aria-describedby="CR22">22</a></sup>, statistical<sup><a href="#CR23" class="usa-link" aria-describedby="CR23">23</a>,<a href="#CR24" class="usa-link" aria-describedby="CR24">24</a></sup> and deep learning methods<sup><a href="#CR25" class="usa-link" aria-describedby="CR25">25</a>–<a href="#CR27" class="usa-link" aria-describedby="CR27">27</a></sup>, have gained more attention in marine ecosystem study by offering an alternative solution to the numerical modelling challenges. Moreover, remote sensing measurements provide precious data support for the developing data-driven spatiotemporal Chl_a prediction methods. Sea-viewing Wide Field-of-view Sensor (SeaWiFS), Moderate Resolution Imaging Spectroradiometers (MODIS), including Terra MODIS and Aqua MODIS, and other remotely sensing data provide near-daily coverage of the global surface ocean<sup><a href="#CR28" class="usa-link" aria-describedby="CR28">28</a></sup> and capture large-scale changes of phytoplankton biomass in the ocean<sup><a href="#CR29" class="usa-link" aria-describedby="CR29">29</a></sup>.</p>
<p id="Par6">However, there remain three challenges in developing large-scale spatiotemporal Chl_a data-driven prediction method. First, temporal variations are difficult to capture in existing data. Temporal variations of Chl_a are controlled by complex physical and biogeochemical stressors, such as water stratification, nutrient supply, and light conditions, whose variability exacerbate the unpredictability of Chl_a concentrations, even over short periods<sup><a href="#CR30" class="usa-link" aria-describedby="CR30">30</a></sup>. Second, spatial heterogeneity and relationships are difficult to model, and distinct temporal patterns in Chl_a distributions have been observed across different locations due to terrain, ocean currents, and other conditions. Third, high rates of missing observations render spatiotemporal variations more challenging to comprehend. Satellite remote sensing measurements are highly susceptible to environmental factors such as orbital position of satellite and cloud coverage<sup><a href="#CR31" class="usa-link" aria-describedby="CR31">31</a></sup>. In a typical coastal ocean such as the Pearl River Estuary, one of our study sites in the northern South China Sea (Fig. <a href="#Fig1" class="usa-link">1</a>a), the average rate of missing 8-day Chl_a data is 50.29%. These kinds of spatiotemporally limited observation data hinder resolving the variations of Chl_a that are needed for accurate predictions.</p>
<figure class="fig xbox font-sm" id="Fig1"><h3 class="obj_head">Fig. 1. Overview of STIMP.</h3>
<p class="img-box line-height-none margin-x-neg-2 tablet:margin-x-0 text-center"><a class="tileshop" target="_blank" href="https://www.ncbi.nlm.nih.gov/core/lw/2.0/html/tileshop_pmc/tileshop_pmc_inline.html?title=Click%20on%20image%20to%20zoom&amp;p=PMC3&amp;id=12358577_41467_2025_62901_Fig1_HTML.jpg"><img class="graphic zoom-in" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/2f2a/12358577/1085100e2e39/41467_2025_62901_Fig1_HTML.jpg" loading="lazy" id="d33e351" height="599" width="682" alt="Fig. 1"></a></p>
<div class="p text-right font-secondary"><a href="figure/Fig1/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div>
<figcaption><p><strong>a</strong> We applied STIMP to four representative global coastal regions: the Pearl River Estuary, northern Gulf of Mexico, Chesapeake Bay, and the Yangtze River Estuary. <strong>b</strong> STIMP is designed to predict future Chlorophyll-a (Chl_a) according to past partial observation. <strong>c</strong>–<strong>f</strong> The overall framework for STIMP involves two successive stages: Imputation and Prediction. <strong>c</strong> STIMP uses past partial observations of Chl_a, with spatial coordinates of the observations as inputs. <strong>d</strong> STIMP uses the Spatiotemporal Denoising Diffusion Model (STDDM) to reconstruct a completed Chl_a dataset with spatiotemporal relationships from the past partial observation dataset. <strong>e</strong> STIMP outputs the future Chl_a based on the completed Chl_a dataset. <strong>f</strong> The outputs of STIMP, including imputed past observations of Chl_a and predicted future Chl_a for the entire ocean, can be used for marine conservation initiatives and policymaking for coastal regions.</p></figcaption></figure><p id="Par7">In this study, we developed an advanced AI-powered spatiotemporal imputation and prediction (STIMP) model for predicting Chl_a in coastal ocean. The success of STIMP is attributed to the paradigm of first imputing and subsequently predicting. High rates of missing observations render spatiotemporal variations of Chl_a and pose challenges to comprehend and predict of the ecosystem. Most data-driven methods are able to make the prediction of Chl_a when the observation datasets are complete, but struggle to identify its temporal patterns and spatial relationships when there are only partial datasets of observations. STIMP decomposes the prediction of Chl_a into two sequential steps: 1) <em>the imputation process</em>, which reconstructs multiple potential complete spatiotemporal Chl_a distributions from partial observations, and 2) <em>the prediction process</em>, which accurately predicts Chl_a based on each reconstructed continuous and complete spatiotemporal Chl_a distribution. Using Rubin’s rules<sup><a href="#CR32" class="usa-link" aria-describedby="CR32">32</a></sup>, the final Chl_a prediction is obtained by averaging the outcomes of multiple imputation and prediction processes. In this way, our STIMP method not only improves the overall predictive performance through accurate imputation of missing data but also provides confidence intervals to quantify the prediction uncertainties.</p>
<p id="Par8">Moreover, STIMP can address the three challenges of incompletion, nonstationary temporal variations, and spatial heterogeneity of data that we are facing by integrating three specially designed modules. We conducted benchmark studies of four representative global coastal regions: northern Gulf of Mexico, Chesapeake Bay, the Yangtze River Estuary, and the Pearl River Estuary. These four regions all suffer eutrophication and hypoxia due to explosively growths of algae with high concentrations of Chl_a. STIMP demonstrated superiority in large-scale spatiotemporal Chl_a imputation and prediction over baseline methods. Our results also indicated that the importance of imputation in the prediction. STIMP has proofed its capabilities to diagnose and prognose broad oceans that typically have spatiotemporally limited data.</p></section><section id="Sec2"><h2 class="pmc_sec_title">Results</h2>
<section id="Sec3"><h3 class="pmc_sec_title">STIMP method</h3>
<p id="Par9">STIMP is a deep learning-based method that accurately imputes and predicts Chl_a in the coastal oceans (Fig. <a href="#Fig1" class="usa-link">1</a>). The inputs for STIMP include observations of Chl_a from coastal oceans, denoted as <strong>X</strong><sup><em>o</em><em>b</em></sup>, and a spatial graph, <strong>G</strong>, that contains the geographic coordinates of the observations. STIMP simultaneously outputs a complete Chl_a dataset, <strong>X</strong>, and accurately predicts Chl_a, <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq1"><math id="d33e394"><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover></math></span>, based on <strong>X</strong>. STIMP and is formulated as:</p>
<table class="disp-formula p" id="Equ1"><tr>
<td class="formula"><math id="d33e413" display="block"><mi>p</mi><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>∣</mo><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup></mrow><mo>)</mo></mrow><mo>=</mo><msub><mrow><mo>∫</mo></mrow><mrow><mi mathvariant="bold">X</mi></mrow></msub><msub><mrow><mi>p</mi></mrow><mrow><mi mathvariant="normal">Φ</mi></mrow></msub><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>∣</mo><mi mathvariant="bold">X</mi></mrow><mo>)</mo></mrow><msub><mrow><mi>p</mi></mrow><mrow><mi>θ</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="bold">X</mi><mo>∣</mo><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup></mrow><mo>)</mo></mrow><mi>d</mi><mi mathvariant="bold">X</mi><mo>.</mo></math></td>
<td class="label">1</td>
</tr></table>
<p id="Par10">Specifically, the primary challenge in learning the imputation function <em>p</em><sub><em>θ</em></sub>(<strong>X</strong>∣<strong>X</strong><sup><em>o</em><em>b</em></sup>) lies in approximating the spatiotemporal distribution of Chl_a. We designed a Spatiotemporal Denoising Diffusion Model (STDDM) as the imputation function. Specifically, STDDM decompose the complicated task into <em>L</em> simple tasks, with the objective of increasing the signal-to-noise ratio. Finally, the spatiotemporal distribution of Chl_a is transformed from an easy-to-sample distribution <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq2"><math id="d33e511"><mi>p</mi><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow><mo>)</mo></mrow><mo>=</mo><mi class="MJX-tex-caligraphic" mathvariant="script">N</mi><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>L</mi></mrow></msub><mo>;</mo><mi mathvariant="bold">0</mi><mo>,</mo><mi mathvariant="bold">I</mi></mrow><mo>)</mo></mrow></math></span>, using a joint distribution in the form of a Markov chain:</p>
<table class="disp-formula p" id="Equ2"><tr>
<td class="formula"><math id="d33e550" display="block"><msub><mrow><mi>p</mi></mrow><mrow><mi>θ</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="bold">X</mi><mo>∣</mo><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup></mrow><mo>)</mo></mrow><mo>=</mo><mo>∫</mo><mspace width="0.25em"></mspace><mi>p</mi><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow><mo>)</mo></mrow><msub><mrow><mi>p</mi></mrow><mrow><mi>θ</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="bold">X</mi><mo>∣</mo><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>,</mo><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup></mrow><mo>)</mo></mrow><msubsup><mrow><mo mathsize="big">∏</mo></mrow><mrow><mi>l</mi><mo>=</mo><mi>L</mi></mrow><mrow><mn>2</mn></mrow></msubsup><msub><mrow><mi>p</mi></mrow><mrow><mi>θ</mi></mrow></msub><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>∣</mo><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi></mrow></msub><mo>,</mo><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup></mrow><mo>)</mo></mrow><mi>d</mi><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mn>1</mn><mo>:</mo><mi>L</mi></mrow></msub><mo>.</mo></math></td>
<td class="label">2</td>
</tr></table>
<p>Then the large scale spatiotemporal future Chl_a distribution is predicted using the function, <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq3"><math id="d33e670"><msub><mrow><mi>p</mi></mrow><mrow><mi mathvariant="normal">Φ</mi></mrow></msub><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>∣</mo><mi mathvariant="bold">X</mi></mrow><mo>)</mo></mrow></math></span>.</p>
<p id="Par11">The network structures of the imputation and prediction functions are shown in the Fig. <a href="#Fig1" class="usa-link">1</a>. For both imputation and prediction functions, nonstationary temporal variations and spatial heterogeneity of Chl_a are all difficult and crucial. For nonstationary temporal variations, we employ Temporal Linear Transformer (TLT). TLT preserves crucial information regarding the Chl_a variations, computing across all elements of the time series to facilitate understanding of the temporal patterns of Chl_a. For spatial heterogeneity, we designed a Heterogeneous Spatial Graph Neural Network (HSGNN). HSGNN learns location-specific parameters from parameter pools to represent spatial heterogeneity. By doing so, distinct temporal patterns across different locations can be well accommodated in spatial-specific parameters in a computationally friendly way. We reuse the same structure of TLT and HSGNN in both the imputation function and the prediction function, ensuring that the spatiotemporal relationships of Chl_a can be well utilized in both tasks.</p></section><section id="Sec4"><h3 class="pmc_sec_title">Benchmarking spatiotemporal imputation and prediction</h3>
<p id="Par12">We evaluated how well STIMP separately imputed and predicted Chl_a concentrations. We used MODIS Aqua project data<sup><a href="#CR33" class="usa-link" aria-describedby="CR33">33</a></sup> for: (1) the Pearl River Estuary, 4325 positions within 20.52–22.98°N, 112.02–115.98°E, with rates of missing data for each position ranging from 32.06% to 89.56% with an average rate of missing data across all positions equal to 50.29%; (2) northern Gulf of Mexico, 2907 positions within 28.52° to 29.98°N, 89.02° to 93.98°W, with rates of missing data for each position ranging from 5.35% to 94.23% with an average rate of missing data across all positions equal to 18.19%; (3) Chesapeake Bay, 1893 positions within 36.52–38.98°N, 74.52–76.48°W, with rates of missing data for each position ranging from 4.09% to 88.05% with an average rate of missing data across all positions equal to 10.49%; and (4) the Yangtze River, 4572 positions within 28.02° to 31.98°N, 121.02° to 123.98°E, with rates of missing data for each position ranging from 41.93% to 89.94% with an average rate of missing data across all positions equal to 54.28%. All data are from 01 January 2003 to 22 September 2023. For default settings, training data span 1 January 2003 through 31 January 2015, with the independent test set encompassing observations from 7 February 2015 to 22 September 2023.</p>
<p id="Par13">For the spatiotemporal imputation, we assessed the performance of STIMP based on four categories, comparing our results with different baseline methods in these categories: (1) a data interpolating empirical orthogonal function (DINEOF) method<sup><a href="#CR34" class="usa-link" aria-describedby="CR34">34</a>,<a href="#CR35" class="usa-link" aria-describedby="CR35">35</a></sup> from geoscience, note that, we selected <em>t</em> = 1 in our implementation after conducting a comprehensive comparison of various values of <em>t</em> (Supplementary Figs. <a href="#MOESM1" class="usa-link">S11</a> and <a href="#MOESM1" class="usa-link">S12</a>); (2) classic statistical methods, including Slide Window and Lin-ITP; (3) spatiotemporal machine learning method, including TRMF<sup><a href="#CR36" class="usa-link" aria-describedby="CR36">36</a></sup>; (4) deep learning methods, including CSDI<sup><a href="#CR37" class="usa-link" aria-describedby="CR37">37</a></sup>, ImputeFormer<sup><a href="#CR38" class="usa-link" aria-describedby="CR38">38</a></sup>, Inpainter<sup><a href="#CR39" class="usa-link" aria-describedby="CR39">39</a></sup> and MaskedAE<sup><a href="#CR40" class="usa-link" aria-describedby="CR40">40</a></sup>. Because our collected data were not ground truthed for unobserved data, we randomly selected nine different rates of missing data, ranging from 10% to 90%, for choosing observed data as imputation targets. In so doing, we were able to verify the performance of all methods with different rates of missing data. Overall, we saw that STIMP outperformed the other baseline methods for different datasets in terms of the mean absolute error (MAE), demonstrating we could apply STIMP effectively to different regions. STIMP significantly reduced MAE by 45.90–81.39% compared to DINEOF, and by 8.92–43.04% compared to the state-of-the-art AI methods. STIMP reduced mean square error (MSE) by 69.47–95.64% compared to DINEOF, and by 12.04–68.30% compared to the state-of-the-art AI methods (Supplementary Fig. <a href="#MOESM1" class="usa-link">S1</a>). In addition, DINEOF performed even worse than linear interpolation Lin-ITP due to the complexity of the spatiotemporal Chl_a distribution. Specifically, the intricate relationships present in the large-scale, long-term observations challenged DINEOF in effectively capturing the spatiotemporal relationships using singular value decomposition. The performance of CSDI and ImputeFormer was inevitably unsatisfactory because neither considers spatial relationships during imputation. Our results indicate that the spatial and temporal relationships are essential for imputing data.</p>
<p id="Par14">We comprehensively compared different methods of predicting Chl_a (Fig. <a href="#Fig2" class="usa-link">2</a>b). For the spatiotemporal prediction, we compared results against baseline methods in three categories: (1) machine learning method, XGBoost<sup><a href="#CR41" class="usa-link" aria-describedby="CR41">41</a></sup>; (2) time series prediction methods, including CrossFormer<sup><a href="#CR42" class="usa-link" aria-describedby="CR42">42</a></sup>, TSMixer<sup><a href="#CR43" class="usa-link" aria-describedby="CR43">43</a></sup> and iTransFormer<sup><a href="#CR44" class="usa-link" aria-describedby="CR44">44</a></sup>; (3) spatiotemporal prediction methods, including MTGNN<sup><a href="#CR45" class="usa-link" aria-describedby="CR45">45</a></sup> and PredRNN<sup><a href="#CR46" class="usa-link" aria-describedby="CR46">46</a></sup>. We also compared our STIMP results with results from the well-calibrated numerical model, CMOMS<sup><a href="#CR15" class="usa-link" aria-describedby="CR15">15</a></sup> for Pearl River Estuary. STIMP performed well for all four regions. Compared to the second best method, STIMP reduced MAE by 12.24%, 13.68%, 6.54%, and 9.72% (Fig. <a href="#Fig2" class="usa-link">2</a>b) and reduced MSE by 22.28%, 22.81%, 15.37%, and 12.17% for all four regions (Supplementary Fig. <a href="#MOESM1" class="usa-link">S2</a>). PredRNN performed the second best. PredRNN uses spatiotemporal recurrent neural networks with long short-term memory to memorize spatial appearances and temporal variations, performing better than time series prediction methods. The results demonstrate the importance of the spatiotemporal relationships for accurate prediction. However, due to the inherent lack of observations of Chl_a, PredRNN could not perform as well as STIMP.</p>
<figure class="fig xbox font-sm" id="Fig2"><h4 class="obj_head">Fig. 2. A benchmarking study of spatiotemporal imputation and prediction of Chl_a for four global representative coastal oceans.</h4>
<p class="img-box line-height-none margin-x-neg-2 tablet:margin-x-0 text-center"><a class="tileshop" target="_blank" href="https://www.ncbi.nlm.nih.gov/core/lw/2.0/html/tileshop_pmc/tileshop_pmc_inline.html?title=Click%20on%20image%20to%20zoom&amp;p=PMC3&amp;id=12358577_41467_2025_62901_Fig2_HTML.jpg"><img class="graphic zoom-in" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/2f2a/12358577/9406fff7a9fc/41467_2025_62901_Fig2_HTML.jpg" loading="lazy" id="d33e803" height="368" width="678" alt="Fig. 2"></a></p>
<div class="p text-right font-secondary"><a href="figure/Fig2/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div>
<figcaption><p><strong>a</strong> Overall mean absolute error (MAE) between ground truth and imputed Chl_a for different interpolation methods. For each coastal ocean, we constructed datasets with nine different rates of missing data, ranging from 10% to 90%. Source data are provided as a Source Data file. <strong>b</strong> Overall MAE between ground truth and predicted Chl_a of different prediction methods. Source data are provided as a Source Data file.</p></figcaption></figure></section><section id="Sec5"><h3 class="pmc_sec_title">STIMP enables spatiotemporal imputation</h3>
<p id="Par15">We used the Pearl River Estuary to demonstrate the effectiveness of STIMP spatiotemporal imputation. The number of missing observations from the Pearl River Estuary reflects the data deficiencies for most estuaries. The advantage of using the Pearl River Estuary as an example is that we have results from numerical simulations to compare to our STIMP results. There are several major cities in the Pearl River Estuary, including Shenzhen, Guangzhou, and Zhuhai, where rapid industrialization and urbanization have adversely impacted water quality in downstream of the Pearl River system<sup><a href="#CR47" class="usa-link" aria-describedby="CR47">47</a></sup>. Eutrophication has produced serious red tide events or harmful algal blooms in the estuary and its adjacent coastal waters since the 1980s, causing economic losses<sup><a href="#CR48" class="usa-link" aria-describedby="CR48">48</a></sup>.</p>
<p id="Par16">High rates of missing observations prevent completing a picture of the spatiotemporal Chl_a relationships for the Pearl River Estuary, impeding forecasting and analysis. However, STIMP enabled large-scale spatiotemporal imputation of the Pearl River Estuary data. STIMP performed exceptionally compared to other imputation methods for one-year imputation in terms of MAE, reducing MAE significantly by 45.90% to 77.35% compared to DINEOF and by 10.20% to 40.38% compared to the second best model (Fig. <a href="#Fig2" class="usa-link">2</a>a). Despite the default length of the time series on imputation, we tested the performance of STIMP in imputation over periods of 6 months and one-and-a-half years (Fig. <a href="#Fig3" class="usa-link">3</a>a). The results demonstrated that the length of the time series on gap-filling did not affect the superiority of STIMP. For 6 months imputation, STIMP significantly reduced MAE by 44.34–76.54% compared to DINEOF, and 4.64–38.22% compared to the state-of-the-art AI methods. For one-and-a-half years imputation, STIMP achieved MAE reductions of 50.34–76.43% compared to DINEOF, and of 0.33–38.17% compared to the state-of-the-art AI methods.</p>
<figure class="fig xbox font-sm" id="Fig3"><h4 class="obj_head">Fig. 3. SIIMP enables large scale spatiotemporal imputation of chlorophyll-a (Chl_a) in the Pearl River Estuary.</h4>
<p class="img-box line-height-none margin-x-neg-2 tablet:margin-x-0 text-center"><a class="tileshop" target="_blank" href="https://www.ncbi.nlm.nih.gov/core/lw/2.0/html/tileshop_pmc/tileshop_pmc_inline.html?title=Click%20on%20image%20to%20zoom&amp;p=PMC3&amp;id=12358577_41467_2025_62901_Fig3_HTML.jpg"><img class="graphic zoom-in" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/2f2a/12358577/968491f84d90/41467_2025_62901_Fig3_HTML.jpg" loading="lazy" id="d33e843" height="441" width="679" alt="Fig. 3"></a></p>
<div class="p text-right font-secondary"><a href="figure/Fig3/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div>
<figcaption><p><strong>a</strong> Overall mean absolute error (MAE) between ground truth and imputed Chl_a for different imputation methods over half-year and one-and-a-half-year periods. <strong>b</strong> Pearson correlation coefficient (PCC) between imputed data and ground truth data of STIMP and data interpolating empirical orthogonal function (DINEOF) method at rates of missing data equal to 10%, 30%, 50%, 70%, and 90%. <strong>c</strong> Measured and imputed Chl_a distribution in the Pearl River Estuary. The first column from the left shows the original observations with many missing values. The second and third columns show the corresponding imputed Chl_a from DINEOF and STIMP. <strong>d</strong> Imputed Chl_a from STIMP at five locations. The original observations are represented by blue lines, and the imputed Chl_a are represented by red lines.</p></figcaption></figure><p id="Par17">We selected observations of the entire Pearl River Estuary from 07 February 2015 to 02 February 2016 and used STIMP and the baseline methods, including data interpolating empirical orthogonal function (DINEOF) method, MaskedAE, and Lin-ITP, to reconstruct the Chl_a distribution to investigate why STIMP imputation of the Pearl River Estuary data outperformed the baseline methods. We examined the correlation between ground truth and imputed data of STIMP and DINEOF using rates of missing data of 10%, 30%, 50%, 70% and 90% (Fig. <a href="#Fig3" class="usa-link">3</a>b). We observed that the Pearson correlation coefficients (PCC) of the STIMP imputed data and ground truth data were greater than 0.90 even when the rate of missing data euqalled 90%. DINEOF was prone to fill in gaps with zero values when missing rate was high and could not perform singular value decomposition of the spatiotemporal distribution of Chl_a. When comparing STIMP results to MaskedAE and Lin-ITP results (Supplementary Fig. <a href="#MOESM1" class="usa-link">S3</a>a), we saw that MaskedAE PCC values were comparable to STIMP when rates of missing data were 10% and 50%. However, MaskedAE imputation severely degenerated when rates of missing data were high. In that case, STIMP PCC (correlated to ground truth data) improved by 6.65% over MaskedAE. In addition, the results illustrated that Lin-ITP introduced significant errors which hindered the analysis of the Pearl River Estuary data.</p>
<p id="Par18">Because STIMP’s imputation is based on spatiotemporal relationships, using case studies, we explored whether the imputed values from STIMP aligned with actual spatiotemporal relationships. STIMP effectively preserved the spatial relationships during the imputation compared to DINEOF on 07 February 05 May, and 10 October 2015 (Fig. <a href="#Fig3" class="usa-link">3</a>c). STIMP generated larger values close to the coastline, and STIMP generated similar values for most regions. STIMP effectively reconstructed the completed data even when the rate of missing data was high (see 07 February 2015). Moreover, STIMP effectively preserved temporal relationships during imputation. In Fig. <a href="#Fig3" class="usa-link">3</a>d, we show the imputation of five single positions from 07 February 2015 to 22 September 2022, where blue represents the observations and red represents the imputation. Compared to simple linear interpolation, STIMP contained more fluctuations, especially for long-term missing data. Overall, we saw that the STIMP results were significantly superior compared to the results from the baseline methods.</p></section><section id="Sec6"><h3 class="pmc_sec_title">STIMP offers spatiotemporal prediction</h3>
<p id="Par19">Predicting Chl_a is critical to diagnosing future sustainable marine environments and formulating effective mitigation schemes, particularly under a changing climate that will warm and stratify the vulnerable ocean. With the continuous and completed spatiotemporal Chl_a distribution imputed from partial datasets of observations, we found that STIMP accurately predicts Chl_a.</p>
<p id="Par20">STIMP has more advantages in long-term prediction. As shown in Fig. <a href="#Fig4" class="usa-link">4</a>a, STIMP gained more improvement for long-term prediction. For 1 year prediction, STIMP achieved 6.54–13.68% mean absolute error (MAE) reduction over baselines. For 2 years prediction, STIMP reduced 13.68–32.25% MAE. For 3 years prediction, STIMP achieved 13.77–32.01% MAE reduction. STIMP outperformed other prediction methods due to its paradigm of first imputing then predicting and three elaborately designed modules. Without imputation, our predictive model results still improved compared to PredRNN (Fig. <a href="#Fig4" class="usa-link">4</a>b), indicating that our designed TLT and HSGNN modules are more suitable for capturing the spatiotemporal relationships of Chl_a than the design of PredRNN. We examine the advantages of having these two modules when we describe our ablation study of STIMP later in supplementary. Moreover, imputation significantly improved how well STIMP predicted distributions (Fig. <a href="#Fig4" class="usa-link">4</a>b, STIMP w/o imputation versus STIMP). In locations with higher rates of missing data, STIMP results often improved more than PredRNN results (Fig. <a href="#Fig4" class="usa-link">4</a>c). Our analysis demonstrated that imputing before predicting contributed to STIMP effectively capturing the spatial distribution and the seasonal signal of Chl_a. The maxima of observed annual mean Chl_a are in the river, but large Chl_a concentrations are spread along the coast in the inner shelf and decrease with distance from the coast (Fig. <a href="#Fig4" class="usa-link">4</a>d). The time series of the domain-averaged Chl_a has a strong seasonal cycle where Chl_a concentrations in the Pearl River Estuary peak during summer when nutrient inputs from the Pearl River are large (Fig. <a href="#Fig4" class="usa-link">4</a>e).</p>
<figure class="fig xbox font-sm" id="Fig4"><h4 class="obj_head">Fig. 4. SIIMP enables large scale spatiotemporal prediction of chlorophyll-a (Chl_a) in the Pearl River Estuary.</h4>
<p class="img-box line-height-none margin-x-neg-2 tablet:margin-x-0 text-center"><a class="tileshop" target="_blank" href="https://www.ncbi.nlm.nih.gov/core/lw/2.0/html/tileshop_pmc/tileshop_pmc_inline.html?title=Click%20on%20image%20to%20zoom&amp;p=PMC3&amp;id=12358577_41467_2025_62901_Fig4_HTML.jpg"><img class="graphic zoom-in" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/2f2a/12358577/15b901238f12/41467_2025_62901_Fig4_HTML.jpg" loading="lazy" id="d33e914" height="537" width="677" alt="Fig. 4"></a></p>
<div class="p text-right font-secondary"><a href="figure/Fig4/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div>
<figcaption><p><strong>a</strong> The performance of STIMP and the baseline models in terms of mean absolute error (MAE) for 1-year, 2-year, and 3-year predictions. <strong>b</strong> MAE between the actual values and the predictions made by PredRNN, STIMP without imputation and STIMP. <strong>c</strong> The relationship between the improved performance due to imputation and the rates of missing data. <strong>d</strong> Time series of domain mean Chl_a from January 2017 to December 2022. <strong>e</strong> Horizontal distribution of observed and predicted temporally averaged Chl_a. <strong>f</strong> Predicted Chl_a at three locations. The first to third columns show the Chl_a predicted by CMOMS, PredRNN, and STIMP. The red scatter points represent the observations. The blue shading represents the confidence intervals of STIMP to quantify the prediction uncertainties. Source data are provided as a Source Data file. <strong>g</strong> Predicted Chl_a for the entire Pearl River Estuary. The first column shows the true observations. The second and third columns show the Chl_a predicted by STIMP and CMOMS.</p></figcaption></figure><p id="Par21">We conducted case studies at three specific locations in the Pearl River Estuary to further demonstrate the superiority of STIMP over other baseline methods: 1) 22°9’N, 113°49’E; 2) 20°41’N, 113°41’E; and 3) 21°16’N, 114°1’E. The three sites correspond to three marine regions delineated by isobaths at 30 m and 50 m below sea level (Fig. <a href="#Fig4" class="usa-link">4</a>f). Data are from 2 February 2016 to 2 February 2022. We compared STIMP to CMOMS<sup><a href="#CR15" class="usa-link" aria-describedby="CR15">15</a></sup>, which is a widely used numerical model for analysing ecosystem dynamics in the Pearl River Estuary. STIMP can not only provide accurate Chl_a prediction (blue lines in Fig. <a href="#Fig4" class="usa-link">4</a>i), but also provide confidence intervals, which is visualized as shaded regions around the predicted values, too quantify the prediction uncertainties. STIMP outperformed PredRNN by a large margin, with MAE improving by 30.28%, 22.09%, and 1.83%. CMOMS yielded large MAE because the model severely underestimated the Chl_a. STIMP improved the MAE by 53.78%, 74.63%, and 66.33% compared to CMOMS. In Fig. <a href="#Fig4" class="usa-link">4</a>g, we present the prediction results for the entire Pearl River Estuary for 2 February 2016, 16 July 2016, and 8 January 2017. We observed that STIMP predictions consistently agreed with the observations, providing larger predicted values near the coastline. CMOMS, on the other hand, severely underestimated the Chl_a in the region far from the coastline, especially in winter.</p></section><section id="Sec7"><h3 class="pmc_sec_title">Applying STIMP to the global ocean</h3>
<p id="Par22">We examined how effectively STIMP can be applied to global coastal oceans by examining how well the model predicted Chl_a for the northern Gulf of Mexico, Chesapeake Bay and the Yangtze River Estuary.</p>
<p id="Par23">The Gulf of Mexico, ranking as the ninth largest body of water globally<sup><a href="#CR49" class="usa-link" aria-describedby="CR49">49</a></sup>, is also among the most economically and ecologically productive water bodies in the world<sup><a href="#CR50" class="usa-link" aria-describedby="CR50">50</a></sup>. The average rate of missing data across all positions for the northern Gulf of Mexico was 18.19%. When imputing data, as shown in Fig. <a href="#Fig2" class="usa-link">2</a>a, STIMP performed well compared to other imputation methods, significantly reducing the error by 69.42–74.88% compared to DINEOF and by 8.92–43.04% compared to the second-best model in terms of MAE. The observations for the entire northern Gulf of Mexico were from 07 February 2015 to 02 February 2016. Our findings indicated that the correlation between the STIMP imputed Chl_a and the ground truth data was significantly higher than that of DINEOF imputed Chl_a and ground truth data with rates of missing data equal to 10%, 50%, and 90%, improving PCC by 6.77%, 24.58% and 226.74% Fig. <a href="#Fig5" class="usa-link">5</a>a). We also compared STIMP to MaskedAE and Lin-ITP methods (Supplementary Fig. <a href="#MOESM1" class="usa-link">3</a>b). STIMP improved PCC by 1.07–6.77% compared to MaskedAE, and STIMP improved PCC by 10.90% to 25.75% compared to linear interpolation (Lin_ITP). For prediction, we showed that STIMP’s effective data imputation accurately predicted large-scale spatiotemporal Chl_a. STIMP predictions improved, compared to PredRNN, for most areas of the northern Gulf of Mexico (Fig. <a href="#Fig5" class="usa-link">5</a>b). From the Chl_a distribution (Supplementary Fig. <a href="#MOESM1" class="usa-link">6</a>), we saw that locations close to the river mouth had the largest Chl_a, and the outer shelf had the smallest Chl_a. Hence, we examined results (Fig. <a href="#Fig5" class="usa-link">5</a>c) at two positions: 1) 29°29’N, 92°11’W and 28°54’N, 91°59’W, from February 2016 to 2 February 2022. Due to the lack of open-source numerical methods, we compared STIMP with XGBoost and PredRNN for these two positions. At the two positions, STIMP reduced MAE by 26.55% and 16.02% compared to XGBoost and reduced MAE by 6.75% and 10.84% compared to PredRNN. The satellite data from the northern Gulf of Mexico had considerable noise. Predictions generated by PredRNN tended to lose periodicity when confronted by the low signal-to-noise ratio data. In contrast, predictions produced by STIMP successfully captured six complete periods, which corresponded to a period of six years.</p>
<figure class="fig xbox font-sm" id="Fig5"><h4 class="obj_head">Fig. 5. STIMP can be applied to other coastal ocean areas.</h4>
<p class="img-box line-height-none margin-x-neg-2 tablet:margin-x-0 text-center"><a class="tileshop" target="_blank" href="https://www.ncbi.nlm.nih.gov/core/lw/2.0/html/tileshop_pmc/tileshop_pmc_inline.html?title=Click%20on%20image%20to%20zoom&amp;p=PMC3&amp;id=12358577_41467_2025_62901_Fig5_HTML.jpg"><img class="graphic zoom-in" src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/2f2a/12358577/e90bc342816e/41467_2025_62901_Fig5_HTML.jpg" loading="lazy" id="d33e1018" height="747" width="682" alt="Fig. 5"></a></p>
<div class="p text-right font-secondary"><a href="figure/Fig5/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div>
<figcaption><p>We applied STIMP to other three representive coastal ocean areas: Northern Gulf of Mexico (<strong>a</strong>–<strong>c</strong>), Chesapeake Bay (<strong>d</strong>–<strong>f</strong>) and Yangtze River Estuary (<strong>g</strong>–<strong>i</strong>). <strong>a</strong>, <strong>d</strong>, <strong>g</strong> Pearson correlation coefficient (PCC) between imputed data and ground truth data with the rates of missing data equal to 10%, 50%, and 90%. <strong>b</strong>, <strong>e</strong>, <strong>h</strong> MAE between the actual values and the predictions made by PredRNN (the first column) and STIMP (the second column). The third column indicates how much STIMP reduced the error compared to PredRNN. <strong>c</strong>, <strong>f</strong>, <strong>i</strong> XGBoost, PredRNN, and STIMP predicted Chl_a at two locations. The red scatter points represent the observations. Source data are provided as a Source Data file.</p></figcaption></figure><p id="Par24">Chesapeake Bay is one of the most productive estuaries in the United States. The average rate of missing data across all positions in Chesapeake Bay was 10.49%. For imputation, as shown in Fig. <a href="#Fig2" class="usa-link">2</a>a, STIMP performed exceptionally compared to the other imputation methods with regard to MAE. STIMP significantly reduced MAE by 62.08% to 75.63% compared to DINEOF and by 26.91% to 33.46% compared to the second-best model, except when the rate of missing data was 90%. We selected observations from the entire bay from 07 February 2015 to 02 February 2016 for this case study. STIMP demonstrated excellent imputation performance compared to DINEOF, improving PCC by 5.09%, 28.17% and 264.67% (Fig. <a href="#Fig5" class="usa-link">5</a>d), MaskedAE and Lin-ITP (Supplementary Fig. <a href="#MOESM1" class="usa-link">3</a>c). Moreover, STIMP improved its predictions compared to PredRNN for most of Chesapeake Bay (Fig. <a href="#Fig5" class="usa-link">5</a>e). The case studies at the two locations at 1) 29°29’N, 92°11’W and 2) 28°54’N, 91°59’W indicated that STIMP more accurately predicted Chl_a than the other two methods. STIMP reduced MAE by 72.10% and 10.39% compared to XGBoost and reduced MAE by 44.34% and 3.99% compared to PredRNN. Overall, STIMP improved MAE by 6.54% compared to PredRNN.</p>
<p id="Par25">The Yangtze River is the third longest river in the world. The river discharges into the adjacent Yangtze River Estuary near the megacities, Shanghai and Hangzhou. The average rate of missing data across all positions in the Yangtze River Estuary was 54.28%. For imputation, as shown in Fig. <a href="#Fig2" class="usa-link">2</a>a, STIMP performed exceptionally compared to the other imputation methods, reducing the MAE by 68.31% to 90.92% compared to DINEOF and by 15.62% to 42.67% compared to the second-best model. The observations for the entire Yangtze River Estuary were from 07 February 2015 to 02 February 2016. STIMP imputed the data well compared to DINEOF (Fig. <a href="#Fig5" class="usa-link">5</a>g), MaskedAE and Lin-ITP (Supplementary Fig. <a href="#MOESM1" class="usa-link">3</a>d). Moreover, STIMP improved predictions compared to PredRNN for most areas of the Yangtze River Estuary (Fig. <a href="#Fig5" class="usa-link">5</a>h), especially for the regions closest to the river mouth. As shown in Fig. <a href="#Fig4" class="usa-link">4</a>i, at 31°34’N, 122°31’E, STIMP reduced MAE by 45.02% and 9.95% compared to the two baseline methods. At 28°24’N, 123°21’E (outer shelf), STIMP’s error improvement was relatively smaller, but MAE still reduced by 14.45% and MAE reduced by 6.59% compared to the two baseline methods.</p>
<p id="Par26">To summarize, we demonstrated that STIMP can be successfully applied to the global coastal oceans. STIMP is a versatile and effective deep learning framework. STIMP not only reconstructs a complete Chl_a dataset by exploring the spatiotemporal relationships in the partial dataset of observations, STIMP also accurately predicts spatiotemporal distributions at large scales. STIMP even successfully captures periodic data when confronted with low signal-to-noise ratio data (for example, for the northern Gulf of Mexico and the Yangtze River Estuary).</p></section></section><section id="Sec8"><h2 class="pmc_sec_title">Discussion</h2>
<p id="Par27">In this paper, we presented STIMP, an effective and versatile deep learning framework for analysing Chl_a using satellite remote sensing measurements. Our results demonstrated that STIMP effectively addresses the challenges of satellite remote sensing of Chl_a when diagnosing and prognosing coastal ocean ecosystems by overcoming high rates of missing data, composing complex spatial heterogeneity, and determining diverse dynamic temporal patterns.</p>
<p id="Par28">Specifically, STIMP imputes historical partial observations before predicting the future of Chl_a for coastal oceans, formulated as <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq4"><math id="d33e1063"><mi>p</mi><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>∣</mo><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup></mrow><mo>)</mo></mrow><mo>=</mo><msub><mrow><mo>∫</mo></mrow><mrow><mi mathvariant="bold">X</mi></mrow></msub><msub><mrow><mi>p</mi></mrow><mrow><mi mathvariant="normal">Φ</mi></mrow></msub><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>∣</mo><mi mathvariant="bold">X</mi></mrow><mo>)</mo></mrow><msub><mrow><mi>p</mi></mrow><mrow><mi>θ</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="bold">X</mi><mo>∣</mo><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup></mrow><mo>)</mo></mrow><mi>d</mi><mi mathvariant="bold">X</mi></math></span>. Most AI methods, such as PredRNN, are designed to predict based on complete observational datasets. Directly applying these other AI methods to partial datasets results in substantial spatiotemporal relationships being disregarded. STIMP breaks down Chl_a prediction into two steps: 1) <em>p</em><sub><em>θ</em></sub>(<strong>X</strong>∣<strong>X</strong><sup><em>o</em><em>b</em></sup>) to reconstruct a complete spatiotemporal Chl_a distribution from partial observations; and 2) <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq5"><math id="d33e1156"><msub><mrow><mi>p</mi></mrow><mrow><mi mathvariant="normal">Φ</mi></mrow></msub><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>∣</mo><mi mathvariant="bold">X</mi></mrow><mo>)</mo></mrow></math></span> to accurately predict Chl_a based on a set of continuous and complete spatiotemporal relationships. STIMP addresses the difficulty of the task and enables us to evaluate the confidence intervals associated with our predictions. When we were designing the model, we leveraged a diffusion model<sup><a href="#CR51" class="usa-link" aria-describedby="CR51">51</a></sup> (an elegant and powerful generative AI method) for the spatiotemporal Chl_a imputation, i.e. <em>p</em><sub><em>θ</em></sub>(<strong>X</strong>∣<strong>X</strong><sup><em>o</em><em>b</em></sup>). Using the diffusion model offered distinct advantages for imputation compared to the traditional interpolating empirical orthogonal function (DINEOF)<sup><a href="#CR52" class="usa-link" aria-describedby="CR52">52</a></sup> in Geoscience and other AI-powered data imputation methods. We designed TLT and HSGNN to capture the diverse dynamic temporal patterns found in an entire time series and the spatial heterogeneity of the entire coastal ocean, respectively. STIMP demonstrated capability in large-scale spatiotemporal Chl_a imputation and prediction in four representative coastal oceans. The length of the time series does not affect the superiority of STIMP. Our results indicate that imputation significantly improved the prediction. In addition, STIMP was robust when presented with various rates of missing data, further showing that the model could be applied to global coastal oceans with different rates of missing data.</p>
<p id="Par29">Despite its advantages, STIMP does have limitations. The advantage of AI-based methods lies in predicting the seasonal and trend components of time series. Many methods<sup><a href="#CR43" class="usa-link" aria-describedby="CR43">43</a>,<a href="#CR53" class="usa-link" aria-describedby="CR53">53</a></sup> incorporate seasonal-trend decomposition within each neural block to enhance the predictability of time-series data<sup><a href="#CR54" class="usa-link" aria-describedby="CR54">54</a></sup>. Analogous to other AI-based time series methods, STIMP robustly capture the seasonal and trend signals of Chl_a but is incapable of effectively capturing anomaly peak signal. Through extensive analysis in the Pearl River Estuary, compared to weekly and monthly mean predictions, STIMP effectively captures fine-scale variability (Supplementary Figs. <a href="#MOESM1" class="usa-link">S13</a>–<a href="#MOESM1" class="usa-link">S15</a>). We also found that even though the numerical simulation method CMOMS<sup><a href="#CR15" class="usa-link" aria-describedby="CR15">15</a></sup> has a large prediction error, it performs better than AI-based data-driven methods in predicting extreme signals. Therefore, we believe that integrating numerical simulation methods with AI-based data-driven methods will be a challenging yet promising direction that we need to address in the future.</p>
<p id="Par30">Moreover, we focused on satellite remotely sensed data with a spatial resolution of 4 km and a temporal resolution of 8 days. In contrast to CMOMS, STIMP demonstrates low sensitivity to variations in spatial and temporal resolutions. Yet STIMP depends on observational data to capture Chl_a’s spatiotemporal patterns. When applied to MODIS's daily Chl_a data with  &gt; 90% missing rates, we might need to incorporate additional prior information to address the issue.</p>
<p id="Par31">In conclusion, based on available satellite observations, STIMP significantly advances large-scale spatiotemporal analysis, diagnostics, and prediction of coastal marine ecosystem health. We expect that STIMP can be broadly applied to future ocean AI-measurement-modelling studies to enhance management and mitigation of worsening coastal ocean ecosystem conditions.</p></section><section id="Sec9"><h2 class="pmc_sec_title">Methods</h2>
<p id="Par32">Rapidly developing satellite remote sensing observations offer opportunities to develop data-driven large-scale spatiotemporal Chl_a prediction method. However, three major challenges must first be solved. First, temporal variations induced by complex physical and biogeochemical stressors are difficult to capture. Second, spatial heterogeneity and relationships are difficult to represent. Third, the high rates of missing satellite observations compromise the completeness of spatiotemporal variations of Chl_a, rendering these observations inadequate to use for accurate prediction.</p>
<p id="Par33">STIMP is an AI-powered unified framework composed of two steps: 1) spatiotemporal satellite Chl_a data imputation <em>p</em><sub><em>θ</em></sub> and 2) Chl_a prediction <em>p</em><sub>Φ</sub>. By doing so, STIMP effectively reconstructs the complete spatiotemporal variations of Chl_a, <strong>X</strong>, from partial observations, <strong>X</strong><sup><em>o</em><em>b</em></sup>, subsequently providing accurate large-scale spatiotemporal predictions of Chl_a <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq6"><math id="d33e1264"><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover></math></span> across coastal oceans, such that:</p>
<table class="disp-formula p" id="Equ3"><tr>
<td class="formula"><math id="d33e1279" display="block"><mi>p</mi><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>∣</mo><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup></mrow><mo>)</mo></mrow><mo>=</mo><msub><mrow><mo>∫</mo></mrow><mrow><mi mathvariant="bold">X</mi></mrow></msub><msub><mrow><mi>p</mi></mrow><mrow><mi mathvariant="normal">Φ</mi></mrow></msub><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>∣</mo><mi mathvariant="bold">X</mi></mrow><mo>)</mo></mrow><msub><mrow><mi>p</mi></mrow><mrow><mi>θ</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="bold">X</mi><mo>∣</mo><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup></mrow><mo>)</mo></mrow><mi>d</mi><mi mathvariant="bold">X</mi><mo>,</mo></math></td>
<td class="label">3</td>
</tr></table>
<p>where <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq7"><math id="d33e1355"><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>T</mi><mo>×</mo><mi>N</mi></mrow></msup></math></span>, <em>N</em> denotes the number of positions and <em>T</em> denotes the length of time series; <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq8"><math id="d33e1385"><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><msup><mrow><mi>T</mi></mrow><mrow><mo>′</mo></mrow></msup><mo>×</mo><mi>N</mi></mrow></msup></math></span>, <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq9"><math id="d33e1413"><msup><mrow><mi>T</mi></mrow><mrow><mo>′</mo></mrow></msup></math></span> denotes the predicted length.</p>
<p id="Par34">We approximate Equation (<a href="#Equ3" class="usa-link">3</a>) by sampling a finite number of samples and using a summation form, which is formulated as:</p>
<table class="disp-formula p" id="Equ4"><tr>
<td class="formula"><math id="d33e1432" display="block"><mi>p</mi><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>∣</mo><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup></mrow><mo>)</mo></mrow><mo>=</mo><msub><mrow><mo mathsize="big">∑</mo></mrow><mrow><mi mathvariant="bold">X</mi></mrow></msub><msub><mrow><mi>p</mi></mrow><mrow><mi mathvariant="normal">Φ</mi></mrow></msub><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>∣</mo><mi mathvariant="bold">X</mi></mrow><mo>)</mo></mrow><msub><mrow><mi>p</mi></mrow><mrow><mi>θ</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="bold">X</mi><mo>∣</mo><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup></mrow><mo>)</mo></mrow><mo>.</mo></math></td>
<td class="label">4</td>
</tr></table>
<p>Here, several datasets <strong>X</strong> are generated by well-trained <em>p</em><sub><em>θ</em></sub>(<strong>X</strong>∣<strong>X</strong><sup><em>o</em><em>b</em></sup>). Based on each dataset, we trained specific <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq10"><math id="d33e1527"><msub><mrow><mi>p</mi></mrow><mrow><mi mathvariant="normal">Φ</mi></mrow></msub><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>∣</mo><mi mathvariant="bold">X</mi></mrow><mo>)</mo></mrow></math></span>. Using Rubin’s rules<sup><a href="#CR32" class="usa-link" aria-describedby="CR32">32</a></sup>, the final Chl_a prediction is obtained by averaging the prediction of specific <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq11"><math id="d33e1558"><msub><mrow><mi>p</mi></mrow><mrow><mi mathvariant="normal">Φ</mi></mrow></msub><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>∣</mo><mi mathvariant="bold">X</mi></mrow><mo>)</mo></mrow></math></span> based on different <strong>X</strong>. In this way, our STIMP method not only improves the overall predictive performance through accurate imputation of missing data but also provides confidence intervals to quantify the prediction uncertainties. More details of training <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq12"><math id="d33e1589"><msub><mrow><mi>p</mi></mrow><mrow><mi mathvariant="normal">Φ</mi></mrow></msub><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>∣</mo><mi mathvariant="bold">X</mi></mrow><mo>)</mo></mrow></math></span> and <em>p</em><sub><em>θ</em></sub>(<strong>X</strong>∣<strong>X</strong><sup><em>o</em><em>b</em></sup>) can be found in the following two subsections.</p>
<section id="Sec10"><h3 class="pmc_sec_title">Spatiotemporal satellite Chl_a data imputation</h3>
<p id="Par35">We contrived a spatiotemporal denoising diffusion model (STDDM) that we applied to the imputation function, <em>p</em><sub><em>θ</em></sub>(<strong>X</strong>∣<strong>X</strong><sup><em>o</em><em>b</em></sup>). STDDM is fundamentally a Denoising Diffusion Probabilistic Model (DDPM) specifically designed to approximate the spatiotemporal distribution of Chl_a conditioned on partial observations.</p>
<p id="Par36">The imputation function conditioned on partial observation. Imputation function intends to leverage deep generative learning to approximate spatiotemporal distribution of Chl_a. The primary challenge in learning the imputation function lies in the complex spatiotemporal distribution of Chl_a, which is challenging to transform from easy-to-sample distribution using neural networks. Inspired by DDPM, we decompose the complex task into <em>L</em> simple tasks. We can manually set a sequence of data distributions perturbed by <em>L</em> levels of signal-to-noise ratio. The objective of each task is to improve the signal-to-noise ratio of the perturbed data distribution from <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq13"><math id="d33e1662"><msubsup><mrow><mi>σ</mi></mrow><mrow><mi>l</mi></mrow><mrow><mn>2</mn></mrow></msubsup></math></span> to <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq14"><math id="d33e1677"><msubsup><mrow><mi>σ</mi></mrow><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow><mrow><mn>2</mn></mrow></msubsup></math></span>, where 0 ≈ <em>σ</em><sub><em>L</em></sub> &lt; <em>σ</em><sub><em>L</em>−1</sub> &lt; <em>σ</em><sub>0</sub>. The final complex spatiotemporal distribution of Chl_a is obtained by the joint distribution <em>p</em>(<strong>X</strong>, <strong>X</strong><sub>1:<em>L</em></sub>∣<strong>X</strong><sup><em>o</em><em>b</em></sup>) defined as a Markov chain with learned Gaussian transitions starting at an easy-to-sample distribution <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq15"><math id="d33e1734"><mi>p</mi><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow><mo>)</mo></mrow><mo>=</mo><mi class="MJX-tex-caligraphic" mathvariant="script">N</mi><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>L</mi></mrow></msub><mo>;</mo><mi mathvariant="bold">0</mi><mo>,</mo><mi mathvariant="bold">I</mi></mrow><mo>)</mo></mrow></math></span>:</p>
<table class="disp-formula p" id="Equ5"><tr>
<td class="formula"><math id="d33e1773" display="block"><msub><mrow><mi>p</mi></mrow><mrow><mi>θ</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="bold">X</mi><mo>∣</mo><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup></mrow><mo>)</mo></mrow><mo>=</mo><mo>∫</mo><mspace width="0.25em"></mspace><mi>p</mi><mrow><mo>(</mo><mrow><mi mathvariant="bold">X</mi><mo>,</mo><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mn>1</mn><mo>:</mo><mi>L</mi></mrow></msub><mo>∣</mo><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup></mrow><mo>)</mo></mrow><mi>d</mi><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mn>1</mn><mo>:</mo><mi>L</mi></mrow></msub><mo>=</mo><mo>∫</mo><mspace width="0.25em"></mspace><msub><mrow><mi>p</mi></mrow><mrow><mi>θ</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="bold">X</mi><mo>∣</mo><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mn>1</mn><mo>:</mo><mi>L</mi></mrow></msub><mo>,</mo><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup></mrow><mo>)</mo></mrow><msub><mrow><mi>p</mi></mrow><mrow><mi>θ</mi></mrow></msub><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mn>1</mn><mo>:</mo><mi>L</mi></mrow></msub><mo>∣</mo><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup></mrow><mo>)</mo></mrow><mi>d</mi><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mn>1</mn><mo>:</mo><mi>L</mi></mrow></msub><mo>=</mo><mo>∫</mo><mspace width="0.25em"></mspace><mi>p</mi><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow><mo>)</mo></mrow><msub><mrow><mi>p</mi></mrow><mrow><mi>θ</mi></mrow></msub><mrow><mo>(</mo><mrow><mi mathvariant="bold">X</mi><mo>∣</mo><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>,</mo><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup></mrow><mo>)</mo></mrow><msubsup><mrow><mo mathsize="big">∏</mo></mrow><mrow><mi>l</mi><mo>=</mo><mi>L</mi></mrow><mrow><mn>2</mn></mrow></msubsup><msub><mrow><mi>p</mi></mrow><mrow><mi>θ</mi></mrow></msub><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>∣</mo><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi></mrow></msub><mo>,</mo><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup></mrow><mo>)</mo></mrow><mi>d</mi><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mn>1</mn><mo>:</mo><mi>L</mi></mrow></msub><mo>.</mo></math></td>
<td class="label">5</td>
</tr></table>
<p id="Par37">In contrast to the noise predictor in DDPM, STDDM is an original data predictor which is utilized in the learned Gaussian transitions <em>p</em><sub><em>θ</em></sub>(<strong>X</strong><sub><em>l</em>−1</sub>∣<strong>X</strong><sub><em>l</em></sub>, <strong>X</strong><sup><em>o</em><em>b</em></sup>). Because a time series of Chl_a data usually contain irregular noisy components, estimating the noise is challenging. Note that we can incorporate <em>p</em><sub><em>θ</em></sub>(<strong>X</strong>∣<strong>X</strong><sub>1</sub>, <strong>X</strong><sup><em>o</em><em>b</em></sup>) into <em>p</em><sub><em>θ</em></sub>(<strong>X</strong><sub><em>l</em>−1</sub>∣<strong>X</strong><sub><em>l</em></sub>, <strong>X</strong><sup><em>o</em><em>b</em></sup>) and <strong>X</strong> can be regarded as clean samples with a signal-to-noise ratio <em>σ</em><sub>0</sub>. Specifically, we define the signal-to-noise ratio <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq16"><math id="d33e2081"><msubsup><mrow><mi>σ</mi></mrow><mrow><mi>l</mi></mrow><mrow><mn>2</mn></mrow></msubsup><mo>=</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi></mrow></msub><mo>/</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi></mrow></msub></mrow><mo>)</mo></mrow></math></span>, where <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq17"><math id="d33e2120"><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi></mrow></msub><mo>=</mo><msubsup><mrow><mo>∏</mo></mrow><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>l</mi></mrow></msubsup><msub><mrow><mi>α</mi></mrow><mrow><mi>i</mi></mrow></msub></math></span> and [<em>α</em><sub>0</sub>, ⋯  , <em>α</em><sub><em>L</em></sub>] is a manually defined noise schedule in which each element regulates the levels of added Gaussian noise to <strong>X</strong><sub><em>l</em>−1</sub>. Then, the objective of the learned Gaussian transition in the <em>l</em>-th task is formulated as:</p>
<table class="disp-formula p" id="Equ6"><tr>
<td class="formula"><math id="d33e2174" display="block"><msub><mrow><mi>p</mi></mrow><mrow><mi>θ</mi></mrow></msub><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>∣</mo><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi></mrow></msub><mo>,</mo><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup></mrow><mo>)</mo></mrow><mo>=</mo><mi class="MJX-tex-caligraphic" mathvariant="script">N</mi><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>;</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo>)</mo></mrow><msqrt><mrow><msub><mrow><mi>α</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></msqrt></mrow><mrow><mn>1</mn><mo>−</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi></mrow></msub></mrow></mfrac><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi></mrow></msub><mo>+</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mrow><mi>α</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow><mo>)</mo></mrow><msqrt><mrow><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msqrt></mrow><mrow><mn>1</mn><mo>−</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi></mrow></msub></mrow></mfrac><mi mathvariant="bold">X</mi><mo>,</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mrow><mi>α</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow><mo>)</mo></mrow><msqrt><mrow><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msqrt></mrow><mrow><mn>1</mn><mo>−</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi></mrow></msub></mrow></mfrac><mi mathvariant="bold">I</mi></mrow><mo>)</mo></mrow><mo>.</mo></math></td>
<td class="label">6</td>
</tr></table>
<p>Unfortunately, the original spatiotemporal distribution of Chl_a, <strong>X</strong>, is unknown for <em>p</em><sub><em>θ</em></sub>(<strong>X</strong><sub><em>l</em>−1</sub>∣<strong>X</strong><sub><em>l</em></sub>, <strong>X</strong><sup><em>o</em><em>b</em></sup>). Hence, we contrive STDDM, an original data predictor, to approximate <strong>X</strong> with partial observation <strong>X</strong><sup><em>o</em><em>b</em></sup> and a perturbed Chl_a distribution, <strong>X</strong><sub><em>l</em></sub>, that is, <em>p</em>(<strong>X</strong>∣<strong>X</strong><sub><em>l</em></sub>, <strong>X</strong><sup><em>o</em><em>b</em></sup>). STDMM is learned by the following objective function:</p>
<table class="disp-formula p" id="Equ7"><tr>
<td class="formula"><math id="d33e2422" display="block"><msub><mrow><mi>min</mi></mrow><mrow><mi>θ</mi></mrow></msub><msub><mrow><mi mathvariant="double-struck">E</mi></mrow><mrow><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msub><msub><mrow><mi mathvariant="double-struck">E</mi></mrow><mrow><mi class="MJX-tex-caligraphic" mathvariant="script">N</mi><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi></mrow></msub><mo>;</mo><msqrt><mrow><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi></mrow></msub></mrow></msqrt><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mn>0</mn></mrow></msub><mo>,</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi></mrow></msub></mrow><mo>)</mo></mrow><mi mathvariant="bold">I</mi></mrow><mo>)</mo></mrow></mrow></msub><mrow><mo>(</mo><mrow><mo>∣</mo><mo>∣</mo><mi>S</mi><mi>T</mi><mi>D</mi><mi>D</mi><msub><mrow><mi>M</mi></mrow><mrow><mi>θ</mi></mrow></msub><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup><mo>,</mo><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow><mo>)</mo></mrow><mo>−</mo><mi mathvariant="bold">X</mi><mo>∣</mo><msup><mrow><mo>∣</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow><mo>)</mo></mrow><mo>,</mo></math></td>
<td class="label">7</td>
</tr></table>
<p id="Par38">In practice, however, three challenges remain in learning the STDMM. First, STDMM cannot differentiate between different subtasks using only <strong>X</strong><sup><em>o</em><em>b</em></sup> and <strong>X</strong><sub><em>l</em></sub> as input, leading to difficulties in optimization. To address this issue, we incorporate the task number <em>l</em> as the input to the STDMM. Second, due to we select <em>N</em> locations belong to the ocean as the <strong>X</strong><sup><em>o</em><em>b</em></sup>, STDMM cannot obtain location information, resulting in an inability to obtain spatial heterogeneity and relationships. We construct the spatial graph <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq18"><math id="d33e2571"><mi mathvariant="bold">G</mi><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>N</mi><mo>×</mo><mi>N</mi></mrow></msup></math></span> to maintain spatial relationships of these locations. By default, if latitude and longitude difference between location <em>i</em> and <em>j</em> are both less than 0.05°, we set <em>G</em><sub><em>i</em><em>j</em></sub> = 1. By doing so, STIMP can extract information from adjacent locations during the information aggregation of Heterogeneous Spatial Graph Neural Network (HSGNN). Third, we cannot obtain the true values for unobserved Chl_a as a supervised learning signal. As a compromise, we treat the observed data as <strong>X</strong>, and further mask part of <strong>X</strong> with <strong>M</strong> to obtain partial observations <strong>X</strong><sup><em>o</em><em>b</em></sup> ← (1 − <strong>M</strong>) ⊙ <strong>X</strong>, where  ⊙ denotes the element-wise product. Because we focus on the performance of reconstructing the unobserved value, the corresponding objective function is given by:</p>
<table class="disp-formula p" id="Equ8"><tr>
<td class="formula"><math id="d33e2630" display="block"><msub><mrow><mi>min</mi></mrow><mrow><mi>θ</mi></mrow></msub><msub><mrow><mi mathvariant="double-struck">E</mi></mrow><mrow><mi mathvariant="bold">X</mi></mrow></msub><msub><mrow><mi mathvariant="double-struck">E</mi></mrow><mrow><mi class="MJX-tex-caligraphic" mathvariant="script">N</mi><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi></mrow></msub><mo>;</mo><msqrt><mrow><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi></mrow></msub></mrow></msqrt><mi mathvariant="bold">X</mi><mo>,</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi></mrow></msub></mrow><mo>)</mo></mrow><mi mathvariant="bold">I</mi></mrow><mo>)</mo></mrow></mrow></msub><mrow><mo>(</mo><mrow><mo>∣</mo><mo>∣</mo><mi mathvariant="bold">M</mi><mo>⊙</mo><mrow><mo>(</mo><mrow><mi>S</mi><mi>T</mi><mi>D</mi><mi>D</mi><msub><mrow><mi>M</mi></mrow><mrow><mi>θ</mi></mrow></msub><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup><mo>,</mo><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi></mrow></msub><mo>,</mo><mi>l</mi><mo>,</mo><mi mathvariant="bold">G</mi></mrow><mo>)</mo></mrow><mo>−</mo><mi mathvariant="bold">X</mi></mrow><mo>)</mo></mrow><mo>∣</mo><msup><mrow><mo>∣</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow><mo>)</mo></mrow><mo>,</mo></math></td>
<td class="label">8</td>
</tr></table>
<p>The training process of STDDM is summarized in Algorithm 1.</p>
<section id="FPar1"><h4 class="pmc_sec_title">Algorithm 1</h4>
<p id="Par39">Training Process of STIMP for imputation.</p>
<p id="Par40"><strong>Input</strong> : A sample of training data, <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq19"><math id="d33e2760"><mi mathvariant="bold">X</mi><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>T</mi><mo>×</mo><mi>N</mi></mrow></msup></math></span>; Spatial Graph, <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq20"><math id="d33e2779"><mi mathvariant="bold">G</mi><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>N</mi><mo>×</mo><mi>N</mi></mrow></msup></math></span>; the number of denoising steps, <em>L</em>; the number of training iteration, <em>M</em>.</p>
<p id="Par41"><strong>Output</strong> : Optimized STDDM</p>
<p id="Par42">1. <strong>for</strong>
<em>s</em> = 1 <em>t</em><em>o</em>
<em>M</em>
<strong>do</strong></p>
<p id="Par43">2.  Get random mask <strong>M</strong></p>
<p id="Par44">3.  <strong>X</strong><sup><em>o</em><em>b</em></sup> ← (1 − <strong>M</strong>) ⊙ <strong>X</strong></p>
<p id="Par45">4.  Sample <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq21"><math id="d33e2847"><mi>l</mi><mo>~</mo><mi>U</mi><mi>n</mi><mi>i</mi><mi>f</mi><mi>o</mi><mi>r</mi><mi>m</mi><mrow><mo>(</mo><mrow><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>⋯</mo><mspace width="0.25em"></mspace><mo>,</mo><mi>L</mi></mrow><mo>)</mo></mrow><mo>,</mo><mi>ϵ</mi><mo>~</mo><mi class="MJX-tex-caligraphic" mathvariant="script">N</mi><mrow><mo>(</mo><mrow><mi mathvariant="bold">0</mi><mo>,</mo><mi mathvariant="bold">I</mi></mrow><mo>)</mo></mrow></math></span></p>
<p id="Par46">5.  Get perturbed value <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq22"><math id="d33e2892"><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi></mrow></msub><mo>←</mo><msqrt><mrow><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi></mrow></msub></mrow></msqrt><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup><mo>+</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi></mrow></msub></mrow></msqrt><mi>ϵ</mi><mo>.</mo></math></span></p>
<p id="Par47">6.  Estimate missing value with <em>S</em><em>T</em><em>D</em><em>D</em><em>M</em><sub><em>θ</em></sub>(<strong>X</strong><sup><em>o</em><em>b</em></sup>, <strong>X</strong><sub><em>l</em></sub>, <em>l</em>, <strong>G</strong>)</p>
<p id="Par48">7.  Update the gradient by  ∇ ∣∣<strong>M</strong> ⊙ (<em>S</em><em>T</em><em>D</em><em>D</em><em>M</em><sub><em>θ</em></sub>(<strong>X</strong><sup><em>o</em><em>b</em></sup>, <strong>X</strong><sub><em>l</em></sub>, <em>l</em>, <strong>G</strong>) − <strong>X</strong><sub>0</sub>)∣∣<sup>2</sup></p>
<p id="Par49">8. <strong>end</strong></p></section></section><section id="Sec11"><h3 class="pmc_sec_title">Reconstructing the missing values with the imputation function</h3>
<p id="Par50">Now we show how we generate missing Chl_a by leveraging the learned imputation function. During imputation, we reconstruct the missing values of satellite Chl_a data using the partial observation. Assuming that the STDDM training was good enough to accurately simulate <em>p</em>(<strong>X</strong>∣<strong>X</strong><sub><em>l</em></sub>, <strong>X</strong><sup><em>o</em><em>b</em></sup>), the final complex spatiotemporal distribution of Chl_a is obtained by progressively reducing the signal-to-noise ratio. Starting at samples <strong>X</strong><sub><em>L</em></sub> from the Gaussian distribution, the signal-to-noise ratio can be reduced by getting samples from the following learned Gaussian transition, replacing <strong>X</strong> with <em>S</em><em>T</em><em>D</em><em>D</em><em>M</em>(<strong>X</strong><sup><em>o</em><em>b</em></sup>, <strong>X</strong><sub><em>l</em></sub>, <em>l</em>, <strong>G</strong>) in Eq. (<a href="#Equ6" class="usa-link">6</a>):</p>
<table class="disp-formula p" id="Equ9"><tr>
<td class="formula"><math id="d33e3097" display="block"><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>←</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo>)</mo></mrow><msqrt><mrow><msub><mrow><mi>α</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></msqrt></mrow><mrow><mn>1</mn><mo>−</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi></mrow></msub></mrow></mfrac><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi></mrow></msub><mo>+</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mrow><mi>α</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow><mo>)</mo></mrow><msqrt><mrow><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msqrt></mrow><mrow><mn>1</mn><mo>−</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi></mrow></msub></mrow></mfrac><mi>S</mi><mi>T</mi><mi>D</mi><mi>D</mi><mi>M</mi><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup><mo>,</mo><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi></mrow></msub><mo>,</mo><mi>l</mi><mo>,</mo><mi mathvariant="bold">G</mi></mrow><mo>)</mo></mrow><mo>+</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mrow><mi>α</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow><mo>)</mo></mrow><msqrt><mrow><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msqrt></mrow><mrow><mn>1</mn><mo>−</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi></mrow></msub></mrow></mfrac><mi>ϵ</mi></math></td>
<td class="label">9</td>
</tr></table>
<p>where <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq23"><math id="d33e3260"><mi>ϵ</mi><mo>~</mo><mi class="MJX-tex-caligraphic" mathvariant="script">N</mi><mrow><mo>(</mo><mrow><mi mathvariant="bold">0</mi><mo>,</mo><mi mathvariant="bold">I</mi></mrow><mo>)</mo></mrow></math></span>. We summarized the imputation in Algorithm 2.</p></section><section id="Sec12"><h3 class="pmc_sec_title">Spatiotemporal Chl_a prediction</h3>
<p id="Par51">We predict the most probable length-<span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq24"><math id="d33e3285"><msup><mrow><mi>T</mi></mrow><mrow><mo>′</mo></mrow></msup></math></span> sequence of Chl_a <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq25"><math id="d33e3298"><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover></math></span> with <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq26"><math id="d33e3312"><msub><mrow><mi>p</mi></mrow><mrow><mi mathvariant="normal">Φ</mi></mrow></msub><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>∣</mo><mi mathvariant="bold">X</mi></mrow><mo>)</mo></mrow></math></span>. To achieve this goal, the data distributions in space and time are important and warrant careful consideration. Fortunately, we must obtain a complete spatiotemporal distribution of Chl_a <strong>X</strong> is obtained by imputing the Chl_a spatiotemporal satellite data, denoted by <em>p</em><sub><em>θ</em></sub>(<strong>X</strong>∣<strong>X</strong><sup><em>o</em><em>b</em></sup>) in Eq. (<a href="#Equ3" class="usa-link">3</a>). We meticulously designed the network architecture to effectively capture spatial correlations and temporal dynamics.</p>
<p id="Par52">First, we leverage a value embedding network with a 1 × 1 kernal convolutional layer to encode the information of historical observation of Chl_a, <strong>X</strong>:</p>
<table class="disp-formula p" id="Equ10"><tr>
<td class="formula"><math id="d33e3369" display="block"><mi mathvariant="bold">H</mi><mo>=</mo><mi>C</mi><mi>o</mi><mi>n</mi><mi>v</mi><mrow><mo>(</mo><mrow><mi mathvariant="bold">X</mi></mrow><mo>)</mo></mrow><mo>.</mo></math></td>
<td class="label">10</td>
</tr></table>
<p id="Par53">Then, STIMP separately captures the spatial and temporal relationship of the input <strong>H</strong> separately. First, the temporal features <strong>H</strong><sup><em>t</em><em>e</em><em>m</em><em>p</em></sup> are learned by a temporal dependency learning module TLT:</p>
<table class="disp-formula p" id="Equ11"><tr>
<td class="formula"><math id="d33e3408" display="block"><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>t</mi><mi>e</mi><mi>m</mi><mi>p</mi></mrow></msup><mo>=</mo><mi>T</mi><mi>L</mi><mi>T</mi><mrow><mo>(</mo><mrow><mi mathvariant="bold">H</mi></mrow><mo>)</mo></mrow><mo>,</mo></math></td>
<td class="label">11</td>
</tr></table>
<p>Then, the spatial relationships and heterogeneity from the spatial graph, <strong>G</strong>, are further mined by HSGNN:</p>
<table class="disp-formula p" id="Equ12"><tr>
<td class="formula"><math id="d33e3440" display="block"><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>s</mi><mi>p</mi><mi>a</mi></mrow></msup><mo>=</mo><mi>H</mi><mi>S</mi><mi>G</mi><mi>N</mi><mi>N</mi><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>t</mi><mi>e</mi><mi>m</mi><mi>p</mi></mrow></msup><mo>,</mo><mi mathvariant="bold">G</mi></mrow><mo>)</mo></mrow><mo>.</mo></math></td>
<td class="label">12</td>
</tr></table>
<p>Eventually, the predicted Chl_a is obtained using a two-layer fully connected neural network:</p>
<table class="disp-formula p" id="Equ13"><tr>
<td class="formula"><math id="d33e3481" display="block"><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>=</mo><msubsup><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>p</mi><mi>r</mi><mi>e</mi></mrow></msubsup><mrow><mo>(</mo><mrow><mi>S</mi><mi>i</mi><mi>L</mi><mi>U</mi><mrow><mo>(</mo><mrow><msubsup><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>p</mi><mi>r</mi><mi>e</mi></mrow></msubsup><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>s</mi><mi>p</mi><mi>a</mi></mrow></msup></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>,</mo></math></td>
<td class="label">13</td>
</tr></table>
<p>where <em>S</em><em>i</em><em>L</em><em>U</em> is activation function.</p>
<p id="Par54">The objective function of training <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq27"><math id="d33e3550"><msub><mrow><mi>p</mi></mrow><mrow><mi mathvariant="normal">Φ</mi></mrow></msub><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>∣</mo><mi mathvariant="bold">X</mi></mrow><mo>)</mo></mrow></math></span> is given by:</p>
<table class="disp-formula p" id="Equ14"><tr>
<td class="formula"><math id="d33e3578" display="block"><msub><mrow><mi>min</mi></mrow><mrow><mi mathvariant="normal">Φ</mi></mrow></msub><msub><mrow><mi mathvariant="double-struck">E</mi></mrow><mrow><mi mathvariant="bold">X</mi><mo>,</mo><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>~</mo><msub><mrow><mi>p</mi></mrow><mrow><mi mathvariant="normal">Φ</mi></mrow></msub><mrow><mo>(</mo><mrow><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>∣</mo><mi mathvariant="bold">X</mi></mrow><mo>)</mo></mrow></mrow></msub><mrow><mo>(</mo><mrow><mo>∣</mo><mo>∣</mo><mi mathvariant="bold">Y</mi><mo>−</mo><mover accent="true"><mrow><mi mathvariant="bold">Y</mi></mrow><mrow><mo>~</mo></mrow></mover><mo>∣</mo><msup><mrow><mo>∣</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow><mo>)</mo></mrow><mo>.</mo></math></td>
<td class="label">14</td>
</tr></table>
<section id="FPar2"><h4 class="pmc_sec_title">Algorithm 2</h4>
<p id="Par55">STIMP Imputation</p>
<p id="Par56"><strong>Input</strong> : A sample of incomplete observed data, <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq28"><math id="d33e3655"><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>T</mi><mo>×</mo><mi>N</mi></mrow></msup></math></span>, with observation indicator, <strong>M</strong>; Spatial Graph, <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq29"><math id="d33e3682"><mi mathvariant="bold">G</mi><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>N</mi><mo>×</mo><mi>N</mi></mrow></msup></math></span>; the number of diffusion steps, <em>L</em>; and the optimized STDDM.</p>
<p id="Par57"><strong>Output</strong> : Imputed data <strong>X</strong></p>
<p id="Par58">1. Set <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq30"><math id="d33e3712"><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>L</mi></mrow></msub><mo>~</mo><mi class="MJX-tex-caligraphic" mathvariant="script">N</mi><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mi>I</mi></mrow><mo>)</mo></mrow></math></span></p>
<p id="Par59">2. <strong>For</strong>
<em>l</em> = <em>L</em>
<em>t</em><em>o</em> 1 <strong>do</strong></p>
<p id="Par60">3.  <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq31"><math id="d33e3755"><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>←</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo>)</mo></mrow><msqrt><mrow><msub><mrow><mi>α</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></msqrt></mrow><mrow><mn>1</mn><mo>−</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi></mrow></msub></mrow></mfrac><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi></mrow></msub><mo>+</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mrow><mi>α</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow><mo>)</mo></mrow><msqrt><mrow><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msqrt></mrow><mrow><mn>1</mn><mo>−</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi></mrow></msub></mrow></mfrac><mi>S</mi><mi>T</mi><mi>D</mi><mi>D</mi><mi>M</mi><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup><mo>,</mo><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi></mrow></msub><mo>,</mo><mi>l</mi><mo>,</mo><mi mathvariant="bold">G</mi></mrow><mo>)</mo></mrow></math></span></p>
<p id="Par61">4.  <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq32"><math id="d33e3881"><mi>ϵ</mi><mo>~</mo><mi class="MJX-tex-caligraphic" mathvariant="script">N</mi><mrow><mo>(</mo><mrow><mn>0</mn><mo>,</mo><mi>I</mi></mrow><mo>)</mo></mrow></math></span></p>
<p id="Par62">5.  <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq33"><math id="d33e3901"><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>←</mo><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mrow><mi>α</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow><mo>)</mo></mrow><msqrt><mrow><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msqrt></mrow><mrow><mn>1</mn><mo>−</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mi>l</mi></mrow></msub></mrow></mfrac><mi>ϵ</mi></math></span></p>
<p id="Par63">6. <strong>end</strong></p>
<p id="Par64">7. <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq34"><math id="d33e3969"><mi mathvariant="bold">X</mi><mo>←</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo>)</mo></mrow><msqrt><mrow><msub><mrow><mi>α</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msqrt></mrow><mrow><mn>1</mn><mo>−</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mn>1</mn></mrow></msub></mrow></mfrac><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>+</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><msub><mrow><mi>α</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo>)</mo></mrow><msqrt><mrow><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow></msqrt></mrow><mrow><mn>1</mn><mo>−</mo><msub><mrow><mover accent="true"><mrow><mi>α</mi></mrow><mo>¯</mo></mover></mrow><mrow><mn>1</mn></mrow></msub></mrow></mfrac><mi>S</mi><mi>T</mi><mi>D</mi><mi>D</mi><mi>M</mi><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup><mo>,</mo><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mn>1</mn></mrow></msub><mo>,</mo><mn>1</mn><mo>,</mo><mi mathvariant="bold">G</mi></mrow><mo>)</mo></mrow></math></span></p>
<p id="Par65">8.<strong>X</strong> ← <strong>M</strong> ⊙ <strong>X</strong><sup><em>o</em><em>b</em></sup> + (1 − <strong>M</strong>) ⊙ <strong>X</strong></p></section></section><section id="Sec13"><h3 class="pmc_sec_title">Network structures of STDDM</h3>
<p id="Par66">STDDM does not limit the network architecture. To make the model for suitable for spatiotemporal imputation, as shown in Supplementary Fig. <a href="#MOESM1" class="usa-link">S16</a>c, we leveraged TLT and HSGNN to handle temporal and spatial relationships, respectively. Specifically, STDDM concatenates the time series of partial observation, <strong>X</strong><sup><em>o</em><em>b</em></sup>; perturbed values, <strong>X</strong><sub><em>l</em></sub>; diffusion step, <em>l</em>; and spatial graph, <strong>G</strong> as the input. STDDM utilizes a value embedding network with a 1 × 1 kernel convolutional layer to encode the information and outputs a <em>d</em>-dimensional latent representations:</p>
<table class="disp-formula p" id="Equ15"><tr>
<td class="formula"><math id="d33e4137" display="block"><mi mathvariant="bold">H</mi><mo>=</mo><mi>C</mi><mi>o</mi><mi>n</mi><mi>v</mi><mrow><mo>(</mo><mrow><msub><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>l</mi></mrow></msub><mo>∣</mo><mo>∣</mo><msup><mrow><mi mathvariant="bold">X</mi></mrow><mrow><mi>o</mi><mi>b</mi></mrow></msup></mrow><mo>)</mo></mrow><mo>,</mo></math></td>
<td class="label">15</td>
</tr></table>
<p>where <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq35"><math id="d33e4172"><mi mathvariant="bold">H</mi><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>L</mi><mo>×</mo><mi>N</mi><mo>×</mo><mi>d</mi></mrow></msup></math></span>. The diffusion step, <em>l</em>, is specified by adding the Transformer sinusoidal position embedding (<em>P</em><em>E</em>)<sup><a href="#CR55" class="usa-link" aria-describedby="CR55">55</a></sup> to <strong>H</strong>:</p>
<table class="disp-formula p" id="Equ16"><tr>
<td class="formula"><math id="d33e4210" display="block"><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>i</mi><mi>n</mi></mrow></msup><mo>=</mo><mi mathvariant="bold">H</mi><mo>+</mo><mi>D</mi><mi>E</mi><mrow><mo>(</mo><mrow><mi>P</mi><mi>E</mi><mrow><mo>(</mo><mrow><mi>l</mi></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>,</mo></math></td>
<td class="label">16</td>
</tr></table>
<p>where <em>D</em><em>E</em> project consists of two fully connected layers and a Sigmoid Linear Unit (SiLU) function as the activation layer, and we broadcast this embedding vector over timesteps and positions <em>L</em> × <em>N</em>.</p>
<p id="Par67">To comprehensively capture the global spatiotemporal and geographic relationship of input <strong>H</strong><sup><em>i</em><em>n</em></sup>, the temporal features, <strong>H</strong><sup><em>t</em><em>e</em><em>m</em><em>p</em></sup>, is learned using the temporal dependency learning module TLT, and then the temporal features are aggregated through a spatial dependency learning module HSGNN:</p>
<table class="disp-formula p" id="Equ17"><tr>
<td class="formula"><math id="d33e4278" display="block"><mtable><mtr><mtd columnalign="center"><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>t</mi><mi>e</mi><mi>m</mi><mi>p</mi></mrow></msup><mo>=</mo><mi>T</mi><mi>L</mi><mi>T</mi><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>i</mi><mi>n</mi></mrow></msup></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center"><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>s</mi><mi>p</mi><mi>a</mi></mrow></msup><mo>=</mo><mi>G</mi><mi>N</mi><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>t</mi><mi>e</mi><mi>m</mi><mi>p</mi></mrow></msup><mo>+</mo><mi>H</mi><mi>S</mi><mi>G</mi><mi>N</mi><mi>N</mi><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>t</mi><mi>e</mi><mi>m</mi><mi>p</mi></mrow></msup><mo>,</mo><mi mathvariant="bold">G</mi></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>,</mo></mtd></mtr></mtable></math></td>
<td class="label">17</td>
</tr></table>
<p>where <em>G</em><em>N</em> means Group Normalization<sup><a href="#CR56" class="usa-link" aria-describedby="CR56">56</a></sup> to stabilize the training. More of the original information <strong>H</strong><sup><em>t</em><em>e</em><em>m</em><em>p</em></sup> is preserved for <strong>H</strong><sup><em>s</em><em>p</em><em>a</em></sup>.</p>
<p id="Par68"><strong>H</strong><sup><em>o</em><em>u</em><em>t</em></sup> is obtained by leveraging the gated activation unit in CSDI<sup><a href="#CR37" class="usa-link" aria-describedby="CR37">37</a></sup>, which is formalized as:</p>
<table class="disp-formula p" id="Equ18"><tr>
<td class="formula"><math id="d33e4410" display="block"><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msup><mo>=</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>o</mi><mi>i</mi><mi>d</mi><mrow><mo>(</mo><mrow><mi>C</mi><mi>o</mi><mi>n</mi><mi>v</mi><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>s</mi><mi>p</mi><mi>a</mi></mrow></msup></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>*</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mrow><mo>(</mo><mrow><mi>C</mi><mi>o</mi><mi>n</mi><mi>v</mi><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>s</mi><mi>p</mi><mi>a</mi></mrow></msup></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>,</mo></math></td>
<td class="label">18</td>
</tr></table>
<p>where <em>C</em><em>o</em><em>n</em><em>v</em> is a convolutional layer with a 1 × 1 kernel. Finally, the predicted imputation target is obtained with</p>
<table class="disp-formula p" id="Equ19"><tr>
<td class="formula"><math id="d33e4492" display="block"><mi mathvariant="bold">X</mi><mo>=</mo><msup><mrow><mi mathvariant="bold">F</mi></mrow><mrow><mi>i</mi><mi>m</mi><mi>p</mi></mrow></msup><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msup></mrow><mo>)</mo></mrow><mo>,</mo></math></td>
<td class="label">19</td>
</tr></table>
<p>where <strong>F</strong><sup><em>i</em><em>m</em><em>p</em></sup> is a fully connected layer.</p></section><section id="Sec14"><h3 class="pmc_sec_title">Network structures of TLT</h3>
<p id="Par69">TLT is dedicated to effectively capturing the temporal relationships of Chl_a. In TLT, each element in the time series will compute attention with all other elements, thereby preserving and propagating essential information throughout the extended sequence<sup><a href="#CR55" class="usa-link" aria-describedby="CR55">55</a></sup>. The long- and short-term temporal dependencies captured by TLT significantly enhance the accuracy of large-scale spatiotemporal Chl_a imputations and predictions.</p>
<p id="Par70">Specifically, TLT takes the representations of Chl_a from a time series <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq36"><math id="d33e4544"><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>i</mi><mi>n</mi></mrow></msup><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>L</mi><mo>×</mo><mi>N</mi><mo>×</mo><mi>d</mi></mrow></msup></math></span> as input, yielding the enriched temporal representation <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq37"><math id="d33e4570"><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>t</mi><mi>e</mi><mi>m</mi><mi>p</mi></mrow></msup><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>L</mi><mo>×</mo><mi>N</mi><mo>×</mo><mi>d</mi></mrow></msup></math></span> by encoding the time dependency in <strong>H</strong><sup><em>i</em><em>n</em></sup>. Two key modules in TLT are the Multi-head Self-Attention (MSA) and Position-wise Feed-Forward (PFF). MSA is mainly in charge of capturing temporal relationships and PFF endows the model with nonlinearity. We mathematically represent the overall procedure of TLT as a function as follows:</p>
<table class="disp-formula p" id="Equ20"><tr>
<td class="formula"><math id="d33e4607" display="block"><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>t</mi><mi>e</mi><mi>m</mi><mi>p</mi></mrow></msup><mo>=</mo><mi>L</mi><mi>N</mi><mrow><mo>(</mo><mrow><mi>P</mi><mi>F</mi><mi>F</mi><mrow><mo>(</mo><mrow><mi>L</mi><mi>N</mi><mrow><mo>(</mo><mrow><mi>M</mi><mi>S</mi><mi>A</mi><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>i</mi><mi>n</mi></mrow></msup></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>,</mo></math></td>
<td class="label">20</td>
</tr></table>
<p>where LN is the standard normalization layer. The key component in MSA is self-attention (SA) along the temporal dimension <em>L</em>, which is defined as follows,</p>
<table class="disp-formula p" id="Equ21"><tr>
<td class="formula"><math id="d33e4664" display="block"><mi>S</mi><mi>A</mi><mrow><mo>(</mo><mrow><mi>Q</mi><mo>,</mo><mi>K</mi><mo>,</mo><mi>V</mi></mrow><mo>)</mo></mrow><mo>=</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo>(</mo><mrow><mfrac><mrow><mi>Q</mi><msup><mrow><mi>K</mi></mrow><mrow><mi>T</mi></mrow></msup></mrow><mrow><msqrt><mrow><mi>d</mi></mrow></msqrt></mrow></mfrac></mrow><mo>)</mo></mrow><mi>V</mi><mo>,</mo></math></td>
<td class="label">21</td>
</tr></table>
<p>where <em>Q</em> = <strong>H</strong><sup><em>i</em><em>n</em></sup><em>W</em> <sup><em>Q</em></sup>; <em>K</em> = <strong>H</strong><sup><em>i</em><em>n</em></sup><em>W</em> <sup><em>K</em></sup>; <em>V</em> = <strong>H</strong><sup><em>i</em><em>n</em></sup><em>W</em> <sup><em>V</em></sup> represent the queries, the keys, and the values, respectively, which are converted from <strong>H</strong><sup><em>i</em><em>n</em></sup>, <em>W</em><sup><em>Q</em></sup>, <em>W</em><sup><em>K</em></sup>, and <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq38"><math id="d33e4784"><msup><mrow><mi>W</mi></mrow><mrow><mi>V</mi></mrow></msup><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>d</mi><mo>×</mo><mi>d</mi></mrow></msup></math></span> are learnable projection parameters. Essentially, MSA computes the dot product of <em>Q</em><sub><em>i</em></sub> and <em>K</em><sub><em>j</em></sub> to generate a weight that measures the relevance between Chl_a at times <em>i</em> and <em>j</em>.</p>
<p id="Par71">MSA utilizes several SA layers: <em>M</em><em>S</em><em>A</em>(<strong>H</strong><sup><em>i</em><em>n</em></sup>) = <em>C</em><em>o</em><em>n</em><em>c</em><em>a</em><em>t</em>(<em>h</em><sub>1</sub>, <em>h</em><sub>2</sub>, ⋯  , <em>h</em><sub><em>n</em></sub>)<em>W</em><sup><em>O</em></sup> + <strong>H</strong><sup><em>i</em><em>n</em></sup> where <em>h</em><sub><em>i</em></sub> = <em>S</em><em>A</em>(<em>Q</em>, <em>K</em>, <em>V</em>). The residual is introduced to preserve more original Chl_a information. The added PFF networks consist of a fully connected layer and a Rectified Linear Unit(ReLU) function as and activation layer.</p></section><section id="Sec15"><h3 class="pmc_sec_title">Network structures of HSGNN</h3>
<p id="Par72">To leverage the spatial dependency of Chl_a, we contrived HSGNN to obtain the enriched spatiotemporal representation, <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq39"><math id="d33e4909"><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>s</mi><mi>p</mi><mi>a</mi></mrow></msup><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>L</mi><mo>×</mo><mi>N</mi><mo>×</mo><mi>d</mi></mrow></msup></math></span> by encoding the spatial dependency in <strong>H</strong><sup><em>t</em><em>e</em><em>m</em><em>p</em></sup> with the assistance of <strong>G</strong>:</p>
<table class="disp-formula p" id="Equ22"><tr>
<td class="formula"><math id="d33e4952" display="block"><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>s</mi><mi>p</mi><mi>a</mi></mrow></msup><mo>=</mo><msup><mrow><mi mathvariant="bold">F</mi></mrow><mrow><mi>s</mi><mi>p</mi><mi>a</mi></mrow></msup><mrow><mo>(</mo><mrow><mi mathvariant="bold">W</mi><mo>⋅</mo><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>t</mi><mi>e</mi><mi>m</mi><mi>p</mi></mrow></msup><mo>⋅</mo><mi mathvariant="bold">G</mi></mrow><mo>)</mo></mrow><mo>.</mo></math></td>
<td class="label">22</td>
</tr></table>
<p>As shown in Supplementary Fig. <a href="#MOESM1" class="usa-link">S16</a>d (a), the time series exhibits spatial heterogeneity, with significantly different means and variances of Chl_a at different locations. Hence, the same parameter <strong>W</strong> for different locations does not meet the requirements.</p>
<p id="Par73">However, it is impractical to design a separate set of parameters for each different position. For the spatial parameter space, <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq40"><math id="d33e5006"><msup><mrow><mi>θ</mi></mrow><mrow><mi>s</mi><mi>p</mi><mi>a</mi></mrow></msup><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>N</mi><mo>×</mo><mi>d</mi><mo>×</mo><mi>d</mi></mrow></msup></math></span>, directly optimizing this parameter spaces brings huge computational burden and data demand, especially when <em>N</em> is large. Instead, we provide a simple yet effective way to maintain a small parameters pool, <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq41"><math id="d33e5035"><mi mathvariant="bold">P</mi><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>k</mi><mo>×</mo><mi>d</mi><mo>×</mo><mi>d</mi></mrow></msup></math></span>, which contains <em>k</em> parameter prototypes. <em>k</em> is defined to be much smaller than <em>N</em>. We can generate a spatial embedding <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq42"><math id="d33e5066"><mi mathvariant="bold">Q</mi><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>k</mi><mo>×</mo><mi>N</mi></mrow></msup></math></span> as a query for all positions, and we can obtain a location-specific parameter using a weighted combination of the parameter prototypes:</p>
<table class="disp-formula p" id="Equ23"><tr>
<td class="formula"><math id="d33e5086" display="block"><msup><mrow><mi mathvariant="bold">W</mi></mrow><mrow><mi>s</mi><mi>p</mi><mi>a</mi></mrow></msup><mo>=</mo><msup><mrow><mi mathvariant="bold">Q</mi></mrow><mrow><mi>T</mi></mrow></msup><mo>⋅</mo><mi mathvariant="bold">P</mi><mo>.</mo></math></td>
<td class="label">23</td>
</tr></table>
<p id="Par74">Because spatial heterogeneity is mainly reflected in the mean and variance of the Chl_a time series across different positions, we generate a query, <strong>Q</strong>, for all positions according to each location, <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq43"><math id="d33e5117"><mi>L</mi><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mn>1</mn><mo>×</mo><mi>N</mi></mrow></msup></math></span>, mean, <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq44"><math id="d33e5135"><mi>μ</mi><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mn>1</mn><mo>×</mo><mi>N</mi></mrow></msup></math></span>, and variance, <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq45"><math id="d33e5153"><mi>ς</mi><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mn>1</mn><mo>×</mo><mi>N</mi></mrow></msup></math></span>:</p>
<table class="disp-formula p" id="Equ24"><tr>
<td class="formula"><math id="d33e5172" display="block"><mi mathvariant="bold">Q</mi><mo>=</mo><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>T</mi></mrow></msup><mfenced close="]" open="["><mrow><mtable><mtr><mtd columnalign="center"><mi>L</mi></mtd></mtr><mtr><mtd columnalign="center"><mi>μ</mi></mtd></mtr><mtr><mtd columnalign="center"><mi>ς</mi></mtd></mtr><mtr><mtd columnalign="center"></mtd></mtr></mtable></mrow></mfenced><mo>,</mo></math></td>
<td class="label">24</td>
</tr></table>
<p>where <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq46"><math id="d33e5205"><mi mathvariant="bold">H</mi><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mn>3</mn><mo>×</mo><mi>k</mi></mrow></msup></math></span>. In doing so, the learned parameter reduces from <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq47"><math id="d33e5224"><msup><mrow><mi>θ</mi></mrow><mrow><mi>s</mi><mi>p</mi><mi>a</mi></mrow></msup><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>N</mi><mo>×</mo><mi>d</mi><mo>×</mo><mi>d</mi></mrow></msup></math></span> to <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq48"><math id="d33e5250"><mi mathvariant="bold">H</mi><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mn>3</mn><mo>×</mo><mi>k</mi></mrow></msup></math></span> and <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq49"><math id="d33e5269"><mi mathvariant="bold">P</mi><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>k</mi><mo>×</mo><mi>d</mi><mo>×</mo><mi>d</mi></mrow></msup></math></span>.</p>
<p id="Par75">Then, we leverage <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq50"><math id="d33e5292"><msup><mrow><mi mathvariant="bold">W</mi></mrow><mrow><mi>s</mi><mi>p</mi><mi>a</mi></mrow></msup><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>N</mi><mo>×</mo><mi>d</mi><mo>×</mo><mi>d</mi></mrow></msup></math></span> to replace the original parameters <span xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IEq51"><math id="d33e5319"><mi mathvariant="bold">W</mi><mo>∈</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mrow><mi>d</mi><mo>×</mo><mi>d</mi></mrow></msup></math></span> in Equation (<a href="#Equ22" class="usa-link">22</a>), introducing the spatial heterogeneity using location specific parameters:</p>
<table class="disp-formula p" id="Equ25"><tr>
<td class="formula"><math id="d33e5342" display="block"><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>s</mi><mi>p</mi><mi>a</mi></mrow></msup><mo>=</mo><msup><mrow><mi mathvariant="bold">F</mi></mrow><mrow><mi>s</mi><mi>p</mi><mi>a</mi></mrow></msup><mrow><mo>(</mo><mrow><msup><mrow><mi mathvariant="bold">W</mi></mrow><mrow><mi>s</mi><mi>p</mi><mi>a</mi></mrow></msup><mo>⋅</mo><msup><mrow><mi mathvariant="bold">H</mi></mrow><mrow><mi>t</mi><mi>e</mi><mi>m</mi><mi>p</mi></mrow></msup><mo>⋅</mo><mi mathvariant="bold">G</mi></mrow><mo>)</mo></mrow><mo>,</mo></math></td>
<td class="label">25</td>
</tr></table>
<p>where <strong>F</strong><sup><em>s</em><em>p</em><em>a</em></sup> is a fully connected network. Now, each position obtains information from an adjacent position through <strong>H</strong><sup><em>t</em><em>e</em><em>m</em><em>p</em></sup> ⋅ <strong>G</strong>. Meanwhile, location-specific parameters, <strong>W</strong><sup><em>s</em><em>p</em><em>a</em></sup>, are utilized to embed the spatial heterogeneity into <strong>H</strong><sup><em>s</em><em>p</em><em>a</em></sup>. As shown in Supplementary Fig. <a href="#MOESM1" class="usa-link">S16</a>d, we leveraged the learned spatial heterogeneous embedding <strong>Q</strong> to partition the Pearl River Estuary. The results of the partition were generally consistent with the the isobaths at 30 m and 50 m below sea level, showing that STIMP indeed captured the spatial heterogeneity of different locations in the Pearl River Estuary.</p></section><section id="Sec16"><h3 class="pmc_sec_title">More training details</h3>
<p id="Par76">STIMP employs Adam for stochastic optimization during model training. By default, the number of training epochs in STIMP is 500 and 200 for imputation and prediction respectively, with learning rate <em>l</em><em>r</em> = 0.0001 and a weight decay parameter λ = 0.00001.</p></section><section id="Sec17"><h3 class="pmc_sec_title">Computational demands</h3>
<p id="Par77">We computed the computational demands of STIMP, including FLOPs (floating-point operations), MACs (multiply-add operations) and Parameters, with Calflops (<a href="https://github.com/MrYxJ/calculate-flops.pytorch.git" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://github.com/MrYxJ/calculate-flops.pytorch.git</a>) on Pearl River Estuary. Moreover, we recorded the GPU memory usage of STIMP. Note that we set the batch size of training data is equal to 1 when calculating FLOPs, MACs and GPU memory, which means the minimum computational requirements for running STIMP. The hardware requirements analysis in Table <a href="#Tab1" class="usa-link">1</a> reveals that STIMP maintains low GPU memory demands (≥1.5 GB), compatible with obsolete consumer hardware, including NVIDIA’s GTX 1050 (2016 release). This highlights the framework’s practical deployability even with limited computational resources.</p>
<section class="tw xbox font-sm" id="Tab1"><h4 class="obj_head">Table 1.</h4>
<div class="caption p"><p>Computational demands of STIMP</p></div>
<div class="tbl-box p" tabindex="0"><table class="content" frame="hsides" rules="groups">
<thead><tr>
<th colspan="1" rowspan="1">Methods</th>
<th colspan="1" rowspan="1">FLOPs (G)</th>
<th colspan="1" rowspan="1">MACs (G)</th>
<th colspan="1" rowspan="1">Parameters (K)</th>
<th colspan="1" rowspan="1">GPU memory-usage (M)</th>
</tr></thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">STIMP (imputation)</td>
<td colspan="1" rowspan="1">29.22</td>
<td colspan="1" rowspan="1">13.34</td>
<td colspan="1" rowspan="1">136.77</td>
<td colspan="1" rowspan="1">1450</td>
</tr>
<tr>
<td colspan="1" rowspan="1">STIMP (prediction)</td>
<td colspan="1" rowspan="1">1.04</td>
<td colspan="1" rowspan="1">0.48</td>
<td colspan="1" rowspan="1">3.7</td>
<td colspan="1" rowspan="1">762</td>
</tr>
</tbody>
</table></div>
<div class="p text-right font-secondary"><a href="table/Tab1/" class="usa-link" target="_blank" rel="noopener noreferrer">Open in a new tab</a></div></section></section></section><section id="Sec18"><h2 class="pmc_sec_title">Supplementary information</h2>
<section class="sm xbox font-sm" id="MOESM1"><div class="media p"><div class="caption">
<a href="/articles/instance/12358577/bin/41467_2025_62901_MOESM1_ESM.pdf" data-ga-action="click_feat_suppl" class="usa-link">Supplementary Information</a><sup> (11.9MB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="MOESM2"><div class="media p"><div class="caption">
<a href="/articles/instance/12358577/bin/41467_2025_62901_MOESM2_ESM.pdf" data-ga-action="click_feat_suppl" class="usa-link">Transparent Peer Review file</a><sup> (9.5MB, pdf) </sup>
</div></div></section></section><section id="Sec19"><h2 class="pmc_sec_title">Source data</h2>
<section class="sm xbox font-sm" id="MOESM3"><div class="media p"><div class="caption">
<a href="/articles/instance/12358577/bin/41467_2025_62901_MOESM3_ESM.xlsx" data-ga-action="click_feat_suppl" class="usa-link">Source data</a><sup> (4MB, xlsx) </sup>
</div></div></section></section><section id="ack1" class="ack"><h2 class="pmc_sec_title">Acknowledgements</h2>
<p>The work described in this paper was fully supported by a grant from the Research Grants Council of the Hong Kong Special Administrative Region, China (Project Reference Number: AoE/P-601/23-N); we thank the support of the Center for Ocean Research in Hong Kong and Macau (CORE), CORE is a joint research center for ocean research between Laoshan Laboratory and HKUST; we thank the Moderate Resolution Imaging Spectroradiometer (MODIS) Aqua projects for providing 8-d Chl_a dataset with spatial resolution of 4 km (<a href="https://search.earthdata.nasa.gov/search?q=10.5067/AQUA/MODIS/L3M/CHL/2022" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://search.earthdata.nasa.gov/search?q=10.5067/AQUA/MODIS/L3M/CHL/2022</a>).</p></section><section id="notes1"><h2 class="pmc_sec_title">Author contributions</h2>
<p>Fan Z., C.Y. and J.G. conceived the study and designed the STIMP algorithm. Fan Z. implemented the STIMP algorithm. Fan Z. and Fa Z. evaluated the baseline methods. Fan Z. and H.K. processed the data and interpreted the results. Fan Z., H.K., C.Y., and J.G. wrote the manuscript.</p></section><section id="notes2"><h2 class="pmc_sec_title">Peer review</h2>
<section id="FPar3"><h3 class="pmc_sec_title">Peer review information</h3>
<p id="Par78"><em>Nature Communications</em> thanks Jesús Morón-López, Xiaofeng Li, and the other anonymous reviewer(s) for their contribution to the peer review of this work. A peer review file is available.</p></section></section><section id="notes3"><h2 class="pmc_sec_title">Data availability</h2>
<p>The MODIS Chl_a data used in this study have been publicly available in the Moderate Resolution Imaging Spectroradiometer (MODIS) Aqua projects<sup><a href="#CR33" class="usa-link" aria-describedby="CR33">33</a></sup> (<a href="https://search.earthdata.nasa.gov/search?q=10.5067/AQUA/MODIS/L3M/CHL/2022" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://search.earthdata.nasa.gov/search?q=10.5067/AQUA/MODIS/L3M/CHL/2022</a>). The processed MODIS Chl_a data is available on Zenodo at 10.5281/zenodo.14638405. Source data are provided with this paper. We also uploaded all scripts and materials to reproduce all the analyses at <a href="https://stimp-tutorials.readthedocs.io/en/latest/" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://stimp-tutorials.readthedocs.io/en/latest/</a>. <a href="#Sec19" class="usa-link">Source data</a> are provided with this paper.</p></section><section id="notes4"><h2 class="pmc_sec_title">Code availability</h2>
<p>The STIMP software package and source code are available on GitHub at <a href="https://github.com/YangLabHKUST/STIMP.git" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://github.com/YangLabHKUST/STIMP.git</a>. We also uploaded all scripts and materials to reproduce all the analyses at the same website.</p></section><section id="FPar4"><h2 class="pmc_sec_title">Competing interests</h2>
<p id="Par79">The authors declare no competing interests.</p></section><section id="fn-group1" class="fn-group"><h2 class="pmc_sec_title">Footnotes</h2>
<div class="fn-group p font-secondary-light font-sm"><div class="fn p" id="fn1"><p><strong>Publisher’s note</strong> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></div></div></section><section id="_ci93_" lang="en" class="contrib-info"><h2 class="pmc_sec_title">Contributor Information</h2>
<p>Can Yang, Email: macyang@ust.hk.</p>
<p>Jianping Gan, Email: magan@ust.hk.</p></section><section id="sec22"><h2 class="pmc_sec_title">Supplementary information</h2>
<p>The online version contains supplementary material available at 10.1038/s41467-025-62901-9.</p></section><section id="Bib1" class="ref-list"><h2 class="pmc_sec_title">References</h2>
<section id="Bib1_sec2"><ul class="ref-list font-sm" style="list-style-type:none">
<li id="CR1">
<span class="label">1.</span><cite>Costanza, R. et al. The value of the world’s ecosystem services and natural capital. <em>Nature</em><strong>387</strong>, 253–260 (1997).</cite> [<a href="https://scholar.google.com/scholar_lookup?Costanza,%20R.%20et%20al.%20The%20value%20of%20the%20world%E2%80%99s%20ecosystem%20services%20and%20natural%20capital.%20Nature387,%20253%E2%80%93260%20(1997)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR2">
<span class="label">2.</span><cite>Pauly, D. et al. Towards sustainability in world fisheries. <em>Nature</em><strong>418</strong>, 689–695 (2002).
</cite> [<a href="https://doi.org/10.1038/nature01017" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/12167876/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?Pauly,%20D.%20et%20al.%20Towards%20sustainability%20in%20world%20fisheries.%20Nature418,%20689%E2%80%93695%20(2002)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR3">
<span class="label">3.</span><cite>Gray, J. S. Marine biodiversity: patterns, threats and conservation needs. <em>Biodivers. Conserv.</em><strong>6</strong>, 153–175 (1997).</cite> [<a href="https://scholar.google.com/scholar_lookup?Gray,%20J.%20S.%20Marine%20biodiversity:%20patterns,%20threats%20and%20conservation%20needs.%20Biodivers.%20Conserv.6,%20153%E2%80%93175%20(1997)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR4">
<span class="label">4.</span><cite>Dai, Y. et al. Coastal phytoplankton blooms expand and intensify in the 21st century. <em>Nature</em><strong>615</strong>, 280–284 (2023).
</cite> [<a href="https://doi.org/10.1038/s41586-023-05760-y" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC9995273/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/36859547/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?Dai,%20Y.%20et%20al.%20Coastal%20phytoplankton%20blooms%20expand%20and%20intensify%20in%20the%2021st%20century.%20Nature615,%20280%E2%80%93284%20(2023)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR5">
<span class="label">5.</span><cite>Gruber, N., Boyd, P. W., Frölicher, T. L. &amp; Vogt, M. Biogeochemical extremes and compound events in the ocean. <em>Nature</em><strong>600</strong>, 395–407 (2021).
</cite> [<a href="https://doi.org/10.1038/s41586-021-03981-7" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/34912083/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?Gruber,%20N.,%20Boyd,%20P.%20W.,%20Fr%C3%B6licher,%20T.%20L.%20&amp;%20Vogt,%20M.%20Biogeochemical%20extremes%20and%20compound%20events%20in%20the%20ocean.%20Nature600,%20395%E2%80%93407%20(2021)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR6">
<span class="label">6.</span><cite>Breitburg, D. et al. Declining oxygen in the global ocean and coastal waters. <em>Science</em><strong>359</strong>, eaam7240 (2018).
</cite> [<a href="https://doi.org/10.1126/science.aam7240" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/29301986/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?Breitburg,%20D.%20et%20al.%20Declining%20oxygen%20in%20the%20global%20ocean%20and%20coastal%20waters.%20Science359,%20eaam7240%20(2018)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR7">
<span class="label">7.</span><cite>Trottet, A., George, C., Drillet, G. &amp; Lauro, F. M. Aquaculture in coastal urbanized areas: a comparative review of the challenges posed by harmful algal blooms. <em>Crit. Rev. Environ. Sci. Technol.</em><strong>52</strong>, 2888–2929 (2022).</cite> [<a href="https://scholar.google.com/scholar_lookup?Trottet,%20A.,%20George,%20C.,%20Drillet,%20G.%20&amp;%20Lauro,%20F.%20M.%20Aquaculture%20in%20coastal%20urbanized%20areas:%20a%20comparative%20review%20of%20the%20challenges%20posed%20by%20harmful%20algal%20blooms.%20Crit.%20Rev.%20Environ.%20Sci.%20Technol.52,%202888%E2%80%932929%20(2022)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR8">
<span class="label">8.</span><cite>Zhu, X., Guo, H., Huang, J. J., Tian, S. &amp; Zhang, Z. A hybrid decomposition and machine learning model for forecasting chlorophyll-a and total nitrogen concentration in coastal waters. <em>J. Hydrol.</em><strong>619</strong>, 129207 (2023).</cite> [<a href="https://scholar.google.com/scholar_lookup?Zhu,%20X.,%20Guo,%20H.,%20Huang,%20J.%20J.,%20Tian,%20S.%20&amp;%20Zhang,%20Z.%20A%20hybrid%20decomposition%20and%20machine%20learning%20model%20for%20forecasting%20chlorophyll-a%20and%20total%20nitrogen%20concentration%20in%20coastal%20waters.%20J.%20Hydrol.619,%20129207%20(2023)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR9">
<span class="label">9.</span><cite>Lapointe, B. E., O’Connell, J. D. &amp; Garrett, G. S. Nutrient couplings between on-site sewage disposal systems, groundwaters, and nearshore surface waters of the Florida keys. <em>Biogeochemistry</em><strong>10</strong>, 289–307 (1990).</cite> [<a href="https://scholar.google.com/scholar_lookup?Lapointe,%20B.%20E.,%20O%E2%80%99Connell,%20J.%20D.%20&amp;%20Garrett,%20G.%20S.%20Nutrient%20couplings%20between%20on-site%20sewage%20disposal%20systems,%20groundwaters,%20and%20nearshore%20surface%20waters%20of%20the%20Florida%20keys.%20Biogeochemistry10,%20289%E2%80%93307%20(1990)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR10">
<span class="label">10.</span><cite>Heffernan, J. B. et al. Hydrologic and biotic influences on nitrate removal in a subtropical spring-fed river. <em>Limnol. Oceanogr.</em><strong>55</strong>, 249–263 (2010).</cite> [<a href="https://scholar.google.com/scholar_lookup?Heffernan,%20J.%20B.%20et%20al.%20Hydrologic%20and%20biotic%20influences%20on%20nitrate%20removal%20in%20a%20subtropical%20spring-fed%20river.%20Limnol.%20Oceanogr.55,%20249%E2%80%93263%20(2010)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR11">
<span class="label">11.</span><cite>Commission, E. Commission decision (EU) 2017/848 of 17 may 2017 laying down criteria and methodological standards on good environmental status of marine waters and specifications and standardised methods for monitoring and assessment, and repealing decision 2010/477/EU. <em>J. Eur. Union</em><strong>125</strong>, 43–74 (2017).</cite> [<a href="https://scholar.google.com/scholar_lookup?Commission,%20E.%20Commission%20decision%20(EU)%202017/848%20of%2017%20may%202017%20laying%20down%20criteria%20and%20methodological%20standards%20on%20good%20environmental%20status%20of%20marine%20waters%20and%20specifications%20and%20standardised%20methods%20for%20monitoring%20and%20assessment,%20and%20repealing%20decision%202010/477/EU.%20J.%20Eur.%20Union125,%2043%E2%80%9374%20(2017)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR12">
<span class="label">12.</span><cite>Colella, S., Falcini, F., Rinaldi, E., Sammartino, M. &amp; Santoleri, R. Mediterranean ocean colour chlorophyll trends. <em>PloS One</em><strong>11</strong>, e0155756 (2016).
</cite> [<a href="https://doi.org/10.1371/journal.pone.0155756" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="/articles/PMC4892652/" class="usa-link">PMC free article</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/27258025/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?Colella,%20S.,%20Falcini,%20F.,%20Rinaldi,%20E.,%20Sammartino,%20M.%20&amp;%20Santoleri,%20R.%20Mediterranean%20ocean%20colour%20chlorophyll%20trends.%20PloS%20One11,%20e0155756%20(2016)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR13">
<span class="label">13.</span><cite>Chassignet, E. P. et al. Us godae: global ocean prediction with the hybrid coordinate ocean model (HYCOM). <em>Oceanography</em><strong>22</strong>, 64–75 (2009).</cite> [<a href="https://scholar.google.com/scholar_lookup?Chassignet,%20E.%20P.%20et%20al.%20Us%20godae:%20global%20ocean%20prediction%20with%20the%20hybrid%20coordinate%20ocean%20model%20(HYCOM).%20Oceanography22,%2064%E2%80%9375%20(2009)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR14">
<span class="label">14.</span><cite>Chassignet, E. P. et al. The HYCOM (Hybrid Coordinate Ocean Model) data assimilative system. <em>J. Mar. Syst.</em><strong>65</strong>, 60–83 (2007).</cite> [<a href="https://scholar.google.com/scholar_lookup?Chassignet,%20E.%20P.%20et%20al.%20The%20HYCOM%20(Hybrid%20Coordinate%20Ocean%20Model)%20data%20assimilative%20system.%20J.%20Mar.%20Syst.65,%2060%E2%80%9383%20(2007)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR15">
<span class="label">15.</span><cite>Gan, J., Liu, Z. &amp; Hui, C. R. A three-layer alternating spinning circulation in the South China Sea. <em>J. Phys. Oceanogr.</em><strong>46</strong>, 2309–2315 (2016).</cite> [<a href="https://scholar.google.com/scholar_lookup?Gan,%20J.,%20Liu,%20Z.%20&amp;%20Hui,%20C.%20R.%20A%20three-layer%20alternating%20spinning%20circulation%20in%20the%20South%20China%20Sea.%20J.%20Phys.%20Oceanogr.46,%202309%E2%80%932315%20(2016)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR16">
<span class="label">16.</span><cite>MATEAR, R. Parameter optimization and analysis of ecosystem models using simulated annealing: a case study at station P. <em>J. Mar. Res.</em><strong>53</strong>, 571–607 (1995).</cite> [<a href="https://scholar.google.com/scholar_lookup?MATEAR,%20R.%20Parameter%20optimization%20and%20analysis%20of%20ecosystem%20models%20using%20simulated%20annealing:%20a%20case%20study%20at%20station%20P.%20J.%20Mar.%20Res.53,%20571%E2%80%93607%20(1995)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR17">
<span class="label">17.</span><cite>Allen, M. R., Kettleborough, J. &amp; Stainforth, D. Model error in weather and climate forecasting. In <em>ECMWF Predictability of Weather and Climate Seminar</em>, 279–304 (European Centre for Medium Range Weather Forecasts, 2002).</cite>
</li>
<li id="CR18">
<span class="label">18.</span><cite>Fontana, C., Grenz, C., Pinazo, C., Marsaleix, P. &amp; Diaz, F. Assimilation of seawifs chlorophyll data into a 3D-coupled physical–biogeochemical model applied to a freshwater-influenced coastal zone. <em>Continental Shelf Res.</em><strong>29</strong>, 1397–1409 (2009).</cite> [<a href="https://scholar.google.com/scholar_lookup?Fontana,%20C.,%20Grenz,%20C.,%20Pinazo,%20C.,%20Marsaleix,%20P.%20&amp;%20Diaz,%20F.%20Assimilation%20of%20seawifs%20chlorophyll%20data%20into%20a%203D-coupled%20physical%E2%80%93biogeochemical%20model%20applied%20to%20a%20freshwater-influenced%20coastal%20zone.%20Continental%20Shelf%20Res.29,%201397%E2%80%931409%20(2009)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR19">
<span class="label">19.</span><cite>Gregg, W. W. Assimilation of SeaWiFS ocean chlorophyll data into a three-dimensional global ocean model. <em>J. Mar. Syst.</em><strong>69</strong>, 205–225 (2008).</cite> [<a href="https://scholar.google.com/scholar_lookup?Gregg,%20W.%20W.%20Assimilation%20of%20SeaWiFS%20ocean%20chlorophyll%20data%20into%20a%20three-dimensional%20global%20ocean%20model.%20J.%20Mar.%20Syst.69,%20205%E2%80%93225%20(2008)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR20">
<span class="label">20.</span><cite>Sanchez-Gonzalez, A. et al. Learning to simulate complex physics with graph networks. In <em>International conference on machine learning</em>, 8459–8468 (2020).</cite>
</li>
<li id="CR21">
<span class="label">21.</span><cite>Corredor, J. E. <em>Numerical Models for Operational Ocean Observing</em>, 113–123 (Springer International Publishing, Cham, 2018). 10.1007/978-3-319-78352-9_6.</cite>
</li>
<li id="CR22">
<span class="label">22.</span><cite>Wu, G. &amp; Xu, Z. Prediction of algal blooming using EFDC model: Case study in the Daxiang Lake. <em>Ecol. Model.</em><strong>222</strong>, 1245–1252 (2011).</cite> [<a href="https://scholar.google.com/scholar_lookup?Wu,%20G.%20&amp;%20Xu,%20Z.%20Prediction%20of%20algal%20blooming%20using%20EFDC%20model:%20Case%20study%20in%20the%20Daxiang%20Lake.%20Ecol.%20Model.222,%201245%E2%80%931252%20(2011)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR23">
<span class="label">23.</span><cite>Chen, Q., Guan, T., Yun, L., Li, R. &amp; Recknagel, F. Online forecasting chlorophyll a concentrations by an auto-regressive integrated moving average model: feasibilities and potentials. <em>Harmful Algae</em><strong>43</strong>, 58–65 (2015).</cite> [<a href="https://scholar.google.com/scholar_lookup?Chen,%20Q.,%20Guan,%20T.,%20Yun,%20L.,%20Li,%20R.%20&amp;%20Recknagel,%20F.%20Online%20forecasting%20chlorophyll%20a%20concentrations%20by%20an%20auto-regressive%20integrated%20moving%20average%20model:%20feasibilities%20and%20potentials.%20Harmful%20Algae43,%2058%E2%80%9365%20(2015)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR24">
<span class="label">24.</span><cite>Fathi, M. M., Awadallah, A. G., Abdelbaki, A. M. &amp; Haggag, M. A new Budyko framework extension using time series SARIMAX model. <em>J. Hydrol.</em><strong>570</strong>, 827–838 (2019).</cite> [<a href="https://scholar.google.com/scholar_lookup?Fathi,%20M.%20M.,%20Awadallah,%20A.%20G.,%20Abdelbaki,%20A.%20M.%20&amp;%20Haggag,%20M.%20A%20new%20Budyko%20framework%20extension%20using%20time%20series%20SARIMAX%20model.%20J.%20Hydrol.570,%20827%E2%80%93838%20(2019)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR25">
<span class="label">25.</span><cite>Ai, H., Zhang, K., Sun, J. &amp; Zhang, H. Short-term Lake Erie algal bloom prediction by classification and regression models. <em>Water Res.</em><strong>232</strong>, 119710 (2023).
</cite> [<a href="https://doi.org/10.1016/j.watres.2023.119710" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/36801534/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?Ai,%20H.,%20Zhang,%20K.,%20Sun,%20J.%20&amp;%20Zhang,%20H.%20Short-term%20Lake%20Erie%20algal%20bloom%20prediction%20by%20classification%20and%20regression%20models.%20Water%20Res.232,%20119710%20(2023)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR26">
<span class="label">26.</span><cite>Wang, L. et al. Employing hybrid deep learning for near-real-time forecasts of sensor-based algal parameters in a microcystis bloom-dominated lake. <em>Sci. total Environ.</em><strong>922</strong>, 171009 (2024).
</cite> [<a href="https://doi.org/10.1016/j.scitotenv.2024.171009" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/38402991/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?Wang,%20L.%20et%20al.%20Employing%20hybrid%20deep%20learning%20for%20near-real-time%20forecasts%20of%20sensor-based%20algal%20parameters%20in%20a%20microcystis%20bloom-dominated%20lake.%20Sci.%20total%20Environ.922,%20171009%20(2024)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR27">
<span class="label">27.</span><cite>Sun, X. et al. Enhanced forecasting of chlorophyll-a concentration in coastal waters through integration of Fourier analysis and transformer networks. <em>Water Res.</em><strong>263</strong>, 122160 (2024).
</cite> [<a href="https://doi.org/10.1016/j.watres.2024.122160" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/39096816/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?Sun,%20X.%20et%20al.%20Enhanced%20forecasting%20of%20chlorophyll-a%20concentration%20in%20coastal%20waters%20through%20integration%20of%20Fourier%20analysis%20and%20transformer%20networks.%20Water%20Res.263,%20122160%20(2024)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR28">
<span class="label">28.</span><cite>Chen, J., Zhang, M., Cui, T. &amp; Wen, Z. A review of some important technical problems in respect of satellite remote sensing of chlorophyll-a concentration in coastal waters. <em>IEEE J. Sel. Top. Appl. Earth Observ. Remote Sens.</em><strong>6</strong>, 2275–2289 (2013).</cite> [<a href="https://scholar.google.com/scholar_lookup?Chen,%20J.,%20Zhang,%20M.,%20Cui,%20T.%20&amp;%20Wen,%20Z.%20A%20review%20of%20some%20important%20technical%20problems%20in%20respect%20of%20satellite%20remote%20sensing%20of%20chlorophyll-a%20concentration%20in%20coastal%20waters.%20IEEE%20J.%20Sel.%20Top.%20Appl.%20Earth%20Observ.%20Remote%20Sens.6,%202275%E2%80%932289%20(2013)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR29">
<span class="label">29.</span><cite>Johnson, K. S. &amp; Bif, M. B. Constraint on net primary productivity of the global ocean by Argo oxygen measurements. <em>Nat. Geosci.</em><strong>14</strong>, 769–774 (2021).</cite> [<a href="https://scholar.google.com/scholar_lookup?Johnson,%20K.%20S.%20&amp;%20Bif,%20M.%20B.%20Constraint%20on%20net%20primary%20productivity%20of%20the%20global%20ocean%20by%20Argo%20oxygen%20measurements.%20Nat.%20Geosci.14,%20769%E2%80%93774%20(2021)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR30">
<span class="label">30.</span><cite>Park, J.-E., Park, K.-A., Kang, C.-K. &amp; Park, Y.-J. Short-term response of chlorophyll-a concentration to change in sea surface wind field over mesoscale eddy. <em>Estuaries Coasts</em><strong>43</strong>, 646–660 (2020).</cite> [<a href="https://scholar.google.com/scholar_lookup?Park,%20J.-E.,%20Park,%20K.-A.,%20Kang,%20C.-K.%20&amp;%20Park,%20Y.-J.%20Short-term%20response%20of%20chlorophyll-a%20concentration%20to%20change%20in%20sea%20surface%20wind%20field%20over%20mesoscale%20eddy.%20Estuaries%20Coasts43,%20646%E2%80%93660%20(2020)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR31">
<span class="label">31.</span><cite>Mercury, M. et al. Global cloud cover for assessment of optical satellite observation opportunities: a HyspIRI case study. <em>Remote Sens. Environ.</em><strong>126</strong>, 62–71 (2012).</cite> [<a href="https://scholar.google.com/scholar_lookup?Mercury,%20M.%20et%20al.%20Global%20cloud%20cover%20for%20assessment%20of%20optical%20satellite%20observation%20opportunities:%20a%20HyspIRI%20case%20study.%20Remote%20Sens.%20Environ.126,%2062%E2%80%9371%20(2012)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR32">
<span class="label">32.</span><cite>Rubin, D. B. <em>Multiple imputation for nonresponse in surveys</em>, vol. 81 (John Wiley &amp; Sons, 2004).</cite>
</li>
<li id="CR33">
<span class="label">33.</span><cite>Esaias, W. E. et al. An overview of MODIS capabilities for ocean science observations. <em>IEEE Trans. Geosci. Remote Sens.</em><strong>36</strong>, 1250–1265 (1998).</cite> [<a href="https://scholar.google.com/scholar_lookup?Esaias,%20W.%20E.%20et%20al.%20An%20overview%20of%20MODIS%20capabilities%20for%20ocean%20science%20observations.%20IEEE%20Trans.%20Geosci.%20Remote%20Sens.36,%201250%E2%80%931265%20(1998)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR34">
<span class="label">34.</span><cite>Alvera-Azcárate, A., Barth, A., Beckers, J.-M. &amp; Weisberg, R. H. Multivariate reconstruction of missing data in sea surface temperature, chlorophyll, and wind satellite fields. <em>J. Geophys. Res. Oceans</em><strong>112</strong> (2007).</cite>
</li>
<li id="CR35">
<span class="label">35.</span><cite>Ma, C., Zhao, J., Ai, B. &amp; Sun, S. Two-decade variability of sea surface temperature and chlorophyll-a in the northern South China Sea as revealed by reconstructed cloud-free satellite data. <em>IEEE Trans. Geosci. Remote Sens.</em><strong>59</strong>, 9033–9046 (2021).</cite> [<a href="https://scholar.google.com/scholar_lookup?Ma,%20C.,%20Zhao,%20J.,%20Ai,%20B.%20&amp;%20Sun,%20S.%20Two-decade%20variability%20of%20sea%20surface%20temperature%20and%20chlorophyll-a%20in%20the%20northern%20South%20China%20Sea%20as%20revealed%20by%20reconstructed%20cloud-free%20satellite%20data.%20IEEE%20Trans.%20Geosci.%20Remote%20Sens.59,%209033%E2%80%939046%20(2021)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR36">
<span class="label">36.</span><cite>Yu, H.-F., Rao, N. &amp; Dhillon, I. S. Temporal regularized matrix factorization for high-dimensional time series prediction. <em>Advances in Neural Information Processing Systems 29</em> (NIPS, 2016).</cite>
</li>
<li id="CR37">
<span class="label">37.</span><cite>Tashiro, Y., Song, J., Song, Y. &amp; Ermon, S. Csdi: Conditional score-based diffusion models for probabilistic time series imputation. <em>Adv. Neural Inf. Process. Syst.</em><strong>34</strong>, 24804–24816 (2021).</cite> [<a href="https://scholar.google.com/scholar_lookup?Tashiro,%20Y.,%20Song,%20J.,%20Song,%20Y.%20&amp;%20Ermon,%20S.%20Csdi:%20Conditional%20score-based%20diffusion%20models%20for%20probabilistic%20time%20series%20imputation.%20Adv.%20Neural%20Inf.%20Process.%20Syst.34,%2024804%E2%80%9324816%20(2021)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR38">
<span class="label">38.</span><cite>Nie, T., Qin, G., Ma, W., Mei, Y. &amp; Sun, J. Imputeformer: Low rankness-induced transformers for generalizable spatiotemporal imputation. In <em>Proc. of the 30th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>, 2260–2271 (2024).</cite>
</li>
<li id="CR39">
<span class="label">39.</span><cite>Yun, T., Jung, H. &amp; Son, J. Imputation as inpainting: Diffusion models for spatiotemporal data imputation (2023).</cite>
</li>
<li id="CR40">
<span class="label">40.</span><cite>He, K. et al. Masked autoencoders are scalable vision learners. In <em>Proc. of the IEEE/CVF conference on computer vision and pattern recognition</em>, 16000–16009 (2022).</cite>
</li>
<li id="CR41">
<span class="label">41.</span><cite>Chen, T. &amp; Guestrin, C. Xgboost: A scalable tree boosting system. In <em>Proc. of the 22nd acm sigkdd international conference on knowledge discovery and data mining</em>, 785–794 (2016).</cite>
</li>
<li id="CR42">
<span class="label">42.</span><cite>Zhang, Y. &amp; Yan, J. Crossformer: Transformer utilizing cross-dimension dependency for multivariate time series forecasting. In <em>The eleventh international conference on learning representations</em> (2023).</cite>
</li>
<li id="CR43">
<span class="label">43.</span><cite>Ekambaram, V., Jati, A., Nguyen, N., Sinthong, P. &amp; Kalagnanam, J. Tsmixer: Lightweight MLP-mixer model for multivariate time series forecasting. In <em>Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>, 459–469 (2023).</cite>
</li>
<li id="CR44">
<span class="label">44.</span><cite>Liu, Y. et al. itransformer: Inverted transformers are effective for time series forecasting. In <em>Proceedings of the Twelfth International Conference on Learning Representations</em>, 1–25 (2024).</cite>
</li>
<li id="CR45">
<span class="label">45.</span><cite>Wu, Z. et al. Connecting the dots: Multivariate time series forecasting with graph neural networks. In <em>Proceedings of the 26th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>, 753–763 (2020).</cite>
</li>
<li id="CR46">
<span class="label">46.</span><cite>Wang, Y. et al. Predrnn: A recurrent neural network for spatiotemporal predictive learning. <em>IEEE Trans. Pattern Anal. Mach. Intell.</em><strong>45</strong>, 2208–2225 (2022).</cite> [<a href="https://doi.org/10.1109/TPAMI.2022.3165153" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/35380958/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?Wang,%20Y.%20et%20al.%20Predrnn:%20A%20recurrent%20neural%20network%20for%20spatiotemporal%20predictive%20learning.%20IEEE%20Trans.%20Pattern%20Anal.%20Mach.%20Intell.45,%202208%E2%80%932225%20(2022)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR47">
<span class="label">47.</span><cite>Jayawardena, A. W. &amp; Lai, F. Time series analysis of water quality data in Pearl River, China. <em>J. Environ. Eng.</em><strong>115</strong>, 590–607 (1989).</cite> [<a href="https://scholar.google.com/scholar_lookup?Jayawardena,%20A.%20W.%20&amp;%20Lai,%20F.%20Time%20series%20analysis%20of%20water%20quality%20data%20in%20Pearl%20River,%20China.%20J.%20Environ.%20Eng.115,%20590%E2%80%93607%20(1989)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR48">
<span class="label">48.</span><cite>Chen, C. et al. Remotely sensed assessment of water quality levels in the Pearl River Estuary, China. <em>Mar. Pollut. Bull.</em><strong>54</strong>, 1267–1272 (2007).
</cite> [<a href="https://doi.org/10.1016/j.marpolbul.2007.03.010" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">DOI</a>] [<a href="https://pubmed.ncbi.nlm.nih.gov/17537463/" class="usa-link">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?Chen,%20C.%20et%20al.%20Remotely%20sensed%20assessment%20of%20water%20quality%20levels%20in%20the%20Pearl%20River%20Estuary,%20China.%20Mar.%20Pollut.%20Bull.54,%201267%E2%80%931272%20(2007)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR49">
<span class="label">49.</span><cite>Kumpf, H., Steidinger, K. &amp; Sherman, K. <em>The Gulf of Mexico Large Marine Ecosystem: Assessment, Sustainability, and Management</em>, 704 (Blackwell Science, Inc., Malden, MA, USA, 1999).</cite>
</li>
<li id="CR50">
<span class="label">50.</span><cite>Spies, R. B., Senner, S. &amp; Robbins, C. S. An overview of the northern Gulf of Mexico ecosystem. <em>Gulf Mex. Sci.</em><strong>33</strong>, 9 (2016).</cite> [<a href="https://scholar.google.com/scholar_lookup?Spies,%20R.%20B.,%20Senner,%20S.%20&amp;%20Robbins,%20C.%20S.%20An%20overview%20of%20the%20northern%20Gulf%20of%20Mexico%20ecosystem.%20Gulf%20Mex.%20Sci.33,%209%20(2016)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR51">
<span class="label">51.</span><cite>Ho, J., Jain, A. &amp; Abbeel, P. Denoising diffusion probabilistic models. <em>Adv. neural Inf. Process. Syst.</em><strong>33</strong>, 6840–6851 (2020).</cite> [<a href="https://scholar.google.com/scholar_lookup?Ho,%20J.,%20Jain,%20A.%20&amp;%20Abbeel,%20P.%20Denoising%20diffusion%20probabilistic%20models.%20Adv.%20neural%20Inf.%20Process.%20Syst.33,%206840%E2%80%936851%20(2020)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR52">
<span class="label">52.</span><cite>Liu, X. &amp; Wang, M. Gap filling of missing data for VIIRS global ocean color products using the dineof method. <em>IEEE Trans. Geosci. Remote Sens.</em><strong>56</strong>, 4464–4476 (2018).</cite> [<a href="https://scholar.google.com/scholar_lookup?Liu,%20X.%20&amp;%20Wang,%20M.%20Gap%20filling%20of%20missing%20data%20for%20VIIRS%20global%20ocean%20color%20products%20using%20the%20dineof%20method.%20IEEE%20Trans.%20Geosci.%20Remote%20Sens.56,%204464%E2%80%934476%20(2018)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR53">
<span class="label">53.</span><cite>Wu, H., Xu, J., Wang, J. &amp; Long, M. Autoformer: Decomposition transformers with auto-correlation for long-term series forecasting. <em>Adv. neural Inf. Process. Syst.</em><strong>34</strong>, 22419–22430 (2021).</cite> [<a href="https://scholar.google.com/scholar_lookup?Wu,%20H.,%20Xu,%20J.,%20Wang,%20J.%20&amp;%20Long,%20M.%20Autoformer:%20Decomposition%20transformers%20with%20auto-correlation%20for%20long-term%20series%20forecasting.%20Adv.%20neural%20Inf.%20Process.%20Syst.34,%2022419%E2%80%9322430%20(2021)." class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">Google Scholar</a>]</li>
<li id="CR54">
<span class="label">54.</span><cite>Stitsyuk, A. &amp; Choi, J. xpatch: Dual-stream time series forecasting with exponential seasonal-trend decomposition. In <em>Proc. of the AAAI Conference on Artificial Intelligence</em>, vol. 39, 20601–20609 (2025).</cite>
</li>
<li id="CR55">
<span class="label">55.</span><cite>Vaswani, A. Attention is all you need. <em>Advances in Neural Information Processing Systems</em> (2017).</cite>
</li>
<li id="CR56">
<span class="label">56.</span><cite>Wu, Y. &amp; He, K. Group normalization. In <em>Proc. of the European conference on computer vision (ECCV)</em>, 3–19 (2018).</cite>
</li>
</ul></section></section><section id="_ad93_" lang="en" class="associated-data"><h2 class="pmc_sec_title">Associated Data</h2>
<p class="font-secondary"><em>This section collects any data citations, data availability statements, or supplementary materials included in this article.</em></p>
<section id="_adsm93_" lang="en" class="supplementary-materials"><h3 class="pmc_sec_title">Supplementary Materials</h3>
<section class="sm xbox font-sm" id="db_ds_supplementary-material1_reqid_"><div class="media p"><div class="caption">
<a href="/articles/instance/12358577/bin/41467_2025_62901_MOESM1_ESM.pdf" data-ga-action="click_feat_suppl" class="usa-link">Supplementary Information</a><sup> (11.9MB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="db_ds_supplementary-material2_reqid_"><div class="media p"><div class="caption">
<a href="/articles/instance/12358577/bin/41467_2025_62901_MOESM2_ESM.pdf" data-ga-action="click_feat_suppl" class="usa-link">Transparent Peer Review file</a><sup> (9.5MB, pdf) </sup>
</div></div></section><section class="sm xbox font-sm" id="db_ds_supplementary-material3_reqid_"><div class="media p"><div class="caption">
<a href="/articles/instance/12358577/bin/41467_2025_62901_MOESM3_ESM.xlsx" data-ga-action="click_feat_suppl" class="usa-link">Source data</a><sup> (4MB, xlsx) </sup>
</div></div></section></section><section id="_adda93_" lang="en" class="data-availability-statement"><h3 class="pmc_sec_title">Data Availability Statement</h3>
<p>The MODIS Chl_a data used in this study have been publicly available in the Moderate Resolution Imaging Spectroradiometer (MODIS) Aqua projects<sup><a href="#CR33" class="usa-link" aria-describedby="CR33">33</a></sup> (<a href="https://search.earthdata.nasa.gov/search?q=10.5067/AQUA/MODIS/L3M/CHL/2022" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://search.earthdata.nasa.gov/search?q=10.5067/AQUA/MODIS/L3M/CHL/2022</a>). The processed MODIS Chl_a data is available on Zenodo at 10.5281/zenodo.14638405. Source data are provided with this paper. We also uploaded all scripts and materials to reproduce all the analyses at <a href="https://stimp-tutorials.readthedocs.io/en/latest/" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://stimp-tutorials.readthedocs.io/en/latest/</a>. <a href="#Sec19" class="usa-link">Source data</a> are provided with this paper.</p>
<p>The STIMP software package and source code are available on GitHub at <a href="https://github.com/YangLabHKUST/STIMP.git" class="usa-link usa-link--external" data-ga-action="click_feat_suppl" target="_blank" rel="noopener noreferrer">https://github.com/YangLabHKUST/STIMP.git</a>. We also uploaded all scripts and materials to reproduce all the analyses at the same website.</p></section></section></section><footer class="p courtesy-note font-secondary font-sm text-center"><hr class="headless">
<p>Articles from Nature Communications are provided here courtesy of <strong>Nature Publishing Group</strong></p></footer></section></article>

                      

                    </main>
                </div>
            </div>
        </div>

        



<!-- Secondary navigation placeholder -->
<div class="pmc-sidenav desktop:grid-col-4 display-flex">
    <section class="pmc-sidenav__container" aria-label="Article resources and navigation">
        <button type="button" class="usa-button pmc-sidenav__container__close usa-button--unstyled">
            <img src="/static/img/usa-icons/close.svg" role="img" alt="Close" />
        </button>
    <div class="display-none desktop:display-block">
       <section class="margin-top-4 desktop:margin-top-0">
              <h2 class="margin-top-0">ACTIONS</h2>
           <ul class="usa-list usa-list--unstyled usa-list--actions">
               
               <li>
                     <a
                             href="https://doi.org/10.1038/s41467-025-62901-9"
                             class="usa-button usa-button--outline width-24 font-xs display-inline-flex flex-align-center flex-justify-start padding-left-1"
                             target="_blank"
                             rel="noreferrer noopener"
                             data-ga-category="actions"
                             data-ga-action="click"
                             data-ga-label="publisher_link_desktop"
                     >
                         <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img" hidden>
                            <use xlink:href="/static/img/sprite.svg#launch"></use>
                         </svg>
                         <span class="display-inline-flex flex-justify-center flex-1 padding-right-2">View on publisher site</span>
                     </a>
               </li>
               
               
               <li>
                    <a
                            href="pdf/41467_2025_Article_62901.pdf"
                            class="usa-button usa-button--outline width-24 display-inline-flex flex-align-center flex-justify-start padding-left-1"
                            data-ga-category="actions"
                            data-ga-action="click"
                            data-ga-label="pdf_download_desktop"
                    >
                         <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img" hidden>
                            <use xlink:href="/static/img/sprite.svg#file_download"></use>
                        </svg>
                        <span class="display-inline-flex flex-justify-center flex-1">PDF (3.7 MB)</span>
                    </a>
               </li>
               
                
               <li>
                   <button role="button" class="usa-button width-24 citation-dialog-trigger display-inline-flex flex-align-center flex-justify-start padding-left-1"
                        aria-label="Open dialog with citation text in different styles"
                        data-ga-category="actions"
                        data-ga-action="open"
                        data-ga-label="cite_desktop"
                        data-all-citations-url="/resources/citations/12358577/"
                        data-citation-style="nlm"
                        data-download-format-link="/resources/citations/12358577/export/"
                    >
                        <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img" hidden>
                            <use xlink:href="/static/img/sprite.svg#format_quote"></use>
                        </svg>
                       <span class="display-inline-flex flex-justify-center flex-1 button-label">Cite</span>
                    </button>
               </li>
                
               <li>

                        <button class="usa-button width-24 collections-dialog-trigger collections-button display-inline-flex flex-align-center flex-justify-start padding-left-1 collections-button-empty"
                              aria-label="Save article in MyNCBI collections."
                              data-ga-category="actions"
                              data-ga-action="click"
                              data-ga-label="collections_button_desktop"
                              data-collections-open-dialog-enabled="false"
                              data-collections-open-dialog-url="https://account.ncbi.nlm.nih.gov/?back_url=https%3A%2F%2Fpmc.ncbi.nlm.nih.gov%2Farticles%2FPMC12358577%2F%3Freport%3Dclassic%23open-collections-dialog"
                              data-in-collections="false">
                            <svg class="usa-icon width-3 height-3 usa-icon--bookmark-full" aria-hidden="true" focusable="false" role="img" hidden>
                                <use xlink:href="/static/img/action-bookmark-full.svg#icon"></use>
                            </svg>
                            <svg class="usa-icon width-3 height-3 usa-icon--bookmark-empty" aria-hidden="true" focusable="false" role="img" hidden>
                                <use xlink:href="/static/img/action-bookmark-empty.svg#icon"></use>
                            </svg>
                            <span class="display-inline-flex flex-justify-center flex-1">Collections</span>
                       </button>
               </li>
               <li class="pmc-permalink">
                    <button
                            type="button"
                            class="usa-button width-24 display-inline-flex flex-align-center flex-justify padding-left-1 shadow-none"
                            aria-label="Show article permalink"
                            aria-expanded="false"
                            aria-haspopup="true"
                            data-ga-category="actions"
                            data-ga-action="open"
                            data-ga-label="permalink_desktop"
                    >
                         <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img" hidden>
                            <use xlink:href="/static/img/sprite.svg#share"></use>
                        </svg>
                        <span class="display-inline-flex flex-justify-center flex-1 button-label">Permalink</span>
                    </button>
                   

<div class="pmc-permalink__dropdown" hidden>
    <div class="pmc-permalink__dropdown__container">
          <h2 class="usa-modal__heading margin-top-0 margin-bottom-2 text-uppercase font-sans-xs">PERMALINK</h2>
          <div class="pmc-permalink__dropdown__content">
              <input type="text" class="usa-input" value="https://pmc.ncbi.nlm.nih.gov/articles/PMC12358577/" aria-label="Article permalink">
              <button class="usa-button display-inline-flex pmc-permalink__dropdown__copy__btn margin-right-0" title="Copy article permalink" data-ga-category="save_share" data-ga-action="link" data-ga-label="copy_link">
                  <svg class="usa-icon" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#content_copy"></use>
                  </svg>
                  <span class="margin-left-1">Copy</span>
              </button>
          </div>
    </div>
</div>
               </li>
           </ul>
       </section>
     </div>

        <section class="pmc-resources margin-top-6 desktop:margin-top-4" data-page-path="/articles/PMC12358577/">
            <h2 class="margin-top-0">RESOURCES</h2>
            
                <div class="usa-accordion usa-accordion--multiselectable" data-allow-multiple>
                    <h3 class="usa-accordion__heading">
                        <button
                        type="button"
                        class="usa-accordion__button"
                        aria-expanded="false"
                        aria-controls="resources-similar-articles"
                        data-ga-category="resources_accordion"
                        data-ga-action="open_similar_articles"
                        data-ga-label="/articles/PMC12358577/"
                        data-action-open="open_similar_articles"
                        data-action-close="close_similar_articles"
                        >
                            Similar articles
                        </button>
                    </h3>
                    <div
                            id="resources-similar-articles"
                            class="usa-accordion__content usa-prose"
                            
                                data-source-url="/resources/similar-article-links/40820013/"
                            
                    >
                        
                    </div>
                    <h3 class="usa-accordion__heading">
                        <button
                        type="button"
                        class="usa-accordion__button"
                        aria-expanded="false"
                        aria-controls="resources-cited-by-other-articles"
                        data-ga-category="resources_accordion"
                        data-ga-action="open_cited_by"
                        data-ga-label="/articles/PMC12358577/"
                        data-action-open="open_cited_by"
                        data-action-close="close_cited_by"
                        >
                             Cited by other articles
                        </button>
                    </h3>
                    <div
                            id="resources-cited-by-other-articles"
                            class="usa-accordion__content usa-prose"
                            
                                data-source-url="/resources/cited-by-links/40820013/"
                            
                    >
                          
                    </div>
                    
                        <h3 class="usa-accordion__heading">
                            <button
                            type="button"
                            class="usa-accordion__button"
                            aria-expanded="false"
                            aria-controls="resources-links-to-ncbi-databases"
                            data-ga-category="resources_accordion"
                            data-ga-action="open_NCBI_links"
                            data-ga-label="/articles/PMC12358577/"
                            data-action-open="open_NCBI_links"
                            data-action-close="close_NCBI_link"
                            >
                                 Links to NCBI Databases
                            </button>
                        </h3>
                        <div
                                id="resources-links-to-ncbi-databases"
                                class="usa-accordion__content usa-prose"
                                data-source-url="/resources/db-links/12358577/"
                        >
                        </div>
                    
                    
                </div>
            
        </section>


        <section
        class="usa-in-page-nav usa-in-page-nav--wide margin-top-6 desktop:margin-top-4"
        data-title-text="On this page"
        data-title-heading-level="h2"
        data-scroll-offset="0"
        data-root-margin="-10% 0px -80% 0px"
        data-main-content-selector="main"
        data-threshold="1"
        hidden
        ></section>
    </section>
</div>


        

<div class="overlay" role="dialog" aria-label="Citation Dialog" hidden>
    <div class="dialog citation-dialog" aria-hidden="true">
        <div class="display-inline-flex flex-align-center flex-justify width-full margin-bottom-2">
            <h2 class="usa-modal__heading margin-0">Cite</h2>
             <button type="button" class="usa-button usa-button--unstyled close-overlay text-black width-auto"  tabindex="1">
                <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#close"></use>
                </svg>
             </button>
        </div>

        

<div class="citation-text-block">
  <div class="citation-text margin-bottom-2"></div>
  <ul class="usa-list usa-list--unstyled display-inline-flex flex-justify width-full flex-align-center">
      <li>
        <button
          class="usa-button usa-button--unstyled text-no-underline display-flex flex-align-center copy-button dialog-focus"
          data-ga-category="save_share"
          data-ga-action="cite"
          data-ga-label="copy"
          tabindex="2">
            <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img">
                <use xlink:href="/static/img/sprite.svg#content_copy"></use>
            </svg>
            <span>Copy</span>
        </button>
      </li>
      <li>
          <a
              href="#"
              role="button"
              class="usa-button usa-button--unstyled text-no-underline display-flex flex-align-center export-button"
              data-ga-category="save_share"
              data-ga-action="cite"
              data-ga-label="download"
              title="Download a file for external citation management software"
              tabindex="3">
                <svg class="usa-icon width-3 height-3" aria-hidden="true" focusable="false" role="img">
                    <use xlink:href="/static/img/sprite.svg#file_download"></use>
                </svg>
                <span class="display-none mobile-lg:display-inline">Download .nbib</span>
                <span class="display-inline mobile-lg:display-none">.nbib</span>
            </a>
      </li>
      <li>
          

<div class="display-inline-flex flex-align-center">
  <label class="usa-label margin-top-0">Format:</label>
  <select aria-label="Format" class="usa-select citation-style-selector padding-1 margin-top-0 border-0 padding-right-4" tabindex="4" >
    
      <option data-style-url-name="ama"
              value="AMA"
              >
        AMA
      </option>
    
      <option data-style-url-name="apa"
              value="APA"
              >
        APA
      </option>
    
      <option data-style-url-name="mla"
              value="MLA"
              >
        MLA
      </option>
    
      <option data-style-url-name="nlm"
              value="NLM"
              selected="selected">
        NLM
      </option>
    
  </select>
</div>
      </li>
  </ul>
</div>
    </div>
</div>

        <div class="overlay" role="dialog" hidden>
  <div id="collections-action-dialog" class="dialog collections-dialog" aria-hidden="true">
   <div class="display-inline-flex flex-align-center flex-justify width-full margin-bottom-2">
        <h2 class="usa-modal__heading margin-0">Add to Collections</h2>
    </div>
    <div class="collections-action-panel action-panel">
      


<form id="collections-action-dialog-form"
      class="usa-form maxw-full collections-action-panel-form action-panel-content action-form action-panel-smaller-selectors"
      data-existing-collections-url="/list-existing-collections/"
      data-add-to-existing-collection-url="/add-to-existing-collection/"
      data-create-and-add-to-new-collection-url="/create-and-add-to-new-collection/"
      data-myncbi-max-collection-name-length="100"
      data-collections-root-url="https://www.ncbi.nlm.nih.gov/myncbi/collections/">

    <input type="hidden" name="csrfmiddlewaretoken" value="kAAHp8mR8AFQxoHAF828d8Q3ggWFwGZucYx21nr65EQZUZWw61k4uRMlBIYrpUyu">

    <fieldset class="usa-fieldset margin-bottom-2">
        <div class="usa-radio">
            <input type="radio"
            id="collections-action-dialog-new"
            class="usa-radio__input usa-radio__input--tile collections-new  margin-top-0"
            name="collections"
            value="new"
            data-ga-category="collections_button"
            data-ga-action="click"
            data-ga-label="collections_radio_new" />
            <label class="usa-radio__label" for="collections-action-dialog-new">Create a new collection</label>
        </div>
        <div class="usa-radio">
            <input type="radio"
            id="collections-action-dialog-existing"
            class="usa-radio__input usa-radio__input--tile collections-existing"
            name="collections"
            value="existing"
            checked="true"
            data-ga-category="collections_button"
            data-ga-action="click"
            data-ga-label="collections_radio_existing" />
            <label class="usa-radio__label" for="collections-action-dialog-existing">Add to an existing collection</label>
        </div>
    </fieldset>

    <fieldset class="usa-fieldset margin-bottom-2">
        <div class="action-panel-control-wrap new-collections-controls">
           <label for="collections-action-dialog-add-to-new" class="usa-label margin-top-0">
                Name your collection
               <abbr title="required" class="usa-hint usa-hint--required text-no-underline">*</abbr>
          </label>
          <input
            type="text"
            name="add-to-new-collection"
            id="collections-action-dialog-add-to-new"
            class="usa-input collections-action-add-to-new"
            pattern="[^&quot;&amp;=&lt;&gt;/]*" title="The following characters are not allowed in the Name field: &quot;&amp;=&lt;&gt;/"
            maxlength=""
            data-ga-category="collections_button"
            data-ga-action="create_collection"
            data-ga-label="non_favorties_collection"
            required
          />
        </div>
        <div class="action-panel-control-wrap existing-collections-controls">
             <label for="collections-action-dialog-add-to-existing" class="usa-label margin-top-0">
                Choose a collection
              </label>
              <select id="collections-action-dialog-add-to-existing"
                      class="usa-select collections-action-add-to-existing"
                      data-ga-category="collections_button"
                      data-ga-action="select_collection"
                      data-ga-label="($('.collections-action-add-to-existing').val() === 'Favorites') ? 'Favorites' : 'non_favorites_collection'">
              </select>
              <div class="collections-retry-load-on-error usa-input-error-message selection-validation-message">
                Unable to load your collection due to an error<br>
                <a href="#">Please try again</a>
              </div>
        </div>
    </fieldset>

    <div class="display-inline-flex">
        <button class="usa-button margin-top-0 action-panel-submit"
            type="submit"
            data-loading-label="Adding..."
            data-pinger-ignore
            data-ga-category="collections_button"
            data-ga-action="click"
            data-ga-label="add">
          Add
        </button>
        <button class="usa-button usa-button--outline margin-top-0 action-panel-cancel"
                aria-label="Close 'Add to Collections' panel"
                ref="linksrc=close_collections_panel"
                data-ga-category="collections_button"
                data-ga-action="click"
                data-ga-label="cancel">
          Cancel
        </button>
    </div>
</form>
    </div>
  </div>
</div>

        

      </div>
    </div>
  </div>



        
    
    

<footer class="ncbi-footer ncbi-dark-background " >
    
        <div class="ncbi-footer__icon-section">
            <div class="ncbi-footer__social-header">
                Follow NCBI
            </div>

            <div class="grid-container ncbi-footer__ncbi-social-icons-container">
                
                    <a href="https://twitter.com/ncbi"
                       class="ncbi-footer__social-icon ncbi-footer__social-icon--gray"
                       target="_blank"
                       rel="noreferrer noopener">
                        <svg width="40"
                             height="40"
                             viewBox="0 0 40 40"
                             fill="none"
                             xmlns="http://www.w3.org/2000/svg"
                             focusable="false"
                             aria-hidden="true">
                            <path d="m6.067 8 10.81 13.9L6 33.2h4.2l8.4-9.1 7.068 9.1H34L22.8 18.5 31.9 8h-3.5l-7.7 8.4L14.401 8H6.067Zm3.6 1.734h3.266l16.8 21.732H26.57L9.668 9.734Z">
                            </path>
                        </svg>
                        <span class="usa-sr-only">NCBI on X (formerly known as Twitter)</span>
                    </a>
                

                
                    <a href="https://www.facebook.com/ncbi.nlm"
                       class="ncbi-footer__social-icon ncbi-footer__social-icon--gray"
                       target="_blank"
                       rel="noreferrer noopener">
                        <svg width="16"
                             height="29"
                             focusable="false"
                             aria-hidden="true"
                             viewBox="0 0 16 29"
                             fill="none"
                             xmlns="http://www.w3.org/2000/svg">
                            <path d="M3.8809 21.4002C3.8809 19.0932 3.8809 16.7876 3.8809 14.478C3.8809 14.2117 3.80103 14.1452 3.54278 14.1492C2.53372 14.1638 1.52334 14.1492 0.514288 14.1598C0.302626 14.1598 0.248047 14.0972 0.248047 13.8936C0.256034 12.4585 0.256034 11.0239 0.248047 9.58978C0.248047 9.37013 0.302626 9.30224 0.528931 9.3049C1.53798 9.31688 2.54837 9.3049 3.55742 9.31555C3.80103 9.31555 3.8809 9.26097 3.87957 9.00272C3.87158 8.00565 3.85428 7.00592 3.90753 6.00884C3.97142 4.83339 4.31487 3.73115 5.04437 2.78467C5.93095 1.63318 7.15699 1.09005 8.56141 0.967577C10.5582 0.79319 12.555 0.982221 14.5518 0.927641C14.7102 0.927641 14.7462 0.99287 14.7449 1.13664C14.7449 2.581 14.7449 4.02668 14.7449 5.47104C14.7449 5.67604 14.6517 5.68669 14.4946 5.68669C13.4523 5.68669 12.4113 5.68669 11.3703 5.68669C10.3506 5.68669 9.92057 6.10868 9.90593 7.13904C9.89661 7.7647 9.91525 8.39303 9.89794 9.01869C9.88995 9.26364 9.96583 9.31822 10.2015 9.31688C11.7204 9.30623 13.2393 9.31688 14.7595 9.3049C15.0257 9.3049 15.0723 9.3728 15.0444 9.62439C14.89 10.9849 14.7515 12.3467 14.6144 13.7085C14.5691 14.1571 14.5785 14.1585 14.1458 14.1585C12.8386 14.1585 11.5313 14.1665 10.2254 14.1518C9.95119 14.1518 9.89794 14.2317 9.89794 14.4899C9.90593 19.0799 9.89794 23.6752 9.91125 28.2612C9.91125 28.5674 9.8407 28.646 9.53186 28.6433C7.77866 28.6273 6.02414 28.6366 4.27094 28.634C3.82499 28.634 3.87158 28.6992 3.87158 28.22C3.87602 25.9472 3.87913 23.6739 3.8809 21.4002Z">
                            </path>
                        </svg>
                        <span class="usa-sr-only">NCBI on Facebook</span>
                    </a>
                

                
                    <a href="https://www.linkedin.com/company/ncbinlm"
                       class="ncbi-footer__social-icon ncbi-footer__social-icon--gray"
                       target="_blank"
                       rel="noreferrer noopener">
                        <svg width="25"
                             height="23"
                             viewBox="0 0 26 24"
                             fill="none"
                             xmlns="http://www.w3.org/2000/svg"
                             focusable="false"
                             aria-hidden="true">
                            <path d="M14.6983 9.98423C15.6302 9.24808 16.5926 8.74754 17.6762 8.51991C19.673 8.09126 21.554 8.30824 23.1262 9.7526C24.2351 10.7723 24.7529 12.1115 25.0165 13.5612C25.1486 14.3363 25.2105 15.1218 25.2015 15.9081C25.2015 18.3043 25.2015 20.6898 25.2082 23.0806C25.2082 23.3468 25.1549 23.444 24.8621 23.4414C23.1297 23.4272 21.3992 23.4272 19.6704 23.4414C19.4041 23.4414 19.3429 23.3588 19.3442 23.1019C19.3535 20.5194 19.3442 17.9368 19.3442 15.3543C19.3442 14.0005 18.3258 12.9448 17.0266 12.9488C15.7273 12.9528 14.6983 14.0071 14.6983 15.361C14.6983 17.9328 14.6917 20.5047 14.6983 23.0753C14.6983 23.3708 14.6198 23.444 14.3296 23.4427C12.6185 23.4294 10.9079 23.4294 9.19779 23.4427C8.93155 23.4427 8.86099 23.3735 8.86232 23.1086C8.8783 19.7619 8.88628 16.4144 8.88628 13.066C8.88628 11.5688 8.87874 10.0708 8.86365 8.57182C8.86365 8.3575 8.90758 8.27896 9.14054 8.28029C10.9048 8.29094 12.6687 8.29094 14.4321 8.28029C14.6464 8.28029 14.6983 8.34818 14.6983 8.54653C14.6903 9.00047 14.6983 9.45441 14.6983 9.98423Z">
                            </path>
                            <path d="M6.55316 15.8443C6.55316 18.2564 6.55316 20.6699 6.55316 23.082C6.55316 23.3629 6.48127 23.4388 6.19906 23.4374C4.47737 23.4241 2.75568 23.4241 1.03399 23.4374C0.767751 23.4374 0.69986 23.3629 0.701191 23.1006C0.709178 18.2648 0.709178 13.4281 0.701191 8.59053C0.701191 8.34026 0.765089 8.27237 1.01669 8.2737C2.74991 8.28435 4.48048 8.28435 6.20838 8.2737C6.47462 8.2737 6.5465 8.33627 6.54517 8.6065C6.54783 11.0186 6.55316 13.4308 6.55316 15.8443Z">
                            </path>
                            <path d="M3.65878 0.243898C5.36804 0.243898 6.58743 1.45529 6.58743 3.1406C6.58743 4.75801 5.32145 5.95742 3.60819 5.96807C3.22177 5.97614 2.83768 5.90639 2.47877 5.76299C2.11985 5.61959 1.79344 5.40546 1.51897 5.13334C1.24449 4.86123 1.02755 4.53668 0.881058 4.17902C0.734563 3.82136 0.661505 3.43788 0.666231 3.05141C0.67555 1.42601 1.9362 0.242566 3.65878 0.243898Z">
                            </path>
                        </svg>
                        <span class="usa-sr-only">NCBI on LinkedIn</span>
                    </a>
                

                
                    <a href="https://github.com/ncbi"
                       class="ncbi-footer__social-icon ncbi-footer__social-icon--gray"
                       target="_blank"
                       rel="noreferrer noopener">
                        <svg width="28"
                             height="27"
                             viewBox="0 0 28 28"
                             fill="none"
                             xmlns="http://www.w3.org/2000/svg"
                             focusable="false"
                             aria-hidden="true">
                            <path d="M16.7228 20.6334C17.5057 20.5527 18.2786 20.3944 19.0301 20.1608C21.3108 19.4193 22.5822 17.8259 22.963 15.4909C23.1228 14.5112 23.1814 13.5287 22.9883 12.5437C22.8106 11.6423 22.4013 10.8028 21.8007 10.1076C21.7526 10.0605 21.7197 10 21.7064 9.934C21.6931 9.86799 21.7 9.79952 21.7262 9.73748C22.0856 8.6206 21.9711 7.51969 21.601 6.42677C21.582 6.3497 21.5345 6.2827 21.468 6.23923C21.4016 6.19577 21.3211 6.17906 21.2429 6.19248C20.7329 6.21649 20.2313 6.33051 19.7611 6.52928C19.1103 6.7908 18.4899 7.12198 17.9104 7.51703C17.84 7.56996 17.7581 7.60551 17.6713 7.62078C17.5846 7.63605 17.4954 7.6306 17.4112 7.60489C15.2596 7.05882 13.0054 7.06203 10.8554 7.61421C10.7806 7.63586 10.7018 7.63967 10.6253 7.62534C10.5487 7.611 10.4766 7.57892 10.4148 7.53167C9.64788 7.03247 8.85171 6.58918 7.96368 6.33359C7.65781 6.24338 7.34123 6.19458 7.02239 6.18849C6.94879 6.17986 6.87462 6.19893 6.81432 6.242C6.75402 6.28507 6.71191 6.34904 6.69621 6.42145C6.32342 7.51437 6.2209 8.61527 6.56307 9.73348C6.59635 9.84264 6.64694 9.93316 6.54177 10.0516C5.47666 11.2604 5.09988 12.6834 5.19574 14.2676C5.2663 15.4244 5.46201 16.5466 6.01454 17.5769C6.84399 19.1171 8.21664 19.9119 9.85158 20.3352C10.3938 20.4706 10.9444 20.5698 11.4998 20.632C11.5384 20.7492 11.4506 20.7798 11.408 20.8291C11.1734 21.1179 10.9894 21.4441 10.8634 21.7942C10.7622 22.0458 10.8315 22.4039 10.6065 22.5516C10.263 22.7766 9.83827 22.8485 9.42421 22.8871C8.17936 23.0056 7.26471 22.4877 6.6283 21.4348C6.25552 20.8184 5.76956 20.3325 5.08523 20.0663C4.76981 19.9325 4.42139 19.8967 4.08537 19.9638C3.7898 20.029 3.73788 20.1901 3.93891 20.4111C4.03639 20.5234 4.14989 20.6207 4.27575 20.6999C4.9796 21.1318 5.51717 21.7884 5.80152 22.5636C6.37002 23.9973 7.48039 24.5697 8.93825 24.6323C9.43741 24.6575 9.93768 24.615 10.4254 24.5058C10.5892 24.4672 10.6531 24.4872 10.6517 24.6762C10.6451 25.4936 10.6637 26.3123 10.6517 27.131C10.6517 27.6635 10.1684 27.9297 9.58663 27.7393C8.17396 27.2671 6.84977 26.5631 5.66838 25.656C2.59555 23.2891 0.720966 20.1861 0.217704 16.3376C-0.357453 11.9127 0.911353 8.00824 3.98551 4.73881C6.11909 2.42656 8.99932 0.939975 12.1203 0.540191C16.5351 -0.0601815 20.4347 1.14323 23.7232 4.16373C26.2449 6.47869 27.724 9.37672 28.1048 12.7726C28.5828 17.0325 27.3686 20.7945 24.4768 23.9827C22.9762 25.6323 21.0956 26.8908 18.9982 27.6488C18.8783 27.6927 18.7585 27.738 18.636 27.7726C18.0356 27.9404 17.6189 27.6395 17.6189 27.0098C17.6189 25.7452 17.6308 24.4806 17.6295 23.2159C17.6329 22.9506 17.6128 22.6856 17.5696 22.4238C17.4325 21.6664 17.3419 21.484 16.7228 20.6334Z">
                            </path>
                        </svg>
                        <span class="usa-sr-only">NCBI on GitHub</span>
                    </a>
                

                
                    <a href="https://ncbiinsights.ncbi.nlm.nih.gov/"
                       class="ncbi-footer__social-icon ncbi-footer__social-icon--gray"
                       target="_blank"
                       rel="noreferrer noopener">
                        <svg width="26"
                             height="26"
                             viewBox="0 0 27 27"
                             fill="none"
                             xmlns="http://www.w3.org/2000/svg"
                             focusable="false"
                             aria-hidden="true">
                            <path d="M23.7778 26.4574C23.1354 26.3913 22.0856 26.8024 21.636 26.3087C21.212 25.8444 21.4359 24.8111 21.324 24.0347C19.9933 14.8323 14.8727 8.80132 6.09057 5.85008C4.37689 5.28406 2.58381 4.99533 0.779072 4.99481C0.202773 4.99481 -0.0229751 4.83146 0.00455514 4.21479C0.0660406 3.08627 0.0660406 1.95525 0.00455514 0.826734C-0.0413285 0.0815827 0.259669 -0.0193618 0.896534 0.00266238C6.96236 0.222904 12.3693 2.24179 16.9889 6.16209C22.9794 11.2478 26.1271 17.7688 26.4372 25.648C26.4629 26.294 26.3179 26.5271 25.6609 26.4684C25.0827 26.417 24.4991 26.4574 23.7778 26.4574Z">
                            </path>
                            <path d="M14.8265 26.441C14.0924 26.441 13.2371 26.6795 12.6626 26.3786C12.0092 26.0372 12.3781 25.0644 12.246 24.378C11.1154 18.5324 6.6849 14.5497 0.74755 14.1001C0.217135 14.0615 -0.0104482 13.9422 0.0134113 13.3659C0.0519536 12.1454 0.0482829 10.9213 0.0134113 9.69524C-0.00127145 9.14464 0.196946 9.03268 0.703502 9.04736C9.21217 9.27128 16.5994 16.2511 17.2804 24.7231C17.418 26.4446 17.418 26.4446 15.6579 26.4446H14.832L14.8265 26.441Z">
                            </path>
                            <path d="M3.58928 26.4555C2.64447 26.4618 1.73584 26.0925 1.06329 25.4289C0.39073 24.7653 0.00933763 23.8617 0.0030097 22.9169C-0.00331824 21.9721 0.365937 21.0635 1.02954 20.3909C1.69315 19.7184 2.59675 19.337 3.54156 19.3306C4.48637 19.3243 5.39499 19.6936 6.06755 20.3572C6.7401 21.0208 7.1215 21.9244 7.12782 22.8692C7.13415 23.814 6.7649 24.7226 6.10129 25.3952C5.43768 26.0677 4.53409 26.4491 3.58928 26.4555Z">
                            </path>
                        </svg>
                        <span class="usa-sr-only">NCBI RSS feed</span>
                    </a>
                
            </div>
        </div>
    

    <div data-testid="gridContainer"
         class="grid-container ncbi-footer__container">
        <div class="grid-row ncbi-footer__main-content-container"
             data-testid="grid">
            
                <div class="ncbi-footer__column">
                    
                        <p class="ncbi-footer__circled-icons-heading">
                            Connect with NLM
                        </p>
                    

                    <div class="ncbi-footer__circled-icons-list">
                        
                            <a href=https://twitter.com/nlm_nih class="ncbi-footer__social-icon ncbi-footer__social-icon--circled" target="_blank" rel="noreferrer noopener">
                                <svg width="32"
                                     height="32"
                                     viewBox="0 0 40 40"
                                     fill="none"
                                     xmlns="http://www.w3.org/2000/svg"
                                     focusable="false"
                                     aria-hidden="true">
                                    <path d="m6.067 8 10.81 13.9L6 33.2h4.2l8.4-9.1 7.068 9.1H34L22.8 18.5 31.9 8h-3.5l-7.7 8.4L14.401 8H6.067Zm3.6 1.734h3.266l16.8 21.732H26.57L9.668 9.734Z">
                                    </path>
                                </svg>
                                <span class="usa-sr-only">NLM on X (formerly known as Twitter)</span>
                            </a>
                        

                        
                            <a href=https://www.facebook.com/nationallibraryofmedicine class="ncbi-footer__social-icon ncbi-footer__social-icon--circled" target="_blank" rel="noreferrer noopener">
                                <svg width="13"
                                     height="24"
                                     viewBox="0 0 13 24"
                                     fill="none"
                                     xmlns="http://www.w3.org/2000/svg"
                                     focusable="false"
                                     aria-hidden="true">
                                    <path d="M4.11371 23.1369C4.11371 23.082 4.11371 23.0294 4.11371 22.9745V12.9411H0.817305C0.6709 12.9411 0.670898 12.9411 0.670898 12.8016C0.670898 11.564 0.670898 10.3287 0.670898 9.09341C0.670898 8.97903 0.705213 8.95158 0.815017 8.95158C1.8673 8.95158 2.91959 8.95158 3.97417 8.95158H4.12057V8.83263C4.12057 7.8055 4.12057 6.7738 4.12057 5.74897C4.1264 4.92595 4.31387 4.11437 4.66959 3.37217C5.12916 2.38246 5.94651 1.60353 6.95717 1.1921C7.64827 0.905008 8.3913 0.764035 9.13953 0.778051C10.0019 0.791777 10.8644 0.830666 11.7268 0.860404C11.8869 0.860404 12.047 0.894717 12.2072 0.90158C12.2964 0.90158 12.3261 0.940469 12.3261 1.02968C12.3261 1.5421 12.3261 2.05452 12.3261 2.56465C12.3261 3.16857 12.3261 3.7725 12.3261 4.37642C12.3261 4.48165 12.2964 4.51367 12.1912 4.51138C11.5369 4.51138 10.8804 4.51138 10.2261 4.51138C9.92772 4.51814 9.63058 4.5526 9.33855 4.61433C9.08125 4.6617 8.84537 4.78881 8.66431 4.97766C8.48326 5.16652 8.3662 5.40755 8.32972 5.66661C8.28476 5.89271 8.26027 6.1224 8.25652 6.35289C8.25652 7.19014 8.25652 8.02969 8.25652 8.86923C8.25652 8.89439 8.25652 8.91955 8.25652 8.95615H12.0219C12.1797 8.95615 12.182 8.95616 12.1614 9.10714C12.0768 9.76596 11.9876 10.4248 11.9029 11.0813C11.8312 11.6319 11.7626 12.1824 11.697 12.733C11.6719 12.9434 11.6787 12.9434 11.4683 12.9434H8.26338V22.899C8.26338 22.979 8.26338 23.0591 8.26338 23.1392L4.11371 23.1369Z">
                                    </path>
                                </svg>
                                <span class="usa-sr-only">NLM on Facebook</span>
                            </a>
                        

                        
                            <a href=https://www.youtube.com/user/NLMNIH class="ncbi-footer__social-icon ncbi-footer__social-icon--circled" target="_blank" rel="noreferrer noopener">
                                <svg width="21"
                                     height="15"
                                     viewBox="0 0 21 15"
                                     fill="none"
                                     xmlns="http://www.w3.org/2000/svg"
                                     focusable="false"
                                     aria-hidden="true">
                                    <path d="M19.2561 1.47914C18.9016 1.15888 18.5699 0.957569 17.2271 0.834039C15.5503 0.678484 13.2787 0.655608 11.563 0.65332H9.43556C7.71987 0.65332 5.4483 0.678484 3.77151 0.834039C2.43098 0.957569 2.097 1.15888 1.74242 1.47914C0.813665 2.32097 0.619221 4.62685 0.598633 6.89384C0.598633 7.31781 0.598633 7.74101 0.598633 8.16345C0.626084 10.4121 0.827391 12.686 1.74242 13.521C2.097 13.8412 2.4287 14.0425 3.77151 14.1661C5.4483 14.3216 7.71987 14.3445 9.43556 14.3468H11.563C13.2787 14.3468 15.5503 14.3216 17.2271 14.1661C18.5676 14.0425 18.9016 13.8412 19.2561 13.521C20.1712 12.6929 20.3725 10.451 20.3999 8.22064C20.3999 7.74025 20.3999 7.25986 20.3999 6.77946C20.3725 4.54907 20.1689 2.30724 19.2561 1.47914ZM8.55942 10.5311V4.65201L13.5601 7.50005L8.55942 10.5311Z"
                                          fill="white" />
                                </svg>
                                <span class="usa-sr-only">NLM on YouTube</span>
                            </a>
                        
                    </div>
                </div>
            

            
                <address class="ncbi-footer__address ncbi-footer__column">
                    
        <p>
            <a class="usa-link usa-link--external"
            href="https://www.google.com/maps/place/8600+Rockville+Pike,+Bethesda,+MD+20894/%4038.9959508,
            -77.101021,17z/data%3D!3m1!4b1!4m5!3m4!1s0x89b7c95e25765ddb%3A0x19156f88b27635b8!8m2!3d38.9959508!
            4d-77.0988323"
            rel="noopener noreferrer" target="_blank">National Library of Medicine
            <br/> 8600 Rockville Pike<br/> Bethesda, MD 20894</a>
        </p>
    
                </address>
            

            
                <ul class="usa-list usa-list--unstyled ncbi-footer__vertical-list ncbi-footer__column">
                    
                        <li class="ncbi-footer__vertical-list-item">
                            









    <a href="https://www.nlm.nih.gov/web_policies.html" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            Web Policies
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__vertical-list-item">
                            









    <a href="https://www.nih.gov/institutes-nih/nih-office-director/office-communications-public-liaison/freedom-information-act-office" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            FOIA
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__vertical-list-item">
                            









    <a href="https://www.hhs.gov/vulnerability-disclosure-policy/index.html" class="usa-link usa-link--external usa-link--alt ncbi-footer__link" rel="noreferrer noopener" target='_blank' >
        

        
            HHS Vulnerability Disclosure
        

        
    </a>


                        </li>
                    
                </ul>
            

            
                <ul class="usa-list usa-list--unstyled ncbi-footer__vertical-list ncbi-footer__column">
                    
                        <li class="ncbi-footer__vertical-list-item">
                            









    <a href="https://support.nlm.nih.gov/" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            Help
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__vertical-list-item">
                            









    <a href="https://www.nlm.nih.gov/accessibility.html" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            Accessibility
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__vertical-list-item">
                            









    <a href="https://www.nlm.nih.gov/careers/careers.html" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            Careers
        

        
    </a>


                        </li>
                    
                </ul>
            
        </div>

        
            <div class="grid-row grid-col-12" data-testid="grid">
                <ul class="ncbi-footer__bottom-links-list">
                    
                        <li class="ncbi-footer__bottom-list-item">
                            









    <a href="https://www.nlm.nih.gov/" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            NLM
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__bottom-list-item">
                            









    <a href="https://www.nih.gov/" class="usa-link  usa-link--alt ncbi-footer__link"  >
        

        
            NIH
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__bottom-list-item">
                            









    <a href="https://www.hhs.gov/" class="usa-link usa-link--external usa-link--alt ncbi-footer__link" rel="noreferrer noopener" target='_blank' >
        

        
            HHS
        

        
    </a>


                        </li>
                    
                        <li class="ncbi-footer__bottom-list-item">
                            









    <a href="https://www.usa.gov/" class="usa-link usa-link--external usa-link--alt ncbi-footer__link" rel="noreferrer noopener" target='_blank' >
        

        
            USA.gov
        

        
    </a>


                        </li>
                    
                </ul>
            </div>
        
    </div>
</footer>

    


        
        
    
  <script  type="text/javascript" src="https://cdn.ncbi.nlm.nih.gov/core/pinger/pinger.js"> </script>


    
        

<button class="back-to-top" data-ga-category="pagination" data-ga-action="back_to_top">
    <label>Back to Top</label>
    <svg class="usa-icon order-0" aria-hidden="true" focusable="false" role="img">
        <use xlink:href="/static/img/sprite.svg#arrow_upward"></use>
    </svg>
</button>
    


        
    
    
    
        
    <script type="application/javascript">
    window.ncbi = window.ncbi || {};
    window.ncbi.pmc = window.ncbi.pmc || {};
    window.ncbi.pmc.options = {
        logLevel: 'INFO',
        
        staticEndpoint: '/static/',
        
        citeCookieName: 'pmc-cf',
    };
</script>
    <script type="module" crossorigin="" src="/static/assets/base-133c6271.js"></script>
    
    <script type="text/javascript" src="https://cdn.ncbi.nlm.nih.gov/core/jquery/jquery-3.6.0.min.js">&#xA0;</script>
    <script type="text/javascript">
        jQuery.getScript("https://cdn.ncbi.nlm.nih.gov/core/alerts/alerts.js", function () {
            galert(['div.nav_and_browser', 'div.header', '#universal_header', '.usa-banner', 'body > *:nth-child(1)'])
        });
    </script>


    <script type="text/javascript">var exports = {};</script>
     <script src="/static/CACHE/js/output.13b077bc3ffd.js"></script>

    <script type="module" crossorigin="" src="/static/assets/article-44d04358.js"></script>
    
        <script type="module" crossorigin="" src="/static/assets/math-574fdcc6.js"></script>
    
    

    </body>
</html>
