Standard protocols for meta-analysis of association studies are inadequate for microbiome data due to their complex compositional structure, leading to inaccurate and unstable microbial signature selection.
To address this issue, we introduce Melody, a framework that generates, harmonizes, and combines study-specific summary association statistics to powerfully and robustly identify microbial signatures in meta-analysis.
Comprehensive and realistic simulations demonstrate that Melody substantially outperforms existing approaches in prioritizing true signatures.
In the meta-analyses of five studies on colorectal cancer and eight studies on the gut metabolome, we showcase the superior stability, reliability, and predictive performance of Melody-identified signatures.
The online version contains supplementary material available at 10.1186/s13059-025-03721-4.
Advanced sequencing technologies have enabled the study of microbial communities that colonize the human body in a culture-independent manner [1].
Microbiome association analysis is routinely performed to discover microbial signatures associated with covariates such as health outcomes, exposures, and molecular traits.
The signature identified in one study is often hard to generalize to other cohorts and populations because of the small sample size in a single study.
A natural way to increase sample size is to perform meta-analyses.
Recent years have witnessed a surge in conducting meta-analyses of microbiome association studies [2–5].
Unfortunately, standard meta-analysis strategies commonly used in clinical and genomics studies fail to address the unique characteristics of microbiome data, undermining the ability of meta-analysis to identify generalizable microbial signatures.
Microbiome data generated from marker-gene or metagenomics sequencing contain sequencing read counts allocated to various microbial features, such as taxonomic and functional units [6].
The sequencing depth (the total number of reads obtained for a sample) is not correlated with the actual microbial load (the total amount of microorganisms or their DNA volumes) in the sample.
Therefore, microbiome data are compositional data that represent the relative abundance (RA) of microbial features.
These counts are distorted from the underlying absolute abundance (AA) per unit volume [7,8].
Although techniques have been developed to recover AA data [9–11], the cost is prohibitive and the effectiveness is debatable because they cannot correct measurement biases arising from different efficiencies (e.g., DNA extraction efficiency, primer binding, and amplification efficiency) with which various features are measured [12].
The RA of all features would shift even if only one feature changes in AA.
The small shift may be too subtle to affect the association analysis of a single study but would become more pronounced and impactful as the sample size and data heterogeneity accumulate in the meta-analysis.
Several compositionality-aware methods have been developed for microbiome association analysis [13–18].
These methods employ different strategies to address compositionality.
Methods such as ANCOM-BC2 [17], LinDA [15], and radEmu [18] explicitly estimate and correct compositional bias to recover AA association coefficients.
SRI [16] keeps the analysis on the relative scale but marginalizes over a prior for each sample’s unknown microbial load, so compositionality is treated as uncertainty rather than bias.
DR [13] ranks features using log-ratio comparisons to a reference frame.
While these methods are useful, they are not designed to estimate and harmonize AA association coefficients across studies for meta-analysis.
In addition to compositionality, other characteristics of microbiome data further compound the challenges of microbiome association meta-analyses.
The sequencing depth strongly influences the sequencing read counts.
Methods that fail to consider the variation in sequencing depth across samples can lead to a high number of false positives, particularly when the depths vary significantly between groups of comparison [19].
While rarefaction is commonly used to address uneven sequencing depth, it may reduce statistical power in certain analyses due to data loss introduced by subsampling [20,21].
Moreover, for many rare features, insufficient sampling and the absence of features result in an excessive number of zero counts.
Some features may be completely missing in a subset of studies in meta-analysis.
While the imputation of zero to non-zero values is a widely adopted practice in processing microbiome data, consensus on the best method is lacking even for data from a single study, and it may introduce additional bias to the analysis [19,22].
Filtering out rare features is another common practice under the belief that rare features are uninformative.
However, recent research has noted an alarming phenomenon that analysis with different filtering criteria can result in identifying very different sets of microbial signatures [23,24].
Pooling individual-level data and combining summary data are two types of meta-analysis strategies, each of which faces different challenges in microbiome association meta-analyses.
Pooled-data meta-analysis requires careful harmonization of individual-level data that usually involves correcting batch effects in microbiome data across studies.
The distribution of microbiome data can substantially differ among studies involving various age groups, genders, geographic regions, and measurement time points.
Batch effects can also occur in sequencing experiments due to differences in reagents, equipment, protocols, and personnel.
More importantly, batch effects are often entangled with association effects in microbiome studies [25–27].
Correcting batch effects while preserving the signal of interest is challenging due to the aforementioned characteristics of microbiome data.
Prior studies in genomics have shown that batch effect correction may distort associations in pooled-data meta-analyses [28–30].
Summary-data meta-analysis circumvents the need for individual-level data harmonization, as summary statistics are generated for each study separately.
This type of meta-analysis is preferable to pooled-data meta-analysis when there are differences in sample ascertainment and in data measurements and availability across studies.
If the individual-level data is not shared, the logistical burden and privacy concerns can be significantly reduced, especially when the data contain sensitive information such as genetics or medical history.
For these critical reasons, summary-data meta-analysis is widely adopted in many research fields, such as genetic association studies [31].
However, standard approaches for generating and combining summary statistics are inadequate for microbiome data due to their unique characteristics mentioned above.
We introduce a summary-data meta-analysis framework named Melody (meta-analysis for selecting microbial drivers in compositionality).
Melody generates accurate and robust summary association statistics between the RA of microbial features and the covariate of interest by respecting the microbiome data characteristics.
The procedure does not require microbiome data normalization, rarefaction, zero imputation, or batch effect correction across studies.
By harmonizing and combining the summary statistics across studies, Melody identifies microbial signatures with their AA consistently associated with the covariate in all studies.
Melody allows study-specific confounder adjustments, accommodates correlated samples, and is computationally efficient.
The recovery of AA associations in Melody relies on the assumption that the true signatures are “drivers,” defined as the minimal set of microbial features whose changes in AA are sufficient to explain the association signal observed at the RA level.
The concept of driver signatures is illustrated in Additional file1: Fig. S1.
The figure demonstrates that the underlying AA association profile compatible with the same RA association profile (referred to as “putative AA association”) is not unique, leading to ambiguity in inferred signatures.
Driver signatures are those features with nonzero effects in the sparsest putative AA association profile.
The figure also shows that driver signatures may or may not overlap with features exhibiting nonzero RA associations.
In subsequent sections, we show that focusing on identifying drivers is crucial for harmonizing RA summary statistics across studies and for discovering stable, generalizable microbial signatures in meta-analyses.
Melody is described in the “Methods” section; its technical details are provided in the Additional file1: Supplementary Note A, and its schematic overview is shown in Fig.1.
For each study, we link the microbiome count data with the covariate of interest using a quasi-multinomial regression model and obtain summary statistics consisting of the estimates of the RA association coefficients and their variances.
The RA association coefficients are estimated based on the scaled score statistics, which are numerically stable, statistically accurate, and computationally efficient [32,33].
The quasi-multinomial framework accommodates overdispersion in microbiome count data and mitigates the risk of inaccurate inference associated with the strict multinomial assumption.
The model easily accommodates confounder adjustments and naturally handles correlated samples (e.g., from longitudinal studies).
The RA association coefficients in the model are formulated at the log-ratio scale, with a specified feature as the reference.
The RA association coefficients are expressed as the shifted AA association coefficients by a constant (“Methods” section).
Next, we combine the RA summary statistics across studies to estimate the sparse meta AA association coefficients.
This meta-analysis is framed as a best subset selection problem [34,35], where we employ a cardinality constraint with the subset size hyperparametersto encourage the sparsity of meta AA association coefficients.
To recover meta coefficients at the AA level using summary statistics at the RA level, we introduce a hyperparameterδℓin each studyℓto shift the RA association coefficient estimates, producing different versions of putative AA association coefficients by varyingδℓ.
These study-specific AA coefficients are then combined to estimate meta AA coefficients.
The hyperparameterssandδℓ’s are jointly tuned using the Bayesian information criterion (BIC) to balance the trade-off between the model fit and sparsity.
As illustrated in Fig.1, the optimalδℓvalues shift the RA coefficients by an appropriate amount to identify a version of putative AA association coefficients that are sparse and consistent across studies.
The Melody-identified driver signatures are microbial features with non-zero estimates of meta AA association coefficients under the optimal hyperparameters.
In the simulations, we compared Melody with the MMUPHin summary-data meta-analysis method and several pooled-data meta-analysis approaches for selecting microbial signatures with differential abundance across two groups of interest.
MMUPHin [5] is an R package that includes a batch-effect correction algorithm and a summary-data meta-analysis method.
The meta-analysis first generates summary statistics using MaAsLin2 [36] within individual studies and then combines these summary statistics using standard meta-analysis methods [37] for association testing.
In the pooled-data meta-analysis, the pooled data were analyzed using representative microbiome association tests ALDEx2 [38], ANCOM-BC2 [17], and the blocked Wilcoxon test (BW) [3], as well as a penalized regression method CLR-LASSO [39].
In ALDEx2 and ANCOM-BC2, we adjusted for studies as confounders.
In BW, we rarefied count data within each study and performed the blocked Wilcoxon rank-sum test with studies specified as blocks.
In CLR-LASSO, we applied LASSO logistic regression [40] using centered log-ratio (CLR) transformed microbiome data as predictors.
Melody was applied to the original data, and the compared methods were applied to both the original data and study-effect corrected data using the MMUPHin batch-effect correction algorithm.
We compared the performance using the area under the precision-recall curve (AUPRC) for signature selection.
Specifically, the precision-recall curves of the test-based methods (MMUPHin, BW, ALDEx2, ANCOM-BC2) were constructed by changing thep-value cutoff, and those of the penalized methods (Melody and CLR-LASSO) were constructed by varying the hyperparameter that controls the signature sparsity level.
We simulated microbiome data for five studies that resemble the structure of five real microbiome datasets [3] (Additional file1: Fig. S2).
The detailed simulation strategy is described in the “Methods” section.
In brief, we consider a wide range of settings by varying the study sample size, the number of signatures, the degree of sign imbalance among signatures, and the degree of sequencing depth unevenness between the two groups of interest.
Melody produces the highest AUPRC values in all settings and is robust with varying degrees of sign imbalance and sequencing depth unevenness (Fig.2).
The AUPRC of ANCOM-BC2 reduces substantially as the degrees of the two factors increase.
The AUPRC of MMUPHin, CLR-LASSO, BW, and ALDEx2 reduce significantly as the degree of sign imbalance increases.
When using the study-effect corrected data, the AUPRC of MMUPHin slightly increases, while the pooled-data meta-analysis methods show minimal change.
We performed another set of simulations for the meta-analysis of studies with correlated samples and compared Melody with MMUPHin and ANCOM-BC2, which can handle correlated samples.
The patterns of the results remain the same (Additional file1: Fig. S3).
To strengthen our benchmarking, we ran an additional suite of simulation studies based on a different data-generation scheme (Additional file1: Supplementary Note B).
We first simulated AA data, introduced AA-level differential abundance, and then added study-specific, feature-level measurement biases to mimic technical batch effects.
We further varied the batch-effect magnitude, number of studies, and association strength.
Across all of these scenarios, Melody consistently outperforms competing methods (Additional file1: Fig. S4).
We conducted a meta-analysis of five metagenomics studies [3,41–44] for colorectal cancer (CRC) to identify microbial signatures associated with CRC.
The data contain 849 gut bacterial species measured on 574 fecal samples across the five studies (Additional file1: Table S1).
Microbial communities display a pattern of cross-study heterogeneity (Additional file1: Fig. S2).
The sequencing depth between CRC cases and controls is significantly different in some studies (Additional file1: Fig. S5).
Our main analysis focused on 401 microbial species with at least20%prevalence across all samples in the five studies.
We applied the methods that were compared in the simulations to analyze the data.
For the test-based methods, the signatures were selected using the Benjamini-Hochberg (BH) procedure [45] at the false discovery rate (FDR) level of 0.05.
For CLR-LASSO, the signatures were selected based on the best LASSO model.
The model tuning was performed via five-fold cross-validation using the default settings of the cv.glmnet function from the glmnet R package (v4.1-8), which selects the hyperparameter by minimizing the cross-validated binomial deviance.
The meta-analysis results of all methods are presented in Additional file2: Table S2.
Melody identified 51 signatures for CRC (Fig.3a), with the top two signaturesFusobacterium nucleatumandParvimonas micrabeing the well-known species promoting CRC [46,47].
Using original data, MMUPHin, CLR-LASSO, BW, ALDEx2, and ANCOM-BC2 selected 84, 94, 110, 44, and 72 signatures, respectively.
Signatures identified on the study-effect corrected data are similar to those identified on the original data.
The top-selected species and their rankings vary markedly across methods (Fig.3b, Additional file1: Figs.
S6 and S7).
We evaluated the stability of signature selection from three perspectives.
(1) Is the selection stable under different subsets of the samples?
We conducted a sensitivity analysis by removing one study at a time from the meta-analysis.
Specifically, we excluded all samples from a single study, identified signatures based on the remaining four studies, and evaluated the overlap of the signatures with those identified using the full dataset comprising all five studies.
(2) Is the selection stable after applying different prevalence filters?
Our main analysis was onK=401species after applying the 20% prevalence filter.
We also identified signatures based on allK=849species, kept the subset of the signatures within theK=401species list, and evaluated the overlap of the subset with those selected in the main analysis.
(3) Is the selection stable if analyzing a subcomposition?
We identified signatures based on a subcomposition withK=267species under orderClostridiales.
We evaluated the overlap of the identified signatures with the subset of main-analysis-identified signatures within theK=267species list.
We performed 100 bootstrap resamples of the combined data (i.e., bootstrap resampling by randomly drawing, with replacement, a sample of the same size from each study, and then combined the resampled datasets across studies), repeated these stability evaluations on the bootstrap samples, and reported the Jaccard index to measure set overlap (Fig.4).
When one study is excluded from the meta-analysis, Melody exhibits higher stability compared to MMUPHin, CLR-Lasso, ALDEx2, and ANCOM-BC2 (Wilcoxon rank-sum test FDR-adjustedP<0.001); BW shows comparable stability to Melody when CRC1 or CRC4 is excluded, and has slightly higher stability when CRC2, CRC3, or CRC5 are excluded (Wilcoxon rank-sum test FDR-adjustedP<0.1).
When the set of microbial features is larger (K=849), the stability of Melody is much higher than that of ALDEx2, ANCOM-BC2, BW, and CLR-Lasso (Wilcoxon rank-sum test FDR-adjustedP<10-6).
When the set of microbial features is smaller (K=267), the stability of Melody is much higher than that of BW, CLR-Lasso, and MMUPHin (Wilcoxon rank-sum test FDR-adjustedP<10-6).
In addition, we evaluated the out-of-sample prediction power of the top-selected species using the leave-one-study-out (LOSO) strategy.
We held out one study for prediction evaluation and randomly split samples from the remaining four studies into a feature selection set and a prediction model training set at a sample size ratio of 3:1.
We performed the meta-analysis on the feature selection set to pick the topNCRC-associated species.
We then used the sample proportions of these species in the training set to train a random forest model for CRC prediction.
Finally, we calculated the area under the receiver operating characteristic (AUROC) of the best random forest model on the hold-out study.
We repeated the procedure 100 times with different random splits of the samples and reported the average AUROC (Fig.5).
The Melody-identified top species have substantially higher AUROC than those identified by the test-based methods in CRC1, CRC2, and CRC5 (Wilcoxon rank-sum test FDR-adjustedP<10-5), and are comparable to the highest AUROC in other studies.
The top species identified by CLR-LASSO performed well in CRC1 but much worse in CRC2, CRC4, and CRC5.
Overall, the group of species prioritized by Melody has the highest average AUROC in CRC prediction (Wilcoxon rank-sum test FDR-adjustedP<10-10), whereas the species prioritized by other methods yielded similar results (Combined panel in Fig.5).
We conducted another meta-analysis of eight microbiome-metabolome association studies [48–55] to identify microbial signatures associated with human gut metabolites.
Most of these studies are case-control studies with one group of individuals with a specific medical condition and the other group of healthy control individuals (Additional file1: Table S3).
The raw data contain 12195 gut bacterial genera and 1151 HMDB-annotated [56] metabolites measured on 2127 fecal samples across the eight studies.
We focused on metabolites and genera with at least10%prevalence within individual studies.
Most metabolites are available in only a subset of studies (Additional file1: Fig. S9).
We considered metabolites that are present in at least two studies.
The final datasets for analysis contain 450 metabolites and 101 genera, resulting in 43722 metabolite-genus pairs.
There is notable heterogeneity among studies in study designs, microbiome sequencing methods, and metabolite measurements (Additional file1: Table S3).
In particular, metabolite levels cannot be directly compared between studies due to differences between metabolomics platforms.
Short-chain fatty acids, for example, are primarily detected using gas chromatography-mass spectrometry (GC-MS) and are rarely detected by liquid chromatography-mass spectrometry (LC-MS) due to their poor ionization efficiency.
Therefore, the pooled-data meta-analysis is unsuitable and we performed Melody and MMUPHin summary-data meta-analyses on the original data.
In both methods, we analyzed each metabolite variable as a covariate of interest while adjusting the disease status as a confounder when generating summary statistics for individual studies.
For MMUPHin, the signatures for each metabolite were selected using the BH procedure at the FDR level of 0.05.
Melody completed the analysis within 20 min, while MMUPHin took 25 min on a laptop (Apple M1 Pro 3.2GHz processor).
Melody identified 5847 metabolite-genus pairs, among which 2499 have positive and 3348 have negative associations (Additional file2: Table S4).
MMUPHin identified 5921 pairs, among which 2065 have positive and 3856 have negative associations (Additional file2: Table S5).
Figure6displays the meta association coefficient estimates of the two methods for the same set of top metabolites, which are associated with a large number of genera.
Melody identifies a greater number of genera that are positively associated with the majority of top metabolites, compared to MMUPHin (Fig.6).
These genera are associated with much fewer metabolites in MMUPHin results (Additional file1: Fig. S10b).
Many of them, such asAnaerostipes,Blautia, andRoseburia, are known to play essential roles in key metabolic processes, including the fermentation of dietary fibers and diverse carbohydrates [57,58], and are closely associated with the production of short-chain fatty acids, bile acids, and amino acid derivatives.
These genera have also been linked with multiple human complex diseases such as metabolic syndrome, inflammatory bowel disease, and obesity [59–61].
Besides the direct engagement of the genus in metabolite production, consumption, or degradation, correlations between metabolites and genera can also result from indirect associations, such as interactions between gut bacteria or co-abundant metabolites.
We further examined metabolites for which the results of the two methods were strikingly different.
Additional file1: Fig. S11 highlights one such metabolite, 4-trimethylammoniobutanoate (also known as gamma-butyrobetaine), a key gut microbial intermediate in the metabolism of L-carnitine to trimethylamine N-oxide (TMAO) with demonstrated proatherogenic effects in preclinical models [62].
Melody identified 13 positive-associated genera and 10 negative-associated genera, whereas MMUPHin identified 7 positive-associated genera and 21 negative-associated genera.
For each method, we removed 5 genera with the highest positive meta association identified by the method and reran the meta-analysis.
The Melody signature selection is stable after the genus removal.
MMUPHin identified many new positive-associated genera, and the set of negative-associated genera also changed substantially.
This is a global phenomenon, not limited to a few metabolites.
We performed the same evaluation for all 106 metabolites with at least 5 positive-associated genera detected by Melody and MMUPHin.
The overlap of the signatures before and after genus removal is much higher in Melody than in MMUPHin for most of these metabolites (Additional file1: Fig. S12).
The stability of the Melody results shown in this experiment is mainly attributed to its ability to capture the fluid association signals in the compositional data.
This evaluation underscores the importance of addressing compositionality to ensure the stability and reliability of results in microbiome association meta-analyses.
We have developed Melody to address major challenges in the meta-analysis of microbiome association studies.
Melody’s key innovations are (a) generating accurate and robust summary statistics by accounting for the unique characteristics of microbiome data; (b) recovering meta association coefficients at the absolute abundance level and identifying driver signatures consistent across studies.
Melody has a unique combination of features that make it desirable for practical use: (1) no need to share individual-level data or to correct study effects; (2) no need to perform data normalization, rarefaction, or zero imputation; (3) no need to assume that the same set of microbial features is measured and analyzed across studies; (4) allows for different designs across studies (e.g., some studies are cross-sectional, and some are longitudinal); (5) easily adjusts for confounders and allows different sets of confounders available across studies; (6) fast computation for large-scale association scans.
Melody tackles compositionality in a novel way.
It corrects study-specific compositional biases by jointly tuning the per-study scaling factorsδℓand the signature sizeswithin a best subset selection framework, yielding consistent AA estimates.
Joint tuning is critical and simply fixingδℓto the median of the RA coefficient estimates fails to achieve comparable performance (Additional file1: Fig. S13).
However, Melody’s effectiveness rests on a sparsity assumption.
In simulations where more than half of the features are driver signatures, theδℓestimates degrade and Melody does not outperform the compared methods (Additional file1: Fig. S14).
Note, however, that observing RA shifts in many features does not automatically imply a dense signal; large effects from a small set of drivers can induce widespread apparent shifts because of compositional constraints.
As demonstrated in the real data application, the set of Melody-identified signatures is not sensitive to the prevalence filter.
However, like any method for high-dimensional feature selection, including lots of noise features could adversely impact the selection accuracy.
Therefore, we still suggest applying a prevalence filter before data analysis if investigators are not interested in detecting very rare features.
The filter can be applied to pooled samples of all studies (as in the meta-analysis for CRC) or samples within each study in case a feature may be more prevalent in some studies and worth keeping (as in the meta-analysis for metabolome).
Melody naturally accommodates different sets of features across studies in meta-analysis.
This article focuses on identifying microbial signatures that are shared across studies, as these are more likely to be generalizable to broader populations.
It can also be of interest to identify microbial signatures with heterogeneous associations across populations (e.g., microbial features associated with the covariate in females but not in males) [63].
Melody can be extended to detect such heterogeneous associations by adapting random-effects meta-analysis and meta-regression techniques [64].
Melody is a new meta-analysis framework that enables the identification of true microbial signatures with absolute-abundance level associations using microbiome relative-abundance data.
Compared to existing meta-analysis approaches, Melody substantially improves cross-study signal harmonization and enhances signature detection accuracy and stability.
With the ever-increasing number of microbiome datasets, we anticipate that Melody will facilitate the accumulation of sufficiently large sample sizes to accelerate the reliable discovery of generalizable microbiome signatures.
As a general meta-analysis framework, Melody can be applied to the integration of association studies involving high-dimensional compositional omics data.
We have provided an efficient R package (miMeta) for the broad utility of Melody.
whereciis the sample-level multiplicative factor that absorbs quantities such as the sequencing depth and the microbial load in a unit volume for a sample, andbkis the feature-level multiplicative factor that absorbs the measurement biases arising from different efficiencies (e.g., DNA extraction efficiency, primer binding, and amplification efficiency) with which various features are measured [12].
where\Ris the index set of non-reference features, andβ0k(R)’s andβk(R)’s are the RA intercept and association coefficients, respectively.
Note that the RA association coefficients of the non-reference featuresβk(R)’s are simply shifted AA association coefficientsβk’s by a constantβR.
The model can be extended to incorporate confounding variables.
LetXidenote the design matrix that includes the intercept and all the explanatory variables andθ(R)=(β(R),γ(R))be the collection of all coefficients, in whichβ(R)contain the RA association coefficients of interest andγ(R)contain the nuisance coefficients.
where⊗represents the Kronecker product,Yi=Yikk∈\R, andpi=pikk∈\R.
The parameters can be consistently estimated by solving the estimating equationS(θ(R))=0.
This is equivalent to finding the maximum likelihood estimator from multinomial logistic regression because the quasi-score function has the same form as the score function of multinomial regression.
To prevent the potential estimation bias due to the small sample size and the presence of rare features, we adopted the mean bias reduction procedure in estimating the parameters of the multinomial regression [65].
whereθ~(R)=(0,γ~(R))andγ~(R)is the estimate ofγ(R)under the reduced model without the covariate of interest inXi,Iβ=Iββ-IβγIγγ-1Iγβ, andIββIβγIγβIγγis the partition of the quasi-information matrix-∂S(θ(R))∂θ(R)forβ(R)andγ(R).
whereUi=Sβ,i-IβγIγγ-1Sγ,i,Sβ,iandSγ,iare theith summand ofSβandSγrespectively.
The correlations cannot be accurately estimated when the number of features is close to or larger than the sample size.
Therefore, we use the diagonal matrix (with variances on the diagonal elements) extracted fromV(R)in the meta-analysis.
This procedure of generating summary statistics can be modified for studies with correlated samples (e.g., from longitudinal studies), and the details are provided in the Additional file1: Supplementary Note A.
whereμ~is the estimate ofμunder a specification of hyperparameters.
Details on solving the best subset selection problem and hyperparameter tuning algorithms that utilized Powell’s algorithm [69], the successive parabolic interpolation (SPI) algorithm [70], and the golden section search algorithm [71], are provided in the Additional file1: Supplementary Note A.
Theμ~under the optimal hyperparameter values is the estimate of the most parsimonious version of the putative AA associations consistent across studies.
The features with non-zero values inμ~are the driver signatures detected by Melody.
We simulated microbiome data by mimicking the species composition patterns of the five metagenomics studies for CRC [3].
For each study, we first fit the generalized Dirichlet multinomial distribution [72] to the 401 species with a prevalence of at least 20% in the real data and obtained the maximum likelihood parameter estimates.
Using the five sets of estimated parameters, we randomly generated independent samples of proportions for five studies from the generalized Dirichlet distribution.
These samples served as the true proportions of the microbial features.
The synthetic data closely resemble the structure of the real microbiome data (Additional file1: Fig. S2).
We considered two settings for the sample sizes of the five studies:n=100,120,140,160,180for relatively large studies, andn=20,30,40,50,60for small studies.
We randomly assigned the samples into 50% cases and 50% controls.
We varied the number of signatures from 4 (1% of the features) to 160 (40%).
Half of the signatures were randomly selected from the set of relatively abundant features with an average proportion of at least10-3in the original real data, while the other half were randomly selected from the remaining features.
We letpos% of the signatures have positive effects and1-pos% have negative effects.
We considered three settings ofpos%:60%,80%, and100%, which reflect various degrees of sign imbalance among signatures.
For each positive-effect signature, we increased their proportions in cases; for each negative-effect signature, we increased their proportions in controls.
The increased fold for each signature was randomly sampled from Uniform(0,Δ), whereΔ=2under the large study setting andΔ=5under the small study setting.
The larger effect size in the small study was chosen to make performance differences among the compared methods more discernible.
Next, we normalized the proportions of all features in each sample to ensure that the total sum of all proportions is one.
Notably, the proportions of all features are shifted after this step, but the features initially changed are considered the driver signatures with different underlying absolute abundances between the case and control groups.
We then used the normalized proportions as multinomial parameters to sample count data.
The sequencing depth for samples in each study was randomly drawn from the pool of sequencing depth in the corresponding CRC study.
Within each study, we increased the sequencing depth of all samples in either case or control group by a factoruto reflect the potential uneven sequencing depth between the two groups of interest.
We considered three settings ofu: 0, 0.5, and 1.
We simulated 100 datasets for each scenario and reported the average AUPRC for signature selection in the simulated data for each meta-analysis approach.
We conducted another set of simulation experiments for meta-analyzing studies with correlated samples.
We first simulated independent samples as described above.
We randomly picked two samplesXi1andXi2to form clusteri.
To introduce correlation between samples within a cluster, we sample baseline compositionXi∗from the generalized Dirichlet distribution and merge this baseline composition intoXi1andXi2and form the correlated samplesXi1∗=(Xi∗+Xi1)/2andXi2∗=(Xi∗+Xi2)/2for clusteri.
The case and control labels are randomly assigned to clusters.
Differential abundance between cases and controls is introduced in the same manner as for independent samples.
All raw sequencing data across studies were reprocessed using the same bioinformatics pipeline for taxonomic profiling [3].
The species-level microbiome count data and the variable for CRC status were obtained fromhttps://github.com/zellerlab/crc_meta.
The five studies involve subjects from five different countries.
The sample sizes of the studies are 109, 127, 120, 114, and 104 (Additional file1: Table S1).
We removed two samples with an outlier sequencing depth of less than 2000.
Our main analysis was onK=401species after removing species with a prevalence less than20%(prevalence was defined as the percentage of non-zero counts in all samples across studies).
Additionally, we analyzed the data with allK=849species and withK=267species under orderClostridialesto assess the stability of signature selection.
In all studies, the microbiome and metabolome were profiled from the same fecal samples.
The datasets undergo curation and processing as part of an established effort [73].
The genus-level microbiome count data and the variables for metabolites and disease status were obtained fromhttps://github.com/borenstein-lab/microbiome-metabolome-curated-data.
We used the eight adult cohorts from this resource with sample sizes of 96, 294, 240, 220, 444, 382, 287, and 164.
There is notable heterogeneity among studies in study designs, microbiome sequencing methods, and metabolite measurements (Additional file1: Table S3).
Our analysis focused on 450 metabolites with study-specific prevalence≥10%in at least two studies and 101 genera with study-specific prevalence≥10%in at least one study.
We applied rank-based inverse normal transformation to the metabolite variable.
We performed Melody and MMUPHin to discover genus signatures for each metabolite.
In both methods, we analyze each metabolite variable as the covariate of interest while adjusting the disease status as a confounder when generating summary statistics within individual studies.
MMUPHin(v1.14.0),ALDEx2(v1.32.0),ANCOMBC(v2.2.2),coin(v1.4-2),glmnet(v4.1-8),brglm2(v 0.9.2),abess(v0.4.8),mlr3(v0.16.1).
Additional file 1: Supplementary Notes A and B, Figs S1-S14, and Tables S1, S3.
The authors thank the editors and two anonymous reviewers for their insightful comments and suggestions, which helped improve the quality of the manuscript.
ZZT conceived the idea and oversaw the study.
ZZT developed Melody with contributions from GC and ZW.
ZW implemented the method, conducted numerical studies, and developed the miMeta R package.
ZZT wrote the first version of the manuscript.
GC and ZW also contributed to the writing.
All authors read and approved the final manuscript.
This work was supported by the NIH grants R01AI192972, R01GM140464, and NSF grant DMS-2054346.