Fluorescence imaging, indispensable for fundamental research and clinical practice, has been driven by advances in fluorophores.
Despite fast growth over the years, many available fluorophores suffer from insufficient performances, and their development is highly dependent on trial-and-error experiments due to subtle structure-property effects and complicated solvent effects.
Herein, FLAME (FLuorophore design Acceleration ModulE), an artificial intelligence framework with a modular architecture, is built by integrating open-source databases, multiple prediction models, and the latest molecule generators to facilitate fluorophore design.
First, we constructed the largest open-source fluorophore database to date (FluoDB), containing 55,169 fluorophore-solvent pairs.
Then FLSF (FLuorescence prediction with fluoroScaFfold-driven model) with a domain-knowledge-derived fingerprint for characterizing fluorescent scaffolds (called fluoroscaffold) was designed and demonstrated to predict optical properties quickly and accurately, whose reliability and potential have been verified via molecular and atomistic interpretability analysis.
Further, a molecule generator was incorporated to provide new compounds with desired fluorescence.
Representative 3,4-oxazole-fused coumarins were synthesized and evaluated, creating an unreported compound with bright fluorescence.
The fluorophore development used to be dependent on trial-and-error experiments.
Here, a modular artificial intelligence framework is built by integrating latest databases, prediction models, and molecule generators to facilitate fluorophore design.
Luminescent molecules have found widespread applications in numerous fields1–3, among which fluorophores have attracted increasing attention in bioimaging due to their small size, chemical tractability, and low cost4,5.
To meet specific requirements such as the penetration depth and detection sensitivity in bioimaging, the underlying structure-property relationship (SPR) of fluorophores is important for designing compounds with proper excitation wavelength and desired brightness6–8.
However, our knowledge of this relationship remains limited9–13, which is largely due to two reasons: (1) Data sparsity.
That is, all possible structural modifications should be tested to illustrate the SPR of a specific fluorophore, but met with synthetic challenges.
Moreover, the problem also lies in the limited access to complete, comparable, and meaningful photophysical data of existing fluorophores14.
(2) Multiple interrelated factors may affect the fluorescence.
A subtle modification in the structure may lead to significant optical changes, and the fluorescence may further be influenced by the surrounding environment, leaving the rational design of fluorophores difficult6,8,15.
Recently, machine learning-based data-driven science has shown tremendous potential to become a very useful tool across various disciplines16–18, such as predicting molecular properties19, virtual screening20, and molecular generation21.
In the case of fluorescence, multiple intricately intertwined properties need to be considered for the molecular design, including maximum absorption wavelength—λabs, maximum emission wavelength—λem, photoluminescence quantum yield—ΦPL, and molar absorption coefficient—εmax6,15.
Pioneered by Tsuda et al., a massively parallelized version of de novo molecule generator (ChemTS) was employed to design fluorophores with absorption/emission wavelengths and oscillator strengths calculated by quantum chemical computation, generating 3643 candidate fluorophores by using 1024 cores for 5 days22.
Though powerful, the high computational cost must be considered.
Due to its end-to-end paradigm, machine learning can learn directly from the data to identify implicit patterns and make predictions without any prior knowledge, promising for fluorescence prediction.
For instance, Ju et al. established a database (ChemFluor) recording the optical properties of over 4300 solvated fluorophores23.
Both the fluorophore and solvent were characterized using molecular descriptors or fingerprints, which were combined as the input for predicting photophysical parameters using the Gradient Boosted Regression Trees (GBRT) model.
Similarly, Park’s group developed a graph convolutional network (GCN)-based model24and employed the integrated gradients method25sequentially to predict seven optical properties and obtain attributions of atoms/functional groups/solvents to the optical properties.
Very recently, Tsai et al. modified the SchNet model to introduce the solvation embedding outside the interaction layers so as not to overly amplify the solute-solvent interaction and provided enhanced prediction for ΔEabsand ΔEemi26.
As researchers in fluorescent probes27–29, we’re keen to make an easy-operation toolkit that allows the generation of structure-new fluorophores with desired optical performance efficiently, to explore the frontiers of fluorophores with a minimized burden on chemical synthesis and experimental tests30.
Very recently, Park et al. developed a generative deep learning (Gen-DL) model to generate molecules with seven predefined optical properties31.
Alternatively, to fully exploit the chemical space, optical property prediction models can be introduced to molecule generators for efficient sampling to select optimal structures with desired optical properties.
Herein, we systematically compiled experimental data to build a new fluorophore database named FluoDB (Fig.1), consisting of 55,169 fluorophore-solvent pairs, as the machine learning algorithm asks for large volumes of data to acquire effective information.
Compared with existing databases, FluoDB improves in both data volume and molecular diversity, categorized with 16 core fluorescent scaffolds and 728 subgroups.
Then we proposed a new prediction model, FLSF (FLuorescence prediction with fluoroScaFfold-driven model), in which a domain-knowledge-derived fingerprint encoded by 728 fluorescent-scaffold subgroups (called fluoroscaffold) is fused to traditional message passing neural networks (MPNN; reported to outperform SchNet, DTNN, and the Transformer in predicting UV-Vis spectra32) using the gated recurrent unit (GRU).
In benchmarking tests, FLSF is advantageous at quickly and accurately predicting optical properties over previous state-of-the-art (SOTA) models.
Its reliability and potential were further validated through a series of interpretability analyses.
To guide the fluorophore design directly, we set up an artificial intelligence (AI) framework, FLAME (FLuorophore design Acceleration ModulE), by integrating different open-source databases, prediction models, and molecule generators.
Using Reinvent 433as a representative molecule generator, a series of compounds with predicted properties were generated.
Among them, 3,4-oxazole-fused coumarins were synthesized using a novel one-pot synthetic methodology, giving an unreported compound with bright fluorescence, and exhibiting the potential of FLAME in accelerating fluorophore design.
Overview of the user-friendly framework, FLAME, assembled from the latest databases (including FluoDB, the database constructed in the current study), prediction models (i.e., FLSF (FLuorescence prediction with fluoroScaFfold-driven model) constructed in the current study together with other state-of-the-art prediction models), and molecule generators, together with its application in the design of unreported fluorophores with desired fluorescence followed by experimental evaluation.
In our previous study, a database (SMFluo1) focusing on near infrared fluorophores was constructed, containing five widely used fluorescent scaffolds29.
The limitation in data volume of SMFluo1 makes it difficult to meet the requirements of deep learning algorithms, particularly those based on graph neural networks (GNN), including GCN and Attentive FP34, leading to moderately good prediction accuracy.
In addition, to evaluate a fluorophore for bioimaging, four key photophysical parameters (λabs, λem, ΦPL, and εmax) are needed, where λabsand λemare related to the penetration depth and ΦPL×εmaxindicates the brightness15.
Of note, other factors including the blinking, thermal stability, photobleaching, and labeling specificity should be taken into consideration when designing probes for bioimaging, but parameters for these properties were not included in FluoDB due to limited access6.
Taking these into consideration, data collection was carried out as follows (Fig.2a): (i) Literature survey via searching the name of fluorescent scaffolds on PubMed; (ii) Retrieval of experimental data from various open-source databases23,35–40and supplement with four photophysical parameters & solvent information from the original literature.
These data were processed after the combination (see “Data processing” in Methods).
aGeneral pipeline for data collection and processing to construct the new database, FluoDB, followed by systematic analysis and statistics of FluoDB to visualize the optical properties of various fluorophores in different solvents.bUMAP (Uniform Manifold Approximation and Projection) of different databases (Deep4Chem36, DyeAgg38, ChemFluor23, ChemDataExtrator (CDEx)35, and SMFluo129) using Morgan fingerprints.
The UMAP algorithm was applied with a neighborhood size of 10 and a minimum distance of 0.3.
The number of unique compounds in each database is listed in the bracket.cDistribution of various fluorescent scaffolds in different databases.
Source data are provided as a Source data file.
Most fluorescent compounds are derived from some basic scaffolds and they may share common optical characteristics; thus, we categorized the fluorophores into twelve classic fluorescent scaffolds and four non-classical scaffolds (Fig.S1; detailed skeletal structures for 728 subgroups are shown in TableS1).
FluoDB, a new database containing 35,528 unique fluorophores and 55,169 fluorophore-solvent pairs, was therefore constructed with SMILES of fluorophores/solvents, category of fluorescent scaffolds, experimental photophysical data, and original reference.
Compared to representative open-source databases (e.g., Deep4Chem36, DyeAgg38, ChemFluor23, ChemDataExtrator (CDEx)35, and SMFluo129), FluoDB gets improved in the number of molecules and the richness in optical information (Fig.2band Fig.S2), exhibiting much higher molecular diversity according to the data distribution and structural analysis (Fig.S3and TablesS2–3).
In addition, different scaffolds distribute relatively even in both FluoDB and Deep4Chem, while the data of each category is largely enriched in FluoDB (Fig.2cand TableS4).
With FluoDB, the correlations between different parameters were investigated (Fig.S4) and indicated an obvious positive correlation between λabsand λem.
In addition, molecular weight (MW) also has a certain positive correlation with λabs, λem, and εmax, which is consistent with the scatter plot analysis (Fig.S5) and experimental results (i.e., introducing large π bridging moieties or strong electron acceptors/donors is commonly used for longer absorption and emission wavelengths41, and these modifications often increase the MW).
External factors such as the surrounding solvent are reported to influence the optical properties of certain fluorophores42.
To investigate this in a large scope, fluorophores with experimental data available for different solvents (≥5) were selected from FluoDB.
The variance distribution of each photophysical parameter for selected molecules in different solvents is shown in Fig.S6, where these parameters do vary along the change of solvent type, underscoring the importance of solvents when predicting optical properties.
As mentioned earlier, we divided the fluorescent scaffolds into 16 types (Fig.S1and TableS1), and any input fluorophore can be quickly classified accordingly to explore potential commonalities from the same group.
As indicated in Figs.S7–22, a discrepancy was found in λabsand λemdistribution with different scaffolds, where most groups centered in the UV-Vis range, while BODIPY, porphyrin, and squaraine lie in longer wavelength (above 550 nm)43,44.
In addition, larger wavelength tunability was found from acridine, naphthalimide, coumarin, and cyanine.
Besides, Δλ (Stokes shift, Δλ = λem− λabs) of BODIPY, porphyrin, and squaraine is relatively small (~25 nm).
Statistical analysis of such large-scale data is indicative for choosing the ideal fluorescent scaffold to start with, and we also prepared a toolkit where users can search for fluorophores with desired similarity as the molecule of interest from the database.
With FluoDB, open-source prediction models, including GBRT23, SMFluo29, UVVisML45, SchNet26, and ABT-MPNN46, were tested.
Data in FluoDB-Lite (SMILES in the mixture/complex form were removed from FluoDB) was divided randomly in a ratio of 7:1:2 for training, validation, and testing, respectively (TableS5).
As shown in Table1and TableS6, ABT-MPNN, a general molecular property prediction model based on an atom-bond Transformer, performed best in predicting λabsand λem, highlighting the advantage of combining Transformers with GNN for molecular representation.
However, the introduction of attention mechanisms in ABT-MPNN led to 10 times slower training than UVVisML (a Directed MPNN, D-MPNN), despite the improved MAE for λabsand λemby 9.18% and 4.86%, respectively.
For practicability, it is desirable to replace the attention mechanism in ABT-MPNN with a new way to speed up the training while maintaining the prediction accuracy.
The unit of MAE/RMSE is nm for λabsand λem, not applicable for ΦPLand εmax(used in log10εmax).
GBRT, SMFluo, UVVisML, SchNet, and ABT-MPNN are implemented from their open-source codes.
The difference between FLSF (FLuorescence prediction with fluoroScaFfold-driven model) and FLSF_MACCS/FLSF_Morgan is the feature extraction method, as fluoroscaffold was introduced in FLSF, while the conventional MACCS/Morgan fingerprints were used for the latter.
λabsmaximum absorption wavelength,λemmaximum emission wavelength,ΦPLphotoluminescence quantum yield,εmaxmolar absorption coefficient,MAEmean absolute error,MSEmean-square error,RMSEroot-mean-square error,R2the coefficient of determination.
As all fluorophores in FluoDB were classified into 16 core scaffolds and distribution discrepancy in optical properties among them was observed (Figs.S7–21), a special molecular fingerprint—fluoroscaffold (a 728-dimensional digital fingerprint encoded by 728 fluorescent-scaffold subgroups listed in TableS1), fused with the current feature extraction method based on MPNN, was designed for better molecular representation of fluorophores.
A new prediction model (FLSF) was constructed based on it (Fig.3a).
As shown in Table2, FLSF predicted well for different fluorophores, especially for BODIPY-based compounds (the largest proportion in FluoDB) with MAE of 6.44 nm/7.37 nm for λabs/λem.
For non-classical scaffolds (i.e., [6 + 5], [6 + 6], 6-n-5, 6-n-6), FLSF also has a good performance, promising for dealing with novel fluorophores.
Overall, FLSF performs well at predicting λabsand λem(R2= 0.94) and needs improvement at ΦPLand εmax(R2≈ 0.6; Fig.3b).
Then we conducted benchmark tests of FLSF and summarized the results in Table1and TableS6for direct comparison with reported SOTA models.
Obvious improvements were seen in the prediction accuracy of λabs, λem, and εmaxby FLSF than ABT-MPNN (the same of ΦPL), at a much faster speed, indicating its great potential for high-throughput screening of candidate fluorophores.
To check whether FLSF can capture the solvent effect, a multi-solvent test set (fluorophores with experimental data available for ≥4 different solvents) together with the control test set (fluorophores in the same solvent) was selected and the prediction performance of FLSF was compared with other baseline models.
As shown in TablesS7–8, FLSF has the best prediction performance on the multi-solvent test set.
To our delight, FLSF can also predict λabsand λemof fluorophores showing solvatochromism with high accuracy (TablesS9–10), further supporting its potency to capture solvent effects.
aThe model architecture of FLSF.
A domain-knowledge-derived fingerprint based on the 728 fluorescent-scaffold subgroups (called fluoroscaffold) is fused with a message-passing neural network (MPNN) for the feature extraction of the input fluorophore.
The feature extraction of the solvent molecule is based on MPNN.
The feature vectors of both the fluorophore and the solvent are input together to output a prediction of the property of interest.
MLP: multilayer perceptron.bThe overall prediction performance of FLSF for different photophysical parameters.
λabs: maximum absorption wavelength; λem: maximum emission wavelength; ΦPL: photoluminescence quantum yield; εmax: molar absorption coefficient.cComparison between FLSF (red points) and TD-DFT (time-dependent density functional theory) calculations (gray points) for λabs(left) and λem(right) prediction.
MAE mean absolute error, R2the coefficient of determination.
Source data are provided as a Source data file.
MAEmean absolute error,λabsmaximum absorption wavelength,λemmaximum emission wavelength,ΦPLphotoluminescence quantum yield,εmaxmolar absorption coefficient.
Time-dependent density functional theory (TD-DFT) used to be the most widely used tool for predicting optical properties47.
However, such traditional theoretical calculations require high computational and time costs48, faced with insufficient accuracy in predicting λabsand λem, much less in parameters like ΦPLinvolved in various radiation and non-radiation processes49.
For direct comparison with FLSF, we collected 162 fluorophore-solvent pairs from FluoDB (TableS11) and used TD-DFT to calculate their λabsand λem(Fig.3cand TableS12).
The MAE of FLSF decreased by more than 0.2 eV for predicting λabsand λemthan TD-DFT.
Of note, FLSF can provide all prediction results in less than one second, while the average calculation time of TD-DFT exceeds 200 CPU hours in the current test set.
The interpretability of a model, illustrating how it makes decisions and achieves related results, helps to verify the reliability of the model and excavate valuable information from the data.
First, we analyzed the interpretability of FLSF from the molecule-level perspective50.
The embedding vectors from three states of FLSF were studied, namely, the state only treated by D-MPNN without fluoroscaffold integration, the state with fluoroscaffold integration but before solvent incorporation, and the state after solvent incorporation.
According to the 2D-PCA (two-dimensional principal component analysis) dimension reduction distribution diagram (Fig.4a), there is a clear difference in the distribution between short-wavelength and long-wavelength fluorophores in λabsand λemprediction tasks, indicating that FLSF can effectively identify their structural features with different wavelengths.
Interestingly, the integration of fluoroscaffold makes this difference more significant, and the data distribution dispersion is further improved after the introduction of solvent, highlighting the importance of scaffold information for the prediction and implying that FLSF is sensitive in capturing subtle differences caused by solvents.
aFLSF embedding interpretability through PCA (Principal Component Analysis).
2D-PCA plots of the molecular embeddings at different stages: (Left) before integrating fluoroscaffold information, (Center) after integrating fluoroscaffold information, and (Right) after further integration of solvent information.
Each dot is colored by experimental values.
PC1: Principal Component 1; PC2: Principal Component 2.
The intensity of the color scale represents the magnitude of the experimental values of the molecular parameters, with darker colors indicating higher experimental values.
Source data are provided as a Source data file.
λabs: maximum absorption wavelength; λem: maximum emission wavelength; ΦPL: photoluminescence quantum yield; εmax: molar absorption coefficient.bSummary of reported structural modification strategies for coumarin-based fluorophores (left) and atomic contributions learned by FLSF (right).
The color bar values represent the normalized difference in the predicted values before and after masking specific atoms.
EDG electron-donating group, EWG electron-withdrawing group, Exp.experimental, Pred.predicted.
Subsequently, the explicability analysis of FLSF at the atom-level perspective was conducted50.
To be specific, each atom in the fluorophore was masked, and the prediction values (e.g., λem) before and after masking were compared to reveal the attribution of each atom.
Coumarin was taken as the example since it has been derived to cover a wide range of wavelengths, providing invaluable SPR information (Fig.4b, left) for validating the reliability of FLSF51,52.
With a classic D-π-A structure, the introduction of electron-donating groups (EDG) on the phenyl ring and electron-withdrawing groups (EWG) on the lactone ring can effectively achieve redshift of coumarin according to experimental experience.
Representative examples in Fig.4b(right) demonstrate that FLSF has grasped such rules.
In addition, researchers found that the replacement of ketone with imine at position 2 can also produce redshift53(e.g., compound e-g), and FLSF has also mastered it.
Of note, although coumarin derivatives with substitution other than oxygen at position 1 are not recorded in FluoDB, FLSF can indicate the contribution of oxygen at this position to the redshift, which is also supported by recent experimental results54.
It implies that FLSF has good generalization ability/reliability and may provide new structural modification suggestions for fluorophore design.
While large databases and various property prediction models have significantly advanced our knowledge of the SPR of certain molecules, a gap exists in their direct applications for molecular design.
Therefore, we aimed to build a multifunctional software package, FLAME, to meet the practical needs of researchers for novel fluorophore design by integrating the database, prediction models, and molecule generators into one framework (Fig.5a).
FLAME provides six open-source fluorophore databases, including FluoDB (Fig.5b).
Users can input the molecule of interest to search for related information of existing molecules in the database, as well as to train the model with different databases for illustrating the data impact.
Meanwhile, FLAME offers six open-source prediction models (i.e., FLSF, UVVisML, ABT-MPNN, SchNet, SMFluo, and GBRT), which can be combined with the above datasets to meet various requirements from different users.
In-parallel comparison between different combinations also helps to identify the best settings for specific parameter prediction (Table3).
aThe framework of FLAME to facilitate the fluorophore design.
FLAME, assembled from the latest databases and prediction models, is feasible for various applications, including virtual screening, molecular generation, and structural optimization.
SMILES: Simplified Molecular Input Line Entry System; MLP: multilayer perceptron; λabs: maximum absorption wavelength; λem: maximum emission wavelength; ΦPL: photoluminescence quantum yield; εmax: molar absorption coefficient.bThe basic workflow of FLAME for various applications, including database search, photophysical property prediction, and creating unreported molecules with predicted optical properties by integrating different fluorophore databases, prediction models, and molecule generators.
Databases including Deep4Chem36, DyeAgg38, ChemFluor23, CDEx35, SMFluo129, and our FluoDB; prediction models including previously reported UVVisML45, ABT-MPNN46, SchNet26, SMFluo29, GBRT23, and our FLSF (FLuorescence prediction with fluoroScaFfold-driven model).
MAEmean absolute error,MSEmean-square error,RMSEroot-mean-square error, databsets including our FluoDB and Deep4Chem36; prediction models including previously reported GBRT23, SMFluo29, UVVisML45, SchNet26, ABT-MPNN46, and our FLSF (FLuorescence prediction with fluoroScaFfold-driven model); λabs: maximum absorption wavelength.
The unit of MAE/RMSE is nm for λabs.
To provide structure-new compounds with predicted optical properties directly, a newly reported open-source generative AI framework, Reinvent 433, was introduced.
As a scoring tool embedded in FLAME for molecular design, the speed of training and predicting is critical for the prediction model.
FLSF proven good at these two aspects was coupled with Reinvent 4 herein (users can make their own choice).
With the help of FLAME, both de novo molecular generation and structural modifications can be achieved.
For example, if users are interested in the development of novel BODIPY derivatives, they can set the desired photophysical parameters (single or multiple parameters) with FLAME.
Then, newly generated molecules (not recorded in FLAME’s built-in database) belonging to BODIPY with predicted properties will be screened out.
Alternatively, users can input a parent structure of interest with desired parameters into FLAME to obtain optimized structures.
Of note, both processes used to be highly dependent on specialized knowledge and years of experience, while FLAME is promising to think out of the box and offer fluorophore candidates more efficiently.
With increasing interest in coumarin-based fluorescent probes due to their excellent biocompatibility, good structural flexibility, and tunable fluorescence52, FLAME is employed to guide the development of novel coumarin derivatives for concept proof (Fig.6aand Fig.S23).
Four optical parameters (λabs, λem, ΦPL, and εmax) were set as scoring targets.
We trained the generative model and sampled one million molecules, with a focus on coumarin-type compounds during screening.
From the virtual library generated by FLAME, 3,4-oxazole-fused coumarins attracted our attention due to their structural novelty and synthesizability.
A variety of oxazole-containing dyes were reported to possess attractive photophysical properties, such as high fluorescence quantum yields55–57, while the fluorescence properties of 3,4-oxazole-fused coumarins have not been reported yet.
aGeneration of unreported heterocyclic-fused coumarins with predicted optical properties by FLAME.
FLSF: FLuorescence prediction with fluoroScaFfold-driven model; Reinvent 433: a newly reported open-source generative AI framework.bThe new strategy for one-pot synthesis of 3,4-oxazole-fused coumarins.cAbsorption (up) and emission (down) spectra of3hand3orecorded in different solvents.
H2O: water; DMSO: dimethyl sulfoxide; EtOH: ethanol; DCM: dichloromethane.
Source data are provided as a Source data file.dConfocal fluorescence images of living HeLa cells treated with different concentrations of3o.
The cell imaging was performed three times with similar results.
Available strategies for the synthesis of this scaffold include (a) heating of 7-N,N-dimethylamino-4-hydroxycoumarin in the presence of nitromethane and DABCO58, (b) synthesis from 4-hydroxy-3-nitrocoumarin and benzyl alcohol under gold nanoparticle or FeCl3catalysis59, and (c) synthesis from 4-hydroxy-3-nitrocoumarin and acids in the presence of triphenylphosphine and phosphorus pentoxide under microwave irradiation60(Fig.S24).
The lack of structural diversity on the phenyl ring using reported strategies, together with the demand for simple and efficient synthetic procedures to construct diverse 3,4-oxazole-fused coumarins from readily available starting materials, drives us to develop new synthetic methodology.
Inspired by our previous work in isocyanide chemistry61–63, we proposed a one-pot approach to synthesize 3,4-oxazole-fused coumarins from ethyl isocyanoacetates and phenyl salicylates promoted by base (Fig.6band Fig.S25).
Under the optimized conditions (TableS13), 16 oxazole-fused coumarins were synthesized successfully (Figs.S26–27), carrying electron-donating or electron-withdrawing substituents on the phenyl ring.
With these compounds in hand, their optical properties were evaluated (Figs.S28–29).
Consistent with the prediction result from FLSF, the introduction of an amino group at the 6- or 7-position of the coumarin scaffold (i.e.,3h,3o) led to a redshift in λabsand an increase in ΦPL(TableS14).
Then, solvent effects on these two fluorophores were investigated (Fig.6cand TableS15).
As expected, the solvent polarity has a significant impact on their absorption/emission wavelengths, and3oliberated much stronger emission than3hin all solvents, which was selected for bioimaging.
Brilliant fluorescence was observed in HeLa cells after 30-min incubation (Fig.6d), indicating its potential for live-cell imaging.
FLAME, a modular AI-assisted framework for fluorophore design, was developed to help researchers design de novo molecules with desired optical performance efficiently.
To achieve this, we expanded the available fluorophore database by supplementing data from various aspects, such as fluorescent scaffold types and photophysical parameters, to give the biggest open-source fluorophore database to date, FluoDB, which contains 55,169 solvated fluorophores and 109,054 data entries including four key photophysical parameters, λabs, λem, ΦPL, and εmax.
Compared with reported databases, FluoDB exhibits higher molecular diversity and data volume.
By conducting a series of data analyses on FluoDB, insights were gained into the correlation between different photophysical parameters, as well as their relationships with molecular weight and solvent type.
To meet the requirement of scoring for molecular generation, the prediction model needs to be accurate and fast.
FLSF with a domain-knowledge-derived fingerprint for characterizing fluorescent scaffolds (called fluoroscaffold: a 728-dimensional digital fingerprint) was designed and exhibited encouraging accuracy with a training speed 10 times faster than ABT-MPNN.
In addition, FLSF’s predictive power was tested through a series of molecule-level and atom-level interpretability analyses.
The attribution of each atom learned by FLSF is highly consistent with expertise.
Based on FLSF, Reinvent 4 as a molecule generator was employed for de novo creation of fluorophore candidates.
A series of 3,4-oxazole-fused coumarins yet-to-be-developed for fluorophores were synthesized using our newly developed metal-free approach via base-promoted tandem reaction of phenyl salicylates with isocyanoacetates.
The predicted optical performance of these compounds is highly consistent with the experimental results (MAE = 13.3 nm for λabs, 0.093 for ΦPL, and 0.430 for log10εmax), and an unreported coumarin derivative with brilliant fluorescence (ΦPL= 0.541, log10εmax= 4.314 in water) promising for bioimaging was obtained.
The above results exemplify the advance of FLAME in facilitating the design of new fluorophores, which can reduce the burden on trial-and-error experiments by simply inputting the desired photophysical parameters into the black box of FLAME.
Multi-step computational processes can thus be executed automatically and can be handled by anyone without a prerequisite for expertise in either fluorescence or computation.
With its modular architecture, FLAME can be further updated with new data/algorithms to advance with time in accelerating fluorophore development.
Moreover, synthetic accessibility predicting models64–68can be further integrated into FLAME for synthesizability scoring during the sampling, and retrosynthetic analysis tools (e.g., AiZynthFinder69, Retro*70, and ASKCOS71) can also be incorporated into FLAME which can help with retrosynthesis planning towards the fluorophore candidate, making fluorophore design and synthesis more efficiently.
In addition to searching literature via PubMed by using fluorescent scaffolds as keywords, we also compiled and supplemented multiple open-source databases, including Deep4Chem36, ChemFluor23, Dye Aggregation (DyeAgg)38, ChemDataExtrator (CDEx)35, DYES39, PhotochemCAD40, and Dye-Sensitized Solar Cell Database (DSSCDB)37.
FluoDB is currently available for the experimental photophysical data, including maximum absorption wavelength (λabs), maximum emission wavelength (λem), photoluminescence quantum yield (ΦPL), and molar absorption coefficient (εmax), which are key factors in photochemical studies.
During the data collection, if multiple peaks were found in the absorption/emission spectra for the same fluorophore-solvent pair, the peak with the longest wavelength/largest intensity was collected for λabsand λem.
The majority of the experimental values were obtained at 298 K, so the effect of temperature was not considered in the model development.
First, we removed the invalid data: (1) remove data without solvent information or with gas as the solvent; (2) remove data whose SMILES cannot be converted to valid chemical structures.
Then we did some general processing to limit the data range of each photophysical parameter: (1) remove data with ΦPLabove 1; (2) remove data with λabsor λembelow 200 nm or above 1500 nm; (3) remove data with εmaxabove ten million.
During the redundant data processing, we set difference thresholds for each parameter.
The difference threshold is 5 nm for λabsand λem, 0.1 for ΦPL, and 0.02 for log10εmax.
For each fluorophore-solvent pair, redundant data from different resources were removed if exceeding the difference threshold, and the average value of the remaining data was put into the database.
Finally, all fluorophores were standardized using SMILES notation, and a dictionary mapping to convert solvent names and acronyms into SMILES was constructed.
Furthermore, the number of solvent types was streamlined from 393 to 72 by removing those that occurred less than 10 times.
Since these less-used solvents account for a small portion of the original data (~2000 entries), their removal will not affect the data diversity.
We trained and tested four optical property parameters separately.
Data containing fluorophores in the mixture/complex form (containing water, metal ions, etc. in the SMILES) were removed from FluoDB (6309 entries were removed) to give FluoDB-Lite (the original FluoDB is also named FluoDB-Full to differentiate it from FluoDB-Lite when applicable), before a random split with a ratio of 7:1:2 (detailed in TableS5).
Of note, some implausible data (εmax< 100) were removed from the test set during εmaxprediction (TableS6).
The hyperparameters for FLSF were tuned by Bayesian optimization on the validation set.
All regression models are evaluated by MAE (mean absolute error), MSE (mean-square error), and RMSE (root-mean-square error).
The training was conducted on two servers—OCHPC and SYHPC.
The OCHPC server has 2 Intel Skylake Gold 6132 processors and 192GB RAM, along with an NVIDIA Tesla K80 24GB GPU.
The SYHPC server has 4 Intel 8360H processors, 3TB RAM, and an NVIDIA A100-40GB GPU.
The hyperparameters for FLSF are shown in TableS16.
The molecules used for the TD-DFT (time-dependent density functional theory) tests were sourced from the previously divided test set.
We selected data that contained all four parameters, excluded molecules containing ions, and restricted the number of heavy atoms to less than 30.
Initial geometries were refined using semi-empirical tight-binding density functional theory (GFN2-xTB) followed by geometry optimizations at the B3LYP/6-31 + G(d)/IEFPCM level of theory in the Gaussian 16 software package.
TD-DFT calculations72were performed with CAM-B3LYP/6-31 + G(d)/IEFPCM level of theory.
1H,13C,19F NMR spectra were recorded using JNM-ECZ 400S (400 MHz) spectrometer.
Chemical shifts were reported in parts per million (ppm), and the residual solvent peak was used as an internal reference:1H (chloroform δ 7.26; DMSO δ 2.50),13C (chloroform δ 77.16; DMSO δ 39.52).
Data are reported as follows: chemical shift, multiplicity (s = singlet, d = doublet, t = triplet, q = quartet, m = multiplet, br = broad, dd = doublet of doublets, ddd = doublet of doublet of doublets), coupling constants (Hz) and integration.
Melting point (MP) was obtained on Buchi M-560.
For thin layer chromatography (TLC), Huanghai TLC plates (HSGF 254) were used, and compounds were visualized with a UV light at 254 nm.
High-resolution mass spectra (HRMS) were obtained on an Agilent G6545 spectrometer using an electron spray ionization time-of-flight (ESI-TOF) source.
Unless otherwise noted, all reactions were carried out under an ambient atmosphere; exclusion of air or moisture was not required.
Anhydrous and deuterated solvents were purchased from commercial suppliers and used as received without further purification.
Phenyl salicylates1a-1p(Fig.S26) were prepared according to literature73.
Ethyl isocyanoacetate (2) was purchased from commercial suppliers and used without further purification.
Further information on research design is available in theNature Portfolio Reporting Summarylinked to this article.
This work was supported by the National Natural Science Foundation of China (82473881 and 82273887 to L.Q.), the Joint Funds of the Zhejiang Provincial Natural Science Foundation of China (LTZ22B020001 to J.L.), Key Research and Development Program of Zhejiang Province (2025C02087 to Z.M.), and Zhejiang University.
We also thank Prof. Tingjun Hou for providing the server for computation and Prof. Chang-Yu Hsieh for helpful discussions throughout this work.
The computational calculations were also supported by the HPC Center of Zhejiang University (Zhoushan Campus) and the High-performance Computing Platform of YZBSTCACC.