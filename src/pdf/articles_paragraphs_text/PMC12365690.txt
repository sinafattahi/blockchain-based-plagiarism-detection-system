Relaxation-diffusion distribution characterizes tissue microstructure using multi-contrast MRI data without using a multi-compartment model. This work applies and generalizes two nonlinear spectral estimation algorithms to compute relaxation-diffusion distributions and compares their performances with the standard linear inverse method. The first algorithm employs maximum entropy (MaxEnt) estimation, extending previous methods by incorporating measurement noise for improved robustness. The second algorithm is based on the MUltiple SIgnal Classification (MUSIC) subspace spectral estimation technique, enabling pseudo-spectral estimation of multi-exponential signals sampled on regular grids without solving optimization problems. Both methods were compared against the basis representation technique and the nonnegative least squares (NNLS) method using synthetic andin vivodata. MaxEnt demonstrated superior spectral resolution compared to other methods. Meanwhile, the multidimensional MUSIC algorithm provided accurate estimations but required a higher signal-to-noise ratio. MaxEnt and MUSIC improve computational efficiency, especially when a high-resolution sampling grid is required for the density functions.

Magnetic resonance imaging (MRI), such asT1-weighted (T1w) andT2-weighted (T2w) MRI, provides different contrasts between tissue types to investigate the tissue structure and diagnose diseases (Lerch et al., 2017;Mugler III & Brookeman, 1990). Quantitative relaxometry improvesT1wandT2wMRI to measure theT1andT2coefficients using data acquired with multiple sequence parameters (Cheng et al., 2012;Deoni, 2010;Deoni et al., 2005;Fujita et al., 2019;Marques et al., 2010). Diffusion MRI (dMRI) provides complementary information to quantitative relaxometry about the microstructure of the cellular arrangement in the underlying tissue (Basser et al., 1994;Stejskal & Tanner, 1965). While diffusion MRI and relaxometry images are usually acquired and analyzed separately in neuroimaging research (Does & Snyder, 1996;Does et al., 1998;Kaden et al., 2016;Ning et al., 2015,2017;Palombo et al., 2020;H. Zhang et al., 2012), joint analysis of multi-contrast MRI data in a high-dimensional space of relaxation and diffusion can provide more specific information about tissue microstructure such as component-specificT1andT2relaxometry parameters (Chan & Marques, 2020;Chatterjee et al., 2018;Deoni et al., 2008;Lancaster et al., 2003;Raj et al., 2014), the relaxation and diffusion parameters (Gong et al., 2020;Veraart et al., 2018), or the correlation coefficients between relaxation and diffusion (Ning et al., 2020). Multi-compartment models are usually developed to estimate compartment-specific tissue parameters. However, the models depend on a priori assumptions of signal models, the number of compartments, and constraints on model parameters. Moreover, the estimation algorithm usually has the degeneracy issue related to locally optimal solutions (Jelescu et al., 2016;West et al., 2019).

An alternative approach for microstructure analysis is to estimate the continuous distribution of relaxometry coefficients (Kroeker & Mark Henkelman, 1986;Whittall & MacKay, 1989;Wiggermann et al., 2020;Yu et al., 2021) or the continuous distribution of diffusion coefficients (Periquito et al., 2021;Pfeuffer et al., 1999). This approach is generalized to the diffusion-relaxation correlation spectroscopy method to estimate the joint distribution of multiple tissue parameters in a high-dimensional space, such as theT1-T2,T1-Diffusion,T2-Diffusion, andT1-T2-Diffusion correlation spectroscopy methods (Avram et al., 2021;Benjamini et al., 2021,2023;Endt et al., 2023;Kim et al., 2017,2020;Martin et al., 2021;Ning et al., 2020;Slator et al., 2021;Topgaard, 2017). For simplicity, these methods will be collectively referred to as a relaxation-diffusion distribution (RDD) in this paper, which may represent distributions in any one or multidimensional subspace. Continuous relaxation-diffusion distributions provide a non-parametric approach to determining the number of tissue compartments and their tissue property. These methods are initially developed to investigate the microstructure of porous medium (Bernin & Topgaard, 2013;Callaghan et al., 2003;de Almeida Martins & Topgaard, 2018;Hürlimann et al., 2002;Montrazi et al., 2020;Song et al., 2002). Recent fast MRI acquisition techniques (Avram et al., 2021;Hutter et al., 2018;Ji et al., 2021,2022) significantly reduce the scan time to gradually make relaxation-diffusion distribution methods feasible forin vivohuman scans and neuroimaging research. The goal of this paper is to apply and generalize two nonlinear methods for RDD estimation and compare their performance with the standard linear inverse model.

Basis representation is a standard approach for estimating RDD using finite MRI measurements, where the basis matrix contains signals computed on a discrete set of parameters. The measured MRI data vector is represented by the basis matrix using a vector of representation coefficients. The number of basis functions is typically much larger than the number of measurements. Thus, the representation vector is estimated by solving an ill-posed inverse problem with a suitable algorithm such as the nonnegative least squares (NNLS) method (Benjamini & Basser, 2016;Kim et al., 2017;Wiggermann et al., 2020). This approach has several well-known limitations. The basis matrix depends on a pre-selected discrete set of tissue parameters. A low-resolution basis matrix can lead to inaccurate representations of off-the-grid spectral content (Chi et al., 2011), reducing the spectral resolution and the accuracy of the estimated tissue parameters. Increasing the number of elements in the basis matrix is usually not an efficient approach to boost the spectral resolution since it will worsen the coherence between the basis functions and escalate the computation complexity to solve the inverse problem, making it impossible to solve the NNLS problem within any reasonable time. Monte Carlo inversion methods have been proposed to improve the computation efficiency by drawing random samples in the parameter spaces (de Almeida Martins & Topgaard, 2018;Martin et al., 2021;Narvaez et al., 2022;Prange & Song, 2009;Topgaard, 2019). For large-dimensional spaces, these methods typically require a trade-off between the number of samples and the randomness of the results. Many previous studies have used low-resolution dictionary matrices with an ad-hoc selection of spectral resolution for correlation spectroscopy analysis with exact optimal solutions. For example, the method inAvram et al. (2021)uses 144 basis functions based on 12 samples in D and 12 inT1to estimate theT1-D correlation spectroscopy. InEndt et al. (2023), three dictionaries with 3600 basis functions were used separately to compute theT1-T2,T1-D, andT2-D distributions (60 samples in each dimension) without a joint three-dimensional representation of the density functions. A more efficient approach is needed for estimating high-resolution RDD analysis.

This work applies and generalizes two new methods for RDD estimation based on techniques from nonlinear spectral estimation. The first method is based on the maximum-entropy (MaxEnt) estimation approach, a classical technique for solving inverse problems in probability theory and power spectral estimation (Cover & Thomas, 2006;Jaynes, 1982). A well-known result in signal processing is that the MaxEnt power spectrum of a stationary time series with a finite set of autocovariances is represented by an auto-regressive model (Burg, 1975;Haykin, 1983). The Gaussian probability distribution is the MaxEnt distribution with fixed mean and variance in probability theory (Cover & Thomas, 2006). MaxEnt methods have been applied for the estimation of nuclear magnetic resonance spectroscopy (Heaton, 2005;Hoch, 1985;Rathi et al., 2014;Sibisi et al., 1984) andT1-T2distribution (Chouzenoux et al., 2010). The method inChouzenoux et al. (2010)relies on solving a large-scale convex optimization problem to directly estimate the density function, which is inefficient for large-dimensional data. The method inMitchell et al. (2012), which is based onHeaton (2005), estimates the optimal parameters of the maximum-entropy distribution in a much lower-dimensional space to improve computational efficiency. However, the algorithm requires solving a non-convex nonlinear least squares problem. Our previous work (Ning, 2023) introduces a dual formulation for MaxEnt RDD estimation, which involves a convex optimization problem in a low-dimensional space. In this work, we further extend the method inNing (2023)and derive a dual formulation for a problem similar toChouzenoux et al. (2010)to integrate measurement noise to improve the robustness of the estimation MaxEnt distribution by solving efficient convex optimization problems.

The second approach uses a generalized Multiple Signal Classification (MUSIC) spectral estimation method to characterize multi-exponential MRI signals. MUSIC and MaxEnt both belong to the family of nonlinear power spectral estimation algorithms to improve the spectral resolution of Fourier transform-based methods (Haykin, 1983;Stoica et al., 1997). The MUSIC method has been generalized to multidimensional spectral estimation inHua (1993);Liao (2015)and has been applied for NMR estimation (Li et al., 1998). This work introduces a modified multidimensional MUSIC method for MRI signals ofT1wcontrast with varying inversion recovery times. The MUSIC method can localize the peak locations of the RDD functions without solving optimization problems, a major advantage compared to other methods. However, it requires samples on a regular grid, which may significantly increase the scan time in practice.

The following sections will introduce more details on the background, the MaxEnt method, the MUSIC method, experiments, and comparison results for different simulationin vivodata methods. Small letters, such asxandθ, denote scalars for notations. Boldface letters, such asx,θ, denote vectors. Capital letters are used to either denote matrices, such asA,B, or integer numbers, such asKandN, whose meanings are self-contained within the context.

thenEq. (1)becomes the so-called multi-compartment models.

The density functionρprovides a non-parametric characterization of the tissue microstructure. The problem considered in this paper is to estimate the densityρgiven a finite set of measuress(xi)fori=1,...,Nwith known functionsa(x;θ). Suppose the signal source is from multiple tissue types. In that case, the number of dominant peaks in the density function estimates the number of compartments, with the tissue parameters given by the peak locations.

The general formulation inEq. (1)has been widely used in many applications to estimate the RDD functions where the distribution is calculated using the basis representation techniques. In these methods, theNdimensional signal vectorsis represented ass=AxwithA∈ℛN×Mwhere each column of the basis matrixArepresents signals from a single compartment. The vectorxcan be estimated by solving the inverse problem, using, for example, the nonlinear least squares (NNLS) algorithm, to provide a discrete representation of the density functions. The choice of the basis matrix is critical for the estimation results. High-resolution results require significantly higher computational complexity, especially for multidimensional data analysis. For example, assume thatKsamples are selected in each parameter space dimensionΘ, then a total number ofM=Kdbasis functions are needed. The increased size of the basis matrix significantly raises the computational complexity in solving the inverse problem to estimatex. The following sections introduce two alternative computationally efficient methods to solve the inverse problem inEq. (1).

wherean(θ)=a(xn;θ)for simplicity, and the objective function quantifies the Shannon differential entropy ofρ(θ).

The MaxEnt approach has led to several well-known analytic expressions, including the Normal distribution in moment problems with given mean and variances (Cover & Thomas, 2006), and the autoregressive model is the MaxEnt solution for a stochastic process with constraints on a finite autocorrelation series (Burg, 1975;Haykin, 1983).

The above dual formulation was applied to estimateT2-Diffusion distribution. The same approach can be applied to RDD analysis of arbitrary MRI signal models. However, a limitation of the formulation inEq. (3)is that the measurement noise is ignored, which is not satisfied in practice, making the results sensitive to noise. A general formulation is introduced below to incorporate measurement noise in the MaxEnt problem.

where the auxiliary variables^=[s^1;...;s^N]is introduced to mitigate the discrepancy between the density function and measurements because of noise. The nonnegative parameterσis selected based on the level of measurement noise. The maximization of the negative quadratic term inEq. (7)may seem uncommon, but this formulation simplifies the derivation of the dual formulation below. In probability theory, the entropy of a probability distribution can be interpreted as the log-likelihood over the space of all random probability distributions that satisfy the constraints (Jaynes & Bretthorst, 2003;Van Campenhout & Cover, 1981). In this framework,Eq. (7)can be interpreted as the maximum log-likelihood of the joint probability of the density function and measurement noise, assuming the noise is i.i.d. Gaussian noise, considering the density function has a unit integral. This interpretation suggests a heuristic choice forσasσ≈var(ϵ)​​/​∫Θp(θ)dθ. For a sufficiently small positiveσ, the optimals^nis expected to be close tosn, similar to the noiseless case in the above subsection.

The objective function inEq. (14)becomes the same as inEq. (4)ifσ=0in the noiseless case. Letλ^denote the optimal solutions toEq. (14), then the optimalρ(θ)has the same analytic expression given byEq. (6).

whereδijdenotes the Kronecker delta function.Eq. (17)shows that the functiong(λ)is strictly convex. In practice, the derivatives require a numerical implementation of the integrals. The optimization problem can be solved efficiently using the Newton algorithm, which only involves the inversion of anN×NHessian matrix, which is an advantage compared to the solution for basis-representation techniques that usually require computing the inversion of a large-scale matrix.

There are several theoretical advantages to introducing the auxiliary variable and measurement noise inEqs. (7)and(14)compared to the original formulations inEqs. (3)and(4). First, the auxiliary variables ensure that the primal optimization problem is strictly feasible, whereas the original primal problemEq. (3)may not have a feasible solution if measurement noise exists. The strict feasibility of the constraint inEq. (7)ensures that there is no duality gap between the primal and dual problems, so that the dual problem has a bounded optimal value. Second, the additional quadratic term introduces an identity matrixσIN×Nin the Hessian matrix to improve the condition number so that the inversion of the Hessian matrix is well-posed, which may not hold for the noiseless formulation inEq. (4).

This section introduces an alternative approach for correlation spectroscopic analysis of multi-exponential MRI signals. Exponential functions are often used for modeling signals in several MRI modalities, such as multi-echo MRI, diffusion MRI signal, and the combinedT2-relaxation and diffusion MRI techniques (Liang & Lauterbur, 2000;Mori & Tournier, 2014). In power-spectral analysis, the subspace methods consist of a family of approaches, including the MUltiple SIgnal Classification (MUSIC) method, that use the singular-value decomposition to decompose the measurements into the signal and noise subspace to estimate the pseudo spectra for power spectral analysis for trigonometric or exponential signals. The MUSIC subspace method does not require the solution of an optimization problem or the selection of a regularization parameter. In the following subsection, we introduce the background of the MUSIC method, a tailored MUSIC method for a special type of signal model forT1-weighted MRI with varying TI times, and a generalized MUSIC method for multidimensional RDD analysis.

where the numerator is introduced to normalize the testing signal vectore(θ). Since the signal vectorEq. (21)is orthogonal to the noise in the ideal case, the functionρMUSIC(θ)is expected to have peaks atθkfor allk=1,…,K. The functionρMUSIC(θ)is usually referred to as apseudospectral density function since it does not strictly satisfy the generative model inEq. (1).

where both the noise subspace matrix and the testing vector are projected to the space ofΠto remove the impact of the constant term on spectral analysis.

where⊗denotes the Kronecker product. Thus, by construction,e(θk)belongs to the column subspace of theH(s)in the noiseless case.

Similar methods can be used to generalize to d-dimensional spaces by using d-folder Hankle matrices. If the signal contains measurements with varying TI values, the method proposed inEq. (27)can be used to improve spectral resolution with a suitable orthogonal projection matrix.

whereN=2,D1​/​D2=0.8​/​0.3μm2​/​ms,R2,1​/​​R2,2=18​/​​121​/​s(i.e.,T2,1≈0.055s,T2,2≈0.083s) and the two compartments have an equal volume fraction. The signals are sampled on a regular grid withb=0,1,2,3,4,5ms​/​μm2andTE=0.071,0.101,0.131,0.161,0.191s. White Gaussian noise is added to the signals with different signal-to-noise ratios (SNR), that is, the ratio between the mean signal and the standard deviation of the noise, to investigate the sensitivity of the estimation methods with measurement noise.

where the parameters for the first component are fixed withDfix=0.8μm2​/​msandR2,fix=181​/​s. The parameters for the second component vary in the intervalsDmov∈[0.1,1.6]μm2msandR2,mov∈[4,34]1​/​s, respectively, with 31 samples for each variable. Gaussian noise with SNR = 300 is added to the simulated signals for each set of parameters. This experiment evaluates the performance of different methods for separating the two components.

whereN=3,D1​/​D2​/​D3=0.7​/​0.3​/​0.2μm2​/​ms,R2,1​/​R2,2​/​R2,3=18​/​13​/​301​/​s,R1,1​/​R1,2,R1,3=0.7​/​1.1​​/​1.51​​/​s. The range ofR1andR2values is selected based on the range ofT1relaxation time of different brain tissue (Bojorquez et al., 2017;Stanisz et al., 2005;Wansapura et al., 1999). The signals are sampled on a regular grid withb=0,0.75,1.4,2.1,2.8,3.5ms​/​μm2andTE=0.07,0.10,0.13,0.16,0.19​​sandTI=0.3,0.5,0.7,0.9,1.1,1.3​​s, respectively, and all three components have the same volume fraction. White Gaussian noise is added to the signal to investigate the sensitivity of the estimation methods to noise. This dataset provides insights to examine the benefit of using high-dimensional measures to resolve signals from different compartments. No variable parameters are investigated due to the large parameter space.

The proposed methods are applied to twoin vivodatasets. The first dataset is from (Ning et al., 2020) which includes dMRI with multiple TEs acquired on a Siemens MAGNETOM Prisma 3T scanner with the following parameters:b=0,0.75,1.4,2.1,2.8,3.5ms​/​μm2with 30 non-collinear gradient directions for each non-zero b value,TE=0.071,0.101,0.131,0.161,0.191s(same as simulation data),TR=5.9s, SMS=2, iPAT=2, 2.5 mm isotropic voxels, and the matrix size is96×96×54. The acquired data were processed to correct for motion and distortion using FSL Topup/Eddy (Smith et al., 2004). The dataset includes aT1-weighted MPRAGE. FreeSurfer (Fischl, 2012) is applied to obtain a tissue label map registered with the dMRI data using a rigid transform. The proposed methods are applied to estimate theR2−Ddistribution in various brain regions. The main goal of the analysis is to compare the different estimation methods and the microstructure across multiple brain regions.

whereR2*denotes the inverse of theT2*relaxation time. The dependence of TR is ignored since TR is much longer than typicalT1values. The MaxEnt andLS+methods are applied to estimate the joint distribution ofR1,R2*, andD. The MUSIC approach is not applied in this dataset because of the limited number and nonuniform samples for b-values and TEs. More specifically, the MUSIC approach requires uniform samples for the construction of Hankel matrices. The size of the Hankel matrix in each dimension should be larger than the expected number of signals. In these data, the nonuniform b-values and the limited samples of TEs make it infeasible to construct the 3-fold Hankel matrices as in the simulation data.

where each column ofArepresents the signal related to a specific tissue parameter. The estimated representation vectorxprovides a non-parametric characterization of the tissue parameters. To illustrate the dependence of the estimation results on the number of atoms in the basis, twoLS+methods are implemented in the analysis. The first method consists of106basis functions with 1000 samples forR2∈[0.3,3]1​/​sand 1000 samples forD∈[0.001,3]ms​/​μm2for the estimation ofT2-Diffusion distribution. The MaxEnt and the MUSIC methods are evaluated on the same set of grid points. The second method, namedLR−LS+, uses a basis matrix with4×104samples, with 200 samples inR2, and 200 samples in D on the same interval as above. The difference betweenLS+with a high-resolution grid andLR−LS+reveals the dependence of the basis-representation method on the resolution of basis functions.

For the estimation of the 3DR1-R2-D distributions in the simulation data, all three methods are evaluated on8×106grid points with 200 samples inR2, 200 samples in D as above, and 200 samples inR1∈[0.3,3]1/​s. For 3Din vivodata, theR1−R2*−Ddistributions are estimated based on 100 samples in each dimension forD∈[0.001,3]ms​/​μm2,R2*∈[0.5,100]1/​s,R1∈[0.33]1/​s. The 3D results provide information to evaluate the importance of using high-dimensional RDD for microstructure analysis.

The following metrics are used to examine the accuracy of the estimated density functions.

Number of Peaks (NoP):The number of dominant peaks of the estimated density functions is considered an estimate of the number of tissue compartments. The MATLAB-basedpeaks2function (Tikuišis, 2024) is applied to estimate the number of peaks in two-dimensional distributions. To mitigate the noise impact, a peak with a magnitude of at least10%of the maximum value of the density function is considered a legitimate peak. For the second simulation dataset, the estimated 3D density functions are projected to 2D marginals of theR2−D,R1−D, andR1−R2spaces, and the average number of peaks in the three marginals is considered as the estimated number of components.

whereθtrue,irepresents the true parameter vector of the i-th components andθpeak,jof the j-th peak. To reduce the bias of the error metric related to the difference in units, the parameters are all linearly scaled to the[0,1]unit interval for comparison.

Compared to the Peak Distance metric, the Wasserstein distance between the true and estimated density functions is sensitive to the bias in peak locations and the spread of the mass around the peaks. Moreover, it does not depend on any peak detection algorithm, providing an alternative and potentially more robust metric to evaluate the bias in the estimated density functions.

Figure 1illustrates the performance of the estimation methods related to different levels of SNR, shown in various types of plots with different free parameters in the algorithm on the x-axis. The first row shows the Number of Peaks (NoP) for the four methods averaged over 100 independent trials for differentlog(σ)values. For reference, the heuristic values forlog(σ)are equal to -3.26, -4.6 and -6.03 forSNR=50, 100, 150, respectively. The MaxEnt and (high-resolution)LS+have very similar performance with accurate estimation results in high SNR stimulation with relatively weak regularization parameters and underestimated NoP with a lower SNR. TheLR−LS+has underestimated NoP even with a high SNR. The MUSIC approach is sensitive to measurement noise, with accurate estimation with SNR = 200. The performance of MUSIC is stable as long as the dimension of the signal subspace is larger than the actual number of signals.

The performance MaxEnt,LS+,LR−LS+and MUSIC methods for the estimation of two-componentR2−Ddistributions using simulation data.

The second row ofFigure 1shows the Peak Distance metrics. For MaxEnt andLS+, the metrics increase with lower SNR and stronger regularization parameters. The MaxEnt has a lower error than theLS+approach. TheLR−LS+method has a more biased estimation than theLS+approach. The MUSIC method has the most accurate estimation at high SNR. The last row ofFigure 1shows the Wasserstein Distance between the true and estimated distributions. For MaxEnt andLS+, the distance increases with stronger regularization parameters, indicating that the peaks are merged but with the mass spread around the true parameters, while the number of peaks decreases. The MUSIC method has a higher distance error since it does not estimate the true distributions.

Figure 2illustrates the mean density function for the four methods based on data with SNR = 200, with the red crosses showing the true parameters. Both MaxEnt and MUSIC show two modes. TheLS+methods show one dominant peak because of the average effect between multiple density functions with variable peak locations and more spread distributions. TheLR−LS+failed to detect the second peak, indicating the importance of using high-resolution basis matrices. On average, the MaxEnt and theLS+method take 11.88 and 114.7 s computation time with MATLAB R2022 on a Linux workstation (Intel Xeon Gold 5318Y), but the MUSIC method only takes 0.1 s.

Illustration of the meanR2−Ddensity functions for the MaxEnt,LS+,LR−LS+and the MUSIC method for data with SNR = 200.

Figure 3illustrates the error metrics based on signals generated using a two-component model (32) with moving parameters. The first row shows the NoP maps for the four methods, where the two axes correspond toDmovandR2,movof the moving parameters. The metrics at each point of the image reflect the average values from 100 independent trials, which mitigates the impact of noise samples. The MaxEnt method shows a more accurate number of peaks than other methods, especially in the regions around the fixed parameters, indicating better spectral resolution. The image shows nonuniform metrics that depend on the relative locations of the parameters. TheLS+method only detects one peak in regions around the fixed parameters, indicating the reduced spectral resolution compared to the MaxEnt method. TheLR−LS+method shows significantly underestimated NoP values, highlighting the need for a high-resolution basis forR2−Danalysis. The MUSIC method displays different spatial patterns than the MaxEnt andLS+methods, with a larger area with underestimated NoP values but fewer areas with overestimated NoP values.

Illustration of the error metrics forR2−Ddensity functions for two-component signals with moving parameters generated usingEq. (32)with SNR = 300.

The second row ofFigure 3illustrates the Peak Distance error metrics, where the red arrow highlights the fixed parameters. All four methods have similar spatial distributions of the error metrics. The MUSIC method shows a lower value, indicating more accurate estimation if the two peaks are well separated.

The last row ofFigure 3illustrates the Wasserstein Distance between the estimated and true distributions. The MaxEnt method shows lower values than the other three methods, even in regions with overestimated numbers of peaks. The MUSIC method has higher errors than other methods, which is expected since the MUSIC method provides a pseudo distribution that does not satisfy measurements. The MaxEnt approach provides more robust and accurateR2−Ddistributions than other methods.

The first row ofFigure 4shows the performance metrics of the MaxEnt andLS+for estimating three-dimensional density functions with three components. A key result is that the MaxEnt andLS+perform significantly better than the two-dimensional case inFigure 1at SNR = 50. Specifically, MaxEnt andLS+have accurate NoP estimations for a wide range of regularization parameters. The MaxEnt method still has lower Peak Distance and Wasserstein Distance metrics than theLS+method, indicating a more accurate estimation of the density functions.

The performance MaxEnt,LS+,LR−LS+and MUSIC methods for the estimation of three-componentR1−R2−Ddistributions using simulation data.

The second row ofFigure 4shows the results for the MUSIC method. Similar to results inFigure 1, the performance strongly depends on the SNR. The MUSIC method accurately estimates the NoP only at very high SNR. The performance degrades significantly with lower SNR values.

Figure 5illustrates the two-dimensional marginal of the estimatedR1−R2−Dthree-dimensional distributions. The first two columns show the results for the MaxEnt andLS+methods, respectively, where the red crosses indicate the location of the true parameters. Both methods show three components in all 2D marginals. The MUSIC approach only shows one component at SNR = 50. The three components are revealed with a higher SNR = 200, as shown in the last column. Due to increased data size, the MaxEnt and theLS+method take much longer computation times, with 619 and 1019 s, respectively. The increased computation time for the MaxEnt method is mainly related to the integral in the computation for the gradients and Hessian. TheLS+method is more demanding on the memory related to the inversion of a large matrix, which limits the highest resolution in this example. The MUSIC method is the most time-efficient approach and only takes 1.4 s per trial.

Illustration of the two-dimensional marginals (first row:R1−Ddistribution, second row:R2−R1, third row:R2−D) of the estimatedR1−R2−Ddensity functions for the MaxEnt,LS+and the MUSIC method.

In summary, the results in this example show that the MaxEnt andLS+methods perform much better in separating multiple components in three-dimensional space than in two-dimensional spaces, especially in situations with low SNR. The MUSIC method accurately estimates data with high SNR if a sufficiently large number of signal subspaces is selected.

Figure 6illustrates the estimatedR2−Ddistributions averaged over multiple voxels in several brain regions. The first row illustrates the FreeSurfer-based labels for these regions overlaid on theT1wimage. The second to the fourth rows show the estimatedR2−Ddistributions from theLS+, MaxEnt, and MUSIC methods, respectively, averaged over all voxels in the selected brain regions. If the RDD distribution has multiple peaks detected by thepeaks2toolbox (Tikuišis, 2024), then the modes are classified into different components based on the underlying diffusivity. For example, the component with the lowest diffusivity is encoded by red and the green color encodes components with higher diffusivity. The black color highlights the overlaps between red and green colors over multiple voxels in the selected brain region.

Comparison of theLS+method (second row) and the proposed MaxEnt (third row) and MUSIC (fourth row) methods usingin vivoMRI data acquired in a two-dimensional space ofR2and D for different brain regions. Different components in each voxel are coded in different colors.

All three methods reveal two tissue components in the mean density maps. The gray matter region also includes the third component with a high diffusivity around 3μm2​/​msand lowR2(longT2), which is potentially related to the cerebrospinal fluid caused by the partial volume effect. Overall, the MaxEnt approach shows density maps and estimated mean NoP values similar to theLS+method but with much lower standard deviation values. The MUSIC method has the lowest variability in NOP measures and smoother density maps than the other methods. To examine the reliability of the results, the SNR is estimated using the denoising method inVeraart et al. (2016), which shows the estimated average SNR in the four regions in the first row ofFigure 6are 162, 280, 123, 148, respectively. Although the true value of SNR is unknown, the large estimated value indicates reliable estimation results. However, the estimated density maps show significant variability within each brain region, especially in the gray matter and thalamus, indicating heterogeneous microstructure across the voxels.

Figure 7shows the histogram of the estimated volume fractions for the components highlighted in red (slow diffusivity) and green colors (fast diffusivity) inFigure 6. The volume fraction is computed as the ratio of the integral of theR2−Ddistribution in the different subsets corresponding to the red and green components, divided by the total integral, which takes values between 0 and 1. The first row shows the histogram corresponding to theLS+method. The cortical gray matter and white matter regions, the slow-diffusion components, have a lower volume fraction than the fast-diffusion components. The peak distributions for the slow and fast distributions in white and gray matter are around (0.3, 0.65) and (0.3, 0.7), respectively. The thalamus and hippocampus regions show a reverse trend with higher volume fractions for the low-diffusion components and lower values for the fast-diffusion components. The peak distributions for the slow and fast distributions in both regions are around (0.8, 0.2).

Histogram of the estimated volume fraction for the components with slow (red) and fast (green) diffusivity.

The second row shows the histogram for the MaxEnt method. The distributions are similar to the results from theLS+method shown in the first row. In the white matter, the volume fraction for slow-diffusion components (red) has a slightly lower peak value around 0.2 compared to theLS+method.

The last row shows the volume fractions for the MUSIC method. Since the MUSIC method provides a pseudo distribution that provides an accurate estimation of the number of peaks and peak locations in some cases, but with a biased mass distribution as shown inFigure 3, the volume fractions are very different from the results of the other two methods, as expected.

It is noted that the two components are only separated based on the relative values of diffusivity, which may include various components in each category. Thus, each category is expected to include heterogeneous distributions of volume fractions.

Figure 8illustrates the averageR1−R2*−Ddistributions in three manually selected brain regions in the cortical gray matter, white matter, and the thalamus, respectively. The top panel shows the results for the gray matter region, highlighted by the blue circle, where the upper and lower rows show the results for the MaxEnt and theLS+methods, respectively. The three columns show theD−R2*,R1−R2*andD−R1marginal distributions. Both methods show the same components with low diffusivity withD= 0.7ms​/​μm2,R2*∈[10,25]1/​sand distributed in three clusters in theR1space, due to improved resolution in theR1space related to more TI samples, which are potentially related to different restricted/hindered water components. The CSF component is also reviewed in both methods, which is characterized by high D and lowR2*,R1values. But the MaxEnt method reveals an additional component, highlighted by the red circles in the first row, that is not shown in theLS+. This component is characterized by a high diffusivity, highR2*mainly between 40 1/s and 60 1/s, andR1values fall between those of CSF and tissue components. These measures are consistent with theR2*values of deoxygenated blood reported inZhao et al. (2007)and theT1value of blood around 1.7 s inX. Zhang et al. (2013).

Comparison of the three dimensionalR1−R2*−Ddistributions estimated using the MaxEnt andLS+methods for three brain regions. The red circles and arrows highlight the main differences between the two methods.

The second panel shows the estimated distributions in a white matter region. The MaxEnt andLS+methods show similar components with restricted/hindered diffusivity and lowR2*with multipleR1values. The red arrow in theD−R2*image shows that the MaxEnt method shows higher resolution with two separated components that are not clearly separated in theLS+results. Moreover, red circles show one component revealed by the MaxEnt method that is not shown in theLS+results. This component has similarR1,R2*, andDmeasures as in the components shown by circles in the first row, which are potentially related to blood components in the perivascular spaces. This component is associated with highR2*andDvalues, which significantly reduce the signal contributions. But its differentR1value makes it possible to separate the signal from other components with varyingTIvalues. Further investigations are needed to examine the reliability and the signal source of this component.

The last panel shows the distributions in a region of the thalamus. Both methods show similar results where the restricted/hindered component has higherR2,*values than the gray and white matter. The MaxEnt method shows higher resolution, which reveals more details in the distribution as highlighted in the red circle. The SNR for the three regions based on the noise map estimated using the MP-PCA denoising method (Veraart et al., 2016) are 87, 94, and 18, respectively.

The proposed MaxEnt and MUSIC methods have several theoretical and practical advantages compared to the basis-representation technique withLS+estimation methods. Specifically, the MaxEnt result shows more accurate peak locations and less biased density functions regarding the Wasserstein distance than theLS+approach in simulations. Moreover, the MaxEnt method has better computation efficiency than high-resolutionLS+by solving a convex optimization problem in a low-dimensional dual space without using a large inversion matrix.

Forin vivodata, the MaxEnt method shows a reduced variability in the NoP measures compared to theLS+approach. The results also show that high-dimensional correlation-spectroscopy with the MaxEnt method provides higher spectral resolution than low-dimensional methods to detect multiple tissue components, even with noisy data. On the other hand, the MUSIC approach is the most efficient algorithm since it does not require the solution of an optimization problem. Moreover, its performance is not sensitive to hyperparameters as long as the dimension of the signal subspace is sufficiently large. However, the performance of the MUSIC approach is sensitive to measurement noise. The MaxEnt andLS+better estimate high-dimensional density functions with noisy data than the MUSIC approach. The MUSIC method shows similar NoP measures forin vivodata since the direction-averaged dMRI data have sufficiently high SNRs. Furthermore, the 3DR1−R2*−Ddistributions have revealed more tissue components than 2D results. Although further validations are needed, high-dimensional RDD analysis provides a promising approach for tissue microstructure analysis.

We note several limitations of the proposed methods and results. First, the modified MaxEnt method inEq. (7)assumes that the measurement noise is Gaussian, which is usually not satisfied in MRI and depends on the image reconstruction algorithm (Cárdenas-Blanco et al., 2008;Gudbjartsson & Patz, 1995). An extension of the method for other noise distributions needs to be explored. Second, the ground truth forin vivodata is unknown. Further validations are needed to investigate the biological basis of the RDD functions using histology data as inBenjamini et al. (2023). Third, the dependence of the estimation results on the measurement parameters is also needed in future work to guide the most time-efficient sampling schedule. Previous works inKim et al. (2017),Liu et al. (2025), andSlator et al. (2021)have shown that applying a suitable spatial regularization or sparsity-promoting norms improves the linear inverse method for RDD estimation. Other methods have been proposed for RDD estimation using sparsely sampled data (Benjamini & Basser, 2016;Benjamini et al., 2023;de Almeida Martins & Topgaard, 2018;Manninen et al., 2024;Martin et al., 2021). Optimization of the MaxEnt method with sparsely sampled data will be examined in future work. Although the MUSIC approach requires samples on a regular grid, the performance of the MaxEnt method with sparsely sampled data with be examined in future work. Moreover, this work focuses on RDD estimation for scalar-valued diffusivity, which ignores direction-dependent diffusivity. The MaxEnt method is also feasible for the estimation of multidimensional diffusion tensor distributions as studied inTopgaard (2017,2019). An improved sampling method, such as B-tensor encoding (Topgaard, 2019;Westin et al., 2016), and more efficient algorithms, such as the Monte Carlo inversion method (Benjamini & Basser, 2016;Benjamini et al., 2023;de Almeida Martins & Topgaard, 2018;Manninen et al., 2024;Martin et al., 2021), may be useful to further improve the accuracy and efficiency for computing the distributions in high-dimensional spaces.

In summary, the proposed MaxEnt and MUSIC algorithms are computationally efficient methods for correlation spectroscopy analysis with potentially better performance than basis-representation methods.

This work was partially supported by the National Institute of Mental Health grants K01MH117346, R21MH126396, R01MH136160, R01MH132610, R01MH125860, and R01MH116173.

The code for the proposed methods is available athttps://github.com/LipengNing/ME-RDD.