A high-resolution spatial physiological atlas of cortical neurons serves as an essential reference for studying neurological diseases and is crucial for a comprehensive understanding of the cortical functions and physiological mechanisms. Although previous studies have elucidated the cellular basis of individual cortex, the molecular characteristics and precise spatial organization of neural cells within multiple human cortex remain incompletely understood. Subcellular-level spatial transcriptomic sequencing and snRNA-seq enabled mapping of 14 human cortical regions, creating a single-cell atlas with transcriptomic data from 1,121,772 nuclei and spatial profiles from 1,888,306 cells to characterize neural cell organization. The atlas reveals distinct expression patterns and spatial arrangements of neural cell types. Glutamatergic neurons show precise laminar patterns, with similar expression in adjacent cortex. SST neurons fall into two transcriptional categories, corresponding to superficial and deep layer distributions. The atlas, integrated with functional networks, highlights correlations between neural cell types and cortical functions, uncovering cell-cell interactions and ligand-receptor patterns with regional differences in neuron-glia communication. It also deciphers transcriptomic differences and cellular composition in layer 4 and the stable subplate (layer 6b) across regions. Our findings offer insights into the cellular foundations of complex and intelligent regions within the human cortex.

Human cortical functions rely on intricate spatial arrangements and interactions among neuronal cell types. Here, authors show a comprehensive cellular atlas illustrating detailed neuron distribution and communication patterns across cortical regions.

Diverse high cognitive functions were supported by cellular circuits formed by billion neural cells in different cerebral cortex regions1–3. High-resolution “cytoarchitectural atlas” of the human cerebral cortex is pivotal for understanding the mechanism of the cortical region performing specific functions4–7. Substantial application of many recent techniques has revealed the high diversity of neuronal cells, providing an unprecedented opportunity for the unbiased exploration of neural cell types3,8–10. By establishing a physiological atlas of cortical neural cells, our work serves as a powerful reference for future neuro-disease cell atlases11. Furthermore, it enables the identification of taxonomic and spatial heterogeneity in certain cortical neurons during the pathological progression of neurological diseases12.

To understand the cellular diversity in the human cerebral cortex, we conducted snRNA-seq on 42 samples from 5 adult donors without neurological disorders (Fig.1a) and sequenced 307,738 nuclei in 14 cortical regions. We then combined our data with published BICCN neocortex data, which covered 8 of the regions included in our 14 cortical regions, resulting in a total of 1,121,772 nuclei. Subsequently, in order to expand the snRNA-seq dataset and better discover the heterogeneity of cortical regions, we merged the BICCN published dataset and unified it at the taxonomic granularity (Fig.1bandSupplementary Figs.). Further to uncover the cortical spatial heterogeneity, we performed spatial transcriptome sequencing on 44 Stereo slides. Our dataset encompassed a broad spectrum of 14 cortical regions, including the frontopolar prefrontal cortex (FPPFC), dorsolateral prefrontal cortex (DLPFC), ventrolateral prefrontal cortex (VLPFC), primary motor cortex (M1), anterior cingulate cortex (ACC), primary somatosensory cortex (S1), primary somatosensory cortex of the eardrum (S1E), superior temporal gyrus (STG), inferior temporal gyrus (ITG), postcentral gyrus (PoCG), supramarginal gyrus (SMG), superior parietal lobule (SPL), angular gyrus (AG), and primary visual cortex (V1) (Fig.1c, Supplementary Dataset1). These were obtained from 9 donors across 14 cortical regions. The median cell number per slide of Stereo-seq was 42916 ± 16007 (Supplementary Dataset1).

Glutamatergic and GABAergic neurons, predominantly located in the cortex, serve as fundamental components in neural circuits by primarily exerting excitatory and inhibitory influences, respectively, within the cortical neural network. Identified transcriptionally, GABAergic neurons exhibit the expression of glutamate decarboxylase (eitherGAD1orGAD2), which is pivotal for synthesizing the inhibitory neurotransmitter GABA14. Conversely, cells that expressSLC17A7, a vesicular glutamate transporter, are typically categorized as glutamatergic neurons due to their capability to release the excitatory neurotransmitter, glutamate4. While subclasses of GABAergic and glutamatergic neurons can possess distinctive transcriptional profiles, morphologies, and functions, the relationships between these classifications can be complex, as underscored by the notable diversity within GABAergic and glutamatergic neuronal populations, as demonstrated by recent research15–17. Our atlas, defined by transcriptomic molecular features, aligns glutamatergic neurons with excitatory neurons and GABAergic neurons with inhibitory neurons, reflecting common classifications in neuroscience15,17–21. Given potential discrepancies among electrical, morphological, and molecular properties, we advocate primarily adhering to molecular criteria, especially since molecular markers stand out as the most insightful, and some molecular traits persist as lifelong cellular characteristics3. By integrating snRNA-seq and BICCN data, we defined transcriptionally 22 subclasses under 3 major classes (Fig.1d, and Supplementary Dataset2): 9 subclasses under glutamatergic neuron class, 7 subclasses under GABAergic neuron class, and 6 subclasses under non-neuronal cell class. And within the subclass, 153 cell types were further divided by transcriptomic characteristics with reference to BICCN data. Each cell type distributed evenly in each donor, indicating the uniformity of sampling in each cortical region. However, we observed that certain cell types exhibit preferential distribution in specific cortical regions. For instance, glutamatergic subtypes LINC00507_3 and LINC00507_4 are more prevalent in the primary motor cortex, while RORB cells, predominantly surrounding the granular layer, are abundant in V1. In contrast, most GABAergic neurons are less abundant in this region. These findings will be discussed in detail in the final section of this research. (Fig.1dand Supplementary Dataset2). Cajal–Retzius cells were not found due to a ratio of less than 0.1% of L1 neurons in the human cortex22. The abbreviations for the classification of nerve cells are as follows: Non-neuronal cells include microglia (MICRO), oligodendrocyte (OLIGO), vascular leptomeningeal cell (VLMCs), endothelial cell (ENDO), astrocyte (AST), oligodendrocyte progenitor cell (OPC). Neuronal cells are also divided into two categories: excitatory and inhibitory. Representative categories of glutamatergic neurons include near projection neurons (NP), intratelencephalic RORB neurons (L3-L4 IT RORB and L4-L5 IT RORB), intratelencephalic LINC00507 neurons (L2-L3 IT LINC00507), intratelencephalic layer 6 neurons (L6 IT), layer 6 Car3 neurons (L6 CAR3), layer 6b neurons (L6b), corticothalamic layer 6 neurons (L6 CT), extratelencephalic (ET), while the representative categories of GABAergic neurons are chandelier neuron (CHANDELIER), parvalbumin neuron (PVALB), somatostatin neuron (SST), lysosome-associated membrane protein 5 Neuron (LAMP5), paired box 6 neuron (PAX6), neuron-derived neurotrophic factor neuron (NDNF), vasoactive intestinal peptide neurons (VIP).

Previous studies have highlighted sex-related heterogeneity in brain structure and gene expression, suggesting potential influences on cellular composition and function23,24.To evaluate the impact of sex in donor sampling, we performed variance analyses on gene expression and cellular distribution data. We partitioned variance contributions from sex, age, spatial domain (layer), subclass, and region. Sex explained <1% of variance in both spatial (gene expression: 0.3%; cellular distribution: 0.8%) and snRNA-seq datasets (gene expression: 0.5%; cellular distribution: non-significant), whereas spatial domain and subclass collectively accounted for >90% (Supplementary Fig.1a, b). Despite limited female representation (2/5 spatial donors; 2/7 snRNA-seq donors), permutation tests confirmed no significant sex-driven clustering (FDR > 0.1). To investigate sex-associated molecular signatures, we performed differential gene expression analysis on datasets stratified by sex, followed by GO pathway enrichment and overlap analysis with disease-sensitive gene sets, categorized into snRNA-seq (Supplementary Fig.2a) and Stereo-seq (Supplementary Fig.2b) datasets. In the snRNA-seq dataset, sex-associated differential gene expression was predominantly observed in GABAergic neurons and non-neuronal cells at the subclass level, with these differentially expressed genes (DEGs) showing significant enrichment for autism spectrum disorder (ASD)-related pathways. In contrast, glutamatergic neurons exhibited minimal sex-associated transcriptional differences. For the Stereo-seq dataset, hierarchical analysis revealed relatively uniform sex-associated gene expression across cortical layers. Notably, sex-specific DEGs in each layer, such asKDM5DandZFY(male-enriched in layer 2), demonstrated substantial overlap with ASD-associated gene sets, highlighting a consistent link between sex-biased gene expression and ASD susceptibility across both datasets.

The spatial resolution of Stereo-seq is approximately 500 nm × 500 nm × 500 nm (i.e., each pixel corresponds to 0.5 µm × 0.5 µm, with a section thickness of 10 µm, though single-molecule localization precision can reach the nanoscale). For subsequent layer-specific analysis (spatial domain analysis), a grid of 100 µm × 100 µm bins (square bin size 200) was employed. For cell-type analysis, cell binning (masked based on nuclei staining, approximately 10–15 µm in size) was applied to facilitate cell-type deconvolution. To address concerns regarding potential bias from variable tissue section numbers (1, 4, 10, 13, 16) across donors, we conducted a multi-factor variance decomposition analysis. Using sum of squares (SS) calculations, we quantified contributions of five factors (donor, region, sex, age, spatial domain) to total variance in spatial transcriptomic data (total SS = 6,272,860). Donor-specific effects accounted for only 1.03% of total variance (SS = 64,347), whereas biological factors—spatial domain (93.77%, SS = 5,880,538) and region (4.62%, SS = 290,026)—dominated (Supplementary Fig.1aandc). To minimize technical confounders, we applied Seurat and Harmony with default parameters, treating donor as a batch factor and region/spatial domain as covariates. UMAP visualization confirmed minimal donor-driven clustering (Supplementary Fig.1c). These analyses demonstrate that biological variability vastly outweighs donor-related bias, validating the robustness of our dataset integration. The proportions of glutamatergic neuron subclasses in single-cell data strongly correlate with those observed in Stereo slides (Supplementary Fig.1d). Neuron proportions across cortical areas also show high consistency with BICCN published data, further validating our findings (Supplementary Fig.1e–h). To accurately identify spatial domains within cortical layers, we integrated multimodal data, including histology (HE and ssDNA staining) and gene expression, into a graph-based deep learning framework (DeepST)25for clustering. The resulting clusters were then annotated using laminar markers and deconvoluted cell type distributions, leading to the robust identification of spatial domains (Fig.2a).

aSingle-cell and laminar segmentation for Stereo-seq analysis. H&E and ssDNA staining was performed on the previous section to observe the morphological structure inside the cells, and total mRNA captured from a cortical section by the chip microspheres (Multiple spatial data input); DeepST utilities a deep graph network model to denoise and spatial spots clustering by using both information from image and transcriptomics (Clustering by deep graph network). Then, the results of domain were annotated with traditional laminar markers and cell type distribution deconvoluted by RCTD (Laminar annotation). The slide size is 1×1 cm. Each slide has completed transcriptomic segmentation mostly with L1 to WM. We captured a total of 1,888,306 cells from 44 slides and markers are displayed using the spare bin (100um×100um).bSpotplots of normalized expression for sample DLPFC, SMG, STG and V1 for genesMBP(marker for WM),SNAP25(marker for Neuron),CCN2(marker for layer 6b),THEMIS(marker for layer 6),PCP4(marker for around layer 5),RORB(marker for around layer 4),COL5A2(marker for layer 4 and layer 3),CUX2(marker for layer 3 and layer 2),LAMP5(marker for layer 2),PCDH8(marker for layer 2),LINC00507(marker for layer 2) andRELN(marker for layer 1).cHeatmap showing scaled expression of representative DEGs enriched in the cortical layer (L1, L2, L3, L4, L5, L6, and WM) (left) and the GO term enrichment analysis for specific regions, highlighting the molecular functions and biological processes (right).dThrough heatmap above, selected non-traditional laminar markers are analyzed as spotplots of normalized expression across 10 cortical regions. These includedCXCL14for layer 1,HPCAL1for layer 2,NEFMfor layer 3,NEFHfor layer 4,SNCGfor layer 5, and bothNPTX1andDIRAS2for layer 6. Additionally,ERMNandBCAS1served as markers for white matter (WM). The markers are displayed using the spare bin (100um×100um).

Various layers differed dramatically in both expression patterns and layer-specific cell types (Fig.2b). The transcriptomic expression of spots alters with spatial position, characterizing the spatial transcriptomic continuity in the cortex, consistent with prevalent neurobiological views26,27. A series of laminar markers can accurately locate different layers and show expression contiguity along with laminar changing (Fig.2b, and Supplementary Dataset2):CCN2highlights layer 6 and areas near WM,PCP4highlights layer 5 and the areas near layer 4,CUX2andCOL5A2for layer 3,LAMP5for layer 2,LINC00507/PCDH8for layer 2, andRELNfor layer 1. Classic markers such asMBPandTHEMISare the top markers for WM and layer 6. The supragranular layers are identified combinatorially by the markersRORBand dense cellular layer staining (Fig.2b). These markers are exceedingly restricted to specific laminar (Fig.2b), indicating satisfactory conserveness for precise laminar markers. At the same time, we can analyze the DEGs in each layer of Stereo slides and find out the non-traditional laminar markers (Fig.2c). Although it is crucial to identify DEGs between layers, some layers shared functional processes, such as the regulation of neurotransmitter secretion across layers 1 to 4 (Fig.2c). Finally, we present these DEGs on a spatial transcriptome slide,CXCL14is similar to the classic layer 1 markerRELN, whileNEFMis similar to the classic layer 3 markerCUX2, and has demonstrated good laminar labeling stability in 14 neocortical regions (Fig.2d).

Glutamatergic neurons are characterized by diverse projection patterns through which axons (long, branching processes that transmit electrical signals) send the neurotransmitter glutamate to other brain regions28. These projection patterns imply the specific brain regions they connect to and the functions they perform in those regions, so subclasses of glutamatergic neurons can be subdivided by projection patterns26,28–30. We leveraged the single-cell transcriptome data to divide glutamatergic neurons into 9 subclasses correspond to different projection types (Figs.3a and b). Intratelencephalic (IT) neurons formed a continuous transcriptomic spectrum of cells with highly correlated gradual changes in spatial position (Fig.3cand Supplementary Fig.3a). Detailed, IT includes 4 subclasses: The L2-L3 IT LINC00507 subclass in the supragranular, the L3-L4 and L4-L5 IT RORB subclasses bridging the supra- and subgranular layers, and the IT L6 subclass beneath layer 5 (Fig.3c, d). Other transcriptionally defined subclasses include the ET, NP, L6 CAR3, CT, and L6b (Supplementary Fig.3a). ET, NP, and CT neurons embody distinct classes of projection neurons, each presenting unique roles and projection patterns within the central nervous system. ET neurons in layer 5 expressCTIP2/BCL6, which are upregulate genes related to axonal maintenance, long-distance signal transmission, and synaptic connections to distant targets31,32. NP neurons specialize in local circuitry, upregulatingSYT6for short-range synaptic transmission and specificity33. Lastly, CT neurons in layer 6 expressFOXP2, supporting long axons and precise thalamic connections7.

aThe UMAP projection plot of glutamatergic neurons. glutamatergic neurons were divided into 9 subclasses corresponding to their projection types: NP, L6 CAR3, L6 IT, ET, L6 CT, L6b, L2-L3/IT, L3-L4/IT and L4-L5/IT.bDetailed UMAP plot showcasing diverse glutamatergic subclasses and the regional information.cThe spatially resolved single-cell transcriptome of the adult human telencephalon DLPFC as determined by Stereo-seq analyses (left). Scatterplot of Stereo-seq example (DLPFC) showing 4 IT gradient-laminar distributed glutamatergic subclasses (right). Cells are colored by their subclass ID (same color as in Fig. 3a). The slide measures 1 cm × 1 cm, with subclasses visualized using cell bins, and cell-type deconvolution conducted with 10 µm cell bins derived from Stereo-seq data.dLaminar distribution of typical glutamatergic neurons at the Stereo spatial cortical regions. Stereo spatial transcriptome results of the glutamatergic neurons were divided into 5 different subclasses. The color and alpha of spots denote the position of each neuron, same color as in Fig. 3a. The subclasses are displayed using the cell bin.eHeatmap showing scaled expression of representative DEGs enriched in L2-L3/IT, L3-L4/IT, L4-L5/IT, and L6 IT (left), and line charts showing the expression levels of marker genes in subclasses during the cortical layer from shallow to deep (right).

To further investigate cross-regional variation, we evaluated the similarity of these regions based on the transcriptomic separability of glutamatergic neurons and observed the specific and continuous variability of glutamatergic neuron subclasses across cortical regions (Supplementary Fig.3b–h). Glutamatergic neurons in spatially adjacent cortical regions have greater transcriptomic similarity (Supplementary Fig.3c, d), especially in the temporal lobe (ITG and STG) and the angular gyrus-connecting parietal triangle (AG, SMG, and SPL) (Supplementary Fig.3c, d). Next, our analysis focused on the DEGs among the 4 IT subclasses across various cortical regions (Fig.3e). We found that the four IT subclasses had unique markers that could identify them in 14 cortical regions (Supplementary Fig.3e–h), although they were similarly expressed in adjacent cortical regions. Furthermore, we also examined how different factors (region and layer) influence transcriptome changes (Fig.4a). Our findings revealed that the IT subclasses are generally less influenced by regional specificity. However, the expression differences become more pronounced when considering laminar changes (subclass changes) (Fig.4a).

aBetween-group sum of squares of factors affecting IT cell type transcriptome variation. Two-sided Anova significance: allp= 0 (n= 42).bThe cellular composition analysis by scCODA show differential subclass in snRNA-seq datasets, highlighting the significant reduction of LINC00507 IT neurons in the ACC. Each dot denotes cells in a subclass in one region compared to all others regions. Only the data with significant output from scCODA will be shown.cScatterplot of Stereo-seq example (ACC) showing 4 gradient-laminar distributed glutamatergic IT subclasses. Cells are colored by their cell density. The slide size is 1x1cm, and the subclasses are displayed using the cell bin.dMature neurons (NeuN) and projection neurons (MAP2) distribution. Left, NeuN and MAP2 staining for neuron. Right, laminar distribution of mature and projection neurons under immunohistochemical staining.eThe biplot showed the correlation between cortical region function and cell specificity by redundancy analysis (RDA). The angle reflects the correlation between function and cell type, and the length indicates the magnitude of each explicative contribution. A small angle between cell type and function suggests a positive correlation, while a large angle suggests a negative correlation. Here ET neurons show a strong correlation with pain function.fDetailed representation of specific cortical regions relevant to pain perception. Zoom-in Stereo slides view for pain-positive (S1, S1E, PoCG, ACC) and pain-negative (ITG, AG, FPPFC) cortical regions, illustrating laminar organization and the distribution of ET. ET densely distributed in pain relevant regions such as S1, S1E, PoCG, while the region with least correlation with pain were found much less ET. The down left plot denotes the pain correlation in cortical regions.gViolin plots in ACC (left) and other regions (right) show the expression of differential genes in ET, ANOVA q-value adjusted. ***p< 0.001, **p< 0.01, *p< 0.05.hDot plot represents the specific pathways of ET neurons in different cortical regions, highlighting their unique characteristics across various areas, highlighting the molecular functions and biological processes of ET in multi-cortical regions. (Hypergeometric test (q-value adjusted)).

To investigate age-dependent trends in LINC00507 expression, we integrated spatial transcriptomics and snRNA-seq data across donors of varying ages. Spatial analysis revealed a pronounced, pan-regional decline in cytoplasmic LINC00507 expression with age (Supplementary Fig.4aandc), corroborated by snRNA-seq (Supplementary Fig.4band d), showing reduced abundance of LINC00507-expressing L2-L3 IT neurons in prefrontal regions (Supplementary Fig.4eandf). Linear mixed-effects models identified significant negative correlations between age and LINC00507 expression (adjusted p < 0.05), with effect sizes ranging from −0.21 to −0.54 (spatial) and −0.18 to −0.49 (snRNA-seq), suggesting that bulk-tissue declines arise from diminished neuronal counts and expression34. These findings align with prior reports and extend them to finer laminar resolutions.

In the subsequent analysis, we examined the differences in cell composition across various brain regions and found that the proportion of L2-L3 IT neurons in the ACC was lower in the single-cell data (Fig.4b), a trend also confirmed by the Stereo slide displays (Fig.4c). We then performed immunohistochemical staining of these characteristic cortical regions using markers such as NeuN and MAP2. The staining confirmed that ACC shows a lower proportion of superficial IT neurons compared to other regions (V1, FPPFC) and lacks a distinct layer 4 (Fig.4dand Supplementary Fig.4g). Besides, comprehensive observations through immunohistochemistry and Stereo slides also revealed the presence of ET (Von Economo neurons) within the ACC. Notably, layers 5 and 6 in the ACC have a higher proportion of gray matter (Fig.4d).

Meanwhile, diffusion weighted imaging and fiber tractography provide a unique noninvasive technique to study the macro-connectivity structure within the brain35. To enhance the precision of functional mapping, we employed the Neurosynth framework for meta-analysis, which provides term-region associations at a 2 mm³ resolution36. This resolution adequately supports the examination of our 14 cortical regions, aligning with their spatial dimensions and facilitating reliable correlations between functional attributes and cell-type distributions37. The 2-mm resolution of Neurosynth enables effective functional assignments across broad cortical areas, with meta-analysis mitigating limitations of individual fMRI studies by integrating data from multiple sources. By quantifying such data, we generate a connectome matrix that reveals that higher-order functions like working memory score highly in the prefrontal lobe, while primary sensory functions (motor and pain back) score higher in the central sulcus (Supplementary Fig.4h). Further linkage with our cellular atlas suggests that the higher-order functions of the prefrontal lobe may be related to the higher density of RORB cell types within this cortical region, while the primary sensory functions of the central sulcus may be more relevant to ET (Fig.4eand Supplementary Dataset3). We found that the pain-related cortical regions in the cortical functional imaging were adjacent to the postcentral sulcus (S1, S1E, and PoCG) and ACC (Fig.4fand Supplementary Fig.4h). We also found that ETs in the postcentral sulcus are densely located in layer 5 (Fig.4f). It is speculated that the dense presence of ETs in layer 5 in the neocortex is highly related to the pain-related functions of the cortical region. So even though the ACC belongs to the periallocortex, the ACC exhibits pain-related functions because there are more ETs in the wider fifth layer (Fig.4f). Von Economo neurons (VEN), large spindle-shaped cells, are expected to be ET in the human telencephalon, and they are restricted to the ACC and frontal insula (FI)31. The ETs in humans and macaques significantly overexpressed more than half of the known VEN marker genes, whereas other neuronal subclasses did not, suggesting that ETs contain VEN38. We also found that these VEN marker genes described in the FI region did not apply to ET in the ACC region, and there was only one ET cluster in the ACC, which were generally highly expressed:GNA15,LYPD1, andNEUROD1(Fig.4g). Gene ontology (GO) terms were performed for ET in the ACC, and they were found to be associated with SRP-dependent cotranslational protein targeting membrane and cytoplasmic translation (Fig.4h).

The atlas also covers cortical non-neuronal cells, showing the distribution of non-neuronal cells in cortical regions (Supplementary Fig.5a, b), as well as their proportions and specific distributions across cortical areas (Supplementary Fig.5c, d). Compared with non-human primates, humans exhibit a higher proportion of OPCs, suggesting that genes associated with the regulation of OPC maturation—specifically, FOXP2, THEMIS, and PCDH15—are more abundantly expressed in the human cortex33. Utilizing Stereo slides, we investigated the distribution of these genes and discovered that their highest overlapping regions are located within layer 6 and even in the WM (Supplementary Fig.5e). Moreover, our gene density analysis across cortical regions revealed a likely higher prevalence of cells co-expressing FOXP2 and THEMIS in the SPL and DLPFC (Supplementary Fig.5f). Non-neuronal subclasses vary in layer distribution, reflecting their functions, such as guiding neuronal migration or stabilizing synaptic connections (Supplementary Fig.5g). OLIGOs are more prevalent in WM, while OPCs are scattered across layers. OPCs play a vital role in nerve conduction and neural development39–41, with consistent numbers across cortical regions but varying gene expression patterns (Supplementary Fig.5h).

Besides, we identified five astrocyte clusters through a comparative analysis with published BICCN cell classifications and subsequently focused on examining their distribution across various cortical regions, as well as their spatial arrangement on Stereo slides (Supplementary Fig.5i–m). Our Stereo-seq analysis revealed that the proportions of Astro4 and Astro5 cells were markedly higher in the ACC compared to other cortical regions (Supplementary Fig.5i, j), and densities were significantly elevated relative to other neocortical regions (Supplementary Fig.5k, l). Astro5 cells were more frequently observed in white matter regions than Astro4 cells, indicating potential functional differences between these astrocyte subtypes in distinct cortical environments (Supplementary Fig.5l). Further DEGs analysis across cortical regions identifiedTMEM144as a gene specifically expressed in Astro4 andSGK1as a gene specifically expressed in Astro5 within the ACC (Supplementary Fig.5m).

Additionally, we leveraged atlas-based analysis to decipher the single-cell spatial transcriptomic profiles of GABAergic neurons. GABAergic neurons are primarily involved in local communication within a specific brain region. They form connections with other neurons within the same brain region and play a critical role in the integration and processing of information within that region42. GABAergic neurons in the taxonomy were split into two groups: caudal ganglionic eminence (CGE)-derived and medial ganglionic eminence (MGE)-derived (Fig.5a). In detail, we identified 4 subclasses of the CGE branch: LAMP5, NDNF, PAX6, and VIP (Fig.5a). On the contrary, MGE-derived neurons have 3 subclasses, CHANDELIER, PVALB and SST (Fig.5a), with developmental fates derived from ventral and dorsal MGEs, respectively43,44. In the adult human cortex, the CGE-derived and MGE-derived neurons accounted for 45% and 55% of the total (Fig.5a), consistent with initial neurodevelopmental origins4,14,45,46, indicating a relatively stable composition of GABAergic neurons during the whole human life.

aUMAP of GABAergic subclasses. Each subclass is represented by its specific color region. The values represent the number of cells.bDistribution of typical CGE-derived subclasses at the stereotaxic cortical regions. The color and alpha of spots denote the position of each cell. The slide size is 1x1cm, and the subclasses are displayed using the cell bin.cUMAP plot distinguishing between the shallow and deep families within the GABAergic SST neuron, respectively (up); distribution of SST clusters within shallow and deep families (down).dZoom-in Stereo slides view for deep and shallow SST family in cortical regions, illustrating different distribution of MGE-derived deep and shallow SST family, with the color of spots denoting the position of each cell. The subclasses are displayed using the cell bin.eHeat map of DEGs between deep and shallow SST families. The horizontal axis is the DEGs and the vertical axis is the cluster, showing that the clusters in the two types of families are significantly different in terms of DEGs.fUMAP plot shows the distribution ofCALBin deep and shallow SST families.gThe enrichment of biological processes in the deep and shallow SST family.hThe observation of typical gene expression patterns of SST families in both shallow and deep stereocortical regions. Dot plots showcase the gene expression levels for 6 representative shallow and deep SST families in each cell. In these plots, the position of the dots corresponds to the cell’s location, while the color intensity indicates the expression level. The genes are displayed using the spare bin (100um×100um).

We found that most CGE-derived clusters favored a supragranular arrangement, especially taxonomic NDNF is present at the superficial layer (Figs.1d and5b), whereas MGE-derived clusters had no apparent laminar restriction. Compared with GABAergic neurons in the mouse cortex, the CGE-derived neurons in the human cortex migrate more shallowly within the tissue and contribute more cells that not only localize exclusively around layer 5 (Fig.5b)47.

Through Stereo slides, it was found that MGE-derived SST neurons have upper and lower layering characteristics (Fig.5c), and MERFISH also confirmed this48. SST neurons exhibit a division into upper and lower regions, with the L3 region showing relative sparsity (Fig.5d). We hypothesize that this pattern results from distinct migratory pathways during development. Specifically, superficial SST neurons migrate through the marginal zone (MZ), while deep-layer neurons migrate via the subventricular zone (SVZ), leading to well-defined layering49. Additionally, we found that 20 genes exhibited upregulation in deep SST neurons compared with shallow SST neurons (Fig.5e). The CALB showed a notably higher expression in superficial SST neurons (Fig.5f), neurons expressing CALB exhibited a tendency to receive more robust input from excitatory neurons within the same layer compared to calbindin-negative neurons49. In contrast, SST neurons located in the subgranular layer were predominantly calbindin-negative (Fig.5f). Furthermore, deep SST neurons are associated with G-protein coupled neurotransmitter receptor activity, while superficial SST neurons are more active in cyclic adenosine monophosphate (cAMP) phosphodiesterase activity (Fig.5g). Besides, we noticed that marker of shallow SST familyPDZD1,GNAL,GRIA4, andCALB1were more expressed in the superficial layer, whileDCC,TRHDE, andGRIN3Aof deep SST family were co-expressed in deep layer (Fig.5h).

High-resolution spatial Stereo-seq enabled us to infer cell-cell interactions resulting from somatic contact or paracrine signaling, which is inferred by frequent cell proximity21,50(Fig.6a). To investigate these potential specific cell-cell interactions, we considered calculating the frequency of observed somatic contact or proximity among cells at the subclass level. Apart from interactions within non-neuronal subclasses, we observed a tendency for non-neuron contact or proximity pairs with certain layer-restricted excitatory neurons (Fig.6b). We also examined the frequency of interactions between subclasses across 4 cortical lobes and found that the IT subclass showed layer-specific interactions with other neuronal cells in these 4 lobes. Interestingly, the GABAergic subclass, particularly in the infragranular layers (layers 5-6), presented more interactions with IT than with CT and NP, while non-neuronal cells did not exhibit a similar trend (Fig.6c). Further analysis of interaction patterns across cortical regions revealed that the ACC and V1 differed significantly from other cortical regions, possibly due to their unique laminar relationships (Fig.6d–f).

aSpatial slide of major subclasses of Glutamatergic neuron (EXC), GABAergic neurons (INH), and non-neuronal cells in 4 lobes (left); and zoomed-in view of the boxed region show multiple somatic contact forms of cell-cell interactions at spatial maps (right). Colored shapes are cell nuclei segmentations. The slide size is 1x1cm, and the subclasses are displayed using the cell bin.bEnrichment map of pairwise soma contact or proximity for subclasses of cells in the human cortex. The color indicates the observed frequency of soma contact or proximity.cHeatmap showing the laminar arrangement of soma contact or proximity interaction patterns (1v1) in the four brain lobes.d,eHeatmap showing the distribution of frequent interaction patterns across cortical regions.fLine chart and heatmap showing the distribution of the somatic contact forms between OLIGO/OPC and various neuronal subclasses in 14 cortical regions. Error bars are provided in the Source Data.gEnrichment of ligand-receptor pairs in contacting microglia/astrocytes and neuronal subclasses.hLine chart and heatmap showing the distribution of the somatic contact forms between astrocyte and various neuronal subclasses in 14 cortical regions. Error bars are provided in the Source Data.iLine chart and heatmap showing the distribution of the somatic contact forms between microglia and various neuronal subclasses in 14 cortical regions. Error bars are provided in the Source Data.jHeatmap showing the distribution of pairing contact microglia/astrocytes and INH/EXC in 14 human cortices.

In the ligand-receptor analysis, astrocytes primarily engage with other neuronal types through mainly three receptor-ligand pairs: NRG3-ERBB4, NRXN1-LRRTM4, and NRXN1-NLGN1. Conversely, microglia demonstrate a more diverse set of receptor-ligand interactions in their communication with various neuronal types. (Fig.6g). We also observed various combinations of these two glial cell types across cortical regions, finding that microglia exhibit greater diversity (Fig.6h, i), whereas the combination of astrocytes with neuronal types showed a specific high proportion in S1E (Fig.6j).

The cytoarchitectural atlas of the adult human cortex provides us with a precise tool for deciphering cortical layers and fine structures. The cellular basis of layer 4 is crucial for understanding sensory processing and related neurological diseases51,52. Although markers for layer 4 and L4-like neurons have been identified in the M1 region15, the distribution and expression pattern of layer 4 in 14 cortical regions remain unknown. To explore this further, we analyzed the distribution density of different subclasses within each cortical region (Fig.7a). Our findings revealed that L3-L4 IT and L4-L5 IT RORB glutamatergic neurons dominate in the V1 region (Figs.7b, c). Using the arrangement of layers in Stereo slides, we calculated the proportion of each layer within the gray matter. Notably, layer 4 in V1 was the largest, significantly exceeding its proportion in other cortical areas (Fig.7dand Supplementary Fig.6). This distribution pattern was closely associated with the pronounced thickness of layer 4 in the visual cortex, as indicated by the higher abundance of RORB neurons (Fig.8a). This analysis confirmed this correlation, highlighting the relationship between the thickening of the granular layer and the increased presence of RORB neurons (Fig.8b).

aThe density distribution of each subclass in the cortical regions (n= 42). The density statistics are shown below. The color follows the color assigned to each subclass in the taxonomy.bHeatmap showing the density distribution of each subclass in cortical areas.cThe biplot showed the correlation between cortical region and glutamatergic subclasses by RDA. The angle reflects the correlation between cortical region and glutamatergic subclasses, and the length indicates the magnitude of each explicative contribution.dThe boxplot depicted the layer arrangement of grey matter in 14 cortical regions using Stereo slides (n = 44, FPPFC = 4, DLPFC = 7, VLPFC = 5, M1 = 3, S1 = 3, S1E = 1, PoCG=1, SPL = 3, SMG = 4, AG = 6, V1 = 3, ITG = 1, STG = 1, ACC = 2, Minimum, maximum, center points, and box boundaries of box plots are provided in the Source Data.) (Two-sided Anova, *p< 0.05, **p< 0.01, ***p< 0.001).

aA refined laminar annotation identification of layer 4 in visual cortex (n= 3), DeepST AI-assisted semi-supervised laminar segmentation based on nucleic acid and cell type annotation.bThe spatially resolved single-cell transcriptome of the adult human telencephalon V1 (n= 3) as determined by Stereo-seq analyses (top left). Selected an area with a layered structure (top right). Scatterplot of two Stereo-seq example (V1) showing gradient-laminar distributed subclasses (down). Cells are colored by their subclass ID (same color as in a). The slide size is 1x1cm, and the subclasses are displayed using the cell bin, and cell-type deconvolution is performed using 10 μm cell bins derived from Stereo-seq data.cVolcano plots showing layer 4 DEGs in 14 cortical regions. The 3–4 most significant genes are shown with their names highlighted (two-sided Wilcoxon test, Bonferroni corrections for multiple comparison; genes with adjusted P < 0.01 and fold change > 1.2 are defined as significant).dVolcano plots showing DEGs in the fine structure of layer 4 in V1. The 6 most significant genes are shown with their names highlighted (two-sided Wilcoxon test, Bonferroni corrections for multiple comparison; genes with adjusted P < 0.01 and fold change > 1.2 are defined as significant).eHeatmap showing scaled expressions of representative DEGs enriched in L4a, L4b, and L4c (left), and the GO term enrichment analysis for specific regions, highlighting the molecular functions and biological processes (right).fStereo spatial slides of layer 4 in V1 showing expression of markers related to the fine laminar structure. In these plots, the position of the dots corresponds to the marker expression in cells, while the color intensity indicates the expression level.

We then examined the DEGs in layer 4 across 14 cortical regions and found significant downregulation ofADAMTS3andFFAR4in V1 (Fig.8cand Supplementary Fig.7), while schizophrenia or neurodegenerative-related genesLRRC73andOGNwere expressed in layer 4 of the temporal lobe (ITG, STG) (Supplementary Fig.7and Supplementary Dataset4). Building on these findings, we employed high-resolution Stereo-seq to perform semi-supervised laminar clustering, further subdividing layer 4 of V1 into three distinct sub-layers and analyzing the differential gene expression within these sub-layers (Fig.8d, e). Finally, Stereo slides validated the accuracy of these DEGs as spatial markers, withEGR1marking L4a,NEFHandSYT2marking L4b, andCD74andCNTN5marking L4c (Fig.8f, and Supplementary Dataset4).

In addition to layer 4, we leveraged the atlas to search for finer structures in human cerebral cortex, like layer 6b (Supplementary Fig.8a). This structure was transcriptionally defined as layer 6b in the human cerebral cortex, and its neurons differ from those in layer 6 and express markers of cortical subplate neurons such asCTGF(CCN2),SEMA3E, andMGST1, etc (Supplementary Fig.8b)53,54. These findings demonstrate that layer 6b is not a transient structure and is stabilized in the posterior segment of layer 6 versus the anterior end of the WM55,56, suggesting that cortical subplate neurons may be a permanent subpopulation. Cortical subplate neurons have only L6b in layer 6b to regulate the activity of deep cortical circuits57, while L6 CT is a transitional cell type that exists between layer 6 and layer 6b (Supplementary Fig.8c). Through differential analysis of the L6b region in each cortical region, it can be found that most regions in the neocortex relatively stable express genes with differential features (Supplementary Fig.9and Supplementary Dataset4).

Besides, we also provide a detailed comparison between our dataset and the BICCN dataset using UMAP visualization, examining the distribution and DEGs at the subclass level (Supplementary Figs.10–51). Additionally, we present the atypical laminar markers identified through hierarchical differential gene expression analysis in Fig.2, visualized across 44 Stereo-seq slices (Supplementary Figs.52–60). Lastly, we perform and present differential gene expression analysis on cortical layers beyond L4 and L6b, further highlighting layer-specific transcriptional profiles (Supplementary Figs.61–67).

We profiled the transcriptomes of 307,738 nuclei from 42 fresh samples, even merged 814,034 nuclei from BICCN published data, and 1,888,306 cells for 44 Stereo slides of 9 donors across the entire human cerebral cortex. We conducted a comprehensive census of cellular diversity and spatial arrangements, which facilitated the delineation of the cellular layer distributions of cell types and provided much more spatial and transcriptomic information than traditional approaches such as RNAscope4,15,58.

Our analysis shows that neural cells in the human cortex exhibit high diversity in cell types and heterogeneity in spatial arrangements. There are favorable mappings among different cellular attributions, such as transcriptomically taxonomic classification, molecular features, laminar distribution, and developmental fate. We showed that differences in expression across different types of glutamatergic neurons may help explain the range of projection patterns (Fig.3). Glutamatergic neurons appeared to be more layer-specific with unimodal distribution, like the RORB neuron type spanning the supra- and subgranular layers and the LINC00507 neuronal type prevalent in the superficial layer. Besides, four types of CGE-derived interneurons were found that tend to arrange in the superficial layer throughout the cortex (Fig.5b). Moreover, we also used spatial transcriptomics with nanoscale resolution to predict cell-cell interactions caused by somatic contacts or paracrine signaling, and discovered combinatorial patterns in multiple neural cells. Simultaneous cellular atlases also revealed the localization of layers 4 and 6b in multicortical regions, exposing specific marker genes and cellular structures.

Previous studies in mice have similarly revealed conserved cellular structures and interactions across cortical layers, employing single-cell transcriptomics and spatial transcriptomics to map cell types and interactions in the mouse brain59,60. However, our study extends this framework by uncovering unique features of the human cortex that are absent in mouse models, such as region-specific variations in SST neurons. These neurons are divided into deep and shallow families with distinct transcriptomic profiles and biological processes. The upregulation of genes likeCALBin shallow SST neurons and the activation of G-protein-coupled receptors in deep SST neurons represent significant differences from the findings in mouse studies. Moreover, our detailed analysis of layer-specific cell-cell interactions underscores the complexity and heterogeneity of neuronal communication within the human cortex.

Our cytoarchitectural atlas covers the entire human cerebral cortex, and samples with high quality and completeness have improved the reliability and robustness of this work. Yet a larger cohort of samples with more cells and genes by more advanced techniques can promote more appropriate and accurate output, which helps find out rarer cell types and bring more insights into potential heterogeneities like genders and ages. Our sex-stratified analyses confirm that the primary findings are robust and independent of sex, with sex-related effects being minimal. By excluding sex-linked genes in our analysis, we minimized potential confounding factors. However, larger cohorts are needed to comprehensively evaluate sex- and age-related interactions. Moreover, we took a robust clustering but conservative in spatial domain identification, which may ignore variability within clusters. Future work should flesh out these differences, as well as link transcriptomic characteristics with morphology and electrophysiology61.

Overall, our study demonstrates the potential power of combining snRNA-seq and spatial transcriptome sequencing for exploring the cellular basis of sensory perception, cognition, and behavior. Research along these lines may not only help elucidate the mysteries of human cognition but also accelerate our understanding of neurological disorders62.

This study was approved by the Ethical Committee of the Harbin Institute of Technology (Approval No. HIT-2021004). Tissues were collected from individuals who died suddenly and had no known history of brain injury or neurological disease. A total of nine neurologically healthy human donors (2 females and 7 males), ranging in age from 5 to 61 years, were included in this study. Among them, five donors were used for Stereo-seq analysis (age: 39 ± 19.9 years; postmortem interval [PMI]: 6.6 ± 2.2 hours), and five donors were used for snRNA-seq analysis (age: 51.4 ± 12.2 years; PMI: 14 ± 4.2 hours) (mean ± standard deviation). Written informed consent was obtained from all participants or their legal next of kin. Postmortem brain donation was authorized by the families, who were provided with non-financial compensation. In accordance with legal and ethical regulations prohibiting monetary incentives, compensation was offered in the form of genome sequencing of the donated brain tissue. The results of the sequencing—screening for potential neuropsychiatric or hereditary neurological conditions—were subsequently communicated to the families. All experiments were performed by following the guidelines of the International Review Board and Institutional Ethics Committee. Brain samples were collected after donor family members signed informed consent in compliance with sample use and storage guidelines. In addition, tissues were used with the informed consent of immediate family members. Coronal sections were used only if they were confirmed not to show neurological or neuropsychiatric disease, based on an assessment by a forensic expert in the Department of Forensic Medicine of Guangdong Medical University. All coronal sections in the study were collected within 48 hours after death and showed an RNA integrity number (RIN) of at least 6.2. Besides, samples for spatial transcriptomic sequencing have RIN over 7 (Supplementary Dataset1).

This study was conducted in collaboration with local researchers, who contributed to study design, implementation, and data interpretation. Roles and responsibilities were agreed upon prior to the research, and capacity-building opportunities for local partners were prioritized. The study adhered to local ethical guidelines and was approved by the Harbin Institute of Technology (Approval No. HIT-2021004). Research protocols followed higher international standards where local regulations were insufficient. We ensured participant safety and minimized risks of stigmatization or harm. Relevant local and regional literature was incorporated into our analysis to contextualize findings. Benefit-sharing measures were discussed for any transferred materials or knowledge.

Coronal brain sections were suspended in pre-chilled to −80 °C, oxygenated artificial cerebrospinal fluid [0.5 mM calcium chloride (anhydrous), 25 mMd-glucose, 20 mM HEPES, 10 mM magnesium sulfate, 1.2 mM sodium phosphate monobasic monohydrate, 92 mMN-methyl-d-glucamine chloride (NMDG-Cl), 2.5 mM potassium chloride, 30 mM sodium bicarbonate, 5 mM sodiumd-ascorbate, 3 mM sodium pyruvate, and 2 mM thiourea]. The sections in artificial cerebrospinal fluid were quick-frozen on dry ice and transported to a pathology dissection table. The following cortical regions were identified in 14 brain sections. These regions were separately extracted from the 14 sections, cut into smaller pieces, immersed in OCT fixative (catalog no. 4583, Tissue-Tek® Sakura, Torrance, CA), quick-frozen on dry ice, and stored at −80 °C until cryosectioning.

Sections were stained with hematoxylin-eosin as follows. Sections were incubated for 1 min at 37 °C, fixed in methanol at −20 °C for 30 min, incubated for 7 min in hematoxylin, for 2 min in Bluing Buffer (catalog no. C0105S, H&E staining reagent test kit, Beyotime, Shanghai, China), and 1 min in eosin. Between each staining step, slides were washed with DNase- and RNase-free water (catalog no. 10977023, Invitrogen™, MA, USA). Stained sections were imaged under a microscope (ECLIPSE Ti, Nikon, Tokyo, Japan).

Sections were stained with Nissl solution as follows. Sections were washed briefly in tap water to remove residual salts, immersed in 2 changes in 100% ethanol (3 min each), defatted through 2–3 changes of 100% xylene (15 min each), and rehydrated in 100% ethanol for 10 min, washed in tap water, stained for 4–15 min with 0.1% cresyl violet Nissl staining solution (catalog no. G1432, Solarbio, Beijing, China), rinsed quickly in tap water, then washed in 70% ethanol.

When necessary, Nissl-stained sections were immersed for 2 min in differentiation solution (catalog no. G1432, Solarbio, Beijing, China), dehydrated through 2 changes of absolute ethanol (3 min each), and cleared through x2 of xylene, then allowed to dry in a fume hood. Cortical layers in the sections were visualized under a fluorescence dissecting microscope (Leica DM6000B, Heidelberger, Germany).

Coronal sections adjacent to Stereo-seq chips were collected for IHC staining with NeuN (Proteintech 26975-1-AP, 1:10000), GAP43 (Abcam ab75810, 1: 3000), and MAP2 (Proteintech 17490-1-AP, 1:2500) antibodies. The 10-μm sections were mounted on gelatinized glass slides and baked to dry for 5 minutes at 37 °C. Afterward, the brain tissues mounted on slides were fixed with 4% paraformaldehyde in 0.1 M phosphate buffer (PBS) for 10 minutes. Following three PBS washes, the sections underwent a 15-minute pre-incubation in 0.5% Triton X-100 in PBS, followed by a 1-hour incubation in a blocking solution comprising 10% normal goat serum and 0.1% Triton X-100 in PBS (0.1% PBST). Subsequently, the sections were incubated overnight at 4 °C in 0.1% PBST containing the monoclonal antibodies NeuN, GAP43, and MAP2 polyclonal antibody.

After another three washes in PBS, the sections underwent a 30-minute incubation in 0.1% PBST containing 0.6% hydrogen peroxide to block endogenous peroxidase that might contribute to background staining. Following three additional PBS washes, the sections were incubated in PBS containing a biotinylated secondary antibody (1:200) for 2 hours. They were then washed three times in PBS and transferred to PBS containing the peroxidase conjugate from the Vectastain CBC kit (Vector Laboratories, Burlingame, CA). After a series of rinses in PBS, the sections were immersed in a solution of 0.05% 3-3’diaminobenzidine-4HCl (DAB, Sigma-Aldrich, St Louis, MO) and 0.05% hydrogen peroxide. Once the staining was complete, the sections underwent dehydration in increasing concentrations of ethanol, were cleared in xylene, and finally, coverslipped with DPX medium. Subsequently, the glass-mounted sections were scanned at 5× (0.88 μm/pixel) in a Zeiss scanner to generate images.

Tissue sections for Stereo-seq were adhered to the Stereo-seq chip (generated by BGI, China) surface and incubated at 37 °C for 3 minutes. Then, the sections were fixed in methanol and incubated for 30 minutes at −20 °C before Stereo-seq library preparation. Where indicated, the same sections were stained with nucleic acid dye (Thermo Fisher,Q10212) and imaging was performed with a Motic Custom PA53 FS6 microscope prior to in situ capture at the channel of FITC.

Samples were prepared for snRNA-seq at NovelBio Bio-Pharm Technology (Shanghai, China). Tissue samples were surgically removed as the methods above and snap-frozen in liquid nitrogen, and then nuclei were isolated as described, with some modifications. Briefly, frozen tissue was homogenized in NLB buffer [250 mM sucrose, 10 mM Tris-HCl, 3 mM MgAc2, 0.1% Triton X-100 (Sigma-Aldrich, Saint-Louis, Missouri, USA), 0.1 mM EDTA, 0.2 U/μL RNase Inhibitor (Takara, Tokyo, Japan)]. Then nuclei were isolated on a sucrose gradient, adjusted to approximately 1000 nuclei/μL, and loaded into single channels to generate single-cell Gel Bead-In-Emulsions (GEMs) using the Chromium Controller Instrument (10X Genomics) and Chromium Single Cell 3’ Reagent Kit (version 3.1, 10X Genomics). After reverse transcription, GEMs were broken, and barcoded cDNA was purified, amplified, fragmented, A-tailed, ligated with adaptors, and subjected to index PCR. The final libraries were quantified using the Qubit High Sensitivity DNA assay (Thermo Fisher Scientific, Cleveland, OH, USA). The size distribution of the libraries was determined using a High Sensitivity DNA chip on a Bioanalyzer 2200 (Agilent, Santa Clara, CA, USA). All libraries were sequenced by Novaseq6000 (Illumina, San Diego, CA, USA) on a 150 bp paired-end run.

Coronal brain sections on slides were used for cell capture, barcoding, reverse transcription, cDNA amplification, and library construction using the Chromium Single Cell 3’ Reagent Kit (version 2, catalog no. 120237, 10x Genomics) according to the manufacturer’s instructions.

Minimal sample sizes were not determined. Data were not collected through randomization, nor were analysts blinded to the data conditions, because all data represented a single set of conditions.

Single-cell sequencing data were processed using the analysis pipelines in Cell Ranger (version 6.0.2, 10X Genomics)63. Reads were aligned against the human reference genome refdata-gex-GRCh38-2020-A, and feature-barcode matrices were generated using thecountfunction in Cell Ranger. Expression levels were calculated as counts per million reads (CPM). In some analyses, CPM values were transformed by log2(CPM + 1). Genes were considered to be detected if CPM > 0. CPM values depended not only on absolute transcript number but also on gene length. Thus, CPM values for short, abundant transcripts could be similar to those for long, less abundant transcripts.

Low-quality cells in each sample were identified and removed using theisOutlierfunction in the program scatter in R, which identifies outliers based on median absolute deviation (MAD) from the median value of each metric across all cells. Cells were defined to be low-quality if 1). The cell library size (total UMI counts) is smaller than 3 MADs; 2). The number of detected genes is smaller than 3 MADs; 3) the proportion of mitochondrial gene counts is bigger than 3 MADs. Doublets were identified using DoubletFinder64, and the expected doublet rate was 0.075.

With the data from the remaining high-quality cells, we removed genes expressed in fewer than 10 cells to avoid unnecessary computational work in downstream analyses. Besides, 2 clusters were assigned to donor-specific due to a higher proportion of donors and were excluded from further analysis. These donor-specific clusters came from one donor in the dendrogram, with very low reads and genes detected.

We performed a principal component analysis based on the normalized gene expression matrix of 2000 highly variable genes. We used Harmony65to perform batch correction across all samples (lambda = 1, theta = 2, donor and library as batch factor), and then uniform manifold approximation and projection (UMAP, default parameters in Seurat RunUMAP) were performed with theRunHarmonyfunction in Seurat66. Constellation plots depicting global relatedness among cell types were generated using theget_knn_graphandplot_constellationfunctions in scrattch.hicat10.

In our clustering analysis, we first corrected the data using the Seurat standard clustering pipeline with Harmony for batch correction (lambda = 1, theta = 2, donor and library as batch factor). Initially, we annotated the clusters at the subclass level based on a common set of broad cell-type marker genes: for example, GAD1 or GAD2 expression identified GABAergic neurons; SLC17A7/SATB2 marked glutamatergic neurons; PDGFRA identified oligodendrocyte progenitor cells; AQP4 indicated astrocytes; PLP1/MOBP marked oligodendrocytes; PDGFRB marked vascular smooth muscle cells; FLT1 identified vascular endothelial cells; and APBB1IP indicated microglia.

To further refine the annotations and align them with the latest datasets, we first performed a global alignment of our data with external data using the Harmony method (lambda = 1, theta = 2, donor and chip as batch factor), and validated the expression of subclass marker genes. After merging our data with the external dataset, which was downloaded fromhttps://cellxgene.cziscience.com/collections/d17249d2-0e6e-4500-abb8-e6c93fa1ac6f16, we split the combined data into smaller datasets according to subclasses and then applied Harmony (lambda = 1, theta = 2, donor and chip as batch factor), again to each smaller dataset for more precise alignment. Based on the aligned features obtained from Harmony (lambda = 1, theta = 2, donor and chip as batch factor), we constructed a k-nearest neighbors (KNN, n = 15) classifier using the external data and their more detailed cluster labels. This classifier was then applied to the aligned dimensionality-reduced features of our data to assign the corresponding detailed labels to our cells.

Additionally, we identified specific marker genes for these finer clusters within each subclass and used them to validate the clusters annotated by the KNN classifier. After several iterations of Harmony parameter adjustments, the alignment became optimal, and our annotated data displayed consistent UMAP visualizations and marker characteristics with the published dataset, demonstrating a high degree of concordance between our dataset and the external reference.

We then defined subclasses and clusters based on the taxonomy dendrogram generated from data of 14 cortical regions. Following the convention of nomenclature4, Clusters were named according to the major cell type (EXC, INH, ASTRO, OLIGO, OPC, VLMC, and MICRO), the maximal expression subclass markers (PAX6, LAMP5, VIP, SST, PVALB, LINC00507, RORB, THEMIS, FEZF2, TYROBP, FGFR3, PDGFRA, OPALINorNOSTRIN), and the top marker for each cluster.

The analysis was done at the subclass level based on single-cell transcriptomics. We used randomForest on single-cell transcriptomic data for each category to build the classification model and obtain the appropriate confusion matrix, which can show how dissimilar cellular transcriptomics are from those from other regions. More comparable molecular features from different areas are represented by higher levels of confusion. The confusion matrix was then further clustered byhclustfunction to show the similarities in transcriptome profiles between various locations. Additionally,FindAllmakersin Seurat66was used to examine the genes that differ in expression across regions.

Meta-analytic functional decoding analysis using Neurosynth (www.neurosynth.org) database was conducted with NiMARE (https://github.com/neurostuff/NiMARE) to capture the most relevant cognitive functions. Specifically, the Neurosynth ROI association method and feature terms were downloaded from the 50 topic terms (v3;https://github.com/NeuroanatomyAndConnectivity/gradient_analysis/blob/master/gradient_data/neurosynth/v3-topics-50-keys.txt). Then, we combined these data with the corresponding cell type and subclass distribution data using the redundancy analysis function RDA from the vegan package. Hellinger transformation is used to standardize the data. The output data were scaled further using the function fortify from the ggplot2 package, with the scale parameter set to 2, which emphasizes the correlation between cell type/subclass and functions based on an angle rather than distance.

Specifically, our first step includes a fMRI meta-analysis by Neurosynth framework on target areas to derive activation scores for each area and function. Neurosynth is a classic framework used for synthesizing human neuroimaging data, employed in hundreds of fMRI studies to perform robust meta-analyses and generate a voxel-activation database13. Neurosynth’s generative mechanism maps diverse term-position relationships from neuroimaging research onto a 2 mm x 2 mm x 2 mm coordinate system13, and this resolution is sufficient for our 14 cortical regions. Then we selected voxels within each cortical region and assessed the association between specific terms and regions by Neurosynth’s meta-analytic method, which a two-way chi-square test method was used to assess the association between terms and spatial coordinates (namely “association test”, more detail referred to their code line 165 (https://neurosynth.org/faq/) and Method in their article13. Then, we selected functional terms highly frequent in Neurosynth, with ample research data support, thus ensuring the robustness of the region-function association.

Subsequently, we correlated these regional functional scores with distributions of region-cell types (originating from snRNA data) to examine the correlation between function terms and cell types. We achieve this by employing RDA to establish a connection between conditions (i.e., functional scores in brain regions) and the distribution of cells in different regions. Redundancy analysis allows studying the relationship between two tables (cell distribution-cortical region; cortical region-function association) by sharing a common variable (cortical region). Lastly, strong correlations between cell types and functions were examined using our Stereo-seq data, such as the number of ET neurons is positively correlated with the pain-term relevance of the cortical region. Building on this foundation, we integrate ‘cortical region-cell type distribution’ with ‘cortical region-function’ data. This integration leverages cortical regions as intermediaries, enabling a detailed probe into the ‘function-cell type distribution’ relationship. In assessing the association between function terms and positions (‘cortical region-function’), we employed a classical and widely used fMRI meta-analysis framework for the related calculations.

We used the Seurat function findMarker to determine the differentially expressed genes at the region, subclass, and region-subclass levels, using FDR as multiple corrections. The KEGG and GO terms enrichment based on the DEGs was accomplished with the help of a Clusterprolifier.

The single-cell transcriptomic data were analyzed or visualized using R (version 3.5.0 and higher,https://www.R-project.org), RStudio IDE (https://www.rstudio.com/), Seurat66, and scrattch suite (https://github.com/AllenInstitute/scrattch)4,10. The cellular compositional analysis was conducted by scCODA67. All statistics tests without specifying were conducted by the Wilcox test.

For Stereo-seq, tissue sections placed on the chip were permeabilized with 0.1% pepsin (Sigma, P7000) in 0.01 M HCl buffer, incubated at 37 °C for 5 minutes, and then washed with 0.1x SSC buffer (Thermo, AM9770) supplemented with 0.05 U/ml RNase inhibitor (NEB, M0314L) (NEB, M0314L). RNA released from the permeabilized tissue and captured by the DNB was reverse transcribed overnight at 42 °C using SuperScript II (Invitrogen, 18064-014, 10 U/ml reverse transcriptase, 1 mM dNTPs, 1 M betaine solution PCR reagent, 7.5 mM MgCl2, 5 mM DTT, 2 U/ml RNase inhibitor, 2.5 mM Stereo-seq-TSO, and 1x First-Str After reverse transcription, tissue sections were washed twice with 0.1x SSC buffer and digested with Tissue Removal buffer (10 mM Tris-HCl, 25 mM EDTA, 100 mM NaCl, 0.5% SDS) at 55 °C for 10 minutes. cDNA-containing chips were then treated overnight at 55 °C with Prepare cDNA Release Mix (enzyme, buffer). VAHTSTM DNA Clean Beads (0.8×) purified cDNA. The concentrations of the PCR products were measured using the Qubit TM dsDNA Assay Kit (Thermo,Q32854). After fragmenting 20 ng of DNA at 55 °C for 10 minutes with in-house Tn5 transposase, the reactions were terminated by adding 0.02% SDS and mixing gently at 37 °C for 5 minutes. This is how fragmented products were amplified: 25 ml of fragmentation product, 1x KAPA HiFi Hotstart Ready Mix, 0.3 mM Stereo-seq-Library-F primer, 0.3 mM Stereo-seq-Library-R primer, and nuclease-free H2O in a total volume of 100 ml. The reaction was then carried out as follows: 1 cycle of 95 °C for 5 minutes, 13 cycles of 98 °C for 20 seconds, 58 °C for 20 seconds, and 72 °C for 30 seconds, and 1 cycle of 72 °C for 5 minutes. PCR products were purified with AMPure XP Beads (0.63 and 0.13), utilized for DNB generation, and then sequenced on an MGI DNBSEQ-Tx sequencer.

An MGI DNBSEQ-Tx sequencer was used to generate Stereo-seq fastq files. CID and MID are present in read 1 (CID: 1-25 bp, MID: 26-35 bp), whereas read 2 contains the cDNA sequences. First, the CID sequences on the initial reads were mapped to the designed coordinates of the in situ captured chip obtained from the initial round of sequencing, allowing for 1 base mismatch to correct for sequencing and PCR errors. Reads with a MID containing N or more than 2 bases and a quality score below 10 were filtered out. Each read’s CID and MID were appended to the header of each read. Using STAR (Dobin et al., 2013), retained reads were aligned to the reference genome ensemble 93 and mapped reads with MAPQ > 10 were counted and annotated with their corresponding genes). UMI with the same CID and gene locus were collapsed, allowing for the correction of sequencing and PCR errors with a single mismatch. Finally, this information was used to generate an expression profile matrix containing CIDs. The entire process has been incorporated into the publicly accessible pipeline SAW, which can be found athttps://github.com/BGIResearch/SAW. The ssDNA-stained nuclei image was harmonized with its CID-tagged expression matrix using StereoCell’s image registration module (SAW defaults)68. For cell segmentation, we applied the pretrained “cyto” Cellpose 2 model on the registered image (model_type = ‘CP’, diameter=30 px, flow_threshold=0, cellprob_threshold=1.0)69. The resulting binary mask—distinguishing cellular from extracellular areas—was used to filter point-level UMI data (retaining only cell-associated transcripts) and to assign transcriptome profiles to individual, cell-sized bins. UMI-to-cell assignment then employed the FAST method from the Stereopy toolkit (default distance threshold, single-threaded)70. Finally, per-cell, per-gene UMI counts were aggregated into a cell–gene expression matrix for downstream analysis.

We used spatial coordinates to determine the Euclidean distance between each spot and the remainder, then ordered the distances between the top 3 (optional) adjacent spots to count the radiusγ(mean add variance). For a given spotSi, a spotSjwas a neighbor, soSWij=1if and only if the Euclidean between two spots is less than the set value. OtherwiseSWij=2.

This also computed a graph adjacency matrix based on spatial coordinates by k-nearest neighbors (KNNs). The number of nearest neighbors was 15. Second, a denoising autoencoder was employed to perform nonlinear mapping on the integrated feature space, thereby generating a low-dimensional representation space that would reduce the risk of model overfitting. Simultaneously, a variational graph autoencoder was inserted into the framework to map spatial associations of spots, generating spatial embedding via integrated representation with the corresponding spatial adjacent spots.

The model was trained according to the following parameters: number of model training, 1000 epochs; the number of dimensions of the normalized gene expression matrix (concat_pca_dim), 50; neural network type, graph convolutional neural network (Conv_type=’GCNConv’); and several integrated neighbors (neighbour_k), 2. Other parameters were default.

The domain spot clustering used 4 integrated neighbors (neighbour_k = 4) with an adjacent weight of 0.3 for data augmentation, and a KDTree-based graph construction with k = 20 neighbors (weights_matrix_nomd). The neural network architecture included linear encoder hidden layers of [64, 16] and convolutional hidden layers of [64, 16]. Pretraining and dimension reduction were enabled, while other parameters were set to their defaults. The model was trained with the output saved to a designated results directory, facilitating downstream spatial analysis.

Finally, we obtained a 28-dimensional vector for each spot, for which we computed the Leiden clustering using Scanpy71. The clustering resolution varied adaptively with the number of spatial domains; it was 7 for human cortical regions.

Based on this primary result, we further corrected and annotated spatial domains manually in terms of their structural features, layer marker genes, Nissl-stained images, and cell type deconvolution.

We deconvolute normalized spatial transcriptomic data with the transcriptomic spectrum of each cell type by RCTD72(mode = “doublet”, filtered out “reject” spot_class and first type as the annotation) to achieve robust results for Stereo-seq data. We selected the top 20 marker genes of pairwise 153 cell types and mapped all cell-type snRNA-seq profiles in spatial spots by a total of 4637 genes. Default values were used for other parameter settings in all analyses. We calculated the probability of each cell type in each spot to calculate their subclass proportion in each pot to draw scatter pie plots. For the cell-type probability boxplot, we calculated the average probability of each cell type in different layers of each slide and performed ANOVA to measure global relatedness and the Wilcox test for specific pairwise comparisons. For the laminar distribution and relative depth, we set 1~7 as the relative depth value for layer 1 to white matter and calculated the standard deviation of probability based on these. For each cell type, we used kernel density estimation to smooth local probability to get weighted density bykde2d.weightedin package ggtern and visualized bygeom_rasterin ggplot2.

To analyze the cellular communication, we first utilized CellChat73, a computational framework designed for deciphering intercellular communication networks, to predict one-to-one cell-type interactions in single-cell data. CellChat utilizes a database of ligand-receptor interactions to infer potential signaling pathways and quantify their strengths, providing insights into the communication patterns among various cell types. CellChat was initialized with normalized gene expression data, grouped by subclass (group.by = “subclass”), using the human ligand-receptor database (CellChatDB.human). The analysis included subsetting data, identifying overexpressed genes and interactions, and computing communication probabilities using the triMean method with 20 bootstrap iterations (nboot = 20, default). Communication pairs were filtered to include at least 10 cells (min.cells = 10, default). Parallel processing was enabled with 4 workers and a 20 GB memory limit.

Following the prediction of cell-cell interactions, we considered two cells within a 15-micrometer range of each other as having somatic contact in spatial data. Based on the cell contacts obtained from all spatial transcriptomic data, we classified them into linked subnetwork units. We then employed the Sequential Pattern Mining Framework (SPMF)74to statistically analyze the frequency of occurrence of connected patterns ranging from 2 to 7 orders (i.e., structures composed of up to 7 interconnected cells).

We used the UMAP algorithm from the package Seurat66to get the reduction of dimension by treating different samples as different batches and retaining default values for all other parameters. First, we normalized spatial gene expression by integrating spatial location information and tissue morphological information (see “Spatial domain identification” above) and then used principal component analysis to obtain a low-dimensional map of the normalized data, with a default of 50 dimensions. Second, the results were corrected for batch effects using Harmony65(lambda = 1, theta = 2, donor and chip as batch factors). The processed data were used to train the model, and this will generate a nonlinear, low-dimensional map of the integrated data. Finally, we applied the UMAP algorithm to this data to generate the 2-dimensional projections.

Further information on research design is available in theNature Portfolio Reporting Summarylinked to this article.

This paper is from the Mesoscopic Brain Mapping Consortium. This work was supported by the National Natural Science Foundation of China (Nos. T2325009) and National Key R&D Program of China (Nos. 2023YFF1204802). We thank NovelBio Bio-Pharm Technology Co., Ltd. (Shanghai, China) for the support of single-cell nucleus sequencing (NovelBrain Cloud Analysis Platform,www.novelbrain.com).