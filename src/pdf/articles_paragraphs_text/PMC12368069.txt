Chronic knee osteoarthritis pain significantly impacts patients’ quality of life and motor function. While motor imagery (MI)-based brain-computer interface (BCI) systems have shown promise in rehabilitation, their application to lower-limb conditions, particularly in pain patients, is underexplored. This study evaluates the feasibility of applying an MI-BCI model to a large dataset of knee pain patients, utilizing a novel deep learning algorithm for signal decoding. This EEG data was collected and analysed from 30 knee pain patients, revealing significant event-related (de)synchronization (ERD/ERS) during MI tasks. Traditional decoding algorithms achieved accuracies of 51.43%, 55.71%, and 76.21%, while the proposed OTFWRGD algorithm reached an average accuracy of 86.41%. This dataset highlights the potential of lower-limb MI in enhancing neural plasticity and offers valuable insights for future MI-BCI applications in lower-limb rehabilitation, especially for patients with knee pain.

Despite treatments such as physical therapy and kinetic therapy have been shown to improve motor function, reduce pain, and enhance overall quality of life in patients1, pain that persists beyond three months—longer than the expected tissue-healing period—becomes chronic2. Knee joint pain, the primary symptom of knee osteoarthritis (KOA), often results from unusual physical activity, tissue inflammation, injury, overuse, or age-related degeneration of the articular cartilage3,4and is considered a progressive multifactorial disease. KOA pain is a leading cause of disability worldwide, significantly impairing patients’ quality of life and imposing substantial societal costs5. Patients with long-term knee joint pain frequently experience restricted lower-limb motor function, which increases the risk of disability and places a considerable burden on their families6.

Recent studies have demonstrated that chronic pain can induce cortical reorganization, altering brain function and potentially affecting the brain’s ability to process motor intentions7. Specifically, a reduction in cortical areas during motor imagery (MI) on the affected side has been observed8, along with changes in motor regions such as the premotor cortex, which is critically involved in MI9. However, musculoskeletal pain, such as that in KOA, likely leads to different cortical adaptations compared to neuropathic pain, resulting in either reduced excitability or overactivation of the motor cortex. These changes may make MI activation patterns less distinguishable, posing challenges for both diagnosis and rehabilitation.

These findings underscore the importance of understanding the neural mechanisms of MI for effective rehabilitation. MI is a mental process in which an individual imagines a movement without physically moving the limb, thereby eliciting changes in motor-related brain activity10,11. This approach has gained attention as a promising rehabilitation tool for patients with motor impairments. Currently, MI training is recommended as an alternative technique for chronic pain management12. Therefore, assessing MI abilities using electroencephalography (EEG) has become essential for clarifying the neural mechanisms underlying motor dysfunction in chronic pain patients and for developing targeted interventions.

Recently, EEG-based brain–computer interface (BCI) technology, which establishes a direct communication channel between the human brain and external devices, has developed rapidly and gained prominence in rehabilitation medicine13. As a novel treatment method, BCI enables patients to control motor devices through MI, thereby bypassing the need for peripheral nerves and muscle tissue14,15. Consequently, BCI has shown considerable promise in rehabilitating individuals with stroke, spinal cord injuries, and neurodegenerative diseases by facilitating motor recovery. With ongoing advancements in brain science, brain activity under various conditions can be recorded using multiple detection techniques, including EEG, functional near-infrared spectroscopy (fNIRS), magnetoencephalography (MEG), and functional magnetic resonance imaging (fMRI)16. However, noninvasive EEG systems remain the most cost-effective option because of their high temporal resolution, portability, and rapid data acquisition relative to other techniques; hence, they are widely employed in both research and clinical settings17. Despite these advantages, the application of EEG-based MI-BCI systems in chronic pain patients poses unique challenges. A recent cross-sectional study found that explicit MI abilities remain preserved in chronic limb pain, supporting the use of mental imagery therapies; however, implicit MI processes, as assessed by EEG-based MI-BCI systems, may still be affected by chronic pain–induced cortical reorganization18. Moreover, accurately identifying lower-limb MI features remains a significant challenge that must be addressed.

MI has become a well-established paradigm in EEG-based BCI research, particularly in sports, cognitive function, and rehabilitation medicine15,19. Decoding motor intent from EEG signals often involves detecting event-related desynchronization/synchronization (ERD/ERS) patterns, with the common spatial pattern (CSP) technique recognized as one of the most effective approaches for feature extraction20–23. MI tasks typically generate sensorimotor rhythms predominantly observed in the alpha (8–15 Hz) and beta (15–30 Hz) frequency bands, reflecting distinct brain activities24,25. In addition, other techniques, such as time–frequency analysis and electrophysiological source imaging, have been investigated to enhance MI-BCI decoding accuracy26–28.

While machine learning (ML) and deep learning (DL) methods for MI decoding have matured in single-session paradigms, cross-session or cross-subject decoding remains a challenge29. Publicly available MI datasets, including those from BCI competitions30, BCI 200031, and various journal publications29–32, provide valuable resources but are constrained by small sample sizes, short recording durations, and a predominant focus on healthy participants13,33,34. These limitations hinder the clinical application of BCI systems and underscore the need for larger, more diverse datasets covering multiple independent sessions, particularly from pain patients. Therefore, developing a cross-session and cross-subject EEG dataset is crucial to advancing BCI research in rehabilitation medicine.

In this study, we recorded a lower-limb MI-BCI EEG dataset over five independent sessions of left-leg and right-leg flexion/extension MI tasks from 30 knee joint pain patients. Each participant performed specific MI experiments every two days, with 100 trials per session, generating 15,000 total trials (30 × 5 × 100). During these tasks, patients were asked to remain quiet and repeatedly imagine movements based on on-screen cues, while an experimenter supervised each session to ensure data reliability. After data collection, we validated our dataset through time-domain, spatial, and classification analyses26,27. The dataset includes raw EEG data, preprocessed data, and experimental metadata, enabling researchers to directly use the information for feature extraction and classification.

The advancement of BCI algorithms depends significantly on data-driven approaches, emphasizing the importance of high-quality datasets32. Although several lower-limb MI datasets from healthy populations address aspects such as real-world usage scenarios35, motion-based tasks36, and compound-limb paradigms37, there remains a shortage of large, high-quality datasets specifically designed for clinical lower-limb MI applications. Notably, lower-limb MI has been recognized as a promising neurorehabilitation paradigm—particularly for individuals with chronic pain or motor impairments—but its cortical representations are located deeper within the interhemispheric fissure, making EEG signal detection more challenging37. This has led to relatively few studies focused specifically on the classification of left versus right leg imagery tasks in clinical contexts. Nevertheless, growing evidence suggests that such classification is feasible. For instance, studies by Liuet al.38successfully established the first lower limb gait MI dataset for stroke patients and emphasized the importance of achieving high classification accuracy in the affected leg. In parallel, recent advancements in MI paradigms, such as somatosensory-stimulated MI39, visually guided MI40, and gait-phase-encoded electrical stimulation38have been proposed to enhance EEG feature discriminability without increasing cognitive or sensory load for patients. These innovations support the scientific rationale of our study and reinforce the urgent need for clinically grounded, large-scale lower limb MI datasets. Hence, to address the gaps in lower limb BCI datasets and to promote the development of high-performance EEG decoding algorithms, it is of great significance to create a large, high-quality lower limb MI dataset specifically for individuals experiencing pain or motor dysfunction.

In this study, we conducted a comparative analysis of MI datasets obtained from left-leg and right-leg tasks in patients with lower-limb pain. We demonstrated the feasibility of binary classification using both traditional ML and DL methods to accurately decode EEG data. Moreover, we proposed an innovative algorithm, the Optimal Time-Frequency Window in Riemannian Geometric Distance Classification Algorithm (OTFWRGD), to validate and enhance the accuracy of lower-limb MI classification, thereby contributing to the advancement of BCI applications in rehabilitation.

This dataset was collected from 30 patients with knee joint pain, recruited from the Air Force Medical Center, and no prior experience with motor imagery (MI). Comprised of 18 males (60%) and 12 females (40%), aged 24 to 45 years, with an average age of 33.5 years (SD = 5.6). The average duration of pain was 7.7 months (SD = 3.1), and intensity as measured by the visual analog scale (VAS), was 4.1 (SD = 0.9). Based on patient history and clinical evaluation, 56.7% of patients were diagnosed with degenerative injuries, 20.0% with overuse-related injuries, 13.3% with trauma-related injuries, and 10% were of unknow origin. Additionally, the average knee injury and osteoarthritis outcome score (KOOS) was 45.3 (SD = 7.0), and the average International Knee Documentation Committee (IKDC) score was 43.1 (SD = 6.5) (shown in Table1). All patients provided informed consent statement prior to participation, and were paid for their participation. Their identities were anonymized using aliases (“Sub01” through “Sub30”). All patients were informed about the study purpose and the procedures of the experiment. Informed consent for the collection and publication of data was acquired. This study and experiment were approved by the Ethics Committee of Air Force Medical Center (approval number: 2024-06-PJ01).

Data is represented as the mean (SD) or n (%). VAS: Visual Analog Scale. KOOS: Knee Injury and Osteoarthritis Outcome Score. IKDC: International Knee Documentation Committee.

Before the experiment, each patient was thoroughly briefed on the experimental procedures and steps to ensure a comprehensive understanding of the entire process. Additionally, the researcher closely monitored each session to guarantee data reliability. The experiment was conducted in a quiet, spacious room. As illustrated in Fig.1, the experimental process encompassed equipment setup and calibration, reading the instructions, conducting the lower-limb MI task, and data inspection, among other steps.

Entire experimental procedures. Written informed consent was received from the patient in the figure for the publication of the images. (a–c) The MI data collected procedure during right- and left leg MI task. (d) One trial of the MI experiment.

Each trial began with a cue phrase displayed on the screen. After reading and comprehending the phrase, participants pressed the “Q” key on the keyboard to initiate the MI task. The entire session lasted approximately 20 minutes, encompassing preparation, MI tasks, and rest periods. Each MI task commenced with a white and red ball appearing at the center of the screen, signaling participants to focus on the upcoming task, as shown in Fig.1a. When a left-leg or right-leg movement was displayed on the monitor, participants were instructed to repeatedly imagine the corresponding leg’s flexion and extension movements (kinetic MI) in accordance with the visual cues, as depicted in Fig.1b. The MI task comprised 100 trials, divided into two blocks of 50 trials each, with a 1-minute break between blocks. Each trial lasted 10 seconds, including 2 seconds of preparation, 4 seconds of imagery, and 4 seconds of rest, as illustrated in Fig.1c. Finally, all patients performed the movement imagery in accordance with the provided video and audio cues. To maintain optimal physical and mental conditions and ensure high-quality EEG signals, participants were permitted to rest and adjust their posture during the break periods.

Patients wore an EEG cap and sat in a chair positioned 80 cm away from a 16-inch LCD screen (HUAWEI MateBook 16 s, China) in a quiet room. Following the standard 10–10 system, EEG data were recorded using a wireless multichannel EEG acquisition system (ZhenTec NT1, Xi’an ZhenTec Intelligence Technology Co., Ltd., China). The system utilized 32 Ag/AgCl semi-dry electrodes mounted on an elastic cap; these electrodes incorporated highly absorbent porous sponges dampened with a 3% NaCl solution, as shown in Fig.2. All electrodes were referenced to Cpz and grounded at FPz, with impedance maintained below 20 kΩ throughout data collection. Horizontal and vertical bipolar electrooculographic (EOG) activity was simultaneously recorded using external electrodes to monitor artifacts from eye movements. All electrodes were connected to a high signal-to-noise EEG amplifier for data collection and pre-processing. Continuous digital EEG data were stored in microvolts (µV) and recorded by a 24-bit analog-to-digital converter. The Table2presents detailed information about the dataset.

Realtime snapshot of the EEG signal and cap electrode distribution. (a) a snapshot of the raw signals recorded in 30 channels and 2 EOG channels. (b) the cap distribution of all 32 electrodes were kept close.

The raw EEG signals were digitally filtered using a band-pass filter ranging from 0.5 to 80 Hz and were sampled in real-time at 500 Hz. A notch filter was applied at 50 Hz to remove power line noise, and the data were continuously written to a hard disk for offline analysis. The collected data were preprocessed using the EEGLAB v2020.0 toolbox in MATLAB (R2020a). The filtered data were then segmented and saved as.mat files under the names “rightLegData” and “leftLegData” in the “trials × channels × time samples” format.

The VAS is a 10-cm horizontal line ranging from 0 to 10, used to evaluate the average daily knee pain intensity over the past 7 days. Patients were asked to indicate the subjective level of pain at the time of evaluation using circular markers. A score of 0 signifies the absence of pain, while 10 indicate the worst conceivable pain. The VAS has been validated and demonstrates very high test-retest reliability41.

The KOOS is a questionnaire comprising 42 items across five subscales: pain, symptoms, activities of daily living, sports recreation, and quality of life42. Each task is rated on a 5-point Likert scale (0–4), with the total score calculated by summing the responses to all 42 items. Lower scores indicate worse knee-related outcomes.

The IKDC is a questionnaire designed to assess knee function and symptoms following injury or surgery43. It provides a score ranging from 0 to 100, based on 10 items addressing pain, function, activity, and daily activity. Patients rate each item on a scale from 0 to 4 points according to their condition. Higher scores reflect better function and fewer symptoms, with the transformed score serving as a measure of overall knee function.

The dataset is available at the Figshare data deposition service44, and is organized following the EEG-Brain Imaging Data Structure (EEG-BIDS) standard. As illustrated in Fig.3, the repository consists of the following structured directories: (1) Sourcedata, which contained raw data that was transferred from.edf format after acquisition, saved as the ‘.mat’ files, named according to patient number and session number. ‘sub-xx’ meant the patient number and ‘ses-yy’ meant the session number; (2) Derivatives data, which were pre-processed from sourcedata, stored as.mat files, with each.mat file containing the five separate sessions for each patient. (3) Stimuli stored experimental instruction files during the task; (4) Code provided the source code used in Technical Validation to help researchers quickly master how to use the current dataset.

Directory tree for the repository with previews of EEG files. Detailed structure of data in EEG-BIDS format.

Each.mat file consists of EEG recordings and the corresponding event labels, which are documented in a BIDS-compliant events file (sub-xx_ses-yy_task-MI_events.tsv).

EEG: An n × 33 matrix, where n represents the number of sampling point. The first 32 of the 33 columns indicate 32 channels, and the 33rd column is the corresponding label.

EEG data: A 5000 × 30 × n matrix, where n represents the number of extracted segments.

Lable: A 1 × n vector indicating the leg movement type (1 for left leg MI, 2 for right leg MI).

This folder stores experimental instruction files used during the MI task.

This folder includes all source codes and scripts used for all data processing, event extraction, feature exraction, classification performance, and BIDS conversion, ensuring full reproducibility of data transformations.

To ensure the integrity of the EEG data, we identified “bad trials” using specific criteria. Any trial was classified as bad if, after applying a band-pass filter (8–30 Hz), its amplitude exceeded ±75 µV within the 0–4000 ms time window. This frequency range corresponds to sensorimotor rhythms (SMR) during motor imagery tasks, and the selected time window was based on an algorithm for determining discriminative intervals described in previous studies. The percentage of bad trials was calculated for each participant, and these trials were excluded from further analyses. Their indices were recorded in each participant’s dataset, as explained in the “Data Format and Structure” section.

Additionally, to verify the reliability of our lower-limb MI-BCI dataset, we analyzed EEG-based brain activity during MI tasks. This step was essential for understanding how pain influences MI performance and the associated neural responses. By comparing brain activity during motor imagery, we assessed how pain-induced cortical changes may affect MI outcomes. This information is crucial for enhancing the accuracy of MI decoding and optimizing rehabilitation strategies, thereby providing valuable insights for brain–computer interface applications in clinical settings for individuals with lower-limb pain.

We present a comprehensive summary of the noncompliant data identified during the five experimental sessions for each participant, based on our assessment criteria. Trials that failed to meet these criteria were classified as “bad” and excluded from further analysis. The Table3provides an overview of this screening process. The horizontal headings—session_1 through session_5 denote the five sessions conducted on separate days, while the vertical headings—sub_1 through sub_30 correspond to the 30 participants included in the study.

For each patient, 100 trials were conducted per session for both left-leg and right-leg MI tasks. A trial was deemed “bad” if the amplitude of at least one channel of the acquired EEG exceeded ± 75 μV during the 2000–6000 ms window (which corresponds to the motor imagery period) following band-pass filtering (8–30 Hz). Specific leads and segments of data that were flagged as “bad” were annotated accordingly in the raw data stored in EDF format. Only the trials that met our quality standards—i.e., the “good” trials—were used in subsequent qualitative and quantitative analyses. This rigorous data-cleaning process ensures the integrity and reliability of the EEG dataset, thereby enhancing the validity of the result.

In this study, we mainly focus on evaluating event-related desynchronization and synchronization (ERD/ERS) patterns. By examining ERD/ERS metrics, we compare differences in brain activity between the two tasks, particularly over the central channels C3 and C4. Furthermore, we employ complementary methods—including Brain Electrical Activity Mapping (BEAM) of relative power46, time–frequency analysis47, and power spectral density (PSD) for intuitive visualization of spatial patterns in brain rhythms48, and to assist in interpreting and confirming our findings. However, these additional metrics primarily serve as qualitative support for the ERD/ERS-based analyses.

ERD and ERS are well-established phenomena in EEG recordings during MI tasks49. Typically, ERD is characterized by a reduction in the amplitude of EEG frequency bands—commonly in the alpha/mu (8–15 Hz) and beta (15–30 Hz) ranges—when a motor-related or cognitive task begins, whereas ERS denotes an increase in these amplitudes, often observed upon task completion or in resting states. Physiologically, ERD reflects cortical activation in sensorimotor areas necessary for motor planning and execution, while ERS is associated with the subsequent rebound or deactivation phase. Detecting these shifts is crucial for confirming whether participants are genuinely engaged in the imagined motor task, making them key markers for BCI applications.

When participants imagine left-leg movements, alpha/beta power typically shows a more pronounced decrease (ERD) over the right sensorimotor cortex, whereas right-leg imagery yields stronger ERD over the left sensorimotor regions. These lateralized patterns, consistent with the contralateral organization of the motor cortex for lower-limb control, confirm that the EEG data reliably capture motor imagery tasks—an essential prerequisite for subsequent feature extraction, classification, and rehabilitation interventions.

Although BEAM, PSD, and time–frequency analyses are also performed to provide quantitative support, they serve primarily as auxiliary measures to bolster the qualitative assessment based on ERD/ERS. For example, BEAM maps use color gradients to illustrate relative power changes, where warmer colors represent ERS and cooler colors indicate ERD. Likewise, time–frequency analysis employing Welch’s method and the Continuous Wavelet Transform, along with PSD estimation, supplies additional validation of the frequency-specific neural responses observed during MI. Nonetheless, in this study, our primary emphasis remains on the ERD/ERS metrics to capture the most notable distinctions in neural activation during MI tasks.

The Fig.4illustrates the ERD/ERS patterns of EEG power in the 8–30 Hz band for channels C3 and C4, which are located over the left and right sensorimotor cortices, respectively. This baseline window was chosen to reflect the resting state before the onset of MI cues in the −2000 ms to 0 ms pre-cue interval, providing a reference for evaluating post-stimulus ERD/ERS dynamics. The results shown that the EEG signal power of left leg MI task in C3 channel was significantly higher than that of the right leg in most patients (participants 1, 4–8, 10, 12, 13, 15–18, 20, 24, 25, 27), while similar results also appeared on the C4 channels when performed right leg MI task. Patients (2–4, 7–9, 13–15, 17, 18, 20–22, 26, 29) exhibited more significant contralateral dominance. However, some patients showed higher brain activation power at 8–30 Hz in C3 than that in C4 when performing right-leg MI task. We suspect that it may have something to do with the injured leg, as the pain-induced protective mechanism may suppresses ipsilateral brain activity when they performed right leg MI task. Further study is necessary to clarify whether this finding is correlated to the injury side.

ERD/ERS, brain mapping, time-frequency and PSD of three subjects.

The results of EEG topographic maps were basically consistent with the changes of brain activation power, although ERD/ERS channels are not always correlated with C3 and C4, it could be related to the alignment deviation of the sampling electrodes as previous studies reports50. In addition, the PSD shows obvious power fluctuation during left or right leg MI task on C3 and C4 channels at frequency of 8–30 Hz, these features are also generally consistent with the above findings. However, given that few studies have explored the features of lower limb based on BCI-MI task datasets, these preliminary findings should be further confirmed in the future.

The Table4shows the ERD/ERS value for C3 and C4 channels across alpha (8–15 Hz), beta (15–30 Hz), and alpha + beta (8–30 Hz) bands from 0 to 4000 ms, and the MI data at different frequency bands were analyzed using independent samplet-test. The statistical results are basically consistent with the ERD/ERS curve. Specifically, for alpha (8–15 Hz) band, the average ERD of the left leg MI task in the C4 channel was significantly lower than that in the C3 channel (−14.6 ± 15.2 vs. −10.8 ± 16.6;t= 2.680,p= 0.012) alpha (8–15 Hz), and a similar result was also found for the right leg MI task (−16.2 ± 14.5 vs. −9.9 ± 12.4;t= −2.394,p= 0.023). These findings indicate that neural activity in the brain shows a strong desynchronization response in the corresponding motor region during both the left and right leg MI tasks. However, for the beta (15–30 Hz) band, although C3 and C4 channels displayed a similar trend, no significant difference was obtained (t= 1.819,p= 0.079 for left leg MI;t= −1.371,p= 0.181 for right leg MI, respectively), suggesting that the desynchronization response in beta band is weaker. For the alpha + beta (8–30 Hz) band, a significant difference was found in the left leg MI task between C3 and C4 channels (t= 2.072,p= 0.047); however, the differences in the right leg MI task reached marginally significant (t = −2.003,p= 0.055), suggesting a weaker but still notable neural response. Collectively, these results highlight the crucial role of the alpha + beta band (8–30 Hz) in neural activation during lower-limb MI task, confirming its involvement in modulating brain activity related to motor planning and execution.

ERD/ERS results of C3 and C4 channels in left and right leg MI tasks.

To rigorously validate the newly collected lower-limb MI dataset in knee joint pain patients, we employed four distinct classification approaches—CSP + LDA, FBCSP + SVM, EEGNet, and our newly developed OTFWRGD method—each capturing different facets of EEG signal analysis and representing a progression from classical feature-engineering methods to advanced machine learning strategies.

Common Spatial Patterns (CSP) is a widely used spatial filtering method in MI-based BCI research that determines linear transformations to maximize variance differences between two classes—in this case, left-leg versus right-leg motor imagery51. When coupled with Linear Discriminant Analysis (LDA), CSP + LDA is a mainstay of both offline and online BCI studies due to its relatively simple implementation and interpretability. Applying CSP + LDA in this study offers a solid baseline and serves as a reference point for comparing more sophisticated approaches.

Filter Bank Common Spatial Patterns (FBCSP) enhances the conventional CSP method by dividing EEG signals into multiple frequency bands (alpha, beta, or even narrower sub-bands) and applying CSP to each band separately52. This procedure facilitates the extraction of frequency-specific patterns particularly pertinent to motor imagery tasks. The features derived from each frequency band are then classified using a Support Vector Machine (SVM), a classifier recognized for its robust performance in numerous BCI applications. By isolating band-specific spatial filters, FBCSP + SVM often surpasses methods relying on a single frequency band, making it a valuable technique for assessing the discriminative power of our dataset across diverse frequency ranges.

EEGNet is a state-of-the-art, compact deep learning architecture tailored for EEG-based BCI53. It uses a sequence of temporal, spatial, and depthwise-separable convolutional layers to automatically learn spatiotemporal features directly from raw or minimally processed signals. By incorporating EEGNet into our analysis, we gauge the performance of a data-driven, end-to-end approach on lower-limb MI data from knee osteoarthritis patients, whose altered cortical dynamics may differ significantly from those of healthy populations. Given its ability to generalize across varied EEG tasks while maintaining a comparatively small set of trainable parameters, EEGNet provides an effective tool for evaluating the intricacy and quality of our dataset.

The Optimal Time-Frequency Window with Riemannian Geometric Distance Classification Algorithm (OTFWRGD) is a novel approach designed to enhance the classification of MI-EEG signals by leveraging optimal time-frequency feature selection, covariance-based feature extraction, and Riemannian geometry-based classification methods. The algorithm systematically processes EEG signals through multiple stages to identify the most discriminative time-frequency window for classification, thereby optimizing feature extraction and improving classification accuracy. First, in Data Acquisition and Preprocessing, raw EEG signals x(t) are filtered using a notch filter (50 Hz) to remove artifacts, yielding a clean signalxft. These filtered signals are then segmented into trials for subsequent analysis.

extracted in different frequency windows of [8,12 Hz], [8,20 Hz], [8,30 Hz], [12,20 Hz], [15,20 Hz], [15,30 Hz], [20,30 Hz], [8,15 Hz], respectively for the filtering results of the raw signal. The innovation of this method lies in its adaptive frequency band selection, where the covariance matrix of each time-frequency window is computed and evaluated to determine the optimal band for classification.

In the Feature Dimensionality Reduction stage, the calculated covariance matrices for every frequency window are then subjected to dimensionality reduction using the Local Tangent Space Arrangement (LTSA) algorithm. This step simplifies the feature space by preserving local geometric relationships while reducing computational complexity and mitigating the risk of overfitting.

where |⋅|Fis the Frobenius norm. The Riemannian mean C is computed as the matrix that minimizes the sum of squared Riemannian distances.

Finally, the classification performance is independently evaluated across multiple predefined time-frequency windows. For each frequency band, the EEG trials are band-pass filtered, covariance matrices are computed, and classification is performed using Riemannian geometry-based methods. After evaluating all bands, the frequency band yielding the highest classification accuracy is identified as the optimal band for that subject and cross-validation split. This selection process ensures that the final classification decision is based solely on the most discriminative time-frequency window, without combining outputs from multiple classifiers.

OTFWRGD has several distinct advantages over traditional methods. By systematically evaluating multiple time-frequency windows, the algorithm automatically selects the most discriminative band for classification, which improves the ability to capture relevant neural oscillations associated with motor imagery tasks. The use of covariance matrices as features allows the EEG data to be mapped into a lower-dimensional Riemannian manifold, making it more robust against artifacts and inter-subject variability. The covariance-based features are invariant to amplitude scaling, which enhances generalization. LTSA effectively reduces feature dimensionality while preserving the intrinsic geometric structure of EEG data, which helps to improve computational efficiency and reduce overfitting, a common issue in high-dimensional EEG feature spaces. The use of MDRM enables efficient classification by computing the distance between covariance matrices in the Riemannian space, unlike traditional Euclidean-based methods, Riemannian approaches are more robust in handling non-stationary EEG signals. The weighted fusion of classification results leads to higher reliability and better adaptability to subject-specific EEG patterns.

This proposed algorithm represents a comprehensive, innovative approach to EEG signal processing for motor imagery tasks, provides a powerful framework for motor imagery EEG classification by optimizing time-frequency feature selection, utilizing covariance-based features, and leveraging Riemannian geometry-based classification methods. By combining adaptive frequency band selection, feature dimensionality reduction, and decision fusion, OTFWRGD significantly enhances classification accuracy, computational efficiency, and robustness in BCI applications.

In this study, each patient EEG dataset was partitioned into a 70% training set and a 30% test set. To further validate the models, a 10-fold cross-validation procedure was used to ensure robust estimation of performance metrics across all patients. The Table5shows the mean classification metrics obtained for the four models—CSP+LDA, FBCSP+SVM, EEGNet, and OTFWRGD—in terms of average accuracy, the kappa coefficient, which is a measure of classification consistency and the precision and sensitivity are measures of the robustness of decoding methods. The average accuracy of the four models is 51.43%, 55.71%, 76.21%, and 86.41%, respectively.

Comparison of the average classification accuracy over the 30 patients among different models.

The Fig.5shows the classification accuracy for each individual subject in the dataset, comparing CSP+LDA, FBCSP+SVM, EEGNet, and OTFWRGD. Across 30 patients (15000 trails), most subjects achieved higher accuracy with OTFWRGD than with the other three methods. EEGNet tended to match or slightly outperform the traditional methods (CSP+LDA and FBCSP+SVM) in a majority of cases, confirming its ability to learn features adaptively. CSP+LDA and FBCSP+SVM displayed more significant variability in accuracy across subjects, suggesting they might be more sensitive to individual differences in knee pain levels or imaging ability.

Classification accuracy in 30 patients when using four models.

To further explore classification performance, the Fig.6presents the confusion matrices for all four models, illustrating how often each classifier correctly identifies left-leg versus right-leg MI tasks. The four classification methods displayed varying performance levels, confirming the usability of our lower-limb MI-EEG dataset in patients experiencing pain. OTFWRGD delivered the highest accuracy and consistency across participants, demonstrating its effectiveness in addressing the unique challenges posed by lower-limb pain. EEGNet also produced promising results, highlighting the potential of deep learning to automatically capture meaningful features from clinical EEG data. Meanwhile, CSP+LDA and FBCSP+SVM confirm that the dataset exhibits relatively reliable MI signals even when employing more traditional machine learning techniques. Overall, these findings indicate robust and distinguishable left- versus right-leg MI activity, supporting the dataset’s validity and practicality for future rehabilitation and BCI applications.

This work is supported by the China Postdoctoral Science Foundation (NO. 2024M764330), Air Force Medical Center Supporting Program (NO.589N9C), Air Fore LSD of China (NO. BKJ23WS1J003), Xi’an Science and Technology Program Project (No. 23ZDCYJSGG0005-2023). Additional Information: All authors thank Junchi Ren, Department of Informatics, King’s College London for his help in technical support and dataset upload.