Single-cell RNA sequencing analysis faces critical challenges including high dimensionality, sparsity, and complex topological relationships between cells. Current methods struggle to simultaneously preserve global structure, model cellular dynamics, and handle technical noise effectively.

We present GNODEVAE, a novel architecture integrating Graph Attention Networks (GAT), Neural Ordinary Differential Equations (NODE), and Variational Autoencoders (VAE) for comprehensive single-cell analysis. Through systematic evaluation across 10 graph convolutional layers, GAT demonstrated optimal performance, achieving average ARI advantages of 0.108 and 0.112 over alternative graph convolutional layers in VGAE and GNODEVAE architectures respectively, along with ASW advantages of 0.047 and 0.098. Extensive comparison across 50 diverse single cell datasets against 18 existing methods demonstrates that GNODEVAE consistently outperforms three major categories of benchmark methods: 8 machine learning dimensionality reduction techniques, 7 deep generative VAE variants, and 3 graph-based and contrastive learning deep predictive models. GNODEVAE achieved average advantages of 0.112 in reconstruction clustering quality (ARI) and 0.113 in clustering geometry quality (ASW) over standard VGAE, with an average ASW advantage of 0.286 over all benchmark methods in clustering geometry quality. In gene dynamics clustering evaluation, GNODEVAE outperformed Diffusion map and Palantir methods across all geometric metrics.

GNODEVAE establishes a robust computational framework that synergistically combines neighborhood-awareness, dynamic modeling, and probabilistic expressiveness for single-cell multi-omics analysis. The consistent superior performance across diverse datasets demonstrates its effectiveness as a versatile tool for cell clustering, dimensionality reduction, and pseudotime trajectory analysis in both scRNA-seq and scATAC-seq data mining.

Single-cell RNA sequencing (scRNA-seq) technology offers unprecedented resolution for investigating cellular heterogeneity and state transitions by measuring gene expression at the individual cell level [1]. Unlike bulk RNA sequencing, scRNA-seq distinguishes transcriptomic profiles among different cell types within complex tissues, enabling identification of rare cell populations, elucidation of regulatory factors, and reconstruction of cell fate determination trajectories. The applications of scRNA-seq have expanded rapidly across developmental biology, cancer research, immunology, and neuroscience, establishing it as a foundational technology for precision medicine and biological discovery.

Single-cell RNA sequencing data presents significant analytical challenges due to its high dimensionality, sparsity, and technical noise [2]. Core computational tasks include dimensionality reduction for visualization, clustering for subpopulation identification, and trajectory analysis for developmental pathway reconstruction. Current methods face three critical challenges: simultaneously preserving global structure and local relationships [3]; accurately modeling complex topological relationships between cells [4]; and effectively mitigating technical noise and biological variation [1].

Traditional clustering approaches face significant limitations when applied to scRNA-seq data analysis. Classical methods such as K-means assume spherical cluster shapes and require pre-specification of cluster numbers, while hierarchical clustering suffers from computational complexity and noise sensitivity in high-dimensional sparse data [2,5]. Despite its consensus-based approach, SC3 (Single-Cell Consensus Clustering) encounters scalability issues with datasets containing large numbers of cells and struggles with highly sparse data due to unreliable distance-based similarity measures [6,7]. Seurat’s clustering workflow and spectral clustering methods face additional challenges with batch effects, parameter sensitivity, and computational bottlenecks in large datasets [8,9]. Fundamentally, these conventional approaches treat cells as independent entities in Euclidean space, failing to model the continuous nature of cellular differentiation processes and complex topological structures that characterize developmental trajectories [10]. The inability to effectively integrate structural relationships, handle uncertainty, and model dynamic processes necessitates more sophisticated approaches that can simultaneously address these interconnected challenges.

Pseudotime analysis has evolved through several generations to address these challenges. First-generation methods focused on structure preservation through minimum spanning trees (Monocle [11]), diffusion maps (Diffusion Pseudotime [12]), and enhanced branch point detection (Wishbone [13]). Second-generation algorithms incorporated advanced graph theory: Monocle 3 [14] implemented uniform manifold approximation and projection (UMAP) and principal graph analysis, Palantir [15] applied Markov processes for fate decisions, and PAGA [16] developed partition-based graph abstraction. Third-generation methods addressed noise and heterogeneity through transcript splicing analysis (RNA Velocity [17]), optimal transport theory (Waddington-OT [18]), and combined velocity with transfer learning (CellRank [19]).

Recent machine learning approaches have provided increasingly effective solutions. Deep autoencoder architectures demonstrate superior performance in capturing multi-scale structures. DCA [20] simultaneously preserves macroscopic cell type distributions and microscopic state transitions, while scVI [21] employs a variational framework that learns global structure and local variation through probabilistic latent representations. Graph learning methods explicitly model cell relationships: GraphSAINT [22] balances computational efficiency with structure preservation, while scGNN [23] iteratively optimizes cell graphs and feature representations.

Graph Attention Networks (GAT) [24] excel at capturing complex topologies by dynamically determining neighbor importance based on cell features, particularly at differentiation branch points. NODE [25] provide a continuous mathematical framework for modeling developmental processes. TrajectoryNet [26] and scNODE [27] have successfully applied NODEs to trajectory inference, while PRESCIENT [28] integrates stochastic simulation to model developmental landscapes. Topological approaches further enhance structure preservation through TopoAE [29], TGCN [30], and CellPath [31].

Deep generative models effectively handle uncertainty through probabilistic frameworks. scVI [21] models gene expression with specialized count distributions while learning batch covariates. Harmony [32] employs iterative clustering and linear correction for batch effect removal, while scArches [33] enables reference-based integration across datasets. Multi-task learning approaches enhance robustness: SAUCIE [34] simultaneously performs dimensionality reduction, batch correction, and clustering; Totalvi [35] jointly models RNA and protein expression; and DESC [36] combines deep embedding with soft clustering for superior performance in noisy environments.

Graph Neural Networks (GNNs) have emerged as powerful tools for processing non-Euclidean data by learning node representations through neighborhood information aggregation [37]. Their key advantage lies in processing irregular structural data and explicitly modeling entity relationships [38]. In single-cell analysis, cells are represented as graph nodes with similarity-based edges, enabling GNNs to leverage intercellular relationships for representation learning [23]. This approach excels at capturing complex topological structures such as differentiation branch points, transitional states, and rare subpopulations, while mitigating noise and batch effects.

Variational Autoencoders (VAE) are probabilistic generative models that learn data’s latent probability distribution [21]. VAEs offer distinct advantages for single-cell analysis: their probabilistic framework naturally handles technical and biological noise; continuous latent space effectively models gradual cell state transitions; generative capabilities enable simulation of hypothetical cell states; and they can integrate prior biological knowledge [39]. Several specialized implementations demonstrate VAE’s utility: scVI [21] models gene expression with zero-inflated negative binomial distributions while handling batch effects; trVAE predicts cellular responses to perturbations [40]; and MM-VAE integrates multi-modal data for comprehensive cell state understanding [41].

The integration of GNNs and VAEs represents a significant advancement for analyzing complex structured data [42], creating a powerful framework that leverages both structural and probabilistic data characteristics. Variational Graph Autoencoders (VGAE) exemplify this fusion, using graph convolutional networks as encoders while reconstructing graph structures through decoders. This integration offers complementary advantages: GNNs capture topological structure while VAEs provide probabilistic frameworks and generative capabilities; GNN message passing mitigates data noise and sparsity while VAE latent space constraints generate meaningful representations [23]. Recent advances demonstrate VGAE’s superior performance: scGNN [23] iteratively optimizes cell graphs and feature representations; GraphSCI integrates multiple cell interaction types for multi-omics analysis [43]; and scVGAE significantly improves subpopulation identification accuracy [44].

NODE [25] combine deep learning with differential equation theory to model continuous dynamic processes, parameterizing neural networks as continuous dynamical systems. Unlike traditional networks with fixed layer numbers, NODEs calculate state changes through numerical solvers. The NODE-VAE architecture combines these approaches to learn continuous trajectories in latent space [45], offering key advantages for single-cell analysis: handling irregularly sampled temporal data [45]; modeling continuous developmental processes [26]; capturing uncertainties through probabilistic frameworks [46]; and generating hypothetical cell states at different timepoints [25]. Applications in pseudotime analysis have shown promising results: TrajectoryNet [26] models developmental trajectories and predicts intermediate cell states, while scNODE incorporates cell type prior knowledge to guide trajectory learning [27].

However, traditional NODE-VAE approaches have limitations when processing complex topological structures, as they typically view cells as independent entities and struggle with highly heterogeneous populations. The integration of graph neural networks, neural ordinary differential equations, and variational autoencoders represents a promising direction for simultaneously addressing all three challenges through complementary strengths in topology representation, dynamics modeling, and uncertainty handling. Our proposed GNODEVAE framework implements this integrated approach, combining GAT’s relationship modeling, NODE’s continuous dynamics representation, and VAE’s probabilistic inference.

We propose GNODEVAE, a graph-based NODE variational autoencoder that integrates graph neural networks, NODEs, and probabilistic inference to model the temporal evolution of graph-structured single-cell data. Unlike traditional variational autoencoders, GNODEVAE infers a continuous-time representation by estimating a time variabletfor each node, enabling the modeling of dynamic processes on graphs without explicit temporal annotations.

The model consists of three main components: 1) an encoder that maps input features to a latent space and estimates time variables, 2) a NODE that models the continuous dynamics in the latent space, and 3) decoders that reconstruct both node features and graph structure.

Our framework supports two encoder variants: a graph-based encoder and a linear encoder, both extended to estimate a time variable for each node.

The graph encoder utilizes a sequence of graph convolutional layers to process node features while accounting for graph topology. Given an input graph withnnodes,dnode features, andmedges, we define node features, edge indices, and optional edge weights.

where,is a ReLU activation function, BN denotes batch normalization, and GNN represents a graph neural network layer. Our implementation supports various graph convolutional architectures, including GAT, Graph Convolutional Networks (GCN), Chebyshev Graph Convolutional Networks (ChebNet), Graph Sample and Aggregate (GraphSAGE), Topology Adaptive Graph Convolutional Networks (TAGConv), AutoRegressive Moving Average (ARMA), Graph Transformers, Simple Graph Convolution (SGConv), and Simple Spectral Graph Convolution (SSGConv).

whereandare learnable parameters,his the hidden dimension, and the sigmoid activation ensuresfor each nodei.

For datasets without graph structure, we provide a linear encoder variant that processes features through linear layers with the same output structure.

The NODE models the continuous-time dynamics in the latent space. Given the inferred latent representationsand time variables, we sort and filter the data points by time to obtain a sequence ofKunique time pointsand corresponding latent states.

GNODEVAE employs two decoders: a structure decoder for reconstructing graph connectivity and a feature decoder for reconstructing node features.

The outputrepresents logits that are passed through a sigmoid function during loss computation. For sparse graphs, we apply a thresholdto retain only significant connections.

This reconstruction is applied to both the VAE latent codesand the ODE-generated trajectories.

wherewithbeing the library size, andis the learned dispersion parameter.

whereKis the number of unique time points after filtering,represents the corresponding input features, and.

whereandrepresent the mean latent representations and ODE trajectory points corresponding to the filtered unique time points, respectively.

The model is optimized using the Adam optimizer. During training, time variables are sorted and filtered to obtain unique time points for ODE solving, and all loss components are weighted according to the specified hyperparameters.

This study benchmarks computational methods for learning a low-dimensional embeddingfrom a single-cell gene expression matrix, whereNis the number of cells,Dis the number of genes, andis the latent dimension. The methods are grouped into three categories.

whereis the projection matrix containing the topdeigenvectors, and the embedding is.

ICA aims to linearly separate the mixed observed signalsinto a set of statistically independent source signalsby finding an unmixing matrix. The model assumes, whereis the mixing matrix. The goal is to findsuch that the components ofare as independent as possible, typically by maximizing their non-Gaussianity.

NMF decomposes the non-negative expression matrixinto two non-negative matrices: a matrix of basis vectors or"metagenes"and a matrix of coefficients or cell loadings.

This model assumes that the observed data(for celli) is a linear combination of a small number of unobserved latent factors, plus Gaussian noise.

Here,is the data mean,is the factor loading matrix, andis a diagonal matrix of noise covariances.

Truncated SVD provides a low-rank approximation of the data matrixby retaining the topdsingular values and their corresponding singular vectors.

whereandare orthogonal matrices of the topdsingular vectors andis a diagonal matrix of the topdsingular values. The embedding is typically.

This method learns a dictionary of basis vectors(atoms) and a sparse code matrixto represent the data.

whereis the sparse code for celliandis a regularization parameter controlling sparsity.

whereandare thej-th eigenvalue and eigenvector of, respectively. PALANTIR builds upon this framework to model cell trajectories [15].

where the first term is the reconstruction log-likelihood and the second is the KL divergence between the approximate posterior and a prior(usually).

This variant introduces a hyperparameterto control the capacity of the latent information bottleneck. A largerencourages a more disentangled latent space.

INFO-VAE improves training stability and representation quality by adding a Maximum Mean Discrepancy (MMD) term to the objective, which measures the distance between the aggregated posteriorand the prior.

This forces the latent factors to be uncorrelated.

whereis the zero-inflation probability,is the mean, andis the dispersion of the Negative Binomial (NB) component, all learned from the latent variable[21].

This model uses a NODE to learn a continuous vector field in the latent space, modeling cellular dynamics and trajectories.

wherefis a neural network parameterized bythat defines the latent dynamics [47].

whereis the embedding of an anchor cell (query),is the embedding of a similar cell (positive key),are embeddings of dissimilar cells (negative keys),is the similarity function, andis the temperature parameter.

scGCC is a graph contrastive learning method. It first builds a k-NN graph from the expression data. Positive pairs are formed by a cell and its augmented version (via feature masking and noise). The model uses a GAT Network encoder within a Momentum Contrast (MoCo) framework to optimize the InfoNCE loss, using other cells in the batch and a dynamic queue as negative keys [48].

CLEAR learns representations by maximizing agreement between two differently augmented views of the same cell, without an explicit graph. Each cell profile is stochastically augmented to create a positive pair. It uses a standard MLP encoder and the MoCo framework to optimize the InfoNCE loss against negative keys from other cells [49].

scGNN is a VAE that incorporates graph-based regularization. Its loss function includes the standard VAE terms plus a graph Laplacian regularizer that encourages connected cells in a k-NN graph to have similar reconstructions.

whereis the reconstruction of,Eis the set of graph edges, andis the edge weight. It uses an EM-like procedure, alternating between updating the latent embeddings and rebuilding the graph based on the new embeddings [50].

The performance of each embedding was assessed using a suite of metrics evaluating both the preservation of biological cell identity and the effective removal of non-biological batch effects.

where the Index is the standard Rand Index, which counts the fraction of cell pairs that are either in the same group in bothCandKor in different groups in both clusterings.

NMI is an information-theoretic metric that quantifies the mutual dependence between the true labels and the predicted clusters. It is normalized by the entropies ofCandKto scale the result between 0 (no mutual information) and 1 (perfect correlation).

Here,I(C,K) is the mutual information, andH(C) andH(K) are the entropies of the respective label sets.

wherea(i) is the mean intra-cluster distance for celli, andb(i) is its mean nearest-cluster distance. The ASW is the average ofs(i) over all cells, with higher values indicating better-defined clusters.

Also known as the variance ratio criterion, the CAL score is the ratio of the sum of between-cluster dispersion to the sum of within-cluster dispersion. A higher CAL score indicates that clusters are dense and well separated.

The DAV score measures the average similarity of each cluster with its most similar one. Similarity is defined as a ratio of within-cluster distances to between-cluster distances. Lower DAV scores correspond to better clustering, as it signifies that clusters are farther apart from each other.

This metric quantifies the degree of redundancy or entanglement in the learned latent representation. It is calculated as the mean of the sum of absolute Pearson correlations for each latent dimension, excluding self-correlation. A lower score signifies a more disentangled representation.

whereis thei-th column (dimension) of the latent matrix.

The Local Inverse Simpson’s Index (LISI) measures the diversity of labels within the local neighborhood of each cell. The ILISI variant assesses batch correction by measuring the diversity of batch labels in these neighborhoods. A high raw score indicates that cells from different batches are well-mixed. We report a scaled score where 1 represents perfect mixing and 0 represents no mixing [51].

The CLISI variant uses the same principle to assess the preservation of biological identity. It measures the diversity of cell-type labels in local neighborhoods. A low raw score indicates that neighborhoods are homogenous with respect to cell type, suggesting good separation of biological structure. We report a scaled score where 1 is optimal (perfect separation of cell types) and 0 is the worst (uniform mixing) [51].

To rigorously evaluate the performance of the benchmarked methods, we conducted a series of statistical tests on the resulting evaluation metrics. The comparisons were performed under a paired experimental design, where each method was applied to the same collection of datasets, allowing for direct and controlled comparisons. A significance level ofwas used for all tests. The initial step for each metric was to assess the normality of its distribution for each method using the Shapiro-Wilk test. The choice of the subsequent statistical test was dependent on the number of methods being compared and whether the normality assumption was met. For comparing the performance of two methods, a paired Student’s t-test was employed if the distributions of their metric scores were both normal. If the normality assumption was violated for either method, the non-parametric Wilcoxon signed-rank test was used as an alternative. For comparisons involving more than two methods, an omnibus test was first performed to detect any overall significant difference among the group. For normally distributed data, a one-way Repeated Measures Analysis of Variance (RM ANOVA) was conducted. In cases where the data was not normally distributed, the non-parametric Friedman test was used. If the RM ANOVA or Friedman test yielded a significant result (p < 0.05), post-hoc tests were conducted to identify which specific pairs of methods differed significantly. Following a significant RM ANOVA, Tukey’s Honest Significant Difference (HSD) test was used for pairwise comparisons. In the case of a significant Friedman test, pairwise comparisons were performed using the Wilcoxon signed-rank test, with p-values adjusted for multiple comparisons using the Bonferroni correction.

To minimize experimental bias related to data selection, we obtained 45 single-cell datasets from public databases, along with an additional 5 datasets specifically included for enhanced multi-batch analysis, as experimental samples for this study (Fig.1A). To emphasize the characteristic of single-cell sequencing as continuous biological snapshots, we deliberately selected 15 normal developmental datasets with prominent continuous states during differentiation processes and 15 cancer datasets with stronger cellular state continuity and clinical significance. Additionally, to validate the practical application value of our proposed method, we expanded our analysis to include 15 scATAC-seq datasets, demonstrating the multi-modal application capabilities of GNODEVAE’s improved VAE architecture.

Based on the fundamental principles of graph learning, we conducted data preprocessing to extract graph structural features, followed by stepwise model improvements guided by experimental evidence. Our approach progressed from graph convolutional layer selection to VGAE implementation, culminating in the construction of the final GNODEVAE model. To validate the generalizability and practical applicability of our improved model, we performed comprehensive benchmarking and performance comparison against 8 machine learning-based dimensionality reduction techniques, 7 deep generative VAE variant models, and 3 contrastive and graph learning models across all 45 datasets. Finally, we conducted hyperparameter tuning of loss terms and ablation studies to further investigate the interpretability and origins of model performance improvements (Fig.1B).

Given the characteristics of single-cell unsupervised tasks and the representation learning properties of VAE, we selected unsupervised clustering metrics to evaluate the quality of latent embeddings obtained by our model (Fig.1B). Among these metrics, ARI and NMI are based on predetermined labels and reflect reconstruction quality, while ASW, CAL, and DAV require latent embeddings as input and reflect the intrinsic clustering geometry quality of the latent space. COR serves as an interpretability metric for disentanglement, elucidating the biological significance of latent space performance improvements achieved through each refinement step.

Systematic evaluation across 45 datasets demonstrates GAT’s consistent superiority over nine alternative graph convolution layers in both VGAE and GNODEVAE architectures, revealing optimal balancing characteristics that establish GAT as the comprehensive performance choice for single-cell analysis. In the VGAE architecture, GAT exhibits significant reconstruction quality advantages in scRNA-seq normal developmental datasets, achieving substantial improvements over traditional methods like ARMA (ARI: +0.341, NMI: +0.338) while maintaining slight advantages over advanced methods like Transformer (ARI: +0.017, NMI: +0.017), with clustering ensemble metrics revealing favorable geometric performance including ASW improvements of +0.096 compared to Graph, CAL substantial enhancement of +121.772 compared to GCN, and DAV improvement of +0.074 compared to TAG, demonstrating that traditional spectral methods consistently underperform across all metrics while intermediate graph neural networks show progressive improvements (Fig.2A, Table1). In scRNA-seq cancer datasets, GAT advantages become more pronounced with reconstruction quality metrics reaching ARI: +0.195, NMI: +0.193 compared to traditional method Cheb while maintaining slight superiority over Transformer (ARI: +0.001, NMI: +0.001), and clustering geometric performance showing ASW improvement of +0.100 compared to Cheb, CAL significant enhancement of +135.011 compared to GCN, and DAV improvement of +0.083 compared to SG, confirming advanced attention methods approach GAT levels but exhibit complex trade-off relationships (Fig.2B, Table2). scATAC-seq datasets validate GAT’s cross-modal stability with reconstruction quality improvements of ARI: +0.089, NMI: +0.088 compared to Graph and slight advantages over Transformer (ARI: +0.013, NMI: +0.013), while clustering geometric metrics demonstrate ASW improvement of +0.088 compared to Graph, CAL enhancement of +124.075 compared to GCN, and DAV improvement of +0.162 compared to TAG (Fig.2C, Table3).

The GNODEVAE architecture significantly amplifies GAT’s performance advantages through architectural synergistic effects, with scRNA-seq normal developmental datasets showing GAT achieving steady reconstruction quality improvements compared to Graph (ARI: +0.186, NMI: +0.184) while performing nearly equivalently to Transformer (ARI: +0.001, NMI: +0.001), and clustering geometric performance realizing qualitative leaps with ASW reaching +0.191 compared to Cheb, CAL achieving massive improvement of +794.152 compared to GCN, and DAV enhancement of +0.804 compared to Cheb, while COR latent space coupling shows significant strengthening of +2.259 compared to traditional method ARMA but exhibits a decrease of −0.297 compared to TAG, reflecting GAT’s achievement of reasonable balance in latent space component disentanglement (Fig.2D, Table4). scRNA-seq cancer datasets demonstrate the strongest performance with reconstruction quality metrics reaching peak levels compared to Cheb (ARI: +0.347, NMI: +0.344) while maintaining clear advantages over Transformer (ARI: +0.047, NMI: +0.047), and clustering geometric metrics showing comprehensive optimization with ASW of +0.198 compared to Cheb, CAL significant improvement of +365.633 compared to GCN, and DAV reaching +0.916 compared to Cheb, with COR exhibiting higher coupling compared to traditional methods (+2.744) but decreases compared to advanced method TAG (−0.337), further confirming the latent space coupling trade-off patterns where GAT exhibits higher latent component correlations compared to traditional methods but shows lower coupling when compared to both TAG and Transformer (Fig.2E, Table5). scATAC-seq datasets further confirm these patterns with reconstruction quality significantly improving compared to Cheb (ARI: +0.137, NMI: +0.136) while maintaining clear advantages over Transformer (ARI: +0.091, NMI: +0.090), clustering cohesion ASW improving +0.104 compared to SSG, clustering separation CAL achieving substantial optimization of +491.822 compared to GCN, and overall clustering quality DAV improving +0.672 compared to Cheb, with COR demonstrating the highest coupling compared to traditional methods (+3.207) but showing significant decrease compared to TAG (−0.756), establishing that although advanced methods like TAG and Transformer perform better in certain clustering geometric metrics, GAT maintains stable advantages in reconstruction quality while maintaining reconstruction quality and clustering geometric performance (Fig.2F, Table6).

Systematic comparison across 45 datasets demonstrates GNODEVAE architecture’s significant performance advantages over VGAE architecture across all dataset categories and evaluation metrics, with the GNODEVAE architecture integrating Graph Attention Networks, Neural Ordinary Differential Equations, and Variational Autoencoders to directly model the continuous characteristics of cellular state transitions, addressing the fundamental limitation of traditional discrete modeling approaches that fail to capture the gradual, continuous changes inherent in cellular differentiation, activation, and transformation processes (Fig.3A, Table7). Performance patterns across different data types reveal distinct biological complexity-related characteristics where scRNA-seq normal developmental datasets exhibit balanced performance improvements with reconstruction quality metrics ARI and NMI increasing by +0.100 and +0.099 respectively, clustering geometric metrics ASW, CAL, and DAV improving by +0.113, +1094.718, and +0.318 respectively, while COR latent space coupling strengthens by +1.321, reflecting how well-defined continuous trajectories from pluripotent to specialized states naturally align with neural ordinary differential equation modeling (Fig.3B, Table7). scRNA-seq cancer datasets demonstrate the greatest reconstruction quality advantages with ARI and NMI achieving +0.167 and +0.165 improvements respectively, accompanied by significant clustering geometric enhancements (ASW: +0.140, CAL: +738.352, DAV: +0.437) and COR coupling improvement of +1.222, establishing that complex non-linear state transitions involved in malignant transformation enable continuous-time modeling to demonstrate maximal reconstruction quality advantages (Fig.3C, Table7). scATAC-seq datasets present characteristic performance trade-offs of GNODEVAE architecture where clustering geometric performance achieves substantial improvements, particularly CAL reaching a dramatic enhancement of +1326.966, with ASW and DAV improving by +0.086 and +0.244 respectively, while reconstruction quality metrics ARI and NMI only achieve modest improvements of +0.069 and +0.068, and COR latent space coupling exhibits the highest increase of +1.633, reflecting the distinctive properties of GNODEVAE architecture when processing sparse, high-dimensional chromatin accessibility data where continuous-time modeling effectively transforms sparse accessibility patterns into smooth latent trajectories, dramatically improving clustering separation and latent space structurization, but this enhancement in latent space coupling does not fully equate to reconstruction quality improvement, instead representing a trade-off relationship between continuous-time dynamics modeling and reconstruction accuracy (Fig.3D, Table7). These systematic performance differences establish GNODEVAE architecture as a fundamental advancement in continuous-time dynamics modeling for single-cell genomics applications, while simultaneously indicating that different architectural choices require careful consideration based on specific analytical objectives and data characteristics.

Systematic evaluation across 45 datasets demonstrates GNODEVAE’s significant advantages over traditional machine learning dimensionality reduction methods in clustering geometry metrics while reconstruction quality metrics do not exhibit similar improvement patterns, with ARI and NMI reconstruction quality metrics showing no statistically significant differences when comparing GNODEVAE with traditional methods, primarily due to the inherent advantages of machine learning techniques in feature extraction and data representation where PCA preserves maximum variance information through principal component analysis, ICA captures intrinsic data structure through independent component decomposition, and NMF extracts local feature patterns through non-negative matrix factorization, as these linear transformation methods effectively maintain the feature structure of original data, thus demonstrating performance comparable to deep learning methods in reconstruction tasks (Fig.4, Tables8,9and10). Despite equivalent reconstruction quality, GNODEVAE exhibits systematic advantages in latent space clustering geometry organization, with scRNA-seq normal developmental datasets showing significant geometric improvements compared to traditional linear methods (PCA, ICA, NMF, TSVD) with ASW improvements ranging from +0.273 to +0.327 and CAL enhancements from +824.599 to +1040.542, while compared to advanced trajectory inference methods (DIFF, PALANTIR), GNODEVAE maintains modest but consistent advantages (ASW: +0.006 to +0.012, CAL: +769.142 to +773.901) though with slight DAV disadvantages (−0.079 to −0.033), suggesting that specialized trajectory methods may produce more compact clusters for well-characterized developmental trajectories (Fig.4A, Table8). scRNA-seq cancer datasets demonstrate larger performance gaps with GNODEVAE achieving ASW improvements of +0.133 to +0.496 and CAL enhancements of +2736.732 to +3098.999 compared to traditional methods while maintaining substantial advantages even against advanced trajectory methods, reflecting GNODEVAE’s superior performance in complex dysregulated cellular state spaces through general-purpose continuous-time modeling (Fig.4B, Table9). scATAC-seq datasets show the most pronounced clustering geometry improvements with CAL enhancements ranging from +4462.961 to +5009.348 and ASW improvements from +0.064 to +0.498, demonstrating the particular suitability of continuous-time modeling for processing sparse binary chromatin accessibility data (Fig.4C, Table10). These results establish GNODEVAE’s unique value proposition in single-cell genomics applications where while traditional machine learning methods possess advantages in computational efficiency and reconstruction accuracy, GNODEVAE achieves systematic improvements in latent space clustering geometry organization through neural ordinary differential equation frameworks, particularly demonstrating clear advantages when processing complex cellular state spaces and sparse high-dimensional data, indicating that when analytical objectives emphasize high-quality unsupervised clustering and biological interpretation, the increased computational complexity of GNODEVAE is justified, while traditional methods retain application value when pursuing computational efficiency and fundamental feature preservation.

Systematic comparison across 45 datasets demonstrates GNODEVAE’s consistent and significant performance advantages over VAE-based generative models across all dataset types, with particularly pronounced benefits in high-dimensional sparse data contexts that confirm the integration of neural ordinary differential equation dynamics represents a critical architectural evolution addressing fundamental limitations of static latent variable models (Fig.5, Tables11,12and13). In scRNA-seq normal developmental datasets, GNODEVAE achieved systematic improvements compared to all VAE variants with ASW enhancements ranging from +0.218 to +0.318 and CAL improvements from +482.294 to +934.374, while VAEs with strongregualrization (highBeta-VAE, TC-VAE, DIP-VAE) demonstrated the poorest performance with DAV improvements of +1.779 to +2.552, indicating that excessive regularization severely compromises clustering geometric performance, and among single-cell specialized methods, scTour showed the best performance within VAE-based approaches but still exhibited significant gaps (ASW: +0.237, CAL: +482.294), demonstrating that despite scTour’s integration of ODE modules for trajectory inference, GNODEVAE maintains significant advantages potentially attributable to the unique role of GAT attention mechanisms that dynamically aggregate neighborhood information through attention weights, incorporating graph structural prior knowledge to more accurately capture intercellular interaction patterns and state transition relationships during continuous-time evolution, while traditional VAE methods including scTour lack this explicit modeling capability for graph structural information (Fig.5A, Table11). scRNA-seq cancer datasets revealed larger performance gaps with GNODEVAE achieving ASW improvements ranging from +0.290 to +0.403 and CAL enhancements from +966.434 to +1409.069, with the systematic amplification of performance advantages compared to normal developmental datasets reflecting the exponentially greater benefits provided by continuous-time modeling frameworks as cellular state complexity increases (Fig.5B, Table12). scATAC-seq datasets demonstrated the most pronounced performance advantages with CAL improvements ranging from +1991.597 to +2423.563 and ASW enhancements from +0.312 to +0.393, with even the best-performing VAE variant scTour remaining significantly inferior (CAL: +1991.597), demonstrating the particular suitability of continuous-time modeling for processing sparse binary chromatin accessibility data, while performance advantages exhibit a clear hierarchical pattern scaling with dataset complexity: scATAC-seq datasets (CAL: +1991.597 to +2423.563) > scRNA-seq cancer datasets (CAL: +966.434 to +1409.069) > scRNA-seq normal developmental datasets (CAL: +482.294 to +934.374), indicating that GNODEVAE’s architectural innovations become increasingly important as single-cell genomics advances toward more complex multi-modal and spatially resolved datasets, where static latent variable models face fundamental limitations in capturing underlying biological complexity (Fig.5C, Table13). These systematic results confirm that GNODEVAE achieves systematic advantages across all evaluation criteria and dataset types through continuous-time modeling without requiring complex regularization strategies or domain-specific modifications, with particularly pronounced performance in high-dimensional sparse data contexts suggesting that future single-cell generative modeling development should prioritize continuous-time dynamics over static latent representations, while explicit modeling of graph structural information proves indispensable for accurately capturing cellular state transitions, establishing the combined framework of attention mechanisms and continuous-time dynamics as the optimal approach for single-cell analysis applications.

Benchmarking against graph learning and contrastive learning predictive models reveals complex performance patterns that illuminate GNODEVAE’s multi-layered characteristics as a generative continuous-time modeling method (Fig.6, Tables14,15and16). In scRNA-seq normal developmental datasets, GNODEVAE achieved moderate advantages in clustering geometry over the pure graph learning method scGNN (ASW: +0.184, CAL: +707.409) and larger performance gaps relative to scGCC, which integrates graph learning with contrastive learning (ASW: +0.202, CAL: +794.492), while demonstrating the most significant advantages over the pure contrastive learning method CLEAR (ASW: +0.386, CAL: +1147.797, DAV: +2.428), reflecting the fundamental importance of generative modeling in maintaining continuity of cellular state transitions through reconstruction regularization, and for reconstruction quality metrics, GNODEVAE achieved statistically significant improvements in ARI and NMI compared to both scGCC and scGNN, demonstrating the advantages of generative modeling in maintaining data reconstruction fidelity, while differences with CLEAR in ARI and NMI did not reach statistical significance, reflecting the competitiveness of contrastive learning methods in certain reconstruction-related tasks (Fig.6A, Table14). In scRNA-seq cancer datasets, GNODEVAE maintained strong clustering geometry advantages over the integrated method scGCC (ASW: +0.147, CAL: +1258.799), showed larger performance gaps relative to the pure graph learning method scGNN (ASW: +0.215, CAL: +1300.083), and continued to maintain maximum geometric advantages over the pure contrastive learning method CLEAR (ASW: +0.375, CAL: +1537.944, DAV: +2.585), with reconstruction quality metrics similarly showing significant improvements for GNODEVAE relative to scGCC and scGNN in ARI and NMI while showing no significant differences with CLEAR, further confirming the consistency of this pattern and the superiority of continuous-time generative modeling in maintaining data representation fidelity (Fig.6B, Table15). scATAC-seq datasets presented a striking reversal pattern that demonstrates the unique value of specialized method integration in specific data modalities, with scGCC, which integrates graph learning and contrastive learning, achieving superior clustering geometry performance over GNODEVAE (ASW: −0.074, CAL: −8863.300), while GNODEVAE still maintained significant advantages over the pure graph learning method scGNN (ASW: +0.256, CAL: +3990.052) and maximum advantages over the pure contrastive learning method CLEAR (ASW: +0.498, CAL: +4224.173, DAV: +3.025), yet for reconstruction quality metrics, scATAC-seq data exhibited patterns distinctly different from RNA data where GNODEVAE showed significant differences in ARI and NMI only when compared to scGCC while showing no significant differences with either scGNN or CLEAR, reflecting the unique characteristics of sparse binary chromatin accessibility data where the complexity of reconstruction tasks causes different modeling paradigms to converge in reconstruction quality while clustering geometry differences remain significant (Fig.6C, Table16).

GNODEVAE’s batch integration evaluation across multiple scales reveals a consistent performance-efficiency trade-off pattern (Fig.7). At 2,000 cells, GNODEVAE maintained equivalent cell-type neighborhood purity compared to advanced methods (scVI, scTour, scGNN, scGCC, CLEAR) on the CLISI metric but significantly outperformed scVI, scTour, scGNN, and scGCC on the ILISI batch mixing metric while achieving comparable performance to CLEAR, demonstrating that the neural ODE framework’s continuous-time dynamics modeling and graph attention mechanisms effectively remove batch-specific technical artifacts while preserving underlying biological variation (Fig.7A). However, this superior integration performance comes at the cost of highest computational runtime overhead, establishing the fundamental trade-off relationship between architectural sophistication and computational demands. As cell populations expanded to 4,000, 6,000, and 8,000 cells, GNODEVAE sustained its equivalent CLISI performance and enhanced ILISI batch mixing effectiveness, with this performance pattern becoming further consolidated across scales, indicating the scalable nature of its integration advantages (Fig.7B-D). Simultaneously, the systematic growth pattern of computational overhead became increasingly pronounced with dataset complexity, reflecting the characteristic challenge where neural ODE architectural complexity directly correlates with data scale and computational resource requirements. These findings demonstrate that GNODEVAE achieves superior and scalable batch integration performance through its continuous-time modeling framework, but the significant computational costs present challenges for routine analysis workflows and provide important considerations for practical deployment in large-scale single-cell genomics applications.

Systematic ablation studies based on scRNA-seq normal developmental datasets () reveal critical architectural insights into GNODEVAE’s design, demonstrating that reconstruction weight analysis with W-recon=10 achieves optimal performance across all metrics with significant improvements in cluster separation (CAL: +1101.365 to +1260.340) and geometric quality (ASW: +0.151 to +0.172) compared to lower weights, establishing reconstruction fidelity as the fundamental driver of GNODEVAE’s clustering capabilities and reflecting the inherent characteristics of VAE theoretical architectures where maximum impact stems from relative weight changes in KL regularization terms (Table17, Fig.8A). ODE regularization exhibits more complex optimization dynamics with different weights achieving optimal performance across different metrics-ODE-recon=1 achieves optimal clustering accuracy while ODE-recon=10 excels in geometric metrics (ASW: +0.036, CAL: +334.560)—where moderate performance differences (±0.025 for ARI/NMI) primarily reflect that KL terms respond less sensitively to ODE changes compared to main reconstruction terms, but this does not diminish the fundamental importance of ODE terms as evidenced by GNODEVAE’s significant advantages over VGAE across 45 datasets in previous architectural improvement experiments (Table18, Fig.8B). KL weight analysis confirms the complex role of distributional regularization, with W-kl=0.01 achieving optimal results across most metrics while high KL weights (W-kl=10) severely degrade performance (ARI: −0.088, ASW: −0.131), reflecting the fundamental trade-off between latent component independence and biological relevance where lower KL regularization leads to entangled latent components better suited to the biological nature of single-cell data, and changes in KL weights lead to significant variations in coupling between latent space components, which theoretically resembles GNODEVAE’s improvement principles by enhancing biologically meaningful coupling (Table19, Fig.8C). Component ablation studies validate each GNODEVAE element’s importance, with reconstruction knockout (RECON-KO) producing severe performance degradation across all metrics (ARI: −0.061, CAL: −261.542) while KL knockout (KL-KO) shows improved geometric metrics (CAL: +323.498) but degraded clustering accuracy (ARI: −0.034), confirming that KL regularization must be carefully calibrated to balance statistical constraints with biological meaningfulness, and suggesting that future neural ODE clustering architectures should prioritize reconstruction fidelity over distributional regularization, potentially requiring integration of specialized correlation regulation modules rather than relying on traditional KL constraints (Table20, Fig.8D).

Comprehensive biological validation using hematopoietic differentiation data demonstrates GNODEVAE’s capacity to capture differentiation dynamics through gene-level interpretation, utilizing a validation framework designed to assess continuous differentiation processes through gene-level dynamics analysis and subpopulation-level pseudotime inference (Fig.9A). Systematic comparison of pseudotime inference revealed distinct differences between GNODEVAE and established trajectory inference methods (Diffusion map and Palantir) in temporal ordering quality, with GNODEVAE providing both overall pseudotime sampling and subpopulation-level pseudotime resolution that better explains subpopulation-level differentiation processes, as confirmed by visual inspection of t-SNE embeddings showing that the continuous-time modeling approach more effectively captures temporal relationships between gene expression changes during differentiation (Fig.9B). Comprehensive evaluation using ASW, CAL, and DAV metrics demonstrated GNODEVAE’s superior capability in organizing genes according to dynamic expression patterns, achieving higher composite scores across all clustering geometry metrics compared to Diffusion map and Palantir methods, indicating that the neural ODE framework more effectively captures the temporal dynamics inherent in biological differentiation processes (Fig.9C). Dynamic gene expression analysis revealed that genes with high dynamic scores were not consistently identified as significant markers through conventional approaches, with subpopulation visualization and analysis of the top 15 genes ranked by dynamic expression scores demonstrating that GNODEVAE identifies genes undergoing significant temporal changes during differentiation but exhibiting non-static differential expression patterns, as confirmed by volcano plot analysis showing that many dynamically important genes occupy non-significant positions in conventional marker gene rankings, highlighting the complementary nature of dynamic versus static gene expression analysis (Fig.9D). Gene Ontology Biological Process (GOBP) enrichment analysis provided strong validation for the biological relevance of GNODEVAE-identified dynamic genes, with dynamically identified genes showing enrichment for diverse biological processes directly related to cellular differentiation—including cytokine production, cell death, cell division, and hematopoietic differentiation—while conventional marker genes enriched for more specialized functional categories such as translation, biosynthesis, and protein folding, confirming that GNODEVAE’s continuous-time modeling approach enables more precise analysis of biological continuous processes captured in single-cell snapshots by identifying genes that participate in active differentiation processes rather than simply distinguishing between static cell states (Fig.9E).

The intrinsic biological snapshot nature of single-cell data fundamentally motivates our exploration of continuous-time modeling architectures. Single-cell sequencing technologies capture molecular snapshots of cells that exist along continuous biological trajectories, whether during normal development, disease progression, or chromatin accessibility changes [52]. This biological reality necessitates computational methods capable of modeling the continuous nature of cellular state transitions, rather than treating cells as discrete, static entities. Our systematic progression from traditional machine learning to deep learning methods, from predictive to generative models, and from contrastive to continuous learning reflects a deeper understanding of how to authentically model biological processes. The evolution toward continuous-time frameworks represents not merely technical advancement, but a fundamental alignment between computational modeling and biological reality, where cellular differentiation, activation, and transformation processes occur through gradual, continuous changes rather than discrete jumps.

GNODEVAE’s architecture addresses this biological imperative through the strategic integration of GAT, NODE, and VAE components. The GAT component captures local structural relationships through attention mechanisms, ensuring optimal modeling of cellular neighborhoods [53], while the NODE component directly models continuous cellular states through differential equation-based dynamics. This combination creates a framework that simultaneously maintains local cellular relationships and global trajectory dynamics. Systematic evaluation of graph convolutional layers confirmed GAT’s superiority in single-cell applications, with attention mechanisms effectively capturing graph topology in the data and providing interpretable weights corresponding to biological relationships between cell types. The NODE component’s ability to transform static representations into continuous-time dynamical systems enables faithful modeling of gradual cellular state changes, revealing patterns of differentiation acceleration and deceleration consistent with known biological phenomena [54].

Our extensive comparative analysis across multiple method categories provides compelling evidence for the superiority of continuous-time modeling approaches. GNODEVAE’s systematic advantages over VAE-based generative models demonstrate that neural ODE integration addresses fundamental limitations of static latent variable models. Consistent performance improvements across all dataset types, particularly the significant advantages in high-dimensional sparse data environments, establish continuous-time dynamics as a key architectural innovation. Comparisons with traditional dimensionality reduction methods reveal that while classical approaches offer computational efficiency, they systematically sacrifice clustering quality for speed. The statistical significance of GNODEVAE’s improvements across all evaluation metrics indicates that the computational overhead of neural ODE-based modeling yields substantial analytical benefits, particularly for exploratory analysis and cell type discovery tasks. Evaluation against graph-based and contrastive learning methods highlights the fundamental importance of reconstruction regularization for single-cell applications, as contrastive learning methods, despite their theoretical advantages in discriminative tasks, systematically fail due to the lack of reconstruction objectives that preserve the continuous nature of cellular state transitions.

Systematic ablation studies reveal fundamental design principles extending beyond GNODEVAE, providing guidance for the broader field of single-cell method development. The complex interactions between reconstruction weights, ODE weights, and KL weights reveal inherent properties of VAE architectures, where adjustment of any weight fundamentally alters the balance between reconstruction fidelity, dynamic regularization, and distributional constraints. The complex effects of KL regularization warrant particular attention, with lower KL weights (W-kl=0.01) achieving optimal performance while high KL weights severely degrade clustering quality, reflecting a fundamental trade-off between latent component independence and biological relevance. This trade-off mechanism suggests that KL regularization in traditional VAE architectures may be inappropriate for the biologically relevant nature of single-cell data, requiring specialized correlation adjustment modules to balance statistical constraints with biological meaningfulness. GNODEVAE’s continuous-time dynamics partially mitigate this issue through implicit regularization, but future architectural designs should more explicitly address the tension between biological relevance and statistical independence.

Despite GNODEVAE’s significant performance advantages, its computational complexity presents practical challenges for real-world applications. The integration and solution processes of neural ODEs require substantially more computational resources compared to traditional methods, particularly on large-scale datasets. Increased training time and memory requirements limit the method’s scalability, which becomes particularly pronounced when processing modern single-cell datasets containing hundreds of thousands of cells. Additionally, hyperparameter sensitivity requires more careful tuning processes, adding complexity to method application. However, these computational costs must be considered within the context of modern artificial intelligence (AI) infrastructure, where initial training complexity can be mitigated through strategies such as model reuse, transfer learning, and knowledge distillation. For research applications pursuing high-quality analytical results, such computational investment is justified, particularly considering the fundamental advantages of continuous-time modeling in capturing biological processes.

These architectural insights have profound implications for the development of biological foundation models. As the field moves toward large generative models capable of predicting biological outcomes, the fundamental architectural exploration demonstrated here directly benefits foundational choices for large-scale single-cell models. The consistent superiority of continuous-time modeling across diverse data types and analytical tasks suggests that future foundation models should prioritize neural ODE-based architectures over traditional static methods. The particularly significant advantages observed in scATAC-seq data, where sparse, high-dimensional chromatin accessibility measurements amplify the limitations of traditional methods, indicate that continuous-time modeling will become increasingly important as single-cell technologies expand to new modalities.

This study presents GNODEVAE, a novel single-cell analysis architecture integrating Graph Attention Networks, Neural Ordinary Differential Equations, and Variational Autoencoders. Through systematic evaluation across 45 diverse datasets, including 5 additional datasets specifically utilized for multi-batch data analysis, GNODEVAE consistently outperforms 18 existing benchmark methods across all clustering metrics, including 8 machine learning dimensionality reduction techniques, 7 deep generative VAE variants, and 3 graph-based and contrastive learning deep predictive models, demonstrating the fundamental advantages of continuous-time modeling in single-cell genomics. Architectural ablation studies reveal the critical importance of reconstruction fidelity and the complex effects of KL regularization in single-cell data, while biological validation confirms the biological relevance of dynamic gene identification. These findings establish continuous-time neural ODE modeling as a key advancement in single-cell analysis, providing a solid foundation for next-generation analytical methods capable of capturing the full complexity of biological systems.

Z.F.: Conceptualization, methodology, software, validation, formal analysis, investigation, data curation, writing-original draft, writing-review and editing, visualization. C.C.: Visualization, formal analysis, data curation, writing-original draft, writing-review and editing. S.W.: Resources, supervision, project administration. J.W.: Resources, supervision, project administration, funding acquisition. S.C.: Writing-review and editing, resources, supervision, project administration, funding acquisition.

This research was funded by National Natural Science Foundation of China of funder grant number 82222060, 82430103, 82473572, 81930090, 81725019, 82073487, 81602790.