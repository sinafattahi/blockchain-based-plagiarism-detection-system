There is a lack of atrial fibrillation (AF) prediction models tailored for individuals without prior cardiovascular diseases (CVDs) to facilitate early intervention. This study aimed to develop and validate an AF prediction model using machine-learning methods based on routine biomarkers in middle-aged individuals without overt CVD.

Data were derived from 122 822 individuals in the Swedish AMORIS (Apolipoprotein-Mortality Risk) cohort who were aged 40–65 years and without CVD diagnosis at baseline (1985–96) and followed for 20 years for incident AF. The sample was split into training and validation data sets. Random forest was used to identify AF predictors from 16 routine biomarkers covering lipids, liver/kidney markers, glucose control and inflammation.

10 356 (8.4%) incident AF diagnosis occurred over a mean of 18.1 years (SD 4.4). Model performance increased sharply when adding the first seven predictors and plateaued when adding additional ones. Therefore, a final AF prediction model was established based on seven predictors: age, albumin, uric acid, triglycerides, glucose, alkaline phosphatase and sex. C-statistics of the final model were 0.82 (95% CI: 0.81 to 0.82) in the training and 0.71 (0.70 to 0.72) in the validation data set in predicting 20-year AF. The model was well-calibrated in the full sample and age and sex subgroups.

A new AF prediction model was established using seven biomarkers from a population without pre-existing CVDs, thus complementing currently available AF prediction models. These markers are readily accessible in primary and specialist care and demonstrate acceptable performance in predicting short- and long-term AF risk.

Existing atrial fibrillation (AF) prediction models have primarily focused on people with pre-existing cardiovascular diseases (CVD), which does not discriminate in healthier populations. There is a lack of AF prediction models that are tailored for middle-aged individuals without prior CVDs to facilitate early AF prevention.

Among 122 822 individuals aged 40–65 years without prior CVD diagnosis, we developed and validated a new AF prediction model based on five routine biomarkers (albumin, uric acid, triglycerides, glucose, alkaline phosphatase) and age and sex, using a machine-learning method. The model is well calibrated with an acceptable discriminative power (0.74 to predict 5-year and 0.71 to predict 20-year AF in external validation). This is the first AF prediction model that incorporated routine data that does not require extra testing beyond what is already available in primary and specialist care.

The model highlights the utility of routine biomarkers in predicting short- and long-term AF risk among healthy individuals. The model may facilitate in the clinical setting to identify individuals at high risk of developing AF for early intervention.

Atrial fibrillation (AF) is the most common cardiac arrhythmia in old age and a significant contributor to ischaemic strokes, heart failure (HF) and mortality.1 2The number of people affected by AF is estimated at 60 million worldwide in 2023 and will double by 2060 unless effective preventions are implemented.3The ability to predict risk of AF is crucial in managing individuals in follow-up. Early interventions targeting people at high risk of AF will help to reduce future AF burden and improve efficiency in healthcare resource allocation.

Traditional cardiovascular risk factors (CRFs) and cardiovascular diseases (CVDs) have been linked to AF4and incorporated into various AF prediction models such as the CHARGE-AF (Cohorts for Heart and Aging Research in Genomic Epidemiology AF consortium),5C2HEST (Coronary artery disease/Chronic obstructive pulmonary disease, Hypertension, Elderly (age ≥ 75 years), Systolic HF, and Thyroid disease)6and ARIC-AF (Atherosclerosis Risk in Communities-AF) model.7 8However, CVDs and CRFs only explain ∼50% of the population attributable risk.9Data from the Framingham Heart Study (FHS) showed that even among individuals without any CRF or CVD at age 55, the lifetime risk of AF is 29.8% for men and 23.4% for women,10suggesting that other midlife factors are at play. However, there is a lack of AF prediction models that are tailored for healthier people without prior CVDs. We have previously shown that elevated uric acid, a proxy for inflammation, in midlife is a strong risk factor for AF later in life, even in the absence of other coexisting CVDs.11Similar associations were observed for lipids12and kidney function markers.13Therefore, analysing circulating biomarkers in a population not only free of CVD but also where biomarkers are measured without clinical indication could provide valuable insights into AF prediction in a healthy population. Incorporating biomarkers in midlife to predict future AF risk, along with assessing the impact of multiple and often coexisting biomarker levels, could be clinically useful for identifying high-risk individuals who may benefit from early preventive interventions, such as lifestyle and dietary changes.

In this study, we employed a machine-learning method, specifically random forest, to establish and validate a novel AF prediction model based on a wide range of circulating biomarkers measured at midlife. Machine-learning models have the advantage over traditional methods, such as cox regressions or point-based methods,8when accounting for interactions and non-linear associations of the predictors.14Real world data from 122 822 individuals aged 40–65 years in the large Swedish population-based AMORIS (Apolipoprotein-Mortality Risk) with 20 years of follow-up was used.

The AMORIS cohort has been established to assess the role of metabolic factors in chronic diseases. The cohort included 812 073 Swedish individuals who underwent health examinations including blood measurements from 1985 to 1996. Most participants were living in the greater Stockholm area at the time of health examinations. Blood tests were taken either as part of a general health check-up at their workplaces (ie, screening), or within primary or occupational healthcare. All laboratory tests were conducted on fresh blood samples by the Central Automation Laboratory (CALAB) in Stockholm. Several routine biomarkers (eg, total cholesterol, triglycerides, glucose and uric acid) were included in a standard package offered by CALAB, making them available for a large proportion of the cohort.

We selected individuals aged 40–65 years who had blood measurements on all candidate biomarkers included in this study, in total 128 626 individuals. From them, we excluded 345 persons who migrated to Sweden, 288 persons with missing information on migration status, 110 persons who died on the blood sampling day, 669 who had a history of AF diagnosis prior to blood measurement and 4392 who had a history of cardiovascular diagnoses (ie, stroke, transient ischaemic attack (TIA), HF, coronary heart disease (CHD), hypertension and diabetes). The analytical sample eventually included 122 822 individuals without overt CVDs at baseline. These individuals were followed via linkage with national registers including the National Patient Register (NPR) and Cause of Death Register using a unique personal identification number. All individuals were followed from the day of blood sampling over a maximum of 20 years for incident AF diagnosis, migration, deaths or end of follow-up.

A wide range of routine biomarkers was available from the CALAB standard package, including albumin (g/L), uric acid (μmol/L), triglycerides (mmol/L), total cholesterol (mmol/L), glucose (mmol/L), iron (μmol/L), alkaline phosphatase (µkat/L), gamma-glutamyl transferase (gamma-GT) (µkat/L), haptoglobin (g/L), aspartate transaminase (µkat/L), alanine transaminase (ALAT) (µkat/L), estimated glomerular filtration rate (mL/min/1.73 m2), fructosamine (mmol/L) and C-reactive protein (mg/L). These markers reflect an individual’s overall health status, including lipid metabolism, liver function, kidney function, glucose control and inflammatory state. These biomarkers, together with age and sex, were included in the random forest analysis, in total 16 variables.

Incident AF diagnoses were identified from the NPR and Cause of Death Register. The NPR contains information on hospital discharge records from inpatient care regionally since 1964 and nationally since 1987, and data on specialised outpatient care were available nationally since 2001. Data in NPR includes the dates and discharge diagnoses of each hospital visit, and all diagnoses were coded according to the International Classification of Diseases, Eighth, Ninth and 10th Revision (ICD-8, ICD-9, ICD-10). The Cause of Death Register is a complete register of all deaths in Sweden since 1952, with ICD codes of underlying and contributing causes of deaths. In this study, incident AF was identified as the first diagnosis appearing in either register (ICD-8: 427.90 and 427.92; ICD-9: 427.3; ICD-10: I48).

Other cardiovascular conditions at baseline were identified from NPR and include diabetes (ICD-8: 250; ICD-9: 250, 251.D; ICD-10: E10, E11, E13, E14), hypertension (ICD-8: 400–404; ICD-9: 401–405; ICD-10: I10, I13, I15), HF (ICD-8: 427.0, 427.1; ICD-9: 402, 404, 425, 428; ICD-10: I110, I130, I132, I27, I280, I42, I43, I50, I515, I517, I528), CHD (ICD-8: 410–14; ICD-9: 410–414; ICD-10: I20-25), stroke (ICD-8: 431–434; ICD-9: 431–434; ICD-10: I61, I63, I64) and TIA (ICD-8: 435; ICD-9: 435; ICD-10: G45).

The study sample was split into training data set (65.7% of the total sample, ie, people living in Northern Stockholm) and validation data set (34.3% of the total sample, ie, people living in Southern Stockholm). This non-random split by location has been recommended as a stronger design than random splitting because it allows for non-random variations between the training and validating data set.15Indeed, there is a statistically significant difference between the two data sets with regards to age, sex and most of the biomarkers included in the study (online supplemental table 1). An overview of the model building and validation process is shown infigure 1. In the training data set, an initial AF prediction model was developed incorporating age, sex and 14 biomarkers. Random survival forests were constructed as an extension of Breiman’s random forest to account for time-to-event data.14Random survival forests outperform widely used parametric or semiparametric survival analyses because they can account for non-linearities and interactions of predictors.14Nodes were split based on the maximisation of the log-rank test statistics. In the training data set, we generated 1000 trees, and two other hyperparameters—minimum node size and the number of predictors used at each split—were optimised to achieve the maximum c-index in out-of-bag data. The model, finalised after hyperparameter tuning, was used to calculate AF-free probability, that is, average predicted AF-free survival probabilities across all trees. Variable importance scores were calculated using the antisplit method to indicate predictive ability. The antisplit method evaluates how important a variable is by reversing the direction of its split in the decision trees and measuring the impact on prediction accuracy. The prediction model was then validated in the validation data set using c-statistics. With regard to calibration, the study sample was first grouped into quintiles based on predicted probabilities of AF, and the mean predicted probability and the observed probability (ie, cumulative incidence of AF-free) are calculated within each quintile and compared against each other. Kaplan-Meier estimates of AF-free probability were calculated within each predicted quintile to show survival function over the follow-up time.

In the next step, based on the variable importance ranking in the initial prediction model, variable selection was performed to optimise the number of predictors included in the final prediction model. A forward selection strategy was employed following the order of variable importance. Random survival forests building, including hyperparameter tuning, were iterated with predictors added one by one, and the c-statistic (ie, area under the curve (AUC)) was calculated for each step in the validation data set. A final set of predictors was selected when adding more predictors did not add statistically significant contribution to the c-statistics in the validation data set.16AUC of the final prediction model with increasing follow-up years was calculated to evaluate if and how discrimination varies by time since blood measurements. Cox regression models with cubic splines were additionally performed to illustrate the association between each predictor and incident AF, adjusting for age, sex and other biomarkers.

All analyses were performed in R (V.4.3.1). We developed a webpage application tool for individual risk prediction of AF (available at:https://shunsuke-murata.shinyapps.io/af_prediction/).

Patients and/or the public were not involved in the design, or conduct, or reporting, or dissemination plans of this research.

The mean age at baseline of the 122 822 individuals (including both training and validation data sets) was 50.8 years (SD 6.9) and 46.9% were women. Over a mean follow-up of 18.1 years (SD 4.4), 10 356 (8.4%) individuals developed incident AF and they were less likely to be women and had a higher baseline mean of uric acid, triglycerides, glucose, iron, alkaline phosphatase, ALAT and Gamma-GT compared with those who remained AF-free during the follow-up (table 1). There were 6863 incident AF cases (8.5%) in the training data set and 3493 (8.3%) in the validation data set.

AF, atrial fibrillation; ALAT, alanine transaminase; ASAT, aspartate transaminase; eGFR, estimated glomerular filtration rate; Gamma-GT, Gamma-glutamyl transferase.

The initial random forest prediction model included all 16 candidate variables, and the c-statistic of the initial model was 0.81 (95% CI: 0.81 to 0.82) in the training data set and 0.71 (95% CI: 0.70 to 0.72) in the validation data set. Sorted variable importance based on each variable’s contribution to the initial prediction model classification is presented infigure 2. Age was the most important predictor, followed by albumin, uric acid and triglycerides. C-reactive protein was the least important predictor. The sequential forward selection is presented as a line chart infigure 2, where model performance (cumulative AUC) increased steeply when adding the first seven predictors one by one into the model, after which the AUC plateaued at 0.71 when adding additional ones (p<0.001 between 6 and 7 variables, p=0.313 between 7 and 8 variables, p=0.378 between 8 and 9 variables and p=0.121 between 9 and 10 variables). Therefore, the first seven predictors, age, albumin, uric acid, triglycerides, glucose, alkaline phosphatase and sex, were included in the final AF prediction model. Cox regression models showed a linear association between these biomarkers and incident AF when they were analysed individually in the training data set (online supplemental figure 1).

The c-statistic of the final AF prediction model was 0.82 (95% CI: 0.81 to 0.82) in the training data set and 0.71 (0.70 to 0.72) in the validation data set in predicting 20-year AF risk. The minimum node size is 65 and the number of predictors used at each split is 2. How the model discrimination changed with each year’s increase in follow-up time is presented infigure 3. The c-statistics slightly declined over follow-up time in both training and validation data, being 0.74 at year 5, 0.73 at year 10 and 0.71 at year 15 in the validation data.Figure 4shows the calibration of the final model in the validation data set. The observed 20-year AF-free probabilities were very similar to the predicted mean in the top four quintiles, whereas in the lowest quintile the observed AF-free probability (0.83) was slightly higher than predicted (0.78). The model was also well calibrated in different age groups and among men and women in prediction of 10-year AF, although the calibration worsened slightly in predicting 20-year AF (figure 5).

In this large population-based study, we developed and validated a novel AF prediction model using machine-learning methods to predict risk of AF over a 20-year period from midlife onwards. Among a wide range of routinely measured biomarkers, we identified five key markers (albumin, uric acid, triglycerides, glucose, alkaline phosphatase) that, together with age and sex, predicted AF at an acceptable level. The model was well-calibrated with predicted probabilities very similar to observed event rates, as in age-specific and sex-specific subgroups.

Previous AF prediction models were mostly developed using clinical diagnosis of CVDs and CRFs in older populations, as shown in a recent meta-analysis comparing five AF prediction models that had been validated in community cohorts. Two models were developed for incident AF as a primary outcome: the CHARGE-AF model to predict 5-year AF and FHS-AF model to predict 10-year AF, which showed a c-statistic of 0.71 and 0.70 in external validation.8Both models included clinical variables such as history of myocardial infarction, diabetes, hypertension and HF in CHARGE-AF,5and ECG parameters and cardiac murmur in FHS-AF.17Other models that are not originally developed for incident AF (eg, CHA2DS2-VASc [1 point each for congestive HF, hypertension, diabetes mellitus, vascular disease, age 65-74, and female sex, and two points each for age ≥ 75 years and stroke/transient ischemic attack/thromboembolism]) performed worse in external validation (c-statistics ranging from 0.66 to 0.69).8In a recent study, when cardiac biomarker NT-proBNP and polygenic risk scores were added to CVDs and CRFs to predict AF, the c-statistics increased to 0.85.18However, the clinical utilisation of the model is limited because measures such as genetic sequencing are not routinely collected.

It is important to note that our model is not directly comparable with previous AF prediction models as our focus is on routine biomarkers among people without overt CVDs, a population that has rarely been considered in earlier studies. Nevertheless, our model demonstrated acceptable performance in external validation for both short- and long-term AF, even within this healthier population. Our model can be readily used in routine care, as it does not require extra diagnostic testing beyond what is already available in primary and specialist care. Compared with models that included non-modifiable clinical factors, our model is more informative for early AF risk factor management, as the biomarkers included in our model can be related to, or result from, adverse lifestyles and diet.19For instance, uric acid levels can be influenced by alcohol intake and consumption of purine-rich food,20which were associated with risk of AF.21Although existing AF risk scores have variably incorporated lifestyle factors, it is clinically easier to identify AF risk using routine blood tests than surveying about lifestyle factors which are subject to recall issues.

Our model also has potential implications for AF screening and stroke prevention in the community. It was estimated that 30% of people living with AF are undiagnosed, and up to 15% of strokes occur in the context of undiagnosed AF.22However, past AF screening and monitoring programmes have only shown a marginal difference in the detection rate of AF between the screening and control arm, partly because most individuals were selected based on age.22Our model has the potential to increase the efficiency of current AF screening in the general healthy population, as it demonstrated acceptable ability to predict short term AF (a c-statistic of 0.75 to predict 1–5 year incident AF). Considering the long-term risk of AF, our model can be informative in the development of primary prevention guidelines for AF and in selecting at-risk individuals for clinical trials aiming at AF risk reduction.

Age was the single most important risk factor for AF in our study, in line with previous studies.10 23The most contributing biomarkers included albumin, uric acid, triglycerides, glucose and alkaline phosphatase, which were associated with AF in a dose-responsive manner. Indeed, these markers are closely related to metabolic syndrome, inflammation and oxidative stress, which belong to the pathogenesis pathways of AF. For instance, both elevated glucose and uric acid are known to promote the activation of proinflammatory cytokines and induce oxidative stress, leading to endothelial dysfunction, a vascular mechanism of AF pathology.24 25Further, circulating alkaline phosphatase is an independent predictor of mortality in the general population and has a crucial role in vascular calcification, inflammation and endothelial dysfunction in kidney disease and CVDs.26It should be noted that in our study, C-reactive protein ranked last in the ability to predict AF. Previous studies have suggested C-reactive protein as a risk factor for AF.27However, when the synergetic interaction among the different biomarkers was accounted for in our study, C-reactive protein became less important compared with other biomarkers in predicting AF. One explanation may be that C-reactive protein acts more as a mediating factor leading to CVDs,28and therefore loses some of its ability to predict AF when metabolic markers that precede C-reactive protein are considered. Our results suggest that targeting other biomarkers, such as those included in our final model, may be more effective in the primary prevention of AF.

Strengths of this study include the large sample size and the wide coverage of routine biomarkers, enabling a comprehensive investigation of precision prediction of AF risk. However, several limitations should be considered. First, we were not able to directly account for lifestyle factors and hypertension was only identified via hospitalisations. However, the biomarkers should to some extent be reflective of lifestyle factors. Second, the applicability of the model to individuals of non-European ancestry is uncertain. Future studies should validate our model or the included biomarkers in other ethnicities. Third, because specialist outpatient data was only available from 2001 and onwards, we could have missed some AF cases diagnosed in outpatient care before 2001, as well as some asymptomatic cases throughout the study period. This could have underestimated the model performance. Fourth, the biomarker levels were only measured once at baseline and may therefore have been subject to change during the follow-up which we were not able to capture. However, this misclassification of the biomarker values is most likely not related to the risk of developing AF, which could have diluted actual associations and underestimated the model’s ability to predict.

We developed a novel AF prediction model using machine learning methods and routinely measured biomarkers among middle-aged people free of overt CVDs. The model is well calibrated with an acceptable discriminative power (0.74 to predict 5-year and 0.71 to predict 20-year AF in external validation). It has the advantage of using existing clinic data to facilitate early identification and timely intervention of individuals at risk of developing AF. Our findings also underscore the potential utility of routine biomarkers in predicting AF both in the short and long term.