Single-cell studies of signal transduction have revealed complex temporal dynamics that determine downstream biological function. For example, the stimulus-specific dynamics of the transcription factor NFÎºB specify stimulus-specific gene expression programs, and loss of specificity leads to disease. Thus, it is intriguing to consider drugs that may restore signaling specificity in disease contexts, or reduce activity but maintain signaling specificity to avoid unwanted side effects. However, while steady-state dose-response relationships have been the focus of pharmacological studies, there are no established methods for quantifying drug impact on stimulus-response signaling dynamics. Here we evaluated how drug treatments affect the stimulus-specificity of NFÎºB activation dynamics and its ability to accurately code ligand identity and dose. Specifically, we simulated the dynamic NFÎºB trajectories in response to 15 stimuli representing various immune threats under treatment of 10 representative drugs across 20 dosage levels. To quantify the effects on coding capacity, we introduced a Stimulus Response Specificity (SRS) score and a stimulus confusion score. We constructed stimulus confusion maps by employing epsilon network clustering in the trajectory space and in various dimensionally reduced spaces: canonical polyadic decomposition (CPD), functional principal component analysis (fPCA), and NFÎºB signaling codons (i.e., established, informative dynamic features). Our results indicated that the SRS score and the stimulus confusion map based on signaling codons are best-suited to quantify stimulus-specific NFÎºB dynamics confusion under pharmacological perturbations. Using these tools we found that temporal coding capacity of the NFÎºB signaling network is generally robust to a variety of pharmacological perturbations, thereby enabling the targeting of stimulus-specific dynamics without causing broad side-effects.

Immune- and stress-response signaling pathways are functionally pleiotropic: they respond to multiple stimuli and mediate distinct biological responses. For innate immune cells distinguishing different immune threats is important, and loss of stimulus-response specificity is linked to autoimmune or inflammatory diseases. This pleiotropy has posed a challenge for the development of safe pharmacologic interventions, and many promising drug compounds have turned out to result in debilitating side effects. Stimulus-response specificity is mediated by the dynamics of cellular signaling, constituting a â€œtemporal code.â€ This raises the question of whether stimulus responses may be pharmacologically targeted without disrupting stimulus-response specificity, or to restore stimulus-response specificity. However, how to effectively measure and quantify the stimulus-response specificity of signaling dynamics remains unclear. Here, we developed and tested computational metrics on high-throughput simulation data to assess drug effects on the stimulus-response specificity of the NFÎºB pathway. The results advance both the study of temporal signaling codes and strategies for precision drug targeting.

Signaling pathways respond to environmental stimuli and direct downstream gene expression. Environmental information may be encoded in the dynamics of signaling activity, constituting a temporal signaling code [1â€“3]. In recent years, advances in live-cell imaging techniques and the optimization of analytical software have enabled the single-cell study of the temporal profiles of key signaling pathways, including NFÎºB [4â€“8], MAPKs (ERK, JNK, p38) [9,10], p53 [11], and their combinations [12,13]. These studies have revealed that the activated signaling dynamics are stimulus-specific, and that stimulus-specific dynamics regulate gene expression responses and the resulting biological functions, while dysregulation of this temporal coding is associated with various pathological conditions [1,14â€“16].

Theoretical studies have explored the dynamics of signaling pathways as new opportunities for therapeutic intervention [16]. Stimulus-specific signaling dynamics have been proposed as drug targets, as demonstrated in studies of NFÎºB [16], p53 [11], ERK dynamics [17,18], PI3K [19], and the MAPK signaling network [20]. This emerging shift toward designing pharmacological interventions that target the dynamics of signaling offers greater precision than traditional approaches targeting steady-state dose-response relationships.

While the theoretical work established that pharmacological perturbation of signaling dynamics is possible, it remains unclear how stimulus-specific the effects of such perturbations are. Previous studies have primarily focused on specific biochemical reaction rates within abstracted and simplified regulatory networks to alter signal transduction specificity and fidelity [16,25,26]. However, it remains unclear how these perturbations affect stimulus-specific responses by more complex, physiologically relevant signaling networks that are functionally pleiotropic. In fact, we currently lack established methods for evaluating the efficacy and specificity of pharmacological targeting stimulus-response signaling dynamics. To address these questions, we have selected a biological system that exhibits stimulus-specific signaling dynamics in response to a wide range of different stimuli and for which a mathematical model that accounts for the stimulus-response signaling dynamics is available: the NFÎºB signaling system in macrophages.

NFÎºB plays critical roles in regulating immune responses to pathogen-associated molecular patterns (PAMPs), damage-associated molecular patterns (DAMPs), and cytokines via regulating transcription, cytokine production, cell division and death, etc [27]. NFÎºB signaling dynamics encode information about immune threats [4,15,28,29] and regulate immune genes to achieve appropriate immune responses corresponding to the specific stimuli [30â€“37]. Loss of specificity in immune cell responses has been associated with autoimmune diseases [4], and other pathological conditions [15,38]. Recently, we identified six informative dynamic features of NFÎºB signaling, termed â€œsignaling codonsâ€, that together are sufficient to encode stimulus-specific information [4]. Specifically, â€œSpeedâ€ (Speed) captures the activation speed, â€œPeak Amplitudeâ€ (Amp) refers to the highest response level, â€œDurationâ€ (Dur) captures the total time NFÎºB levels remain above an activation threshold, â€œTotal Activityâ€ (AUC) measures the overall accumulation of NFÎºB activity, while â€œEarly vs. Lateâ€ (EvL) represents the front-loading of NFÎºB activity and â€œOscillatory Powerâ€ (Osc) quantifies the oscillation properties of the signaling trajectory.

Prior work also described a mathematical model of the NFÎºB signaling system that accounts for the temporal trajectories of NFÎºB that are representative of experimental single-cell stimulus-response datasets [4]. The model consists of receptor-associated signaling modules (receptor module) that respond to five representative ligands (TNF representing cytokines, LPS, CpG, and Pam3CSK representing bacterial derived molecules, Poly(I:C) representing virus-derived molecules) and a common core module that includes the kinases TAK1 and IKK and the IÎºBÎ±-NFÎºB negative feedback loop. The topology of this mathematical model is well supported by decades of experimental studies and the parameterization is based on numerous publications starting in 2002 [30,39].

To assess the impact of pharmacological perturbations on the integrity of the NFÎºB signaling networkâ€™s temporal coding capacity (i.e., its ability to convey stimulus-specific responses), we selected 10 inhibitors targeting biomolecules involved in NFÎºB signaling pathways, each tested at 20 dosages. Leveraging the well-established mathematical model of the NFÎºB signaling network allowed us to generate synthetic data representing cellular responses to different stimuli under these drug regimes. With this immense amount of synthetic perturbation data, we developed computational methodsâ€”stimulus confusion maps and stimulus confusion scoresâ€”to evaluate alterations in stimulus-response specificity resulting from pharmacological perturbations of the NFÎºB signaling network. We demonstrated the capacity of stimulus confusion maps to (1)Â identify pharmacological perturbations that may enhance or diminish stimulus-specific NFÎºB signaling dynamics; (2) select drug regimens that maximize or minimize the stimulus specificity of NFÎºB pathways; and (3) evaluate the side effects of drugs on altering the stimulus-response specificity of NFÎºB temporal patterns. Applying these tools shows the robustness of temporal coding capacity of the NFÎºB signaling network under a variety of pharmacological perturbations.

Pharmacological perturbations can affect the temporal coding capacity of the innate response network that ultimately controls the dynamical activation of NFÎºB. To investigate this at scale, we developed a computational workflow. The workflow is anchored by an experimentally validated systems model comprised of interconnected ordinary differential equations (ODEs) [4]. This model recapitulates the temporal trajectories of nuclear NFÎºB activity in response to a range of doses of each of five pro-inflammatory ligands, and shows a high degree of specificity in terms of ligand- and dose-specific NFÎºB dynamics and therefore high temporal coding capacity. The model comprises 94 biochemical reaction that are controlled by 126 kinetic parameters, which may be subject to pharmacologic perturbation. Thus, the model may be used to generate data that addresses how pharmacological perturbation may modulate the coding capacity of the innate immune signaling network (Fig 1A).

(A)Schematic of the NFÎºB network model. Five ligands bind to their cognate receptors triggering associated signaling modules that activate the kinase IKK which causes degradation of IÎºBÎ± and hence de-repression of NFÎºB activity. There are numerous pharmacological agents that interfere with different reactions within this NFÎºB signaling network.(B)Table of pharmacological compounds that inhibit biochemical processes within the NFÎºB signaling network. Numbers indicate the kinetic parameters that are affected by the indicated compound.(C)The computational workflow begins with simulations that yield NFÎºB trajectories in response to 5 ligands (TNF, LPS, CpG, Poly(I:C), and Pam3CSK) at low/medium/high doses in the presence of pharmacological treatment with one of 10 compounds at one of 20 doses. The resulting 3000 trajectories are defined by 481 timepoints (every 5 min for 8 hrs) which are then reduced through (1) canonical polyadic (CP) decomposition, (2) functional principal component analysis (fPCA), or (3) quantifications of previously identified informative trajectory features, known as signaling codons. Using the outputted features from dimensionality reduction, epsilon network clustering is applied to the 15 stimulus conditions (colored by stimuli) within a drug regime. Cluster-based stimulus confusion, specificity, and inhibition scores are calculated to reveal the pharmacological effects on stimulus-response specificity of NFÎºB dynamics, also described as the temporal coding capacity of the NFÎºB signaling pathway.

The stimulating ligands were selected to span a variety of immune threats, including bacteria, virus, and cytokines. The ligand doses were chosen using a log-spaced dosage scheme to capture diverse dynamic behaviors, guided by dose span analyses from experimental data. The simulated trajectories under these doses are directly validated by both representative single-cell NFÎºB trajectories (from live-cell imaging) and bulk-level IKK activity measurements (via western blots) [4]. These doses yield simulations that most closely resemble the corresponding biological experimental data. In addition, they were chosen to capture a broad range of dynamic features, including variability in peak values, oscillatory behavior, integral activity, activation speed, timing (early vs. late responses), and duration (S1 Fig). Specifically, LPS and CpG span a spectrum from minimal peak values to high amplitude responses; TNF conditions reflect transitions from minimal to high oscillations at similar peak levels, with low doses producing only early activity and high doses inducing sustained late responses; Pam3CSK demonstrates a shift from low-amplitude oscillations to high, non-oscillatory responses; and PolyIC highlights variation in activation speed.

We identified 10 pharmacological compounds with well-described biochemical mechanisms of action (Fig 1B,S1 Table). As such, we could map each compound to the affected kinetic parameters within the ODE model. This library includes compounds that impact the core module: IKK inhibitor (IKKi) [40,41], TAK1 inhibitor (TAK1i) [40], Beta-TRCP inhibitor (BTRCPi) [42,43], Phosphatase inhibitor (PP2Ai) [44,45], transcription enhancer (TSA) [46], NFÎºB-induced transcription inhibitor (PDTC) [16], translation inhibitor (CHX) [16], and nuclear export inhibitor (Sel) [47]. A proteasome inhibitor, MG132, inhibits the degradation of IÎºBÎ±, whether complexed to NFÎºB or not, in the core module, and several receptors and their associated complexes in receptor modules [16]. Lysosome inhibitor (CHL) inhibits the degradation of CD14 and several toll-like receptors (TLRs) trafficking to the plasma membrane and endosomes [48]. The selected compounds are the inhibitors/enhancers of kinase/enzymes in the NFÎºB signaling pathway, so which parameters to change is constrained by their biochemical functions in the signaling pathway.

In order to quantify the stimulus-specific temporal coding capacity of NFÎºB under pharmacological perturbation, we designed a computational workflow. The workflow consists of the following steps: (1) generation of 3000 NFÎºB simulated trajectories in response to 15 stimulus conditions and under 200 pharmacological alterations (10 drugs at 20 doses resulting in 200 drug doses, DD) to our ODE model; (2) dimensionality reduction of the simulated trajectories using either matrix-based decomposition methods or decomposition into informative dynamic signaling features that were identified using information theory [4]; (3) in the reduced dimension space, epsilon network clustering of simulated trajectories; (4) quantification of the confusion and specificity effects within each regime through the calculation of corresponding scores (Fig 1C). The goal of this workflow is to characterize the extent to which drug treatments (ranging from attenuating and enhancing effects on NFÎºB activation) may affect the stimulus-specific dynamics of the NFÎºB signaling module, either through maintaining or diminishing its temporal coding capacity.

Using the NFÎºB systems model, we first generated stimulus-responsive nuclear NFÎºB temporal trajectories in response to 5 ligands (TNF, LPS, CpG, Poly(I:C), and Pam3CSK) at 3 doses (15 total stimulus conditions). These 15 trajectories are stimulus-specific and hence encapsulate NFÎºBâ€™s temporal coding capacity. Next, we applied the 10 previously described pharmacological compounds to our model by modifying their corresponding kinetic parameters at 20 log-linearly spaced drug doses (DD) ranging from10âˆ’320x (DD1) to10âˆ’3x (DD20). This resulted in 3000 simulated NFÎºB trajectories, representing nuclear NFÎºB concentration over an 8-hour stimulation time course (Fig 2).

Stimulus-specific NFÎºB trajectories (0 â€“ 8 hours) following computational compound perturbations. The stimulating ligands are indicated at the top labels. The doses of these stimuli (Low, Medium, and High) are denoted by small labels on the left. A total of 21 trajectories are presented in each graph, from the untreated condition (depicted in black) to a compound dose (CD) of 20 (depicted in bright red). The colorbar on the right corresponds to specific compound dose indices.

Visual inspection of the simulated trajectories suggests that across all 15 stimulus conditions, most compounds cause a reduction in NFÎºB activation with increasing compound doses. Exceptions include the transcription and translation inhibitors PDTC and CHX and the lysosome inhibitor CHL. By inhibiting the production of the NFÎºB inhibitor, IÎºBÎ±, PDTC and CHX treatment enhances nuclear NFÎºB activity. Similarly, with increasing doses of CHL, lysosome-dependent receptor degradation decreases, resulting in maintained (TNF-stimulated) and enhanced (LPS, CpG, Poly(I:C), and Pam3CSK-stimulated) activation of the NFÎºB signaling network. By examining dynamic features including â€œSpeedâ€, â€œPeak Amplitudeâ€, â€œDurationâ€, â€œArea Under the Curve (AUC)â€, â€œEarly vs Lateâ€, and â€œOscillatory Powerâ€ [4] (See methods for details), we observed that these simulated pharmacological perturbations significantly alter the NFÎºB signaling dynamics (S2 Fig).

However, it remains unclear how the stimulus-specific temporal coding capacity of NFÎºB dynamics is affected, especially in conditions of attenuating drug treatments. For example, while Sel and MG132 both reduce NFÎºB activation at increasing doses, they do so through altering signaling dynamic features that could thereby affect the stimulus-specificity of the stimulus-response trajectories. Across stimuli, we observe that at intermediate drug doses, Sel generally maintains the same trajectory shape as each stimuliâ€™s untreated trajectory whereas MG132 leads to modulation of oscillatory behavior. Thus, to elucidate compound-specific effects on stimulus-specific signaling dynamics, we applied the next step in our computational workflow, dimensionality reduction, in order to represent the 3000 complex temporal trajectories by key, interpretable features.

NFÎºB signaling is stimulus-response specific, and a loss of this stimulus-response specificity has been linked to autoimmune diseases, such as Sjogrenâ€™s Syndrome [4]. To quantify the stimulus-response specificity, we sought a dimensionality reduction method that reduced data complexity but encoded stimulus-specific information of the signaling dynamics. Given the immense high-dimensional and time-dependent information within our dataset, we set out to test the utility of three different dimensionality reduction methods which prioritize distinct characteristics within our data: canonical polyadic decomposition, functional principal component analysis, and signaling codons. Within each low-dimensional space, the temporal trajectories are represented by a method-specific feature set. While these techniques were applied to all 200 drug regimes, we selected two representative regimes, Sel at DD15 and MG132 at DD6 (for simplicity, referred to as Sel and MG132 for the remainder of this section), to demonstrate the functionality of each dimensionality reduction method.

We first searched for general trends in the pharmacological effects within the original trajectory space. In doing so, we observed that Sel treatment, the nuclear export inhibitor (Fig 3A), reduces NFÎºB oscillations while generally maintaining each trajectoryâ€™s initial peak (untreated vs. treated inFig 3B). We also noted this treatmentâ€™s similar effects on trajectories stimulated by medium doses of LPS and CpG (stimulation indices 5 and 8). In addition, MG132, the proteasome inhibitor (Fig 3C), causes stimulus- and dose-specific alterations to NFÎºB dynamics (treated vs. untreated inFig 3D). For instance, all TNF- and Pam3CSK-stimulated trajectories have uniform oscillations (simulation indices 1â€“3 & 13â€“15) which can be attributed to their respective receptorâ€™s (TNFR and TLR2) proteasome-mediated degradation. For these 6 stimulus conditions, treatment with MG132 results in competition between reduced receptor degradation and reduced IÎºBÎ± degradation which yields similar trajectory shapes (simulation indices 1â€“3 & 13â€“15 inFig 3D). These Sel- and MG132-treated trajectories were then compared to their feature vectors in the lower dimensional spaces (described in detail below) to determine the extent to which each technique recapitulates temporal dynamics.

(A)Schematic of how example drug treatment Sel DD15 affects the NFÎºB signaling network.(B)Trajectories of NFÎºB activity over time for drug treatment Sel DD15 across 5 ligands and 3 doses. Solid colored lines represent the trajectories under drug treatment, while dashed lines depict untreated trajectories. Rows indicate different ligands (labeled on the right) and columns specify ligand doses (labeled on the top of the panel). Stimulation indices are labeled in the top right corner.(C)Schematic of how example drug treatment MG132 DD6 affects the NFÎºB signaling network.(D)Trajectories of NFÎºB activity over time for drug treatment MG132 DD6 shown as described in panel B.(E)Temporal patterns corresponding to seven CPD components identified by decomposing the entire NFÎºB trajectory dataset shown inFig 2.(F)Heatmap representations of the weights of the indicated seven CPD components shown in panel E for the Sel DD15 data shown in panel B.(G)Heatmap representations of the weights of the indicated seven CPD components shown in panel E for the MG132 DD6 data shown in panel D.(H)Temporal patterns corresponding to five fPCA eigenfunctions (components) identified by decomposing the entire NFÎºB trajectory dataset shown inFig 2.(I)Heatmap representations of the weights of the indicated five fPCA eigenfunctions shown in panel H for the Sel DD15 data shown in panel B.(J)Heatmap representations of the weights of the indicated five fPCA eigenfunctions shown in panel H for the MG132 DD6 data shown in panel D.(K)Schematic of the 6 dynamical features known as signaling codons, that were identified as informative of the stimulus-response NFÎºB trajectories. Temporal pattern and signaling codon indices are specified in the top left corner.(L)Heatmap representations of the normalized signaling codon values for the Sel DD15 data shown in panel B.(M)Heatmap representations of the normalized signaling codon values for the MG132 DD6 data shown in panel D.

The first dimensionality reduction approach is tensor decomposition (canonical polyadic decomposition, CPD), which provides a comprehensive factorized approximation of the data [49,50]. The 3000 simulated trajectories were organized into a five-dimensional tensor (ð’œâˆˆð”½481Ã—5Ã—3Ã—10Ã—20), with dimensions representing ligand, ligand dose, drug, drug dose, and time. Employing non-negative CPD, we decomposed this tensor into 7 components, accounting for 87.5% of the variance observed in the original trajectory space (S3A Fig, Methods).

The factor weights along the time dimension (atime,r,r=1,2,â€¦,7) can be regarded as 7 temporal patterns that encompass key dynamics within the original trajectory space (Fig 3E). Each trajectory is approximated as a weighted sum of these temporal patterns (S3C Fig, Methods for detailed explanation).

For each trajectory (Xi,j,k,l), the 7 weights ({Ï‰r,i,j,k,l}r=1,2,â€¦,7) corresponding to the 7 temporal patterns represent its feature vector within the CPD-defined landscape. The component weights were calculated as the product of the component scalar,Î»r, a scaling factor to correct for the inherent scale invariance of CPD,Ïr, and the factor weights in all but the time dimension (S3B-S3D Fig, see methods and supplement for feature vector details). The landscapes (i.e., feature vectors) for the drug regimes highlighted above are visualized inFig 3Fand3G. Focusing first on the Sel-treated landscape, we observe, for instance, that medium doses of LPS and CpG stimulation are mainly weighted in temporal patterns 4 and 7 (stimulation indices 5 and 8 in blue dashed boxes ofFig 3F). However, these stimulus conditions have slightly different weights in temporal pattern 4, while in the original trajectory space medium doses of LPS and CpG stimulation are similarÂ (stimulation indices 5 and 8 inFig 3B). Next, within the MG132-treated landscape, all doses of Pam3CSK stimulation are weighted in temporal patterns 1 and 6 to varying extents (stimulation indices 13â€“15 boxed inFig 3G). This contradicts their nearly indistinguishable dynamics in the original trajectory space (stimulation indices 13â€“15 inFig 3D).

Considering the importance of temporal information, we also applied functional principal component analysis (fPCA) to our dataset. A major difference between fPCA and PCA is that the order of functional data carries continuous (i.e., temporal) information meaning that permutations of the multivariate data will lead to different results. We organized the simulated data into a 3000x481 matrix ([Xm,ti]m=1,2,â€¦,3000;i=1,â€¦,481) containing the 3000 combinations of stimuli conditions (15) and drug regimes (200) at 481 timepoints. We found that the first 5 components account for 95.6% of the variance (S4A Fig, see methods for details). The resulting eigenfunctions characterize the dynamic temporal patterns (Fig 3H), and each trajectory can be approximated by the linear combination of these temporal patterns (S4B-S4C Fig).

Like our CPD-defined feature vectors, the fPCA-defined feature vectors consist of fPCA scores ({Î¾r(m)}r=1,2,â€¦,5) in the 5 components/temporal patterns (Fig 3H). The fPCA-defined Sel-treated landscape shows similar weights in the 5 temporal patterns for medium doses of LPS and CpG stimulation (stimulation indices 5 and 8 in blue dashed boxes ofFig 3I). Regarding the MG132-treated landscape, while fPCA features better recapitulate the similarities between all Pam3CSK-stimulated responses compared to CPD, fPCA still results in subtle variations in temporal patterns 2, 3, and 5 for these stimuli (stimulation indices 13â€“15 boxed inFig 3J). Overall, this shows that encoding the timepoint order may lead to a more meaningful representation of temporal trajectories.

Our final decomposition method leveraged the concept of NFÎºB signaling codons. The approach decomposes the trajectories into 6 informative dynamic features identified by an information maximizing algorithm that identified the dynamic features that best distinguished stimulus- and dose-specific NFÎºB responses [4]. These 6 signaling codons include â€œSpeedâ€, â€œPeak Amplitudeâ€, â€œDurationâ€, â€œArea Under the Curve (AUC)â€, â€œEarly vs Lateâ€, and â€œOscillationsâ€ (Fig 3K, see methods for calculation details).

Normalized signaling codons values ({fs(Xm(t)}s=1,2,â€¦,6) make up the signaling codon-defined feature vectors used to derive the final drug regime landscapes (Fig 3Land3M). In the signaling codon-defined Sel-treated landscape, we observe consistent, near average signaling codon values for medium doses of LPS and CpG stimulation (stimulation indices 5 and 9 in red boxes inFig 3L). Interestingly, the subtle, yet significant discrepancies in the Oscillations and Early vs. Late codons for these conditions highlights the slightly more apparent three oscillatory peaks for the LPS-stimulated trajectory (stimulation indices 5 and 9 in red boxes inFig 3B), which was not captured in the matrix-based decomposition landscapes (stimulation indices 5 and 9 in red boxes inFig 3F). This underscores the importance of the signaling codon methodâ€™s capacity to discern both the number and timing of peaks. Further, the signaling codon-defined MG132-treated landscape also more adequately describes trajectory dynamics compared to the matrix-decomposition landscapes. This can be highlighted by the similar signaling codon values across Pam3CSK conditions, with an emphasis on their high oscillation power and relatively late NFÎºB activity (stimulation indices 13â€“15 boxed inFig 3M), whereas matrix methods decomposed these trajectories into weighted damped oscillation patterns.

In summary, based on the visual analysis of the feature spaces for the two drug regimes presented here, we found that matrix-based decompositions of temporal trajectories best recapitulate NFÎºB dynamics when the method emphasizes timeseries (fPCA) rather than structural information (CPD). Additionally, quantified signaling codons reflect a range of nuanced differences and general similarities between dynamic trajectories. To quantitively assess their performance, we opted to include all feature spaces when evaluating drug effects on NFÎºB stimulus-response specificity, discussed in detail below.

To quantify the effect of drugs on stimulus specificity, we applied a clustering method, epsilon network clustering, across different feature spaces (Fig 4A). In this framework, stimuli grouped into the same cluster are interpreted as exhibiting confused signaling responses, while those in separate clusters are considered distinguishable. This use of unsupervised classification to assess dynamic specificity is similar to prior approaches that employed supervised classifiers to evaluate distinguishability and confusion in signaling dynamics [4,7]. To define the clustering threshold (epsilon), we first clustered trajectories under the same drug treatment to establish an expert classification based on dynamic pattern similarity, guided by our scientific understanding of the stimulus-response specificity encoded in dynamic features of NFkB signaling [4,13,29]. We then defined the misclustering rate as the discrepancy between the clustering output and the expert classification, and used it as an objective function to optimize epsilon. The optimized epsilon values in each dimensionality reduction space serve as the clustering criterion that best reflects expert knowledge. Using this workflow, we aimed to determine the dimensionality reduction method that best captures knowledge-based signaling dynamics clusters.

(A)Illustration of the workflow prior to and including epsilon network clustering for the example drug treatment MG132 DD6. The 15 stimulated trajectories (left panel; indices as ordered inFig 3D) were represented by a dimensionally reduced feature space (middle panel; e.g., signaling codons with indices as ordered inFig 3M). In the feature space, the 15 trajectories were grouped using epsilon network clustering (right panel; 2/6 example dimensions shown). Dashed circles and C1-7 annotations represent the distinct clusters. C2 consists of the non-responder trajectories (nâ€‰=â€‰3). Trajectories with distancesâ€‰>â€‰optimized Îµ threshold are clustered separately (e.g., C4 and C6) while trajectories with distancesâ€‰<â€‰optimized Îµ threshold are clustered together (e.g., C1 whose 6 overlapping trajectories are illustrated).(B)Stimulus cluster maps constructed from epsilon network clustering results for drug treatment MG132 DD66. Each row and column within one map correspond to a specific stimulus, as denoted on the left side of the left panel. Within each map, off-diagonal black squares represent responsive clusters and red squares on the diagonal represent inhibited NFÎºB signaling (non-responder). Left, middle, and right panels display the expert classification, clusters derived from trajectory space, and clusters derived from signaling codon space, respectively.(C)Stimulus cluster maps constructed from epsilon network clustering results for drug treatment Sel DD15. For labeling see panel B. (D)Misclustering rates (# of misclustered stimuli/15 stimuli) for each feature space across the 5 randomly selected drug regimes.

We implemented epsilon network clustering on the original trajectories and in the previously described low dimensional feature spaces for five selected drug regimes (S5A Fig): CPD (using 7 components,7C CPD, and extended to 40 components, 40C CPD), 5 component fPCA (5C fPCA), and 6 signaling codons (Fig 4A). If signal specificity and coding capacity were maintained, this would yield 15 distinct clusters unique to each stimulus, where fewer, and more intermingled clusters would indicate a loss of signal specificity and loss of coding capacity. All clustering results were then visualized in stimulus confusion maps. Off-diagonal dark points indicate converging responder trajectories in response to two stimuli, that therefore constitutes a case of coding confusion. In contrast, red points on the diagonal indicate successfully inhibited trajectories (Figs 4B,4CandS5). To illustrate, for the drug treatment Sel at DD15, the expert stimulus cluster map shows three confusion clusters: medium doses of LPS and CpG; medium and high doses of Poly(I:C); medium and high doses of Pam3CSK. In addition to the confusion clusters, the response to low dose LPS is characterized as a â€œnon-responderâ€ and the other trajectories exhibit stimulus-specific dynamics (Fig 4B). Visually, the signaling codon-defined cluster maps most similarly resembled the expert classification (S5B Fig) across all 5 validation drug regimes (Figs 4BandS5C).

To quantitively determine which feature space gives the most reliable clusters, we calculated the misclustering rate under the optimal epsilon values in each feature space compared to the corresponding expert classification (see methods for calculation details). Indeed, the signaling codon feature space had an average misclustering rate of 1.6/15 whereas the remaining feature spaces, including the original trajectory space, resulted in misclustering rates of 3.0/15 or greater (Fig 4D). This shows that the low-dimensional signaling codons prioritize key, dynamical features that may be deemphasized in the high-dimensional trajectory space, ultimately resulting in a greater capacity to differentiate between stimulus-specific NFÎºB responses. Thus, we focused the remainder of our analysis to the signaling codon feature space.

Then, the size of the largest cluster is defined as thestimulus-response confusion score(SRC), as all trajectories within one cluster are considered to be similar and potentially indistinguishable for NFÎºB target genes.

Thestimulus-response specificity score(SRS) is the total number of clusters, which represents the number of uniquely identifiable NFÎºB signaling profiles under the same pharmacological perturbation.

We also defined theinhibition score(INH) as the cluster size of non-responders which quantifies inhibition strength of each drug treatment.

For the example drug treatment MG132 at DD6 depicted inFig 4A, epsilon network clustering in the signaling codon space finds seven clusters which represent seven predicted distinct dynamical responses under treatment (SRSâ€‰=â€‰7). Given the nearly identical TNF and Pam3CSK-stimulated responses across all three doses, these conditions form the largest cluster with an SRCâ€‰=â€‰6. Low doses of LPS, CpG, and Poly(I:C) yield completely attenuated signals, forming the non-responder cluster with an INHâ€‰=â€‰3.

For all 200 drug regimes, we applied epsilon network clustering using the optimized Îµ boundary and calculated the resulting INH, SRC, and SRS scores to gain a comprehensive overview of trends in treatment effects on the temporal coding capacity of the innate NFÎºB signaling network. First, at high doses of treatment, we found that 5 compounds (e.g., BTRCPi and IKKi) cause complete inhibition while 2 compounds (CHL, CHX) lead to no inhibition of NFÎºB activity; 3 compounds (PDTC, PP2Ai, Sel) selectively inhibit activity in a stimulus-dependent manner (Fig 5A). Additionally, the maximal stimulus confusion can be reached by compounds at intermediate (e.g., IKKi and MG132), high (e.g., CHX and PP2Ai), or relatively all (e.g., CHL) treatment doses (Fig 5B). With the networkâ€™s high innate temporal coding capacity (SRSâ€‰=â€‰13 for untreated condition), Sel is the only compound that enhanced temporal coding capacity (Sel at DD5â€“14 SRSâ€‰=â€‰15) (Fig 5C). Notably, regimes can modulate coding capacity by either partially inhibiting signaling while confusing all other stimuli (e.g., IKKi DD13 INHâ€‰=â€‰6, SRCâ€‰=â€‰9Fig 5Aand5B) or by partially inhibiting signaling while still maintaining stimulus-specific responses (e.g., TAK1i DD12 INHâ€‰=â€‰10, SRSâ€‰=â€‰5,Fig 5Aand5C). Taken together, this suggest that confusion and inhibition can be selective. These distinct patterns of altering temporal coding capacity are summarized in more detail below.

(A)Heatmap of inhibition scores for all 10 compounds across 20 compound doses treatments as indicated.(B)Heatmap of stimulus-response confusion (SRC) scores for all 10 compounds across 20 compound doses treatments as indicated.(C)Heatmap of stimulus-response specificity (SRS) scores for all 10 compounds across 20 compound doses treatments as indicated.(D)Stimulus cluster map for the 15 stimulus conditions under no drug treatment (untreated). Each row and column within the map correspond to a specific stimulus, as denoted on the left and bottom side of the map. Off-diagonal black squares represent responsive clusters and red squares on the diagonal represent inhibited NFÎºB signaling (non-responders).(E)Bar plot of the percentage of drug regimes within a specific range of inhibition scores (specified on x-axis) corresponding to the three categories of drug regime functions.(F)Stimulus confusion maps for all 10 compounds (far left labels) across 20 compound doses (bottom labels) treatments.

Using the previously described stimulus confusion maps, we next sought to investigate changes in temporal coding capacity at the level of specific stimulus conditions. For the 15 conditions under no drug treatment (i.e., untreated), 13 out of 15 are specific (SRSâ€‰=â€‰13), low dose LPS does not elicit a detectable NFÎºB response (INHâ€‰=â€‰1) and there are significant similarities between high doses of CpG and Pam3CSK-stimulated responses (SRCâ€‰=â€‰2) (Fig 5D).

Separately, the compound-treated stimulus confusion maps enabled us to find regimes that alter the temporal coding capacity of NFÎºB signaling pathway in three distinct ways: (i) complete inhibition of NFÎºB activity under all 15 stimulus conditions (Fig 5E, INHâ€‰=â€‰15) (ii-iii) partial stimulus-response specificity and confusion of the remaining stimulus conditions without (ii) (Fig 5E, INHâ€‰â‰¤â€‰1) or with (iii) inhibition (Fig 5E1<â€‰INHâ€‰<â€‰15). (i) High treatment doses of BTRCPi, IKKi, MG132, TAK1i, and TSA result in complete inhibition of NFÎºB activity (Fig 5A). As the compound dose increases, inhibition typically begins at low ligand doses and progresses to medium and high doses (Fig 5F). (ii) Drug regimes like CHL DD20 and CHX DD20 exhibit partial stimulus-response specificity and partial confusion without inhibition (Fig 5A-5C). CHL DD20 tends to confuse bacterial PAMPs such as LPS and CpG, while CHX DD20 primarily causes confusion between cytokines and PAMPs (Fig 5F). (iii) Compounds like MG132 at DD6 and PP2Ai at DD20 induce partial stimulus-response specificity and confusion, with the rest of the stimuli inhibited. Under these regimes, the specificity scores are 7/15, with inhibition primarily affecting low-dose ligands and confusion occurring mostly at medium and high doses (Fig 5F).

The compound-treated stimulus confusion maps also allow for the identification of significant drug regimes that influence the NFÎºB signaling temporal coding capacity. For example, MG132 at DD6 both induces confusion and inhibition for some stimulus conditions while maintaining specificity for the rest (Fig 5F). In the untreated regime, CpG and Pam3CSK are indistinguishable, whereas other stimuli, such as TNF and Pam3CSK, are distinct (Fig 5D). However, under MG132 DD6 treatment, the stimulus confusion map reveals that TNF and Pam3CSK responses are confused, while CPG and Pam3CSK responses are distinct (S6A Fig). By comparing trajectories and the corresponding signaling codons between the untreated and treated regimes, we observe that TNF and Pam3CSK blur together, whereas Pam3CSK and CpG become clearly differentiated (S6B Fig). These results confirm the efficacy of signaling-codon-derived stimulus confusion maps in quantitatively estimating the effects of drug regime on altering NFÎºB temporal coding capacity.

While exploring pharmacological perturbations aimed at altering specific aspects of NFÎºB signaling, a possible side-effect is increased confusion among stimuli and conditions, thereby reducing the signaling temporal coding capacity. Thus, given the diverse pharmacological perturbations explored throughout this study, it is important to evaluate the robustness of the stimulus-specific temporal coding capacity of NFÎºB signaling pathway. The robustness of the NFÎºB signaling pathway is defined by the maintenance or preservation of its capacity for stimulus-response specificity across responsive conditions, under various drug treatments. we considered two key categories of robustness evaluation: (1) the degree to which stimulus specificity is maintained under pharmacological perturbation while altering specific NFÎºB dynamics; (2) the extent to which the drug-treated conditions are confused with the untreated conditions.

To broadly assess how much specificity is preserved within each drug regime, we computed the proportion of those that cause confusion for each pair of stimuli out of the 200 drug regimes (Fig 6A). Stimuli pairs across cytokine and PAMPs are confused under few drug regime treatments. For instance, the TNF vs. Poly(I:C) pair is confused by less than 10% of all drug regimes. Confusion among bacterial PAMPs occurs more frequently among drug regimes. This is exemplified by similar NFÎºB responses in the condition of high dose CpG and medium or high dose Pam3CSK under 89 and 55 drug regimes which can be explained by the similarity between their NFÎºB trajectories under the untreated condition.

(A-B)Number of drug regimes where a given stimulus pair is â€œconfusedâ€ within a given drug regime for(A)single drug (nâ€‰=â€‰200) and(B)drug combination (nâ€‰=â€‰180) perturbations. Excludes regimes where both stimulated trajectories are completely inhibited by drug treatment.(C)Number of drug regimes where a given untreated-treated stimulus pair is â€œconfused.â€ Columns represent the 15 untreated trajectories, rows represent all treated trajectories. Low dose LPS (column 4) induces an inhibitory response, resulting in no â€œconfusionâ€ across all treated conditions.

We next wanted to determine whether the temporal coding capacity robustness under single drug perturbations extends to combinations of drug perturbations using two representative drug doses. For 180 drug combinations (10 drugs at DD5 and DD10, yielding 45 drug combinations x 4 drug dose combinations), we simulated NFÎºBâ€™s response to the 15 stimulus conditions and applied the same workflow developed for single perturbations; their stimulus confusion maps are shown inS7 Fig.

In calculating the total pairwise stimulus confusion across all 180 drug combination regimes, we found that select cross-stimulus comparisons tend to follow or exacerbate the same trends described for the 200 single drug regimes while others introduce new confusion patterns (Fig 6B). In comparing TNF vs. PAMPs to the single drug case, for combinations, there is no longer TNF vs. Poly(I:C) confusion (2 single vs. 0 combination drug regimes across all stimulus doses). However, the proportion of drug combination regimes that leads to TNF vs. Pam3SCK confusion increased three-fold. Intriguingly, among bacterial PAMP pairs, confusion between LPS and CpG increased from 10% of all single drug regimes to 21% of all drug combination regimes; that between high dose CpG and medium/high dose Pam3CSK is more consistent (34% of single vs. 31% of combination treatments). Although subtle, drug combinations also resulted in increased confusion between Poly(I:C) and LPS/CpG, which is nearly absent from single drug treatment effects.

To evaluate the potential for confusion between drug-treated conditions and untreated conditions, we compared the pharmacologically perturbed conditions with the untreated NFÎºB signaling profile (S8Aâ€“S8B Fig). Most of the drug regimes showÂ minor confusion between treated and untreated conditions. The average frequency of same-stimulus confusion between treated and untreated conditions is 25/200, while cross-stimulus confusion frequency is less than 10/200 (Fig 6C). Cross-stimulus confusion between treated and untreated conditions occurs primarily among the bacterial PAMPs. For example, Sel-DD13 treated medium-dose Pam3CSK stimulation is confused with untreated medium-dose LPS stimulation (yellow box inFig 6C), and IKKi-DD3 treated high-dose CpG stimulation resembles untreated medium-dose LPS stimulation (red box inFig 6C) (S8Câ€“S8D Fig).

In summary, the pharmacological perturbations considered in this study have minor off-target effects of reducing NFÎºB signaling temporal coding capacity, and the temporal coding capacity of NFÎºB signaling remains robust against a variety of pharmacological perturbations. However, in extending our workflow to multi-drug perturbations, we found that NFÎºBâ€™s ability to maintain stimulus-specific responses begins to waver.

In this work, we introduced the stimulus-response specificity score and stimulus confusion maps to evaluate the efficacy and specificity of pharmacological perturbations in targeting stimulus-specific dynamical responses of the NFÎºB signaling pathway (Figs 4and5). We applied pharmacological perturbations to a well-established NFÎºB signaling network model, generating a large, simulated dataset of NFÎºB temporal trajectories (Figs 1and2). In generating low-dimensional representations of the temporal trajectories, we then found that signaling codons best recapitulated the stimulus- and perturbation-specific signaling dynamics, compared to traditional decomposition methods such as Canonical Polyadic Decomposition (CPD) and functional Principal Component Analysis (fPCA) (Figs 3and4). The application of the newly developed stimulus confusion maps to 200 drug regimens ultimately demonstrated the robustness of the temporal coding capacity of the NFÎºB signaling network (Fig 6).

One challenge in developing methods to evaluate the extent of pharmacological perturbation effects on stimulus-response specificity is the high dimensionality of time-series or trajectory data. To address this, we first reduced the time dimensions of the trajectories to a lower-dimensional representative space using CPD, fPCA, and signaling codon approaches (Fig 3). To assess the similarity or specificity of NFÎºB dynamics under drug treatment, we applied epsilon network clustering to the reduced-dimensional spaces, optimizing epsilon for each approach to generate confusion maps for each pharmacological perturbation. By comparing these confusion maps with those derived from expert classification, we found that methods based on signaling codons provided the most accurate calculation of the stimulus confusion maps and the corresponding scores (Fig 4).

We used clustering to quantify the stimulus-response specificity. When confronted with a population of single-cell experimental data, stimulus-response specificity is quantified using mutual information (MI) [8,51] or machine learning classifiers [4,7]. Both approaches investigate the input and output relationship. Where MI quantifies the correlation between input and output, and machine learning calculates the mislabeling rate of the output, with the label information as the input. The unsupervised classification approach we used in this study does not calculate the mislabeling rate or input-output relationship, but is conceptually similar to supervised classifiers and is appropriate when considering a single representative trajectory. It accounts for the distinguishability of the outputs, which is a key factor of the supervised classifier performance. Intuitively, our methods give an upper bound estimation of the supervised classifier performance.

Why do signaling codons show superior performance over other methods of dimensionality reduction? Signaling codons are precise metrics that quantify informative dynamic features of NFÎºB signaling trajectories [4,28]. They capture trajectory features that involve multiple time points and incorporate temporal order information. In contrast, decomposition approaches like canonical polyadic decomposition (CPD) and functional principal component analysis (fPCA) decompose trajectories into structural (CPD) or temporal (fPCA) components with corresponding weights [49,52]. While these methods are effective in approximating or reconstructing the original trajectories through weighted combinations of components [49,52], they are less effective than signaling codons in quantifying the similarity and specificity of NFÎºB dynamics. CPD does not involve time-point information and is insensitive to time-point order (S3E Fig). Conversely, by emphasizing the datasetâ€™s structural information, CPD calculates a joint decomposition dependent on all dimensions, meaning each temporal pattern is dominated by specific combinations of stimulus, stimulus dose, drug, and drug dose conditions. This may result in misleading comparisons between similar or different trajectories based on the conditions being compared. fPCA involves trajectories but the components are less precise and nimble than signaling codons, which are specific temporal features that were identified as being informative about the biological experimental signaling data.

By applying the newly developed stimulus confusion map to all 200 drug regimes, we found that the majority of the drugs inhibited NFÎºB signaling without losing the stimulus-specificity of the remaining NFÎºB stimulus responses, highlighting the robustness of the temporal coding capacity of NFÎºB signaling pathway (Fig 6). The confusion observed within select drug regimes, however, was primarily attributed to dose-related confusions within the same ligand stimulation rather than cross-ligand confusion (Fig 6). The dynamical system being â€œsloppyâ€ with respect to their parameters could potentially contribute to the observed robustness of stimulus-response specificity [53]. However, both parameter sensitivity analysis (S2 Fig) and pairwise comparison between treated and untreated conditions (Fig 6C) indeed demonstrate significant dynamic changes under the simulated drug treatments.

The drug treatment changes the macrophage state by altering the NFÎºB signaling parameters; this is conceptually similar to macrophage polarization, which can be modeled by changing multiple parameters. Singh, Sen et al. (2024) [29] evaluated the stimulus-response specificity for an experimental dataset of polarized macrophages, and showed that the pairwise confusion in the experimental data remains generally similar between the five ligand (TNF, Poly(I:C), Pam3CSK, CpG, LPS) stimulation conditions for different polarization states. This aligns with our model prediction of the temporal coding capacity robustness.

As immune response genes can decode dynamic features of NFÎºB signaling [30â€“35], this robustness in ligand distinctionâ€”even under drug treatmentâ€” might be indicative of minimal to no drug side effects or off-target effects. This could allow cellular NFÎºB responses in a specific condition to be diminished without causing confusion in immune responses to other stimuli. Such robustness of the temporal coding capacity of the NFÎºB network to various pharmacological perturbations might be a result of evolutionary processes [54], as losing stimulus specificity could lead to pathological conditions [4,15].

The workflow presented here may also be generalized to other stimulus-response-specific signaling pathways, such as ERK, JNK, and p53 [1], and the cell types or the biological contexts where they are active. For these pathways, a potential challenge in applying our pipeline is the limited investigation of mechanistic modeling details. However, recent advances in machine learning approaches, such as the hybrid modeling strategy that integrates partially known mechanistic models with artificial neural networks (ANN) [55], have lowered the barrier to implementing our pipeline in other systems. Then, with either a mechanistic or hybrid model, pathway- and cell-specific signaling codons would have to be determined. Using context-specific signaling codons to calculate SRS, SRC, INH scores and stimulus confusion maps would then characterize whether the temporal coding capacity of these pathways may be affected or remain robust under drug perturbations.

There are limitations to our workflow that might also present promising directions for future research. First, since single-cell data show high heterogeneity in signaling [5,56], incorporating cellular heterogeneity might provide new insights and present new challenges in the effective design of drugs. Second, in this study, we tested only idealized pharmacological perturbations, which are modeled to alter specific parameters within the signaling network; the reality may be more complicated and how the drug effects are to be modeled must be refined to move the present study beyond the â€˜proof-of -principleâ€™ stage. Further, a broader drug library and whole-cell modeling may yield alternative insights regarding the robustness of the NFÎºB signaling pathwayâ€™s temporal coding capacity. Overall, our work presents an effective tool for evaluating to what extent pharmacological targeting may maintain stimulus-response specificity and reveals principles underlying the robustness of NFÎºB signaling dynamics.

The previously developed 52-dimensional ordinary differential equation (ODE) model [4] was simulated. This model consists of five receptor modules that regulate the NFÎºB core signaling module. The NFÎºB signaling experimental data were measured in primary macrophages derived from the bone marrow of mVenus-RelA mice to curate the original mechanistic model for the unperturbed condition.

Drug-treated conditions were modeled by altering specific parameters as indicated inFig 1BandS1 Table. These changes involve multiplying certain parameters by values ranging from 10-0.15to 10-3in 20 linearly spaced steps, representing 20 different drug doses for each compound. Specifically, the IKK inhibitor (IKKi) reduces the values of parametersk3,k25,k26, while the TAK1 inhibitor (TAK1i) decreases parameterk67; the Beta-TRCP inhibitor (BTRCPi) reduces parametersk25andk26; the phosphatase inhibitor (PP2Ai) modifiesk4; the transcription enhancer (TSA) reducesk5; the NFÎºB-induced transcription inhibitor (PDTC) inhibitsk6; the translation inhibitor (CHX) reducesk8; the nuclear export inhibitor (Sel) impacts parametersk11,k12, andk14; the proteasome inhibitor (MG132) reduces multiple parameters, includingk15,k16,k26,k26,k53,k58,k61,k64,k69,k73, andk75; the lysosome inhibitor (CHL) inhibits parametersk30,k42,k43,k44,k78,k83,k86,k87,k92, andk93.

We chose to alter specific parameters rather than directly modeling the pharmacodynamic reactions because a few targets of the selected 10 compounds arenâ€™t represented in the NFÎºB model. Thus, for simplicity, they are modeled by changing the corresponding kinetic parameters. Essentially, our approach is similar to traditional PK/PD models which tracks decaying drug concentration over time. Our approach provides snapshots of this decaying drug concentration: higher drug doses are representative of the drug concentration at earlier timepoints and as the drug dose decreases, we also capture later stages of drug treatment (or lower overall dose).

The ODE model was simulated using MATLABâ€™s ode15s solver. Simulations were conducted in two phases: an initial phase to establish a steady state under each condition (untreated and treated), followed by a second phase where different stimulation were applied. A total of 15 stimulations were applied, involving five ligands with three different doses each. Specifically, the stimulation included 0.3 ng/mL, 3.3ng/mL, and 33ng/mL TNF; 0.33ng/mL, 3.3ng/mL, 33ng/mL LPS; 33nM, 100nM, 330nM CpG; 3.3ug/mL, 33ug/mL, 100ug/mL Poly(I:C); and 10ng/mL, 33ng/mL, 100ng/mL Pam3CSK. All simulation results were visualized using MATLAB.

Here,Î»ris the component scalar, andaI,r,aJ,r,aK,r,aL,r, andaT,rare the factor vectors of therthcomponent. The operatorâŠ—denotes the outer product. The factor weights in the time dimension,aT,r,r=1,2,â€¦,R, resemble distinct temporal patterns of NFÎºB trajectories under different stimulus conditions and drug treatment. We therefore referred toaT,ras the keyRtemporal patterns withinð’œ.

Due to the inherent scale invariance of CPD (e.g., multiplyingaI,rby a constant andaT,rby its reciprocal yields the same result), the solution toEquation (1)is not unique. To enable meaningful comparisons between components, we rescaled all temporal patterns to have an area of 20 and incorporated each patternâ€™s scaling factorÏinto the component weight calculations (Equation (2)).

Prior to decomposition, we normalized each element ofð’œwithin the drug dimension to ensure that the decomposition captured the effects of NFÎºB responses across the 10 drugs â€“ each of which with a distinct mechanism of action â€“ in a balanced manner. For drug treatmentk, we normalized all timepoints asð’œ^i,j,k,l,t=ð’œi,j,k,l,tmaxiâ€²,jâ€²,lâ€²,tâ€²(ð’œiâ€²,jâ€²,k,lâ€²,tâ€²}\). We applied CPD toð’œ^using the decomposition.non_negative_parafac function from the TensorLy package in python with â€˜intâ€™â€‰=â€‰random and n_iter_maxâ€‰=â€‰900 and all other settings left as the default parameters. Additionally, we tested â€˜rankâ€™ (i.e., number of components) = 1â€“8 to determine the optimal number of components. To quantify this, we first reconstructed the decomposition output,ð’œreconstruct, using the cp_to_tensor function from the TensorLy package and then calculated the reconstruction error asVar(ð’œreconstructâˆ’A)Var(A). In doing so, we decided onr=â€‰7 since higher values started to result in redundant temporal patterns. However, to test the limits of the method to accurately recapitulate and cluster timeseries data (see below), we also implemented it using 40 components.

Finally, for ther=â€‰7 andrâ€‰=40 component decompositions, we organized each trajectoryâ€™s component weights into a feature vector, [Ï‰1,i,j,k,l,Ï‰2,i,j,k,l,â€¦,Ï‰r,i,j,k,l], respectively. These two separate sets of feature vectors represented the 7 component CPD- and 40 component CPD-defined landscapes.

Given that the simulated NFÎºB trajectories are time dependent, we employed functional principal component analysis (fPCA) as our second dimensionality reduction technique. The formalism of fPCA is similar to that of PCA with the key difference being that the data is decomposed into eigenfunctions rather than eigenvectors. Because of this, the variable (i.e., timepoint) order carries information, where random permutations result in different decompositions.

We first organized our data into a matrix,[Xm,ti]m=1,2,â€¦,3000;i=1,â€¦,481wheremis the index representing a particular stimulus condition and a drug regime combination andirepresenting a given timepoint. Then, in applying fPCA toX, each individual trajectory, denoted byXm(t), was approximated according toEquation (3)whereÎ¼(t)represents the mean function used for centeringXandÎ¾r(m)represents the mthtrajectoryâ€™s score (i.e., weight) in the rtheigenfunction (i.e., functional principal component),Ï•r(t). As with PCA,Ï•1(t)captures the dominant pattern of variation withinXwith each subsequent component representing the dominant pattern of variation orthogonal toÏ•1(t),Ï•2(t),Ï•3(t),Ï•râˆ’1(t).Therefore, each of the 3000 trajectoriesXm=1,2,â€¦,3000(t)can be approximated by the linear combination of the eigenfunctions, each of which weighted byÎ¾r(m).

We implemented fPCA on our simulated trajectories using the sckit-fda function in python. We opted to use a grid representation ofXwhich we obtained with skfda.representation.grid.FDataGrid. With the resulting discretized object, we then initialized the fPCA class skfda.preprocessing.dim_reduction.FPCA using the default parameters â€˜centeringâ€™â€‰=â€‰True, â€˜regularizationâ€™â€‰=â€‰None, â€˜component_basisâ€™â€‰=â€‰None, and â€˜_weightsâ€™ = None. To determine the optimal number of components (i.e., the minimum number that still captured a sufficient amount of variance inX), we varied the number of components parameter, â€˜n_components,â€™ from 1-10. We then calculated and plotted the cumulative variance explained across all 10 fPCA decompositions. Setting â€˜n_componentsâ€™â€‰=â€‰5, we finally used the.fit_transform method to compute the first 5 components and their scores.

Similar to our interpretation of CPD weightings in the time dimension, we regarded the functional principal components as the key temporal patterns that dominated in our dataset. Therefore, for each trajectoryXm, we organized their 5 weightings/scores in the first 5 functional principal components into a 5-dimensional feature vector. These vectors represented the fPCA-defined landscape.

Six signaling codons are dynamic features capturing the stimulus-specific information encoded in macrophage NFÎºB trajectories [4]. Specifically, â€œSpeedâ€ quantifies the activation response time, and â€œPeakâ€ is the highest response activity. â€œDurationâ€ measures the total time of NFÎºB level above a low threshold, while Area Under the Curve (â€œAUCâ€) quantifies the total integral of NFÎºB activity. Finally, Early Vs Late (â€œEvLâ€) represents the front-loading of NFÎºB activity, while Oscillatory Power (â€œOscâ€) captures the oscillations due to IÎºBÎ± negative feedback that are present in the trajectory. Below are the detailed definitions of each codon.

All the signaling codons are calculated using MATLAB. For an NFÎºB signaling trajectory,X(m)=(x1(m),x2(m),x3(m),â€¦,xN(m))represents the simulated trajectorymacross N time points with a time intervalÎ”t.x1(m),i=1,2,3,â€¦,N, is the observation at time(iâˆ’1)Â·Î”t.

Where{x(m)^(fk}is the discrete Fourier transform of the trajectory{xi(m)}, calculated using the fft function in MATLAB.{x(m)^(fk)2}is the power spectral density. In the Osc formula, the summation is performed over the frequency range between 0.33 and 1 hour-1.

For each NFÎºB trajectory, the corresponding six signaling codons were calculated and saved in a 6-dimensional vector. To obtain scores for each drug regime, these vectors were organized into a15Ã—6matrix, with each row representing the NFÎºB trajectory under one of the fifteen stimulation conditions.

We developed an epsilon network clustering framework applied separately to five different feature spaces â€“ 7 component CPD, 40 component CPD, 5 component fPCA, signaling codons, and the original trajectories â€“ to quantify the similarities/differences between NFÎºB responses under distinct stimuli conditions for a given drug regime. To do this, we calculated the Euclidean distance between all pairwise feature vectors representing the 15 stimulus conditions in a drug regime within a given reduced dimensionality space. Smaller distances are indicative of a more similar response between two stimulus conditions. These distances were used as inputs for epsilon network clustering in which stimulus responses whose distances fell within a radius of Îµ were clustered together. Stimulus conditions were iteratively clustered according to Îµ, allowing for responses with a Euclidean distanceâ€‰â‰¥â€‰Îµ to be clustered together if there was an intermediate condition with Euclidean distanceâ€‰â‰¤â€‰Îµ for the aforementioned conditions.

The misclustering rate between clusters are defined in the next paragraph. The optimized Îµs were then applied to evaluate clustering performance within the different spaces.

To define MR between clusters A and B,MR(A,B), we first aligned the clusters from Partition A to those in Partition B in a way that minimizes mismatches. This defines the optimal mapping between the two partitions. We then identified mismatched elements and counted them under the optimal mapping. Third, we calculateed MR as the proportion of elements that were assigned to different clusters after optimal alignment.

We expanding our epsilon network clustering framework to all 200 drug regimes, using the predetermined optimal Îµ within each feature space. Clustering results were saved as confusion matrices and visualized in stimulus cluster maps. Each drug regimeâ€™s confusion matrix had a size of 15â€‰Ã—â€‰15 with each column and row representing the different stimuli. Off-diagonal elements were assigned a value of 1 if the corresponding stimuli were in the same cluster and 0 otherwise. Non-responder stimuli for each drug regime were tracked using a separate vector. For each drug regime, since the confusion matrix is symmetric, only the lower triangular portion was visualized in stimulus cluster maps. Diagonal elements within the cluster maps were marked in red for inhibited trajectories and classified as â€œnon-respondersâ€ using the separate non-responder vector. For each stimulus pair, the number of drug regimes in which they were confused was tallied. All of the results were implemented and visualized in MATLAB.

Non-responder trajectories are defined by an NFÎºB peak value below 0.05. Within the signaling codon space, we corrected the signaling codons EvL and Speed for non-responders to avoid non-sensical results. When clustering, the non-responder cluster is defined as the one that overlaps the most with the predefined non-responder trajectories and used in misclustering rate calculations.

Because the signaling codon space achieved the smallest misclustering rate, we defined stimulus-specific and confusion scores solely within the signaling codon space. Given a drug regimeâ€™s set of clusters,S={S1,S2,â€¦,Sk}, we considered stimuli that were within the same cluster and therefore elicited similar NFÎºB responses as confused while those within distinct clusters were defined as specific. For all drug regimes, non-responder NFÎºB trajectories were defined by an NFÎºB peak value below 0.05. These non-responder trajectories were contained in the non-responder cluster and used to quantify the Inhibition Score (INH):INH=|Snonâˆ’responder|. Among other responsive stimuli, the Stimulus Response Specificity (SRS) score was calculated as the total number of clusters:SRS=|S|while the Stimulus-Response Confusion (SRC) score was defined as the size of the largest cluster:SRC=maxSiâˆˆS|Si|. These calculations were implemented in MATLAB.

To compare drug-treated and untreated conditions, we constructed a confusion matrix in the signaling codon space by calculating the Euclidean distance between the untreated 15 stimulus-response vectors and their drug-treated counterparts. For responder conditions, distances less than the optimal Îµ were classified as confused and assigned a value of 1; otherwise, they were assigned 0. Non-responsive treated conditions were compared with the untreated low-dose LPS condition and marked in red. For each stimulus pair, the total number of drug regimes (out of 200) in which they were confused with untreated conditions was computed and visualized (Fig 6C). All the results were calculated and visualized in MATLAB.

Trajectories of nuclear NFÎºB concentration (y-axis of each plot) over time (x-axis of each plot) for untreated conditions across 5 ligands and 3 doses. Rows indicate different ligands (labeled on the right of the panel), and columns specify ligand doses (labeled on the top of the panel). Stimulation indices are labeled in the top right corner.

(A)Illustration of six signaling dynamic codons: Duration (Dur), Oscillations (Osc), Peak Amplitude (Amp), Total Activity (AUC), Early vs. Late Activity (EvL), and Activation Speed (Spe).(B)Signaling dynamic codons for nuclear NFÎºB trajectories following pharmacological perturbation. For each drug panel, signaling dynamic codons are stratified by column (labeled on the top) and stimuli are stratified by row (labeled on the left). Each individual plot pertains to one signaling codon (y-axis) for a particular stimulus at 3 doses (low â€“ triangle, medium â€“ square, high â€“ circle, labeled on the bottom left), ranging from untreated to drug dose 20 (log scale x-axis).

(A)R2X plot depicting the percent variance explained after the application of CP decomposition for 1â€“8 components.(B)Heatmap of weights corresponding to seven temporal patterns using the drug treatment TSA at drug dose (DD) 2 as an example in defining the landscape for specific drug regime. Inside the heatmap, 15 rows depict 15 stimuli (5 ligands at 3 different doses). Colors within each row indicate the weights of the seven temporal patterns. These weights are the product of the component weights associated with the respective drug, drug dose, ligand, and ligand dose dimensions. The specific order of the 15 stimuli is outlined on the top of the figure, with L, M, and H denoting low-dose, medium-dose, and high-dose respectively. The weights of the temporal pattern (squares labeled by C1-C7 represent the weights for component 1â€“7 temporal patterns, respectively) stimulated by high-dose TNF under the TSA DD2 drug regime are specifically highlighted.(C)An example of the high-dose TNF stimulated NFÎºB trajectory perturbed by TSA at DD2 is displayed on the left. This can be approximated by the weighted sum (weights indicated by colors in the squares) of the seven temporal patterns (displayed adjacent to the colored squares). The weights are the product of the component weights corresponding to the specific drug, drug dose, ligand, and ligand dose dimensions obtained from CP decomposition.(D)The weights employed in the reconstruction of the simulated trajectory are the products of the weights in the dimensions of ligand, ligand dose, drug, and drug dose, with the yellow bars providing an example of calculating the weights for component 6 of (C). The subpanels and Fig 3E are the outcomes of Canonical Polyadic Decomposition (CPD) to nuclear NFÎºB time trajectory tensor, resulting in seven distinct components. These components are represented by their respective weights across various dimensions: time (Fig 3E), ligand, ligand doses, drugs, and drug dose index (this figure).(E)Temporal patterns of CP decomposition components under time point order alterations. We altered the time point order of the original tensor by splitting it into two parts along the time dimension, and then taking their reversed concatenation (i.e., the altered-time-order tensor had a time point order of (241:481, 1:240). We then applied CP decomposition using 7 components for this altered tensor.

(A)R2X plot depicting the percent variance explained after applying fPCA using 1â€“10 principal components.(B)Heatmap of weights corresponding to five temporal patterns for the drug treatment Sel at drug dose (DD) 15. The weights are the score outputs from the decomposition. The 15 heatmap rows correspond to the 15 stimuli (5 ligands at 3 different doses) with their order annotated at the top of the heatmap (Lâ€‰=â€‰low-dose, Mâ€‰=â€‰medium-dose, Hâ€‰=â€‰high-dose). The squares labeled C1-C5 represent the five temporal pattern (i.e., components 1â€“5) weights for NFÎºB activity under high-dose TNF stimulation and perturbed by the Sel DD15 drug regime.(C)An example of the high-dose TNF stimulated NFÎºB trajectory perturbed by Sel at DD15 is displayed on the left. This can be approximated by the weighted sum (weights indicated by colors in the squares) of the five temporal patterns (displayed following each colored square).

(A)Trajectories of nuclear NFÎºB concentration (y-axis of each plot) over time (x-axis of each plot) for drug regimes CHL DD8, IKKi DD11, MG132 DD6, Sel DD15, TAK1i DD14 across 5 ligands and 3 doses. Solid colored lines represent the trajectories under drug treatment, while dashed lines depict untreated trajectories. Rows indicate different ligands (labeled on the right of each set of drug regime plots), and columns specify ligand doses (labeled on the top of each set of plots). Stimulation indices are labeled in the top right corner.(B)Expert classifications for 5 representative regimes: CHL DD8, IKKi DD11, MG132 DD6, Sel DD15, and TAK1i DD14 used in epsilon network clustering. Clusters for each regime are annotated according to the trajectory indices in (A).(C)Stimulus cluster maps constructed from epsilon network clustering results for 5 representative regimes. Each row and column within one map corresponds to a specific stimulus, as denoted inS6A Fig. Within each map, off-diagonal black squares represent responsive clusters and red squares on the diagonal represent inhibited NFkB signaling (non-responder). Panels from left to right display the expert classifications, clusters derived from the trajectory space, signaling codon space, 7 component CPD feature space, and 40 component CPD feature space, and fPCA feature space (Labeled on the top of the panel).

(A)Stimulus cluster maps for trajectories treated with MG132 at DD6.(B)Examples of decreased temporal coding capacity (high doses of TNF and Pam3CSK, top row) and increased temporal coding capacity (high doses of Pam3CSK and CpG, bottom row), represented in the trajectory space (left and middle columns) and signaling codon space (right column).

Stimulus cluster map for the 15 stimulus conditions under 180 drug combination regimes. The 180 regimes are comprised of 45 combinations of the 10 drugs and 4 dose combinations using DD5 and DD10 (45 x 4â€‰=â€‰180). Columns represent untreated stimuli and rows represent treated stimuli. Black clusters on and off the diagonal represent â€œconfusionâ€ between stimulus conditionsâ€™ NFÎºB responses. Red squares on the diagonal represent inhibited NFÎºB signaling (non-responders).

Stimulus cluster map for the 15 stimulus conditions under no drug treatment (untreated) vs. 15 stimulus conditions under(A)an example drug regime and (B)all 200 drug regimes. Columns represent untreated stimuli and rows represent treated stimuli. Black clusters on and off the diagonal represent â€œconfusionâ€ between treated and untreated NFÎºB responses under the same or different stimulus condition, respectively. Off-diagonal red squares represent inhibited NFÎºB signaling (non-responders).(C-D)Examples of confusion and distinction of the stimuli before and after drug treatment. Cross-stimulation confusion signaling codon Euclidean distances are annotated which are within the optimal Îµ boundaryâ€‰=â€‰0.28.