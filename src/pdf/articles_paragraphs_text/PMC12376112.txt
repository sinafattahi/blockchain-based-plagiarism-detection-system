Italian ryegrass (Lolium multiflorumLam.) is an important forage grass, providing a major source of feed for ruminants in temperate regions. Due to its highly heterozygous and repeat‐rich genome, high‐quality chromosome‐level genome assemblies are scarce for Italian ryegrass. Here, we sequenced the genome of a genotype from the Italian ryegrass cultivar ‘Rabiosa’ (hereafter referred to as Rabiosa), and we obtained Oxford Nanopore Technologies long reads (∼60‐fold coverage), Illumina short reads (∼85‐fold coverage), and high‐throughput chromosome conformation capture data (∼60‐fold coverage). With Rabiosa as one of the parents, we constructed an F1population consisting of 304 individuals, which were genotyped by reduced representation sequencing for linkage map construction and quantitative trait locus (QTL) analysis. Using whole‐genome sequencing data of Rabiosa and the genetic linkage map, we first generated a chromosome‐level unphased haploid assembly (scaffold N50 of 338.75 Mb, total Benchmarking Universal Single‐Copy Orthologs [BUSCO] score of 94.60%). Then, based on the unphased assembly and a reference‐based phasing approach, we generated a chromosome‐level haplotype‐resolved assembly containing both haplotypes (scaffold N50 of ∼250 Mb and total BUSCO score of ∼90% for each haplome). Between the two haplotypes of Rabiosa, we observed a highly collinear gene order at the chromosome level and a high sequence variation at the local level. With a graph‐based reference built from the unphased and the haplotype‐resolved assemblies of Rabiosa, we conducted a QTL analysis, and two QTL significantly associated with stem rust resistance were detected. The genome assemblies of Rabiosa will serve as invaluable genomic resources to facilitate genomic applications in forage grass research and breeding.

The first chromosome‐level haplotype‐resolved assembly for highly heterozygous Italian ryegrass was generated.

A customized haplotig purging pipeline and a reference‐based phasing pipeline were established.

Highly consistent gene order but low local sequence identity was observed between the two haplotypes.

Two quantitative trait loci (QTL) significantly associated with stem rust resistance were detected using a graph‐based reference.

Italian ryegrass is an important forage crop used to feed livestock in temperate regions worldwide. However, the nature and complexity of its genome limit the application of genomics‐based breeding strategies. Using a combination of advanced sequencing technologies, including long and short DNA reads and long‐range linkage information, we provide the first genome assembly of Italian ryegrass that is separated for the two sets of chromosomes inherited from each parent (i.e., haplotype‐resolved). We validated the usefulness of our genome assemblies for genetic analyses and identified two genome regions that are associated with resistance to stem rust, an major disease for Italian ryegrass. Our genome assemblies provide a valuable resource for future research and breeding efforts aimed at improving Italian ryegrass and other forage crops.

Italian ryegrass (Lolium multiflorumLam.) is one of the most important forage grasses widely grown in temperate regions across the world, providing highly digestible and palatable feed for livestock (Boller et al.,2010). It is a diploid, outcrossing species containing seven pairs of chromosomes (2n= 2x= 14) with a very high level of heterozygosity (Copetti et al.,2021). Its genome size is estimated to be around 2.5 Gb (Copetti et al.,2021), of which 70% are repetitive sequences (Zwyrtková et al.,2020). The relatively large genome size, together with the high degree of repetitiveness and heterozygosity, makes genome assembly of this species very challenging. As a result, so far only two draft genome assemblies have been reported with one being highly fragmented (Knorst et al.,2019) and the other being haplotype‐redundant (Copetti et al.,2021). Thanks to recent advances in long‐read sequencing technologies, a chromosome‐level haploid assembly of Italian ryegrass has been generated with Pacific Biosciences’ high‐fidelity sequencing technology (PacBio HiFi) long reads (Brunharo et al.,2025). While this haploid assembly showed a high quality in terms of contiguity, completeness, and correctness, it may miss some important alleles of its heterozygous diploid genotype. Biased results might be obtained for downstream genomic applications when relying on a haploid reference. Therefore, to further advance forage grass research and breeding with the rapidly advancing long‐read sequencing technologies, haplotype‐resolved diploid assemblies containing both haplotypes are now needed.

Traditionally, when de novo assembling a heterozygous diploid genome, the assembly algorithm randomly selects only one of the two alleles to be present in the output sequence, leading to a mosaic haploid assembly with alleles among loci randomly alternating between haplotypes (Chin et al.,2016; Garg et al.,2021). With half of the genetic variation missing, a mosaic haploid assembly is never the best representation of a highly heterozygous diploid genome. Ideally, a heterozygous diploid genome should always be represented as a haplotype‐resolved assembly where alleles from both homologous chromosomes are not only present but also correctly combined or phased (Cheng et al.,2021; Garg et al.,2021; Koren et al.,2018; Llamas et al.,2021). To generate haplotype‐resolved assemblies with long‐read sequencing technologies such as Oxford Nanopore Technologies (ONT) or PacBio HiFi, so far, three approaches have been developed and adopted: bin‐then‐assemble, such as trio‐binning (Koren et al.,2018) and reference‐based phasing (Garg et al.,2021; Porubsky et al.,2021); assemble‐then‐bin, such as ALLHiC (Guk et al.,2022), HapHiC (Zeng et al.,2024), and phasing with pollen or pedigree sequencing data (Bao et al.,2022; Serra Mari et al.,2024; Sun et al.,2022; Q. Zhou et al.,2020); and graph‐based phasing, such as Hifiasm (Cheng et al.,2021) and Verkko (Rautiainen et al.,2023). These methods have generated promising haplotype‐resolved assemblies, suggesting that it is now feasible to generate haplotype‐resolved assemblies also for highly heterozygous grass species such as Italian ryegrass.

Recently, a graph‐based human pangenome reference was published (Liao et al.,2023), showing the advantage of overcoming reference bias using a pangenome reference instead of a single reference. In plant sciences, more and more pangenomic studies for grass species such as wheat (Triticum aestivumL., Walkowiak et al.,2020), barley (Hordeum vulgareL., Jayakodi et al.,2020), maize (Zea maysL., Gui et al.,2022), rice (Oryza sativaL., Shang et al.,2022), and various species of millet (Panicum miliaceumL., J. Chen et al.,2023;Setaria italica(L.) P. Beauv., He et al.,2023;Pennisetum glaucum(L.) R. Br., Yan et al.,2023) have also emerged. All these studies illustrate the transition from single‐reference‐dependent genomics to pangenomic approaches. Given its high level of genetic diversity and its importance as a source of forage, pangenomic resources for Italian ryegrass should be generated. Moreover, to pave the way for future pangenomic studies forLoliumspecies, methods such as pangenome graph construction, haplotype‐aware read mapping, and variant genotyping with the graph‐based reference could be tested with Italian ryegrass.

In this work, we first aimed at generating a haplotype‐resolved genome assembly for a highly heterozygous Italian ryegrass genotype using ONT long reads with high‐throughput chromosome conformation capture (Hi‐C) data and a genetic linkage map. Then, based on the resulting haplomes, we aimed at understanding the high level of heterozygosity in the genome and addressing how high heterozygosity might affect genome assembly and phasing. Finally, to explore the potential of current pangenomic methods, we aimed at building a graph‐based reference based on the haplotype‐resolved assembly and conducting quantitative trait locus (QTL) analysis for resistance to stem rust with the graph‐based reference.

A genotype (M.02402/16) of the Swiss Italian ryegrass cultivar ‘Rabiosa’ (Agroscope) was selected for whole‐genome sequencing (WGS). This genotype, referred to as Rabiosa, was crossed with a genotype (M.2002/18) of another Italian ryegrass cultivar ‘Sikem’ (DLF Seeds A/S), resulting in a bi‐parental population of 304 F1individuals. Both Rabiosa and Sikem are highly heterozygous genotypes.

In total, 304 F1seeds, collected from both Rabiosa and Sikem spikes, were germinated for 2 days in Petri dishes. The seedlings were transplanted to the greenhouse and were grown there for approximately 4 weeks. Two clonal replicates of a subset of 135 plants (133 F1individuals and the two parents) were planted in autumn 2018 in a first environment at Zurich (47.427° N, 8.516° E) using an alpha design. Because of severe drought, only one replicate of each plant could be phenotyped in 2019. After phenotyping in 2019, the plants were dug out and divided into three clonal replicates and planted in a second environment at Zurich (47.427° N, 8.516° E) using an alpha design. After phenotyping in 2020, these plants were again transplanted to a third environment at Zurich (47.427° N, 8.516° E) using an alpha design and again phenotyped in three clonal replicates in 2021.

The first chromosome‐level haplotype‐resolved assembly for highly heterozygous Italian ryegrass was generated.

A customized haplotig purging pipeline and a reference‐based phasing pipeline were established.

Highly consistent gene order but low local sequence identity was observed between the two haplotypes.

Two quantitative trait loci (QTL) significantly associated with stem rust resistance were detected using a graph‐based reference.

ONT sequencing for Rabiosa was conducted following the method described in Frei et al. (2021). Hi‐C library preparation and sequencing for Rabiosa were performed at the Functional Genomic Center Zurich (FGCZ), Switzerland. Illumina WGS data of Rabiosa were generated by NRGene as described previously (Copetti et al.,2021). For the bi‐parental population, genotyping‐by‐sequencing (GBS) libraries were prepared with the restriction enzymePstI as described by Begheyn et al. (2018) and sequenced with Illumina HiSeq 2500 at FGCZ.

For Rabiosa v1, ONT long reads were first assembled using Flye 2.8.3 (Kolmogorov et al.,2019) with –min‐overlap 10,000 and –iterations 2, then the contigs were polished with accurate short reads using Polca (Zimin & Salzberg,2020) for one round. After polishing, haplotigs were removed from the polished assembly using a customized haplotig purge pipeline (Section2.7). Hi‐C data were mapped to the haplotig‐purged assembly using the Arima Hi‐C mapping pipeline (https://github.com/ArimaGenomics/mapping_pipeline), and SALSA2 (Ghurye et al.,2019) was used to scaffold the haplotig‐purged assembly with the Hi‐C mapping results. The scaffolds generated by SALSA2 were further anchored to pseudo‐chromosomes using ALLMAPS (Tang et al.,2015) based on the genetic linkage map generated with the GBS data from the bi‐parental F1population (Section2.6). The resulting pseudo‐chromosomes from ALLMAPS were used to anchor the scaffolds generated by SALSA2 again using the Tritex pipeline (Monat et al.,2019) with Hi‐C data, producing the Rabiosa v1 assembly.

For Rabiosa v2, ONT long reads were first corrected with accurate short reads using FMLRC2 (Mak et al.,2023). Then, the corrected ONT long reads were assembled using Canu 2.2 (Koren et al.,2017) with batOptions = ‐eg 0.12 ‐sb 0.01 ‐dg 3 ‐db 3 ‐dr 1 ‐ca 500 ‐cp 50. One round of short‐read polishing was applied to the Canu assembly using Polca (Zimin & Salzberg,2020). After polishing, the same customized haplotig purge pipeline was applied, and then the haplotig‐purged contigs were scaffolded to pseudo‐chromosomes using the Tritex pipeline with Hi‐C data and Rabiosa v1 as the reference. For the resulting chromosome‐level assembly, a Hi‐C contact map was generated using Juicer (Durand, Shamim, et al.,2016) and 3d‐DNA (Dudchenko et al.,2017), and manual curation was conducted using Juicebox (Durand, Robinson, et al.,2016). This resulted in the Rabiosa v2 assembly.

GBS data from the bi‐parental F1population were first demultiplexed using Sabre (Najoshi,2022), and quality check was performed using FastQC (Andrews,2015). Later, adapters were trimmed off using Trimmomatic (Bolger et al.,2014).

Several genetic linkage maps were constructed in this work. The first genetic linkage map was the one used for scaffolding Rabiosa v1. Clean GBS reads obtained from the above methods were mapped to the scaffolds generated with SALSA2 using the short‐read aligner BWA‐MEM (Li,2013). Then, single nucleotide polymorphisms (SNPs) were called using SAMtools and BCFtools (Danecek et al.,2021). Ungenotyped SNPs were imputed using LinkImputeR (Money et al.,2017), and the genetic linkage map was built using Lep‐MAP3 (Rastas,2017) by sorting and ordering markers based on the recombination fraction between SNP markers. When building the genetic linkage map with Lep‐MAP3, Rabiosa was considered as parent 1 and Sikem was considered as parent 2 for all F1individuals, as these were derived from a bi‐directional pair‐wise cross. Informative SNP markers (markers that are heterozygous in either or both parents) were selected for map construction. These SNP markers were separated into seven linkage groups (LGs) using SeparateChromosomes2 from Lep‐MAP3, with lodLimit = 20,θ= 0.2.

A second batch of genetic linkage maps was generated based on SNPs called against pseudo‐chromosomes of Rabisoa v2 and the haplotype assemblies (Rabiosa h1 and h2, Section2.8), following the same read mapping and variant calling methods. Prior to linkage map construction, no imputation was made to fill missing genotypes in the variant calling file, and F1individuals were filtered if more than 30% of their SNPs were not genotyped. Lep‐MAP3 (Rastas,2017) was again used for linkage map construction. Informative markers from both parents were used for constructing consensus maps, aiming to include as many SNPs as possible into the maps for follow‐up validation. The genetic map distance of the SNP markers was calculated with the given order (the physical position) of the SNP markers from the assemblies (OrderMarkers2 with improveOrder = 0). By comparing the physical position with the genetic map position of the SNP markers, these maps were used to validate the structural correctness of the pseudo‐chromosomes in the assemblies (Figure4a, track B). If the structure of the pseudo‐chromosome is correct, then the physical position of the markers should correlate well with the corresponding genetic map position. Discrepancies between the physical position and the genetic map position, such as a steep slope in the correlation plot (a short distance on thex‐axis, the physical position, corresponds to a much longer distance on they‐axis, the genetic linkage map position, between two markers), might indicate structural mistakes in the assembly.

(a) Circos plot showing genomic features of Rabiosa v2, h1, and h2. Track A shows pseudo‐chromosomes of Rabiosa v2 (gray), h1 (red), and h2 (blue), respectively; track B shows the base pair position in the assembly versus genetic linkage map position; track C shows the number of high‐confidence genes per 10 Mb; track D shows the number of low‐confidence genes per 10 Mb; track E shows the fraction of repetitive sequences per 10 Mb; and track F shows the GC content per 10 Mb. (b) Genome synteny between Rabiosa and barley cultivar Morex. (c) Sequence variation between Rabiosa h1 and Rabiosa h2. The distribution of gaps, single nucleotide polymorphisms (SNPs), insertions and deletions (INDELs), and presence and absence variations (PAVs) are displayed. Sequence identity per 100 kb was revealed by the track at the top with the red dashed line indicating 30% identity.

For the QTL analysis with the graph‐based reference (Section2.15), SNPs were first identified from the graph‐based reference, and then these SNPs were projected to Rabiosa v2 to obtain their physical positions. These SNPs were genotyped with GBS reads from all F1individuals (Section2.14), and SNP markers that were only heterozygous in Rabiosa were considered for computing the genetic map position (OrderMarkers2 with improveOrder = 0) based on the projected physical position in Rabiosa v2 using Lep‐MAP3 (Rastas,2017). To verify the resulting genetic linkage map, a recombination fraction plot was generated using R/qtl (Broman et al.,2003). For the QTL analysis with the single reference (Rabiosa v2), the SNPs obtained when generating the second batch of genetic linkage maps were used for map construction. With Lep‐MAP3 (Rastas,2017), two genetic linkage maps were constructed with SNP markers that were only heterozygous in Rabiosa or Sikem, respectively. Similarly, the position of SNP markers in the genetic linkage maps was calculated with the given order of these SNP markers in Rabiosa v2.

A customized pipeline named PurgeGrass (available at GitHub,https://github.com/Yutang‐ETH/PhaseGrass/tree/main/PurgeGrass) was developed to purge both Flye and Canu assemblies in this work. The pipeline pairs allelic contigs based on evidence from all‐by‐all alignment, micro‐synteny, and Benchmarking Universal Single‐Copy Orthologs (BUSCO) genes. All‐by‐all alignment was conducted using Purge Haplotigs (Roach et al.,2018), and micro‐synteny between contigs was detected using a pipeline consisting of GMAP (Wu & Watanabe,2005), GffRead (G. Pertea & Pertea,2020), DIAMOND (Buchfink et al.,2015), and MCScanX (Wang et al.,2012) with transcripts generated in a previous study (Copetti et al.,2021). BUSCO genes were detected using BUSCO v4.1.4 (Manni et al.,2021) with database embryophyta_odb10. A contig is considered as a haplotig of a longer contig if it fulfills one of the following criteria: (1) having alignment coverage greater than 70% with a longer contig, (2) sharing at least five collinear genes with a longer contig, and (3) sharing at least one single‐copy complete BUSCO gene with a longer contig.

First, WGS Illumina short reads were mapped to Rabiosa v2 pseudo‐chromosomes using BWA‐MEM (Li,2013), and then SNPs were called using SAMtools and BCFtools (Danecek et al.,2021). Next, Hi‐C data were mapped to Rabiosa v2 pseudo‐chromosomes to phase the SNPs using Hapcut2 (Edge et al.,2016), following the pipeline described here,https://github.com/vibansal/HapCUT2/tree/master/HiC. This resulted in a sparse chromosome‐level phase block per pseudo‐chromosome. In parallel, ONT long reads were mapped to the pseudo‐chromosomes using Winnowmap2 (Jain et al.,2022). By combining the local phase information provided by the ONT read alignment with the long‐range phase information provided by the sparse chromosome‐level phase block derived from Hi‐C data, SNPs were phased through pseudo‐chromosomes using WhatsHap (Martin et al.,2016). This resulted in a dense chromosome‐level phase block per pseudo‐chromosome. Finally, ONT reads were binned to different haplotypes using WhatsHap based on the chromosome‐level phase blocks with high‐density SNPs, resulting in four sets of reads including haplotype 1, haplotype 2, untagged, and unaligned. Only haplotype 1 and 2 reads were used subsequently to generate haplotype assemblies.

Flye (Kolmogorov et al.,2019) was used to assemble reads of each haplotype separately. Then, one round of short‐read polishing was applied to each haplotype assembly using Polca (Zimin & Salzberg,2020). Next, each assembly was scaffolded with Hi‐C using SALSA2 (Ghurye et al.,2019), and then mis‐joins in the resulting scaffolds were corrected using Tritex (Monat et al.,2019). The corrected scaffolds were aligned to Rabiosa v2 to construct pseudo‐chromosomes using RagTag (Alonge et al.,2022). Additional manual curation to both haplotype assemblies was conducted using Juicer (Durand, Robinson, et al.,2016), 3D‐DNA (Dudchenko et al.,2017), and Juicebox (Durand, Robinson, et al.,2016), resulting in Rabiosa h1 and h2. The two haplotype assemblies were concatenated to a diploid assembly (Rabiosa dip), and a diploid Hi‐C contact map was also generated with Juicer.

The general assembly statistics were calculated with assembly‐stats (https://github.com/sanger‐pathogens/assembly‐stats). The completeness of the assemblies was assessed using BUSCO v4.1.4 (Manni et al.,2021) with database embryophyta_odb10. The k‐mer profile of each assembly was generated using the k‐mer analysis toolkit (KAT; Mapleson et al.,2017). To calculate the ONT read alignment depth, all ONT long reads were aligned to Rabiosa h1, h2, and dip separately using Winowmap2 (Jain et al.,2022), and the alignment depth was calculated using Mosdepth (Pedersen & Quinlan,2018). RNA‐seq‐read mapping was done with the methods described in Section2.10, and the mapping rate was reported from HISAT2 (Kim et al.,2015).

First, a custom repeat library was generated using RepeatModeler2 (Flynn et al.,2020) and ProtExcluder.pl (Campbell et al.,2014) based on Rabiosa v2. Then, transposable elements (TEs) in Rabiosa v2, h1, and h2 were annotated using RepeatMasker (Smit et al.,2013) with the custom repeat library.

Gene models were built using EVidenceModeler (EVM) (Haas et al.,2008) with evidence from ab initio gene prediction, protein alignment, and transcript alignment following the method described in Tritex (Monat et al.,2019). Ab initio gene prediction was performed using BRAKER2 (Brůna et al.,2021) with protein sequences from Kyuss (Frei et al.,2021). Protein sequences collected from closely related species (Methods S1) were mapped to the assembly using GenomeThreader (Gremme et al.,2005), and alignment results were merged using GenomeTools (Gremme et al.,2013). Transcripts collected from closely related species (MethodsS2) were mapped to the assembly using GMAP (Wu & Watanabe,2005), and mapped transcripts were merged using Cuffcompare (Trapnell et al.,2012) and StringTie merge (M. Pertea et al.,2015). Coding sequences were identified using TransDecoder (Haas, BJ,2018) with the merged mapped transcripts. Additionally, RNA‐seq data of Rabiosa generated previously (Copetti et al.,2021) were also used for genome annotation in this work. RNA‐seq reads were first trimmed using fastp (S. Chen et al.,2018), then transcripts were constructed using the alignment‐based approach with HISAT2 (Kim et al.,2015) and StringTie2 (M. Pertea et al.,2015) following the instructions detailed in M. Pertea et al. (2016). All evidence was integrated by EVM to generate consensus gene models.

Using BLAST (Altschul et al.,1990), gene models were searched for against The TRansposable Elements Platform (TREP), a TEs database (Schlagenhauf & Wicker,2016), the UniProt reviewed database (The UniProt Consortium et al.,2021), and the Pfam protein families database (Mistry et al.,2021). Based on the BLAST results, gene models were classified into high‐ and low‐confidence groups. High‐confidence genes were defined as those with a hit in either the UniProt or Pfam database and no more than 25% overlap with a TE gene in TREP. In contrast, low‐confidence genes were defined as those without a BLAST hit in either the UniProt or Pfam database and no more than 25% overlap with a TE gene in TREP. Notably, since the TREP database may not represent all the repetitive sequences of Italian ryegrass, there might be some TE coding genes remaining in the high‐ and low‐confidence groups. A more comprehensive TE database could be used to improve the classification of the functional protein‐coding genes, or TE could be masked prior to gene annotation.

Functional annotation was performed using AHRD (https://github.com/groupschoof/AHRD) and InterProScan 5 (Jones et al.,2014).

Pseudo‐chromosomes of Rabiosa h2 (query) were aligned against pseudo‐chromosomes of Rabiosa h1 (reference) using AnchorWave (Song et al.,2022) allowing inversions. The resulting alignments were converted to the Sequence Alignment/Map (SAM) format with the maf‐convert script provided by AnchorWave. Then, the SAM alignment file was further converted to the Pairwise mApping Format (PAF) by paftools.js from Minimap2 (Li,2018). Next, with the PAF file as input, SyRi (Goel et al.,2019) was used to call SNPs, small insertions and deletions (INDELs), large presence and absence variations (PAVs), and inversions.

In parallel, short reads were aligned to Rabiosa h1 to call SNPs and small INDELs with BWA (Li,2013) and BCFtools (Danecek et al.,2021). ONT long reads were aligned to Rabiosa h1 with Winnomap2 (Jain et al.,2022), and PAVs were called with Sniffles (Sedlazeck et al.,2018). Gaps in Rabiosa h1 and h2 were detected using a custom Python script. Common SNPs, small INDELs, and large PAVs that were detected by both whole‐genome alignment (WGA) and read alignment were identified by custom R scripts. Common SNPs and INDELs between two variant calling methods were defined as SNPs and INDELs sharing the exact start position, while common PAVs between two variant calling methods were defined as PAVs that overlap each other, or the start position of one PAV is within 10 bp downstream of the end position of the other PAV. Only common variants were used for sequence identity calculation and PAVs containing gaps were filtered. Sequence identity was calculated per 100 kb along the pseudo‐chromosome as (100 kb − total length of common variants − gaps − unaligned sequences reported by SyRi)/100 kb.

Pair‐wise WGA was first performed among Rabiosa v2, h1, and h2 using AnchorWave (Song et al.,2022). Then, the resulting alignments were converted to PAF format as described above, and one PAF file was obtained for each pair‐wise alignment. All PAF files were concatenated into one PAF file using a custom R script and then fed into pangenome graph builder (PGGB, Garrison et al.,2023) to construct the graph‐based reference.

SNPs in the graph‐based reference were detected by deconstructing the graph‐based reference using vg deconstruct (Garrison et al.,2018). Subsequently, the resulting vcf file from deconstruction was filtered using vcfbub (https://github.com/pangenome/vcfbub), resulting in a vcf file containing only SNPs. GBS data of each F1individual in the bi‐parental population were mapped to the graph‐based reference using Giraffe (Sirén et al.,2021), and the resulting alignment files were further processed with the vg toolkit (Garrison et al.,2018). Based on the alignment, any SNPs in the previous vcf file covered by at least five GBS reads of one F1individual were genotyped by the vg toolkit, resulting in one vcf file with the genotypes of this individual. All individual vcf files were finally merged to one vcf file using BCFtools merge (Danecek et al.,2021).

whereyijklrepresents the measurement for stem rust occurrence on a single plant basis,μdenotes the overall mean,githe effect of genotypei,ejthe effect of environmentj,geijthe interaction effect of genotypeiwith environmentj,blkjthe effect of thelth incomplete block nested within thekth complete block, andεijklthe residual error. The best linear unbiased estimators (BLUEs) for each genotype across all environments were calculated by using all factors within Equation (1) as random effect, exceptblkj, which was considered as fixed effect. All the phenotypic data analyses were conducted using R version 4.3.1 (R Core Team,2023). Package lm4 (Bates et al.,2015) was used for fitting mixed‐effect models. Package emmeans (Searle et al.,1980) was used for calculating the BLUEs. Resistance data were obtained for 133 F1individuals along with their two parents, and the BLUEs calculated for the 133 F1 individuals were used for QTL analysis.

The genetic linkage maps (Section2.6) and the BLUEs were integrated into a CSV file as input for QTL analysis using R/qtl (Broman et al.,2003). Composite interval mapping (CIM) was used to calculate the marker‐trait association (function cim in R/qtl with n.marcovar = 5, window = 10). The suggested logarithm of odds (LOD) threshold was defined as the 95th percentile of the distribution of the genome‐wide maximum LOD score. The distribution was obtained by conducting a permutation test using the function scanone from R/qtl with n.perm = 200. The percentage of variance explained by each QTL was calculated using the function makeqtl from R/qtl.

For Rabiosa, the following sequencing data were obtained: ONT long reads (total length of 153 Gb, corresponding to ∼60‐fold coverage of the haploid genome; read N50 of 21 kb), Hi‐C reads (540 million 150 bp pair‐end reads, corresponding to ∼60‐fold coverage of the haploid genome), and Illumina short reads (818 million 150 bp pair‐end reads, corresponding to ∼85‐fold coverage of the haploid genome) from a previous study (Copetti et al.,2021).

The F1population, together with the two parental genotypes Rabiosa and Sikem, was subjected to GBS, yielding on average 2.6 million 90‐bp single‐end reads per individual (ranging from 0.1 to 6 million) across the 304 F1 individuals.

For the chromosome‐level haploid assembly (Rabiosa v1), the raw Flye assembly was first polished with accurate short reads, resulting in contigs with a total length of 3.39 Gb (TableS1) and a contig N50 of 660.61 kb (TableS1). Next, haplotigs in the polished assembly were removed with a customized pipeline, resulting in a haplotig‐purged assembly with its total length reduced to 2.75 Gb (Table1). Based on the haplotig‐purged assembly, subsequent scaffolding with a consensus genetic linkage map containing 26,203 informative SNP markers (2083 and 2293 markers with a unique genetic map position in the map of parent 1 and 2, respectively, FigureS1) and Hi‐C data generated a chromosome‐level assembly with a scaffold N50 of 275.65 Mb and a 77.82% anchoring rate (2.14 out of 2.75 Gb were anchored to seven pseudo‐chromosomes, Table1).

Abbreviation: BUSCO, Benchmarking Universal Single‐Copy Orthologs.

The more contiguous chromosome‐level haploid assembly (Rabiosa v2) was generated by scaffolding based on Rabiosa v1 with contigs produced by Canu (Koren et al.,2017), using the same ONT data. Contigs generated by Canu were first polished, resulting in a total length of 4.18 Gb (TableS1) and a higher contig N50 of 966.70 kb (TableS1) compared to Rabiosa v1. Removing redundant haplotigs resulted in a haplotig‐purged assembly with a total length of 2.46 Gb (Table1) and a higher contig N50 of 1.33 Mb (Table1). Using Rabiosa v1 as the reference together with Hi‐C data, this haplotig‐purged assembly was scaffolded, resulting in a chromosome‐level assembly with a scaffold N50 of 338.75 Mb and a 91.16% anchoring rate (2.24 out of 2.46 Gb was anchored to seven pseudo‐chromosomes, Table1). Rabiosa v2 was used for all further analyses.

With the unphased haploid assembly Rabiosa v2, a reference‐based phasing approach was applied to separate the reads belonging to the two Rabiosa haplotypes. Seven chromosome‐level phase blocks together with some small phase blocks that could not be integrated into the chromosome‐level phase blocks were constructed with high‐density SNPs (Figure1a; TableS2). Ideally, one chromosome‐level phase block should be obtained for each pseudo‐chromosome, and the small phase blocks might lead to haplotype switches in downstream haplotype partitioning (assigning long reads to corresponding haplotypes). Based on the haplotypes of all the phase blocks, ONT reads were assigned to one of the four groups: haplotype 1, haplotype 2, untagged, and unaligned (Figure1b, TableS3). Roughly 50 Gb ONT long reads (∼20‐fold coverage) were assigned to either haplotype, and based on these haplotype‐specific read sets, two phased haploid assemblies were generated. Each haplotype assembly showed a total size of ∼1.80 Gb and a contig N50 of ∼270.00 kb (Table1). By further scaffolding, around 1.60 Gb of each assembly was anchored to seven pseudo‐chromosomes, resulting in two chromosome‐level assemblies with a scaffold N50 of around 250.00 Mb (Table1). The two chromosome‐level phased assemblies were named Rabiosa h1 and Rabiosa h2, respectively.

(a) Phase blocks generated by reference‐based phasing. They‐axis indicates the seven pseudo‐chromosomes (Chr 1–7), and thex‐axis indicates the base pair position (in Mb) in the pseudo‐chromosome. In each pseudo‐chromosome, the red line represents the largest phase block, and black vertical lines indicate small phase blocks that could not be integrated into the largest phase block. The blue vertical line indicates the length of the pseudo‐chromosome, showing whether the largest phase block spans the whole pseudo‐chromosome and reaches chromosome‐level coverage. (b) Read binning results from reference‐based phasing. Reads assigned to haplotypes were classified as tagged, reads mapped to pseudo‐chromosomes of Rabiosa v2 but not assigned to either haplotype were classified as untagged, and reads not mapped to any pseudo‐chromosomes were classified as unaligned. The sum of tagged, untagged, and unaligned reads is equal to the total length of the Oxford Nanopore Technologies (ONT) reads used for reference‐based phasing.

Quality assessments were conducted for the unphased haploid assembly (Rabiosa v2) and the two phased assemblies (Rabiosa h1 and h2). All three assemblies showed a high completeness as indicated by their total BUSCO scores (Table1) and the k‐mer comparison results (Figure2a–c). All three assemblies reached a chromosome‐level contiguity as indicated by their scaffold N50 (Table1). Notably, Rabiosa v2 showed a higher completeness and contiguity compared to the two‐phased assemblies, reflected by its larger assembly size and higher scaffold N50 (Table1).

(a–d) K‐mer comparison between assembly and whole‐genome sequencing (WGS) short reads for Rabiosa v2, Rabiosa h1, Rabiosa h2, and Rabiosa dip, respectively. The plots show whether the presence and copy number of the k‐mers in the assembly match the distribution of the k‐mers in WGS short reads. Thex‐axis represents k‐mer frequency in the WGS short reads, and they‐axis shows the corresponding count of the distinct k‐mers from the reads. For a heterozygous diploid genome, two peaks are expected for the distribution of the k‐mers from reads. The first peak (heterozygous peak) at the lower frequency represents k‐mers from the two alleles at heterozygous loci, and the second peak (homozygous peak) at the doubled frequency of the first peak represents k‐mers from homozygous loci. The colors in the plot show the copy number of k‐mers from the reads in the assembly, with black showing no presence, red showing one copy, and purple showing two copies. For a haploid assembly with only one allele present for each locus, the first peak should be half black and half red, and the second should be full red. For a diploid assembly with both alleles present for each locus, the first peak should be full red, and the second peak should be full purple. (a–c) suggest that Rabiosa v2, h1, and h2 are haploid assemblies with some homozygous sequences missing (small black area under the homozygous peak). (d) suggests that Rabiosa dip is a diploid assembly with some alleles from heterozygous regions missing (small black area under the heterozygous peak) and some homozygous regions collapsed as one copy (red area under the homozygous peak). (e), Oxford Nanopore Technologies (ONT) read alignment coverage for Rabiosa h1 (blue), haplotype 1 in Rabiosa dip (red), Rabiosa h2 (dark blue), and haplotype 2 in Rabiosa dip (dark red). The read alignment coverage for a haplotype in the diploid assembly is expected to be half of the alignment coverage of a haploid assembly. (f) RNA‐seq read mapping rate (y‐axis) in Rabiosa v2, h1, h2, and dip. RNA‐seq data were obtained from multiple tissues with three replicates (x‐axis).

Rabiosa h1 and h2 were concatenated to form a diploid assembly (Rabiosa dip). Rabiosa dip showed a typical diploid assembly k‐mer profile (Figure2d), suggesting that it was a good representation of the diploid genome. For each haplotype in the diploid assembly, a halved ONT read alignment coverage was observed compared to the haploid assemblies (Figure2e), suggesting that the haplotypes of Rabiosa were indeed separated. Compared to the three haploid assemblies, Rabiosa dip showed a higher total BUSCO score and, as expected, a much higher duplicated BUSCO score (TableS4) as well as a higher RNA‐seq read mapping rate (Figure2f). This suggested that the haplotype‐resolved diploid assembly was a more complete representation of the diploid genome when compared to the haploid assemblies.

The order and orientation of the contigs in the pseudo‐chromosomes of Rabiosa v2, h1, and h2 were found to be correct based on the Hi‐C contact maps (Figure3a,b). Complementary to the Hi‐C contact maps, large‐scale structural correctness of the pseudo‐chromosomes was also supported by the high consistency between marker order in the genetic map and their physical position in the assembly (Figure4a, track B).

(a) High‐throughput chromosome conformation capture (Hi‐C) contact map of Rabiosa v2. (b) Hi‐C contact map of pseudo‐chromosomes of both haplotypes in Rabiosa dip. Each red pixel in the plot indicates one interaction between two loci within or between chromosomes, and each blue box represents one pseudo‐chromosome. If the sequence in the pseudo‐chromosome is correctly ordered and oriented, then more interactions should be observed between closely linked loci within chromosomes, resulting in a “smooth” red diagonal line.

With the evidence‐based genome annotation pipeline, a total of 72,069, 56,142, and 55,928 high‐confidence genes were identified for Rabiosa v2, h1, and h2, respectively (Figure4a, track C). In addition, 113,004, 91,753, and 90,448 low‐confidence genes were identified for Rabiosa v2, h1, and h2, respectively (Figure4a, track D). With all the gene models (including high‐ and low‐confidence genes), a high completeness of the gene space was observed in Rabiosa v2, h1, and h2, as indicated by the total complete BUSCO scores of 91.8%, 85.7%, and 85.5%, respectively (TableS4). The number of complete BUSCO genes found in high‐confidence and low‐confidence genes was 83.3% and 9.2% in Rabiosa v2, respectively (TableS4), indicating the presence of true genes in the low‐confidence gene set. Around 70% of each assembly was found to be composed of repetitive sequences (Figure4a, track E; TableS5), and an average GC (guanine‐cytosin) content of 44% was observed for each assembly (Figure4a, track F).

Based on the high‐confidence gene models, a highly consistent gene‐based synteny was observed between Rabiosa and closely related species, including perennial ryegrass (Lolium perenneL.) and barley (Figure4b; FigureS2). The known translocation resulting in chromosome 4 ofLoliumspp. having synteny with chromosome 4 and a segment of chromosome 5 of barley (Pfeifer et al.,2013) was observed (Figure4b), validating the correctness of the pseudo‐chromosome structure in the Rabiosa assemblies. Notably, the inverted orientation of chromosomes 6 and 7 between Rabiosa and Kyuss (FigureS2) does not indicate true chromosome rearrangements between Italian and perennial ryegrass but is indicative for the wrong orientation of pseudo‐chromosomes in the first version of Kyuss (Frei et al.,2021), as revealed by Y. Chen et al. (2024). A highly consistent chromosome‐level gene order was observed between the Rabiosa haplotypes h1 and h2 (FigureS3), with a mean alignment identity of 98.22% across 13,308 gene pairs.

With a k‐mer‐based analysis, we first estimated the level of heterozygosity of Rabiosa, and a high level of heterozygosity of 3.43% was observed (FigureS4). This suggests a high sequence variation between the two haplotypes of Rabiosa with three to four SNPs per 100 bp. In parallel to the k‐mer‐based analysis, we also tried to estimate the sequence variation between the two haplotypes of Rabiosa based on not only SNPs, but also other types of variants called from WGA and read mapping. A total of 2,205,246 SNPs, 181,734 small INDELs (length shorter than 50 bp), and 52,578 large PAVs (length equal to or greater than 50 bp) were detected between Rabiosa h1 and h2 (Figure4c; TableS6). With these variants, sequence identity between haplotypes was calculated per 100 kb window along the pseudo‐chromosomes, and sequence identity as low as 30% was observed between haplotypes in many 100 kb windows (Figure4c; FigureS5). This low sequence identity suggests that there was a much higher level of sequence variation between the two haplotypes of Rabiosa when structural variants were also considered.

QTL analysis for stem rust resistance was conducted with the genetic linkage map constructed based on the graph‐based reference and compared to QTL results from a genetic linkage map constructed based on a single reference (Rabiosa v2).

The graph‐based reference was constructed based on the three Rabiosa assemblies (Rabiosa v2, h1, and h2). Rabiosa v2 was included in the graph‐based reference so that variants detected from the graph could be projected to Rabiosa v2 to find their corresponding physical positions in Rabiosa v2. The physical position from the same coordinate system (the same assembly) allowed us to compare the QTL analysis results between the single‐reference and the graph‐based reference. The graph‐based reference contained 21 paths, corresponding to the 21 pseudo‐chromosomes of the three assemblies. The total size of the graph‐based reference was 3.66 Gb, and there were 243,499,034 nodes and 334,693,667 edges in the graph (Figure5a).

(a) The 1D visualization of the graph‐based reference of Rabiosa showing multiple alignments for Rabiosa v2, h1, and h2. Each horizontal colored rectangle corresponds to a pseudo‐chromosome in one assembly (one path in the graph) containing nodes in the graph. The name of the pseudo‐chromosome was shown by they‐axis label (rabiosa_0, rabiosa_1, and rabiosa_2 correspond to Rabiosa v2, h1, and h2, respectively). The black lines at the bottom are the edges in the graph indicating how nodes were connected. (b) Pair‐wise recombination fraction between markers in the Rabiosa linkage map generated with single nucleotide polymorphisms (SNPs) from the graph‐based reference. A low recombination fraction (indicated by the yellow color) was observed within linkage groups, and a high recombination fraction (no linkage, indicated by the dark blue color) was observed between linkage groups and distant parts of the same linkage group. (c) Results of quantitative trait locus (QTL) analysis for stem rust resistance with a graph‐based reference and a single reference (Rabiosa v2). The brown vertical lines in the gray horizontal bars (chromosomes) represent SNPs used for QTL analysis, and black lines connect the same SNP between the graph‐based reference and the single reference. The numbers linked to the significant QTL peaks show the base pair position (in Rabiosa v2) of the most significant SNP in the QTL.

Since the graph‐based reference is essentially a form of non‐redundant multiple sequence alignment, variants can be directly detected from the graph‐based reference. With the graph‐based reference of Rabiosa, 54,614 SNPs with alleles differentiating haplotypes were obtained and projected to Rabiosa v2 to have the corresponding physical positions in Rabiosa v2. These SNPs were further genotyped with GBS reads from all F1individuals and both parents. Phenotypic data of stem rust resistance were available for 133 F1individuals and the two parents (Rabiosa and Sikem), and a clear segregation of stem rust resistance was observed as a bimodal distribution (FigureS6). After genotyping, 304 F1individuals with 1,237 SNPs that were only heterozygous in Rabiosa were selected to build a genetic linkage map (Figure5b). Combining the genetic linkage map and the phenotypic data of stem rust resistance resulted in 132 F1individuals for subsequent QTL analysis. Two significant QTL associated with stem rust resistance were detected, with one located on LG 2 and the other located on LG 7, corresponding to pseudo‐chromosomes 2 and 7 in Rabiosa v2, respectively (Figure5c; Table2).

Quantitative trait locus (QTL) analysis results for stem rust resistance.

For QTL analysis with the single reference, a genetic linkage map was constructed based on Rabiosa v2. GBS reads from all F1individuals and both parents were aligned to Rabiosa v2 to call SNPs. In total, 264 F1individuals with 5,034 SNPs that were only heterozygous in Rabiosa were used to construct the genetic linkage map. Combining this genetic linkage map with the phenotypic data of stem rust resistance resulted in 120 individuals for QTL analysis. The same two QTL that were associated with stem rust resistance were detected (Figure5c; Table2), validating the results of the QTL analysis with the graph‐based reference. In addition, a QTL analysis was also conducted using a linkage map consisting of 6,778 SNPs that were only heterozygous in Sikem. In this analysis, both QTL, although detectable, did not exceed the significance threshold (FigureS7). Combining this result with the phenotypic distribution of resistance to stem rust (FigureS6), we hypothesize that complementing resistance sources, either another dominantly inherited resistance allele of the QTL on chromosome 7 or the independently segregating resistance source chromosome 2 from Sikem, are segregating in this population.

Rabiosa v2, the chromosome‐level unphased haploid genome assembly of the highly heterozygous Italian ryegrass genotype Rabiosa, showed a much better quality compared to the reported draft assemblies for this genotype (Copetti et al.,2021) or other genotypes of this species (Knorst et al.,2019). It showed a comparable quality to the recently reported reference‐level assembly (Brunharo et al.,2025) with regard to the scaffold contiguity and assembly completeness (Rabiosa v2 vs. Brunharo's assembly, Scaffold N50, 338.75 Mb vs. 363.00 Mb, total BUSCO score, 94.60% vs. 92.80%). Notably, for Rabiosa v2, 60‐fold error‐prone ONT data were used to generate the assembly, while for the assembly of Brunharo et al. (2025), nearly 100‐fold accurate PacBio HiFi data were used. More importantly, we generated two haplotype assemblies (Rabiosa h1 and h2, Figures1,2, and3b) with the error‐prone ONT data, which is more challenging to work with compared to the highly accurate PacBio HiFi data (Li & Durbin,2024). Although the contigs of each haplotype assembly we generated were rather fragmented (contig N50 270 kb, Table1), we still managed to anchor more than 93% of the total length of the contigs onto pseudo‐chromosomes (Table1). Besides, when concatenating the two haplotype assemblies into a diploid assembly (Rabiosa dip) and comparing it with the haploid assemblies, we found that the diploid assembly was a more complete representation of the gene space of the diploid genome (higher total BUSCO score and RNA‐seq read mapping rate, TableS4; Figure2f). This suggests that a haplotype‐resolved assembly should be considered when generating genome assemblies for highly heterozygous species such as Italian ryegrass.

A high level of heterozygosity was estimated with k‐mers for Rabiosa (3.43%, FigureS4), which is consistent with the high SNP frequency (1 per 20 bp) observed in ryegrass (Hayes et al.,2013). Compared to other published highly heterozygous plant genomes, such as tea (Camellia sinensis, heterozygosity 2.31%, Zhang et al.,2021), lychee (Litchi chinensis, heterozygosity 2.27%, Hu et al.,2022), and diploid potato (Solanum tuberosum, heterozygosity 2.10%, Q. Zhou et al.,2020), Rabiosa showed the highest level of heterozygosity, suggesting that there is a high level of sequence variation between the two haplotypes of Rabiosa. Indeed, a very high level of sequence variation (30% sequence similarity in some 100 kb regions) was observed between the two haplotypes of Rabiosa when estimating the sequence variation with different types of variants, including SNPs, INDELs, and PAVs (Figure4c). As the mean alignment identity of the gene coding sequence between haplotypes is around 98%, as revealed by the gene‐based synteny analysis, the high sequence variation between the haplotypes is mainly from intergenic regions. This is consistent with the high intergenic sequence variation found previously in Rabiosa based on a single locus analysis (Copetti et al.,2021). Such a high level of sequence variation might explain some of the challenges or technical limitations we encountered when assembling Rabiosa.

We found that the high level of sequence variation between the two haplotypes of Rabiosa may cause sequence‐alignment‐based haplotig‐purge tools, such as Purge Haplotigs (Roach et al.,2018) and purge_dups (Guan et al.,2020), to fail to align allelic contigs, leaving more redundant allelic sequences (false duplication) in the assembly after purging (indicated by the duplicated BUSCO score, TableS4). The same situation was observed in otherLoliumgenome assemblies. For example, a haploidL. rigidumassembly with 70% duplicated BUSCO score (Paril et al.,2022) was generated using Purge Haplotigs (Roach et al.,2018), and the new reference‐level Italian ryegrass assembly with 20% duplicated BUSCO score (Brunharo et al.,2025) was generated using purge_dups (Guan et al.,2020). Notably, for the Brunharo's assembly, even though 100‐fold high‐quality PacBio HiFi data were used for assembly, the relatively high unexpected rate of false duplication remained. This suggests that the false duplication in the assembly is not a limitation from the input sequencing data but a technical limitation of the bioinformatic methods that could not handle the high sequence variation between haplotypes. To overcome the technical limitation and purge as many redundant haplotigs as possible for Rabiosa, in addition to sequence‐alignment‐based methods, we also used micro‐synteny and BUSCO genes to pair allelic contigs, which led to better purging results compared to using the sequence‐alignment‐based tools alone (lower duplicated BUSCO scores, TableS4).

Genome phasing was also hampered by the high sequence variation between haplotypes. A reference‐based phasing approach was chosen in this work to separate the haplotypes of Rabiosa as no parental datasets or highly accurate long reads were available. Based on the unphased haploid assembly (Rabiosa v2) as the reference, we found that around 26% (40 Gb out of the total 153 Gb) of the ONT reads were left unassigned to any haplotypes based on the long‐read alignment to the reference. This high proportion of unassigned reads could be attributed to reference bias caused by the high sequence variation between haplotypes rather than sequences from homozygous regions (Porubsky et al.,2021). As the haploid assembly (Rabiosa v2) was a mosaic representation of the diploid genome with alleles alternating between haplotypes in the pseudo‐chromosomes, when mapping long reads from both haplotypes to the reference, reads from one haplotype might be aligned to the reference, but reads from the other haplotype may not be aligned or incorrectly aligned to the reference (Jain et al.,2022). If reads were incorrectly aligned to the wrong position due to repetitive sequences (Jain et al.,2022), they might be left unassigned to any haplotypes because of no variants called in the repetitive sequences (FigureS8). The high proportion of unassigned reads led to a low coverage (∼20‐fold) of haplotype‐tagged reads in each haplotype, which compromised the contiguity and completeness of the phased haplotype assemblies (Rabiosa h1 and h2). For the reference‐based phasing approach, due to the reference bias caused by the high sequence variation between haplotypes, long reads can only be assigned to haplotypes when they are correctly aligned to the reference. More future work is needed to overcome this limitation when applying reference‐based phasing to highly heterozygous genomes. Nonetheless, to the best of our knowledge, the two haplotype assemblies (Rabiosa h1 and h2) generated in this work are the first and the only haplotype‐resolved assembly reported for Italian ryegrass so far.

A graph‐based reference can be built by adding structural variations (SVs) into a single reference, and this type of graph‐based reference has been used for many genome‐wide association studies (GWAS) in plants (J. Chen et al.,2023; Cochetel et al.,2023; Liu et al.,2020; Y. Zhou et al.,2022). A graph‐based reference can also be built by aligning chromosome‐level genome assemblies, and this approach is more accurate than adding a catalog of SVs to a single reference (Hickey et al.,2020). However, so far, not many attempts have been made to perform GWAS or QTL analysis in plants with this type of graph‐based reference built from de novo assemblies (Vaughn et al.,2022). To explore the potential of the graph‐based reference built from de novo assemblies for future pangenomic studies inLoliumspp., we generated a graph‐based reference with all three Rabiosa assemblies (Rabiosa v2, h1, and h2) and performed QTL analysis for stem rust resistance with the graph‐based reference. Based on this graph‐based reference, we identified two significant QTL for stem rust resistance, and the same two QTL were also found by the QTL analysis with a single reference (Rabiosa v2, Figure5c; Table2). This suggests that the graph‐based reference together with the current pangenomic tools, such as the PGGB (Garrison et al.,2023), haplotype‐aware read mapper (Giraffe, Sirén et al.,2021), and the toolkit to manipulate the graph‐based reference (vg toolkit, Garrison et al.,2018), can be reliably applied to highly heterozygousLoliumgenomes. However, several challenges with the pangenomic approach should be noted. First, due to the high sequence variation between haplotypes, haplomes are difficult to align, and a more suitable WGA tool is needed. For example, instead of using the standard aligner wfmash in PGGB, we used AnchorWave (Song et al.,2022), which is a synteny‐based aligner for pair‐wise WGA as it is specifically designed for highly heterozygous plant genomes. However, even with AnchorWave, we found that the two haplotypes were not well aligned, leaving the graph‐based reference 1.42 Gb larger than the total size of the pseudo‐chromosomes of Rabiosa v2 (3.66 vs. 2.24 Gb). In contrast, for a pangenome of human built from 90 haplotypes with PGGB, the size of the graph was only 5 Gb, adding just 2 Gb more sequence variations from 90 haplotypes to the haploid genome (genome size 3 Gb, Liao et al.,2023). Second, although QTL analysis worked with the graph‐based reference, we found that the QTL detected on LG 7 with the graph‐based reference showed a lower LOD score compared to the same QTL detected with the single reference. However, this does not necessarily indicate that the QTL analysis with the graph‐based reference performed worse than QTL analysis with the single reference. A possible reason for the lower LOD score with the graph‐based reference could be that fewer SNPs were genotyped in the QTL region with the graph‐based reference due to the difficulty of aligning the two divergent haplotypes (Figure5c). To improve QTL analysis using the graph‐based reference, small INDELs and large SVs present in the graph‐based reference need to be considered in addition to SNPs (Vaughn et al.,2022) as SNPs may not be called or genotyped if the two haplotypes could not be aligned.