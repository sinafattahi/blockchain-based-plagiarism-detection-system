This study addresses from the Optimal Experimental Design perspective the use of the isothermal experimentation procedure to precisely estimate the parameters defining models used in predictive microbiology. Starting from a case study set out in the literature, and taking the Baranyi model as the primary model, and the Ratkowsky square-root model as the secondary,D- andc-optimal designs are provided for isothermal experiments, taking the temperature both as a value fixed by the experimenter and as a variable to be designed. The designs calculated show that those commonly used in practice are not efficient enough to estimate the parameters of the secondary model, leading to greater uncertainty in the predictions made via these models. Finally, an analysis is carried out to determine the effect on the efficiency of the possible reduction in the final experimental time.

In the field of food safety, predictive microbiology has become an essential tool1, as it is responsible for developing the models which allow the behaviour of the microorganisms in food to be described. These models can be divided into two main categories, primary and secondary models2. The primary models describe the growth or inactivation of the microorganisms in static or constant environmental conditions, and therefore these models are expressed only as functions of time. In the secondary models, the kinetic parameters of the primary model are expressed as functions of environmental factors, such as temperature, pH or water activity. Dolan and Mishra3provides a comparison of the two types of model, with regard to the methodology for estimating the parameters, showing the main advantages and drawbacks of each one.

Experimentation is key to the construction of these models, since the quality of experiments is directly related to the precision with which model parameters are estimated. This is very important, as uncertainty in the estimations is reflected in the predictions made with these models4. Faced with this problem, many studies have considered using techniques of Optimal Experimental Design (OED). OED is a statistical methodology aimed at selecting the most informative experimental conditions according to specific optimality criteria. It allows experimenters to obtain parameter estimates that are unbiased and have minimum variance, using the fewest possible observations. In practical terms, this leads to reduced experimental costs and improved efficiency. In this context, many studies have considered using OED techniques to determine the best experimental points to obtain the maximum possible information, and thus more accurate estimations. The work of Versyck et al.5, pioneers in this area, applies OED in an Arrhenius-type secondary inactivation model. In the literature is widely used the combination of the Baranyi model as the primary model, and the Ratkowsky square-root model as the secondary, as it is the model type that has been most thoroughly analysed from the OED perspective, in both the isothermal and non-isothermal cases6–10. Nevertheless, there are also studies applying OED to other models, such as the modified Gompertz model11or the Bigelow, Mafart and Peleg models12.

When carrying out these experiments, there are two different possibilities: isothermal or non-isothermal experiments. Although the design of the experiments has been studied for both possibilities, various authors indicate the former are more appropriate for estimating the kinetic parameters of the model, due to the constant conditions throughout the experiments13,14. In addition, they are less expensive and easier to perform and analyse. In contrast, non-isothermal experiments provide a more realistic view of microbial behaviour. It is important to note that, in both types of experiments, the observations are obtained from different units of the food product under study. This ensures the use of genuine replicates, meaning that each measurement is taken independently by repeating the same experiment under identical conditions, thus avoiding correlation between observations. The usual procedure found in the literature for modelling microbial behaviour is to carry out isothermal experiments for different temperatures and estimate the primary model parameters for each temperature. From the estimates of the kinetic parameter of the model for the different temperatures, the parameters of the secondary model are estimated. Once all the parameters have been fitted, the model is validated using non-isothermal experiments15–17. However, this procedure involves a significant problem from a statistical point of view, since it assumes the estimates of the kinetic parameter as observed values in order to perform the subsequent fitting of the parameters of the secondary model, ignoring the uncertainty of these estimates. It is clear that if, for each temperature, the estimates of the kinetic parameter of two experiments are equal, they will lead to the same estimates of the secondary model parameters regardless of the uncertainty in the first. However, if this inherent variability is taken into account, it is assumed that the lower the uncertainty in the estimates of the kinetic parameter, the lower the uncertainty in the estimates of the parameters of the secondary model, and the greater the confidence in the predictions made by the model.

The aim of this study is to analyse, from the perspective of OED, the different scenarios that can be considered when planning isothermal experiments, in order to accurately estimate the parameters of the primary and secondary models. In this study, it is considered the primary Baranyi model and as a secondary model the Ratkowsky square-root model, because they are the most widely used in the literature. These models are used with the data obtained in the growth experiments ofPseudomonas spp.on button mushrooms (Agaricus bisporus), described by Tarlak et al.16. This study shows both the optimal designs for each of these scenarios and the comparison between them, allowing the loss of efficiency that occurs in each case, and thus the robustness of the designs obtained, to be determined.

whereis the natural logarithm of cell concentration (CFU/mL) at time(hours);andare the natural logarithms of initial and asymptotic concentrations, respectively;is the maximum growth rate andis the lag phase duration (h). The functionis used to incorporate the adjustment for the lag phase in microbial growth. It ensures a smooth transition from the lag phase to the exponential growth phase, allowing the model to better represent real growth curves, especially at early time points. A graphical representation of the typical microbial growth curve is provided in Fig.1, where the lag, exponential, and stationary phases are indicated to help visualize the dynamics captured by the Baranyi model. The Baranyi model can also be formulated in a differential form, which is commonly used in non-isothermal studies due to its flexibility for dynamically changing conditions.

Microbial growth curve as described by the Baranyi model (1).

whereTis the temperature (°C),bis a regression coefficient andis the theoretical minimum growth temperature. Note that the Ratkowsky model is generally valid for suboptimal temperature ranges. Although more complex models, such as the extended Ratkowsky model20, may better describe microbial behaviour near maximum growth temperatures, the Ratkowsky model remains a standard choice for many applications.

This gives the definition ofapproximate design, understood as a discrete probability measureon, with finite support atndistinct points, known as support points.

whereare the weights or proportions observed at each pointandis the set of all approximate designs in. Approximate designs are widely used in the OED literature due to their good properties for optimality calculation and verification. However, they must be adapted to the number of observations,N, to be carried out, which means rounding and fitting the weights. The calculation of efficient exact designs is considered in studies such as21. Therefore, in this paper, the designs are considered approximate.

whereyis the response variable,xthe vector of designable or controllable variables taking values in,the regression function andis the vector of unknown parameters of the model. It is assumed that the error,, follows a normal distribution with mean zero and constant variance.

whereand eachcorresponds to the partial derivative of the model with respect to thei-th parameter evaluated inwhich are the initial values of the parameters, called nominal values. The need for these nominal values leads to obtaining locally optimal designs, since it depends on the choice of these values.

Different optimality criteria arise from the varied ways in which the FIM can be optimised. Each of these criteria is defined via a criterion function,, which is convex and lower bounded, and defined in, the set of all information matrices. The designwhich minimisesis called-optimal. This paper uses the most popular criterion in OED theory, the criterion ofD-optimality. This is equivalent to minimising the volume of the confidence ellipsoid of the model parameter estimates, and so in practice it optimises the joint estimate of all the model parameters. Its criterion function is given bywhenand 0 otherwise. Usually the determinant of the FIM is maximised, given the property that the determinant of the inverse of a matrix is the inverse of its determinant.

Furthermore, the criterion ofc-optimality is also considered, which allows estimating a linear combination of the parameterswith minimum variance, wherecis a known vector of constants. Its criterion function is given by.

By means of the General Equivalence Theorem (GET)23,24, it is possible to verify the-optimality of a design for those criteria based on the FIM, using the sensitivity function. A design is optimal whenfor allandat the support points of. In the case of theD-optimality criterion, the sensitivity function is expressed as, whereis the generalised variance function, andkrepresents the number of parameters of the model. For thec-optimality criterion, it is defined as25.

The sensitivity function reflects the contribution of each design point to the variability in the estimation of the parameters, through the chosen optimality criterion. In the case ofD-optimality, this is captured by the generalised variance function, which represents the variability associated with observing at pointx. Therefore, it is desirable to include in the design those points where this variability is highest, i.e., whereis large and thusis low. According to the General Equivalence Theorem, a design is optimal whenfor allandexactly at the support points of the optimal design. For the calculation of the optimal designs, it has been implemented in Python the Wynn-Fedorov algorithm, which is based on the GET26,27.

It is common to calculate the efficiency of a design with respect to the optimal design, although it is also possible to determine relative efficiencies between different designs. In the case of relative efficiencies, the set of possible values the efficiency can take is.

whereTris the trace andis the gradient of the criterion function.

Given the uncertainty in the choice of nominal values for parameters, it is useful to perform a sensitivity analysis for the design with respect to these nominal values. This analysis studies the efficiency of the design when the chosen nominal value is not the true value of the parameter. This is done by varying the nominal value within a range considered of interest and calculating the efficiency of the design in each case. When the variations in efficiency are significant, it is said that the design is sensitive to uncertainty in that parameter, while in the opposite case it is said that the design is robust.

As a reference to explain a standard procedure followed in predictive microbiology for the estimation of the parameters of primary and secondary models, the experiment carried out by Tarlak et al.16is taken as a case study.

This experiment first considers four isothermal experiments at temperatures of 4, 12, 20 and 28 °C (shown in Table1). The results of these experiments give estimates for the kinetic parametersandof the primary model expressed by Eq. (1) for each temperature, as shown in Table2. Next, the estimate for the parameter, associated with each temperature, is taken as the observed value, to obtain the estimates for the parameters of the secondary model (and°C) defined by Eq. (2). Finally, these models are validated by expressing them in the form of differential equations using non-isothermal experiments.

Sample times of the isothermal experimental designs for each temperature in the experiment carried out by Tarlak et al.16.

Estimation of the parameters for the Baranyi model in the isothermal experiment carried out by Tarlak et al.16.

Based on this procedure, different experimentation strategies addressed through OED are provided for each of the possible scenarios.

Firstly, to estimate precisely all the model parameters (),D-optimal designs are given for each temperature proposed by Tarlak et al.16. The design space for time is considered from the beginning of the experiment (0 h) until the stationary phase of the model is reached, at which population growth no longer occurs. The parameter estimates provided by the authors for each temperature are considered as nominal values (Table2). Table3shows the optimal designs obtained for each temperature, and theD-efficiency of the design proposed in the work of Tarlak et al.16for each temperature. To calculate these efficiencies, their designs are considered approximate, with weight 1/Nat each observation time. TheD-optimal designs obtained are equally-weighted designs, with each support point corresponding to 25% of the total observations. These efficiencies indicate that there is a loss of efficiency between 14 and 20% compared to the obtainedD-optimal designs. Figure2a shows the sensitivity functions of theD-optimal designs. It is clear that the support points of the design are distributed similarly for the four cases, observing shorter distances between times the higher the temperature of the experiment. This behaviour is expected, since the higher the temperature, the faster the growth of microorganisms.

Equally-weighted isothermalD-optimal designs for estimating,,, andfor each temperature, andD-efficiencies of designs of Table1with respect toD-optimal designs.

Sensitivity functionforD-optimal designs in Table3.

Taking theparameter estimate as the observed value for estimating the secondary model parameters leads to ignoring its uncertainty in the second estimate. In this case, the best approach is to use an estimate ofwith minimum variance, and soc-optimality should be considered, which provides designs to estimate the parameterwith minimum variance for each temperature. Table4shows thesec-optimal designs for each temperature. It should be noted that in this case, equally-weighted designs are no longer obtained, but rather certain support points have a greater weight than others in the design. Thus, the central points of the design account for between 65 and 70% of the observations to be made. This is related to the physical meaning of the kinetic parameter, as it defines the slope of the growth curve in the central phase, the exponential phase. A certain similarity can also be seen between the points and the weights of the various designs, and the phenomenon already mentioned for theD-optimal designs, whereby the higher the temperature the shorter the time between support points, is seen again. These designs allow the parameters of the secondary model to be estimated based on the values ofwith minimal uncertainty. The third column of Table4gives thec-efficiency of the designs proposed by the authors (Table1) with respect to thec-optimal design; that is, the goodness measure of how well they estimate the parameterwith respect to thec-optimal design. Thesec-efficiencies, below 50% in all cases, indicate that the parameter estimation of these designs entails 50% more variability than that obtained with thec-optimal design.

c-optimal designs for estimatingandc-efficiencies of designs of Table1andD-optimal designs of Table3with respect toc-optimal designs.

It is clear that these designs do not provide accurate individual estimations of the parameter. The last column of Table4shows thec-efficiency of theD-optimal designs obtained in Section “D-optimal designs”, confirming that, even using these designs, the estimation of parameteris considerably more accurate than with those previously mentioned.

In the optimal designs calculated in the previous section, the temperatures considered are the ones fixed by the experimenters in the work of Tarlak et al.16. It is possible, however, that the temperatures chosen in the experiments also influence the estimation of the model parameters. Therefore, to accurately estimate the parameters of the primary model (function of time) and the secondary model (function of temperature), the most suitable solution is to design over both variables, time and temperature. To do this, the design is calculated for the primary model (Eq. (1)) in which the parameteris substituted for the secondary model (Eq. (2)). Calculating theD-optimal design for this extended model provides the design that allows accurate estimation of the parameters,,,band, jointly. In this way, not only the times but also the temperatures at which the experiment should be carried out are obtained, thus eliminating the constraint of having to experiment at the fixed temperatures of 4, 12, 20 and 28 °C. The design space considered for temperature is [4 °C, 28 °C].

In order to calculate theD-optimal isothermal design in temperature and time, we take as nominal values of the primary model parameters the mean of the estimates provided by Tarlak et al.16. For the parameters of the secondary model,band, the nominal values taken are the estimates provided in that work. These nominal values are provided in Table5.

Nominal values for the parameters in the Baranyi primary model and Ratkowsky secondary model, forD- andc-optimal desings controlling temperature and time.

Opposite of the sensitivity function,, of the isothermalD-optimal design in temperature (T) and time (t),. Red marks stand for the optimal design support points.

Note that this design could be applied when performing only two isothermal experiments, one at 4 °C and the other at 28 °C. Since at 0 h it would be possible to experiment at any temperature, either 4 °C, or 28 °C could be chosen. For the final experimental point, if the temperature is chosen to be 4 °C, the final experimental time would beh, while if the decision is to experiment at 28 °C, it would beh. Thus, for example, if the cost of increasing the temperature were high, the choice could be made to carry out three independent observations at 4 °C at 0 h, 87.88 h andh and two independent observations at 28 °C, at 31.17 h and 43.75 h. While if the time cost is higher, then observations could be made at 4 °C at two time points, 0 h and 87.88 h, and at 28 °C at three points 31.17 h, 43.75 h andh. Any of the above combinations maintains the optimality of the design, that is, it optimises precision in the joint estimation of all parameters.

For the purposes of making a comparison, the Tarlak design in two variables is considered to be the union of the four designs that they propose at each of the temperatures (Table1). Thus, each experimental point has an associated weight of 1/30. TheD-efficiency of this design with respect tois 0.58. In the case of the jointD-optimal design, from the union of the four designs described in Table3, itsD-efficiency with respect tois 0.65. The efficiencies indicate that the designs applied previously, with the imposition of the fixed temperatures, are rather limited when it comes to accurately estimating the parameters of both models together.

Since the nominal values of the primary model parameters,,and, have been taken as the mean of the estimates of these parameters obtained by Tarlak et al.16(Table2), it is of interest to study the sensitivity of theD-optimal designto the range of values of the estimates of these parameters. To carry out this analysis, the efficiency of the obtainedD-optimal design,, is calculated with respect to theD-optimal design for another nominal value of this parameter using Eq. (3). Figure4provides a graphical representation of the sensitivity analysis. The red line indicates the maximum achievable efficiency, which is equal to 1. For this reason, the optimal design achieves maximum efficiency for the initial nominal value (marked by the vertical blue dashed line). As shown in Fig.4, this design undergoes a greater loss of efficiency for variations in the nominal value of the parameter, and is more pronounced in the case of underestimation of this parameter, while it behaves robustly for the range of estimates of the parametersand. As a solution to the loss of efficiency with respect to the uncertainty in the nominal values, Muñoz del Río et al.28describe a methodology through which the optimal design is made robust.

D-efficiencies for the sensitivity analysis ofwith respect to the nominal values of the primary model parameters(a),(b) and(c).

As shown in Section “D-optimal design”,has a support point where the experiment time depends on the temperature at which the experiment is being carried out. As shown in the results, as the temperature increases, the final experimental time decreases. Furthermore, this relationship between final experimental time and temperature has been adjusted using a logarithmic model. It seems logical that for cost-saving reasons the experimenter would therefore seek to shorten the experiment as much as possible. Therefore, based on thedesign, an efficiency analysis was carried out to determine the final experimental times that lead to designs with high efficiency, and so can lead to greater time savings. Figure5a shows the behaviour of the relationship between temperature and final experimental time for both thedesign and for designs with 99%, 97% and 95% efficiency. It can be seen that assuming a 1% efficiency loss already significantly reduces the final experimental times with a time saving of between 48 and 58%. Table6also shows the adjustments to these relationships (represented in Fig.5b) along with the RMSE value and the relative savings in experiment time. It should be noted that the best adjustments found after considering different options, such as polynomial and exponential functions, are shown.

Final time-saving curves of the experiment ensuring minimum efficiency. (a) Real temperature-time values obtained for each minimum guaranteed efficiency. (b) Mathematical function of final experimental time with respect to temperature expressed in Table6.

Relationship between temperature and final experimental time based on efficiency.

First column: minimum guaranteed efficiency. Second column: mathematical expressions of final experimental time as a function of temperature. Third column: Root Mean Square Error (RMSE) associated with each function. Fourth and fifth column: minimum and maximum relative time saving with respect to the optimal experimental design.

Thec-efficiency of theD-optimal design,, with respect tois 0.015, indicating very poor precision in estimating the secondary model parameters with the design intended for accurate estimation of all parameters together. The option of calculating thec-optimal forbandseparately was also explored. In the latter case, the design is the same as the jointc-optimal design forband. In the case of thec-optimal design for estimating parameterb, itsc-efficiency with respect to thec-optimal design for both parameters,, is 0.41, so it does not represent a direct solution to the problem.

This study addresses the experimental procedure used in predictive microbiology for estimating model parameters from the OED perspective. The Baranyi model is considered as the primary model, and the Ratkowsky square-root model as the secondary model applied to the case study set out in16. Firstly, considering the isothermal experiments with the temperatures fixed and the objective being to estimate all the parameters of the primary model, theD-optimal design is provided for each temperature. TheD-efficiency (Table3) of the designs used in practice to estimate these parameters shows a loss of efficiency of around 20% compared to the optimal ones, which results in lower precision in the joint estimation of the parameters. This loss inD-efficiency results, in practical terms, in a larger volume of the confidence ellipsoid for the model parameter estimators. Consequently, Tarlak’s designs imply wider confidence intervals, less precise predictions than optimal designs. On the other side, if the optimal designs are used approximately 20% fewer experimental replicates are needed to achieve the same estimation accuracy, leading to a significant reduction in experimental costs. In predictive microbiology, the estimation of the parameters of the secondary model is carried out by fitting the values obtained from the estimation of the parameterin the previous step for each temperature. This fitting assumes the estimates of a parameter to be observed values, which is associated with an estimation error that is not considered. This paper proposes the use of thec-optimal design to obtain an estimate with minimum variance of the parameter. In this way the fitting is made on a value with lower associated uncertainty. The results of thec-efficiency (Table4) of these designs compared to those used in practice show a reduction of more than 50% in the number of required observations.

Now, in order to provide fair comparisons, the temperatures at which these experiments are designed are those taken from the study with which the results are compared. However, OED allows for the precise estimation of all parameters in a direct manner by designing in two variables, that is, providing not only the times but also the temperatures at which the experiment should be carried out. If the kinetic parameter () is replaced in the primary model by the secondary model, it provides a extended model in two variables, time and temperature, with all the parameters of interest. TheD-optimal design in two variables,, results in a 42% reduction in the number of observations with respect to the designs used in practice. These reductions not only improve the statistical quality of the parameter estimates but also lead to significant savings in time, cost, and laboratory resources, making the experimental process more efficient and feasible, especially in industrial or regulatory settings. Since this optimal design depends on the choice of initial values for the parameters, a sensitivity analysis of the design is carried out against uncertainty in these values. This analysis shows that the design is robust for all parameters except. To make the design more robust, the methodology developed by Muñoz del Río et al.28could be applied, in which points are added to the support of the optimal design to minimise its loss of efficiency with respect to the uncertainty in the selected parameter(s). This methodology is based on the idea of the maximin criterion with a previous step, which guarantees computational savings, in which the candidate points to enter the design are preselected.

Two-variableD-optimal design leaves the experimenter to choose two of the observation points, the initial and final points. For the initial point (0 h), the experimenter can choose the temperature at which the sample is taken. For the final point, due to the construction of the design, it can be observed that there is a relationship between the temperature at which the experiment is carried out and its final experimental time. In order to save costs in the experiments, different reductions in the final experimental time of the experiment are proposed (Fig.5), ensuring a minimum efficiency of the resulting design. These reductions show a minimum saving of 48% in time with respect to the optimal time, with minimal losses in efficiency (between 1 and 5%). In addition, these relationships between temperature and final experimental time are expressed mathematically for various efficiencies (Table6). This is of interest because the experimenter, knowing the relationship of costs of the experiment relative to time or temperature, can choose between waiting longer and experimenting at a lower temperature, or shortening the time of the experiment by increasing the temperature of the final observation.

Finally, in the case where the goal of the study is only to estimate the parameters of the secondary model, thec-optimal design of both parameters in two variables is proposed,. Thec-efficiency of the previousD-optimal design,, with respect to this one is 1.5%, that is, when the only concern is to estimate these two parameters,D-optimal design is not very efficient and a design intended solely for this estimation is necessary.

The methodology presented in this work focuses on the construction of approximate optimal designs, which provide the values of the controllable variables where observations should be taken, along with the proportion of replicates at each value. In practical terms, the efficiency of a design reflects the quality of parameter estimation when the total number of observations is fixed. Therefore, it quantifies the gain in estimation accuracy achieved by observing at certain points versus others. For example, if a design has 50% efficiency relative to the optimal design, this means that the optimal design can achieve the same level of estimation precision using only half the number of observations. This translates directly into savings in experimental effort and cost. However, in cases where experiments have already been conducted, it is still possible to apply this framework to evaluate the quality of the existing design. When the optimal design is known, comparing it with the current design allows one to quantify potential gains in efficiency and estimate how many observations could have been saved without compromising precision. Additionally, when the optimal design is not available, tools such as the Atwood’s bound can provide a lower bound on the efficiency of a given design. Moreover, methodologies such as sequential or adaptive design can be employed starting from existing designs to identify new observation points that incrementally guide the experiment towards optimality. These approaches offer a practical path for improving parameter estimation even after initial experimentation has been performed.

As future work, it would be of great interest to carry out experiments based on the proposed optimal designs and estimate the model parameters using the resulting data. This would allow an empirical evaluation of the expected improvements in parameter estimation precision, for example by comparing the width of the confidence intervals with those obtained using non-optimal designs.

The authors would like to thank the editor and the reviewers for their careful reviews and helpful comments that improved the quality of this paper. This work was supported by Ministerio de Ciencia e Innovación [Grant Number PID2020-113443RB-C21], by Junta de Comunidades de Castilla-La Mancha through Fondo Europeo de Desarrollo Regional, Spain [Grant Number SBPLY/21/180501/000126] and by Universidad de Castilla-La Mancha, Plan Propio co-funded by FEDER [Grant Number 2022-GRIN-34288].