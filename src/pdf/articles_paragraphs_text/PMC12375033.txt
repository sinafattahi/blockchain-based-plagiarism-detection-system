Tetherless magnetic devices (TMDs) that are driven using external stimuli have potential applications in minimally invasive surgery. The magnetic field produced by electromagnet- and permanent magnet-based robotic systems is a viable option as an external stimulus to enable the motion of a TMD in viscous and viscoelastic media. In order to realize the navigation of TMDs in fluidic environments, we design a permanent magnet-based robotic system with an open configuration using two synchronized rotating magnetic dipoles to generate time-varying rotating magnetic fields. These fields are used to apply torque on a TMD in low-Reynolds-number flow regimes. The configuration of the system is vertically symmetric, allowing permanent magnets to exert relatively uniform magnetic fields within the center of the workspace. We derive the configuration-to-pose kinematics and the pose-to-field mapping of the system. Such derivation is the basis for realizing the motion control of TMDs in three-dimensional space. The kinematic system holds one translational degree of freedom (DOF) and three rotational DOFs, allowing it to control the pose of actuator magnets with four DOFs. The nonlinear inverse kinematic problem is solved using an optimization algorithm. The experimental results of this level of control demonstrate that the mean absolute error and the maximum tracking error of three-dimensional motion control are 1.18 mm and 2.64 mm, respectively. This paper tackles the challenge of generating and controlling synchronized rotating magnetic fields to actuate and navigate TMDs. Commonly, this involves collaboratively manipulating two permanent magnets by attaching each to the end-effector of an industrial robot. This paper proposes a novel approach: robotically manipulating two permanent magnets through a symmetric configuration constrained by a connecting plate. This method simplifies the manipulation of rotating magnetic fields, thereby aiding the simplification of TMD motion control strategies. Future research will improve the design of this robotic system to offer more degrees of freedom, thus achieving greater flexibility in TMD motion control.

Small-scale tetherless magnetic devices (TMDs) have the potential to improve minimally invasive medicine by precision surgery due to its dexterity1, allowing them to access regions inaccessible by tethered surgical devices. With these merits, small-scale TMDs have attracted significant attention of being utilized in biomedical applications such as targeted drug delivery2,3, nanotechnology4,5, microfluidic6,7and biomedical8,9applications. One of the challenges in these applications is the precise TMD motion control along a prescribed trajectory10–12. The vast majority of TMD motion control is achieved by using electromagnet-based robotic systems13–16. Despite the merit of high controllability of generated uniform magnetic field (including orientation and strength control) by changing the coil current, and the ability to turn-off the magnetic field completely17–19, these systems have some shortcomings, such as the difficulty of scaling up to the size of in vivo application due to the restriction of the projection distance of the field gradient, and heat emission problem due to the low efficiency of electric-to-magnetic conversion caused by the electromagnetic coils20. In contrast to electromagnet-based robotic system, permanent magnet-based robotic systems can generate stronger magnetic field21, and have no heat emission problem. In particular, those with open configurations can be scaled up to the size of in vivo applications22. Consequently, permanent magnet-based robotic systems are becoming increasingly popular.

Depending on how a TMD is propelled, permanent magnet-based robotic systems can be classified based on the applied driving mode: (1) Torque-driven mode which serves the magnetic torque as the main form of actuation and propels a TMD (e.g., a helical microrobot) by rotating it. (2) Force-driven mode which serves magnetic force (i.e., the force due to magnetic gradient) as the main form of actuation and propels TMD by pulling it. (3) Torque-force-driven mode which serves either one of them (magnetic torque and force) or both of them as effective forms of actuation and to propel a TMD by rotating it or pulling it or both. Furthermore, permanent magnet-based robotic systems in each mode can be generalized into three categories based on the number of actuator magnets: (1) Using one actuator magnet. (2) Using two actuator magnets. (3) Using an array of actuator magnets.

The permanent magnet-based robotic systems in torque-driven mode rotate actuator magnets to generate a rotating magnetic field, resulting in a magnetic torque, as the main source of actuation, exerted on TMDs. With using one actuator magnet, Mahoney et al. have proposed a method to control the magnetic field at a point in space to be rotated about any desired axis with a constant frequency, thus the TMD motion is controlled by aligning the TMD’s dipole moment with the applied magnetic field23. Nelson et al. have provided a solution to generate two independent rotating magnetic fields with any desired field-rotation axes at any two points, allowing it for the independent motion control of two TMDs24. Despite the controllability of the field-rotation axis, such systems may produce unnecessary magnetic force which creates a tendency for a TMD to move toward the actuator magnet. This unnecessary magnetic force can be reduced by increasing the distance between the TMD and the actuator magnet, yet the applied magnetic torque on the TMD is inevitably weakened. To overcome this undesired behavior, Mahoney et al. have presented a strategy to substantially reduce the magnetic force while maximizing the magnetic torque, by limiting the absolute upper boundary on the magnitude of maximum magnetic force for any orientation of TMD dipole moment25. This strategy can diminish the magnetic force yet not eliminate it. With using two actuator magnets, Hosney et al. have designed a robotic system by rotating the two actuator magnets synchronously for the wireless motion control of a helical microrobot, which stabilizes the motion of the microrobot by eliminating the magnetic field gradient within the workspace of the microrobot and develops gravity compensation technology by manipulating the angular speed and motion direction of the microrobot26. With using an array of actuator magnets, Zhang et al. have implemented a method of arranging the rotational actuator magnets circumferentially to generate a rotating magnetic field in the center area of the circle and obtain a synchronous reversing magnetic field with constant strength27. Qiu et al. have developed a robotic system incorporating four rotary actuator magnets, which can generate a rotating magnetic field with the orientation of the field-rotation axis being arbitrary in a plane28. Although these systems using an array of actuator magnets can generate rotating magnetic fields without the translational movement of actuator magnets, the number of DOFs of these robotic systems to control the magnetic field is potentially restricted.

The permanent magnet-based robotic systems in force-driven mode generate a magnetic gradient field, resulting in a magnetic force, as the main source of actuation, exerted on TMDs. With using one actuator magnet, Khalil et al. have demonstrated a robotic system that attaches the actuator magnet to the end-effector of a robotic arm, achieving the kinematic control of paramagnetic microparticles in 3-D space with the manipulation of the exerted field gradient on the dipole of the microparticles29. Mahoney et al. have first demonstrated a 5-DOF manipulation of an untethered magnetic capsule by a 6-DOF robotic manipulator with the feedback of only 3-DOF capsule position30. Magnetic force are utilized to manage the total force (the sum of magnetic force, gravitational force, and buoyancy force) applied on the capsule. With using two actuator magnets, Shapiro et al. have demonstrated the capability of a robotic system consisted of an arrangement of two permanent magnets to create magnetic force, and eventually to push therapeutic nanoparticles31. Amokrane et al. have optimized a robotic system to produce a maximum push-pull force on magnetic microparticles by manipulating magnetic field gradient, enabling the navigation of microparticles in cortical microvasculature network32. With using an array of actuator magnets, Abbes et al. have reported a robotic system with a magnetic unit being attached to the end-effector of a robotic arm such that the magnetic unit consists of four actuator magnets, demonstrating the steerability to push and pull the magnetic microparticles in viscous fluids33. Son et al. have presented a robotic system that can create a strong magnetic force trap enabling a cylindrical millirobot to penetrate continuously into soft tissue. The penetration motion is assisted by the induced magnetic torque which directs the orientation of the millirobot to the center of the array of actuator magnets34. In comparison to the systems in torque-driven mode, those in force-driven mode at the same level require more energy consumption in the propulsion of TMDs in fluids, making the systems in force-driven mode more suitable in use for the scenarios of driving small-scale TMDs when requiring to limit the size of actuator magnets.

The permanent magnet-based robotic systems in torque-force-driven mode generate a rotating magnetic field and gradient field, resulting in a magnetic torque and force, as the main sources of actuation simultaneously, exerted on TMDs. These systems can be selectively switched to those in torque-driven mode or those in force-driven mode according to the specific application, making them have extraordinary versatility. With using one actuator magnet, Mahoney et al. have proposed a method to convert the magnetic force into a lateral force by manipulating the actuator magnet to be rotated with a specific trajectory. Such an operation can make a TMD be simultaneously pushed and rolled on a surface, inducing potentially enhanced rolling motion (higher rolling velocity) or it may be used for the scenarios of levitating device35. This method relies on the specific rotation control of the actuator magnet. With using two actuator magnets, Hosney et al. have introduced a strategy of combining the propulsion force converted from the magnetic torque and the magnetic force, which is proved to decrease the drilling time of blood clots36. Pittiglio et al. have developed a robotic system using two independent serial manipulators, which can generate a magnetic field with a high degree of manipulability by controlling the pose of two actuator magnets collaboratively, enabling the system to work in torque-force-driven mode suitably37. With using an array of actuator magnets, Ryan et al. have built a robotic system to create fields and field gradients in any direction in three-dimensional (3-D) path-following tasks, and shown that this system is able to implement 1-D and 2-D motion control via rolling as well as 3-D motion control via gradient pulling38. The disadvantage of this system is that the size of the workspace is severely restricted unless extremely large size actuator magnets are utilized39.

In this paper, we focus on the permanent magnet-based robotic systems in torque-driven mode. Our system has an open configuration without using commercial robotic arms. The system holds one translational DOF and three rotational DOFs, enabling it to control the pose of two actuator magnets collaboratively with four DOFs. Further, the system is arranged with a vertically symmetric configuration to exert relatively uniform magnetic fields within the center of the workspace. This symmetric configuration is physically constrained through a connecting plate, which simplifies the yawing motion control of the field-rotation axis within the center region of the workspace by only driving one robotic joint, as a result, leading to an ease of yawing motion control of TMDs. Besides, the forward (from joint space variables to the orientation of field-rotation axis) and inverse kinematics (from desired orientation of field-rotation axis to desired joint space variables) of the system is analyzed, which serves as a basis of implementing TMD motion control. Our system is verified to have the ability of achieving TMD motion control in torque-driven mode. The remainder of the paper is organized as follows: “Magnetic-based robotic system” section provides the forward and inverse kinematic analysis of the magnet-based robotic system. “Orienting field-rotation axis” section analyzes the possible unreachable zone of the field-rotation axis at the central point of the workspace. “Characterization of the magnetic field” section investigates the magnetic field strength and field gradient within the workspace. “Closed-loop motion control” section validates the ability of implementing 3-D closed-loop motion control of TMDs conducted in an agar-gel phantom.

We consider a time-varying rotating magnetic field produced by the superposition of the contributions of multiple dipole sources. These dipole sources are fixed in three-dimensional space by a robotic configuration and exert a controlled magnetic torque on a TMD in low Reynolds (Re) numbers.

whereis the homogeneous transformation between the global frame of reference and theith frame of reference of the magnetic source, as shown in Fig.1. Further,is the magnetic field due to theith magnetic source in the local frame. The properties of the magnetic fieldis completely characterized by the pose of each magnetic moment () and can be manipulated using the joint space variables ().

The magnetic field at a point () is characterized by the configuration-to-pose kinematics (), and the pose-to-field mapping () under the global frame of reference. Additionally theith magnetic source is arranged a local frame of reference.

between the unit vector of field-rotation axis (, refer to the rotation axis of magnetic field) and the unit vector of dipole-rotation axis (, refer to the rotation axis of magnetic moment) can be characterized by the configuration of the permanent-magnet robotic system, as shown in Fig.2.

A permanent-magnet robotic system uses rotating dipole fields to produce uniform magnetic field within a limited workspace. (a) Assignment of the frames to the setup, two cylindrical permanent magnets are attached to the end-effectors such that the magnetization vectors are perpendicular to the-axis. The two magnetic sources rotating synchronously around their self-rotation axis ofare expected to generate a rotating magnetic field atwith the field-rotation axis of. (b) A container filled with an agar-gel tissue phantom providing the TMDs with a viscoelastic swimming environment is placed at the center of the workspace. The inset box indicates the frameandattached onith magnetic dipole source.

Superimposing the magnetic field of multiple magnetic sources can generate greater and uniform field within the enclosed region between the permanent magnets. Translating and rotating these magnetic sources can be used for actuation. Therefore, we need to control the pose of the magnetic sources by robotically moving a robotic configuration in order to obtain the desired field-rotation axis for actuation at. Since we are considering rotating magnetic field for actuation, the magnetic dipole of theith source can be continuously rotated in synchrony with an angle(such thatis the angular velocity of two synchronized rotating dipoles) about theith dipole-rotation axis. The orientation of these axes of rotation is completely characterized using the forward kinematics ().

To control the dipole-rotation axis, a number of joints must be independently controlled. Here, we consider a translational base framesupporting four actuated rotational joints. The pure translation of framewith respect to the global frame of reference is characterized by the joint space variable, which enables the superimposed field to be translated without affecting its spatial derivatives. The first and second rotational joints are orthogonally arranged to rotate frameandabout the- and-axes respectively, as shown in Fig.2a. The rotation of framewith respect to frameand the rotation of framewith respect to frameare characterized by the joint space variableand, which enables control of the yawing and pitching motion of the field-rotation axis at, respectively. Framesupports two symmetrically placed actuated rotational joints aligned to rotate frameandabout the- and-axes, respectively. The rotation of framewith respect to frameis characterized by the joint space variable, which also enables the control of yawing motion of the field-rotation axis at. This allows us to have multiple control options (manipulatingoror both of them) when to plan a yawing motion of field-rotation axis at, and thus it improves the flexibility of our system. These joints are equally spaced with respect to thez-axis of the global frame of reference. Frameis defined as the frame of reference of theith permanent magnet, two magnetic sources rotate about the-axis of framesuch that their magnetic moment is orthogonal to these vectors. Further, frameis only rigidly translational with respect to frame. In addition, the rotation ofith permanent magnet is characterized in framesuch that frameis only rotational with respect to frame. The origin ofand that of frameare overlapping and the-axis of frameand the-axis of frameare coincident.

The rotation of framewith respect to frameenables control of the yawing motion of the field-rotation axis at. This yawing motion is important for the steering of TMDs. In Eq. (4),is the homogeneous transformation matrix between frameand.

whereis the translation vector of the origin of framein frame. Further,andare constants determined by mechanical dimensions of the system. For,and. For,and. Multiplying the solution for all transformation matrices, results in the overall homogeneous transformation matrixwhich governs the relation between the vector of joint space variablesand unit vector of dipole-rotation axis.

Hence the relationship between the unit vector of field-rotation axis, the unit vector of dipole-rotation axisand the vector of joint space variablesat positionis found.

Given the desired unit vector of field-rotation axis, then the problem of solving inverse kinematics is converted to that of solving Eq. (23) with the orientation of the dipole moment of each magnetic source () varying synchronously and periodically in time. The algorithm flow of solving inverse solutions based on the desired field-rotation axis is presented in Algorithm. The frame parameters required for the algorithm are demonstrated in Table2(see Appendix A) where themm,mm,mm,mm,mm,mm andmm. In the algorithm, the increase and decrease of the value of joint space variableindicates the positive and negative linear motion of translational joint, respectively. Similarly, the increase and decrease of the value of joint space variable(or) indicates the counterclockwise and clockwise rotation of that revolute joint, respectively. In particular, our permanent-magnet robotic system allows two consecutive clockwise or counterclockwise rotations of framewith respect to frame, which is characterized by joint space variable([-:]), enabling TMDs make two continuous clockwise or counterclockwise rotations.

Referring to Algorithm 1, the desired vector of joint variablesand desired unit vector of dipole-rotation axiscan be calculated based on the desired unit vector of field-rotation axis.

Inverse solutions at separate points from a predefined 3-D spiral trajectory with calculating the desired field-rotation axis (), desired dipole-rotation axis () and desired vector of joint variables () at 17 representative waypoints.

Replacing thewithin Algorithm 1, we can acquire the desired vector of joint variables () at each waypoint, as shown in Table1.

The challenge of aligning the field-rotation axis in diverse directions varies depending on the design of the robotic system and the constraints of joint space variables. Since the orientation of the field-rotation axis, as denoted by the unit vector of field-rotation axis, governs the motion direction of a TMD, it’s imperative to analyze the difficulty level of orienting the field-rotation axis within its reachable orientation zone at the TMD’s location. In this section, we’ll presume the TMD is positioned at the central point of the workspace. The central point is defined as the middle point of line segment between two actuator magnets’ centroids when the system is at its initial state. The initial system state refers to. Subsequently, we’ll evaluate the difficulty of aligning the field-rotation axis to a particular direction at this central point.

The yawing and pitching motion of field-rotation axis plays an important role on the motion direction control of TMDs. Specifically, at the central point, we associate the yawing motion of the field-rotation axis with joint space variable, and the pitching motion with joint space variable.

Figure3shows the orientation of field-rotation axis changes along withand. Theenables the yawing motion of the field-rotation axis at the central point, as shown in Fig.3a. The unit vector of field-rotation axis rotates uniformly asvaries at equal intervals over one revolution, which means the rotation of field-rotation axis is synchronized with the rotation of. Note that the unit vector of field-rotation axis at the case ofis overlapped by that at the case of. Theenables the pitching motion of field-rotation axis, as shown in Fig.3b. The unit vector of field-rotation axis rotates non-uniformly asvaries at equal intervals fromto, which means the rotation of field-rotation axis is not synchronized to the rotation of. Meanwhile, the rotational direction of the unit vector of field-rotation axis changes from clockwiseto counterclockwise, and then back to clockwise.

Characterization of the yawing motion and pitching motion of the unit vector of field-rotation axis with respect to joint space variableandat the central point of the workspace in the frame. The arrows indicate the unit vectors of field-rotation axis. (a) The unit vector of field-rotation axis rotates counterclockwise inx-yplane as joint space variablevaries fromto. (b) The vector of field-rotation axis first rotates clockwise as indicated by, then rotates counterclockwise as indicated by, and finally rotates clockwise back as indicated byiny-zplane as joint space variablevaries fromto. Please refer to the Segments S1 and S2 inSupplementary Videofor a visual demonstration..

The robotic joint space determines the motion space of actuator magnets, while the actuator magnets’ motion space determines the field-rotation axis’s reachable orientation zone at any point in the workspace. With revolute joints, the motion space of two actuator magnets is a hollow ellipsoid-like space and can be covered by an 800 mm800 mm500 mm cuboid, as shown in Fig.4a. With all joints (revolute plus translational joints), the motion space of two actuator magnets is a cylinder-like space and can be covered by an 800 mm1000 mm500 mm cuboid, as shown in Fig.4b.

Mapping the robotic joint space to the orientation of the field-rotation axis at the central point (O) of the workspace. (a) The motion space of actuator magnets relative to robotic revolute joints. (b) The motion space of actuator magnets relative to robotic revolute and transnational joints. (c) The orientation of the field-rotation axis at the central point is characterized by the angle ofand the angle of. The angle ofis the one between the projection vector of the field-rotation axis and the positivex-axis, and the angle ofis the one between the vector of the field-rotation axis and the positivez-axis. The range ofis set as [] while the range ofis set as []. The largest singular value of Jacobinin-plane, plotted in a logarithmic color scale.

where the Moore–Penrose pseudoinverseis the inverse mapping that minimizesif the robotic system is over-actuated. The largest singular value ofserves as a measure of the most extreme scenario where a change in the unit vector of the field-rotation axis is approximately mapped to a magnitude change in the robotic joints41. If the largest singular value approaches infinity, the robotic system is close to experiencing a kinematic singularity.

To assess the system’s capability to make a TMD ascend or descend at its central point, we measure the difficulty of executing the system as the field-rotation axis approaches the vertical direction at the central point. The orientation of the field-rotation axis at the central point is characterized by anglesand. Specifically, therefers to the angle between the projection vector of the field-rotation axis and the positivex-axis, and therefers to the angle between the vector of the field-rotation axis and positivez-axis, as shown in Fig4c. The angleis constrained within the range [], whileis limited to the range []. These angular constraints define two conical regions corresponding to unreachable motion directions for the TMD, which are symmetric about thexOyplane. It shows the color map of the logarithmic largest singular value of(the abbreviation of) in the-plane at the central point. The color map reveals how hard it is for the field-rotation axis toward the orientation indicated by anglesand. Asdecreases fromtoor increases fromto, it gradually becomes harder. Therefore, it indicates that the more vertical the motion direction of a TMD, the more challenging it becomes for the system to implement. In our approach, we adopt a method of having the TMD ascend or descend in a spiral instead of vertically to achieve the TMD’s arrival at the designated position.

The two identical magnets, spaced apart by a distance of, are placed symmetrically on thex-axis relative to framewith the unit vector of dipole-rotation axis () paralleling to they-axis, as shown in Fig.5a. The two identical magnets are rotating in synchronization around the dipole-rotation axis () with a synchronous rotation angle, resulting in a time-varying magnetic field (magnetic flux density) and field gradient in the workspace of our permanent-magnet robotic system. We study the magnetic field variation within the spherical space centered at the origin and with a radius ofr.

Two identical magnets are rotated synchronously around the unit vector of dipole-rotation axis, resulting in a time-varying magnetic field within the center spherical space. (a) Two identical actuator magnets are rotated synchronously around the unit vector of dipole-rotation axis. (b–e) The maximum and minimum magnetic field strengths (and) undergo changes within the center spherical space with a radius of 20 mm, 30 mm, 40 mm, and 50 mm at a constant distance (350 mm) between two actuator magnets during a single rotation period of actuator magnets. The magnetic field strength distribution over the surface of the spherical space varies asis at several constant degrees (,,,,,and). (f) The changes ofandin relation to the radius of the spherical space at a constant distance (350 mm) between two actuator magnets. (g,h) The changes ofandat different radii of the center spherical space in relation to the distance () between two actuator magnets.Please refer to Segment S3 in Supplementary Video.

For a fixedand a fixed distance between two actuator magnets (), both maximum and minimum magnetic field strengths (and) are present within a specific space. Similarly, for anywith a fixed, both highest and lowest magnetic field strengths (and) are also present within the same space. Factors such as the synchronous rotation angle, the distance between two actuator magnets, and joint space variables contribute to a time-varying magnetic field within the workspace of our permanent-magnet robotic system. In this section, we delve into the analysis of the evolving magnetic field and its gradient in the center spherical space resulting from these factors.

To study the impact of synchronous rotation angle () on the magnetic field strength and gradient, we keep the distance between two actuator magnets constant such thatmm. Aschanges, both theandwill vary. This results in the curves showing the changes ofand, as shown in Fig.5b–e. The red curve (), green curve (), and the region between them form a variation band. The variation band becomes wider at a larger center spherical space. The changes ofandwith respect toexhibit periodic behavior, with both of them sharing a period of. Furthermore, we visualize the distribution of magnetic field strength over the surface of the central spherical space with radii of 20, 30, 40, and 50 mm, while maintainingat specific fixed angles (,,,,,, and). We observe that the magnetic field strength near the two actuator magnets is greater than in the central region of the sphere.

The influence of the radius (r) of the center spherical space on theand, withset to 350 mm, is depicted in Fig.5f. The magnitudes ofandat differentrare demonstrated in Table3(Please refer toAppendix). Asrincreases from 0 to 50 mm, theincreases from 3.348 to 5.337 mT, whereas thedecreases from 1.704 to 1.167 mT, indicating that the rate at which theincreases is faster than the rate at which thedecreases.

The influence of the distance () between two actuator magnets on theandare shown in Fig.5g,h, respectively. Asincreases,decreases at a faster rate compared to. Further, theat a largerrdecreases faster whileat a smallerrdecreases faster. Specifically, asincreases from 350 to 450 mm, theat, 30, 40 and 50 mm decreases from 3.615 to 1.658 mT, 3.973 to 1.757 mT, 4.526 to 1.904 mT and 5.337 to 2.108 mT, respectively. Theat, 30, 40 and 50 mm decreases from 1.605 to 0.771 mT, 1.489 to 0.737 mT, 1.340 to 0.692 mT and 1.167 to 0.638 mT, respectively.

Similar to the definition in magnetic field strength, for a fixedand a fixed distance between two actuator magnets (), both maximum and minimum magnetic field gradients (and) are present within a specific space. Comparatively, for anywith a fixed, both highest and lowest magnetic field gradients (and) are also present within the same space.

The change of maximum field gradientalong with the synchronous rotation angle () is periodic with a period of, as shown in Fig.6a–d. Besides, the magnetic field gradient distribution over the surface of the center spherical space with the radius of 20, 30, 40, and 50 mm while keepingat a set of constant degrees (,,,,,and) is visualized. It is evident that the magnetic field gradient is noticeably higher in the vicinity of the actuator magnets within the spherical space compared to the central portion of the sphere.

The result of varying magnetic field gradients on the center spherical space between two actuator magnets. (a–d) The maximum magnetic field gradient changes within the center spherical space with a radius of 20 mm, 30 mm, 40 mm, and 50 mm at a distance (350 mm) between two actuator magnets during a single rotation period of actuator magnets. The magnetic field gradient distribution over the surface of the spherical space with a radius of 20 mm, 30 mm, 40 mm, and 50 mm varies asis at different degrees (,,,,,and). (e) The change of thein relation to the radius (r) of the spherical space at a constant distance (350 mm) between two actuator magnets. (f) The change ofin response to the distance () between two actuator magnets. (g) The change of the radius () of gradient-free space in response tofor a set of given thresholds ().Please refer to Segment S4 in Supplementary Video.

With an increasing radius (r) of the center spherical space,also exhibits a corresponding increase. Note that the minimum field gradientis equal to 0 for any. Asrincreases from 0 to 50 mm,increases from 0 to 0.097 T/m, as shown in Fig.6e. Note that theremains to be 0.

The influence ofon theis shown in Fig.6f. Asincreases,at a largerrdecreases faster. Specifically, asincreases from 350 to 450 mm, theat, 30, 40 and 50 mm decreases from 0.028 to 0.008 T/m, 0.045 to 0.012 T/m, 0.067 to 0.017 T/m and 0.097 to 0.024 T/m, respectively.

A space is assumed to be a gradient-free if the magnitude of magnetic field gradient within the space below a threshold () such that. The threshold determines the degree of gradient-free in that space. The smaller the threshold, the higher the degree of gradient-free in the space. Asincreases, the radius () of the gradient-free space expands for a set of given thresholds, as shown in Fig.6g. Specifically, asincreases from 350 to 450 mm, theat, 0.01, 0.015 and 0.02 increases from 3.86 to 13.23 mm, 7.67 to 25.29 mm, 11.38 to 35.65 mm, and 14.95 to 44.36 mm, respectively. Conversely, the desired distance () between two actuator magnets can be calculated for the gradient-free space with a required size at a specified threshold. The size of the gradient-free space can be enlarged by increasing the distance between the two actuator magnets. However, this comes at the expense of the average magnetic field strength in the gradient-free space.

In addition, the motion of each robotic joint influences the distribution of both the magnetic field strength and the field gradient within the central spherical region. Visualizations illustrating how each joint’s motion affects the magnetic field strength and the field gradient are provided in Segments S5 and S6 of the Supplementary Video, respectively.

A TMD is controlled to follow three predefined 2-D trajectories and a 3-D spiral circular trajectory in an agar-gel tissue phantom to verify the capability of our permanent magnet-robotic system of implementing TMD motion control. The TMD consists of a twist body and a cylindrical magnet. The body of the TMD is fabricated using a 3D printer with Formlabs photopolymer resin (FLGPBK04), and has a length of 4 mm, a diameter of 1.5 mm, and a weight of 0.0049 g. The magnet of the TMD is made of Grade-N45 NdFeB and axially magnetized with the diameter ofmm and the height ofmm, and it has the weight of 0.0064 gram. The magnet is positioned at the tail with its dipole moment being perpendicular to the helix axis of the TMD. The two identical actuator magnets are fabricated with cylindrical Grade-N45 NdFeB and axially magnetized. Each of them has the diameter ofmm and the height ofmm. Further, the actuator magnets are controlled to rotate synchronously. Each of them is driven by a Maxon motor (Planetary Gearhead GP 32 C D32 mm, 1.0-6.0 Nm, Ceramic Version) with a Maxon controller (EPOS2 50/5, Digital positioning controller, 5 A, 11-50 VDC).

The field-rotation axis’s translational motion, characterized by joint space variable, is implemented by a linear motion stage (KUA1505-520-150-A1-N3, X-Axis unit, Japan). Further, the motion stage is driven by an A1 actuator (MX-106R, Dynamixel Actuator). The yawing motion of the field-rotation axis, which is characterized by joint space variable, is accomplished by an A2 actuator (H42P-020-S300-R, Servomoteur Dynamixel PRO PLUS). The pitching motion of the field-rotation axis, which is characterized by joint space variable, is realized by two A1 actuators which are in synchronous control mode. Another yawing motion of the field-rotation axis, characterized by joint space variable, is fulfilled by two A3 actuators (M42P-010-S260-R, Servomoteur Dynamixel PRO PLUS).

To measure the real-time position and the moving direction of the TMD, two cameras (Aviator GIGE, avA1000-100gm, Basler AG, Ahrensburg, Germany) are mounted on orthogonal sides of the container. Besides, the TMD is immersed in agar-gel tissue phantom which is made of gelatine powder (Ec Nr: 232-554-6, Boom BV, Rabroekenweg, The Netherlands) and demineralized water with a mass ratio ofwt%. To make the agar-gel tissue phantom, we put the aqueous solution of which inside a transparent cubical container with a length ofmm, and afterward the aqueous solution is stored in a refrigerator at a temperature of 4 degrees Celsius for 12 hours prior to the experiment. The TMD is actuated under the actuation frequency of 2 Hz during the closed-loop motion control.

We implement 2-D closed-loop motion control experiments with two prescribed trajectories. To begin with, the prescribed “Triangle” and “Square” trajectories are broken intoandrepresentative waypoints, respectively. Then, the desired inverse solution at each representative point of prescribed trajectories is solved based on the algorithm presented in Algorithm 1. Next, these inverse solutions provide the real-time reference positions for joint space variables during the implementations of TMD closed-loop motion control. The prescribed (red) and actual (blue) trajectories with their tracking errors are indicated in each case, as shown in Fig.7. It indicates that the maximum position tracking errors of the “Triangle” and “Square” trajectories are 1.94 mm and 1.20 mm, respectively. The increase in the motion speed of the TMD can be achieved by increasing the actuation frequency. However, increasing the TMD’s motion speed requires the system to have the capability to respond quickly. Otherwise, it may lead to an increase in position tracking error. Please refer to Segment S7 inSupplementary Video.

2-D closed-loop motion control of a TMD to move along a prescribed 2-D trajectories. (a) “Triangle” trajectory with its tracking error. (b) “Square” trajectory with its tracking error. The prescribed trajectories (red) and the actual trajectories (blue) are indicated. The TMD achieves an average motion speed of 0.27 mm/s during the closed-loop motion control. Please refer to Segment S7 inSupplementary Video.

We implement 3-D closed-loop motion control experiments with one prescribed trajectory. To begin with, the prescribed 3-D spiral trajectory is broken intorepresentative waypoints (see Table1). These waypoints are evenly distributed on the predefined trajectory. The desired field-rotation axis at each representative waypoint is indicated by red arrow. Given the representative waypointand the desired field-rotation axis, the desired dipole-rotation axis, and the desired vector of joint space variablesat each waypoint is calculated in Table1by using the algorithm presented in Algorithm 1.

The time-dependent changes of reference (red) and actual (blue) positions in joint space variables are shown in Fig.8a. The time-dependent change ofshows a tendency for the linear motion stage to move forth and back to follow the TMD motion in they-axis direction. The time-dependent change ofindicates that the bottom yawing motor approximately rotatesat two adjacent representative waypoints. The time-dependent change ofindicates that the pitching motor decreases its pitching angle as the TMD moves upward. The time-dependent change ofindicates that the two top yawing motors make a small rotation. As we look at the time-dependent changing trend of each joint space variable, the control system tends to keep the TMD at the center of the workspace throughout the process of controlling the TMD to move along the predefined trajectories.

3-D closed-loop motion control of a TMD is implemented using our permanent magnet-based robotic system. The TMD is controlled to follow a predefined 3-D spiral trajectory inside a square container (with the side length of 100 mm) filled with agar-gel tissue phantom. (a) The reference position (red) and actual position (blue) of each joint variable indicates the control input and output of each joint variable. (b) The actual track points from the top view form a circle with a diameter of 30.6 mm, and those in the side view form the rising spirals with a pitch of 19.0 mm. (c) The synthetic 3-D trajectory (green) indicates the mean absolute error compared to the predefined one (black) is 1.18 mm and the maximum tracking error is 2.64 mm. The desired field-rotation axis at each representative point is indicated by a red arrow. Please refer to Segment S8 inSupplementary Video.

Figure8b indicates the real-time position of the TMD at the top and side views. From the top view, the TMD trajectory forms a circle with a diameter ofmm. From the side view, the trajectory forms a spiral with a pitch ofmm. Further, Fig.8c demonstrates that the mean absolute error of 3-D motion control, by calculating the average positioning error between the synthetic and predefined 3-D trajectory (green and black), ismm, and the maximum tracking error is 2.64 mm. Experimental results reveal that the TMD can move controllably.Please refer to Segment S8 in Supplementary Video.

We develop a permanent magnet-based robotic system which enables motion control of TMDs. First, we derive a kinematic model which relates the field-rotation axis, the dipole-rotation axis and the joint space variables. Then, we characterize the yawing and pitching motion of the field-rotation axis at the central point of workspace. Next, we analyze the difficulty level of orienting the field-rotation axis at the central point of the workspace and observe that the system exhibits greater degree of singularity as the field-rotation axis becomes vertical. Then, we characterize the magnetic field and field gradient in workspace and observe that the center region of the workspace is almost a gradient-free region. Finally, we demonstrate the capability of our robotic system to control a TMD moving along prescribed trajectories in 2-D and 3-D space experimentally. In addition, our system is not only capable of driving highly magnetized devices, like those containing NdFeB magnets for magnetization, but also caters to weakly magnetized devices, such as soft sperm robots that utilize injected magnetic particles for magnetization4243.

The authors would like to thank E.D. de Jong and Mert Kaya for fabricating mechanical parts during the development of our permanent-based robotic system, and thank Zihan Wang for providing the assistance of image tracking of tetherless magnetic devices.

The parameters corresponding to each frame shown in Fig.2are demonstrated in Table2as below. In which, for,and, and for,and.

Highest and lowest magnetic field strengths, and highest field gradient within the center spherical space of different radii within a rotation period of actuator magnets.