One of the most important advanced and efficient technologies in converting DC electrical energy to AC is switched-capacitor multilevel inverters with reduced charging current, which enable output voltage boosting. This paper proposes a structure based on the switched-capacitor technique. The proposed structure, which consists of a single voltage source, 10 power electronic switches, 3 capacitors, and one diode, generates an 11-level stepped voltage waveform at the output with an output voltage amplitude up to 2.5 times the input voltage. This structure produces both positive and negative voltage levels without the need for an H-bridge and imposes appropriate voltage stress on the components. In the proposed structure, since a maximum of two switches are involved in the charging path of the capacitors, the current stress on the switches is minimal, resulting in low losses for the proposed structure. A comprehensive comparison based on important performance parameters has been conducted with other structures to evaluate the efficiency of the proposed topology. The operation of the proposed structure was first assessed in the Simulink environment of Matlab under various loading conditions and subsequently validated through the implementation of an experimental prototype. This structure is capable of supplying inductive loads with different power factors and is suitable for industrial applications.

With advancements in science and technology, the supply of energy required by humans through renewable energy sources such as wind and solar has increased. Since renewable energy sources are always available and environmentally friendly, they have replaced fossil fuels. Renewable energy sources generally produce a direct voltage with low amplitude and magnitude, which cannot be directly connected to the electrical grid. Inverters act as intermediaries, converting the voltage generated by renewable energy sources into AC voltage compatible with the electrical grid. In general, inverters are categorized into two types based on their output voltage levels: two-level and multilevel inverters. Notable features of multilevel inverters include improved voltage and current waveform quality, lower harmonic interference, higher reliability, increased efficiency, reduced electromagnetic issues, and lower component stress1–3.

Generally, conventional multilevel inverters are categorized into three different types: Neutral Point Clamped (NPC), Flying Capacitor (FC), and Cascaded H-Bridge (CHB), which are utilized in various applications based on requirements4–6. The NPC and FC structures are powered by a single source; however, they require a significantly high number of diodes and capacitors, leading to challenges such as capacitor voltage balancing complexity and high costs. Moreover, these structures lack voltage-boosting capability, and their output voltage is equal to or lower than the input voltage. In applications involving the connection of renewable energy sources to the grid, a high-gain DC-DC converter is required. The cascaded H-Bridge structure, on the other hand, consists of multiple input voltage sources, making the practical implementation of these multiple sources challenging. Considering the limitations of conventional inverters, researchers have introduced switched-capacitor-based structures7.

Switched-capacitor multilevel inverters, with the ability to automatically balance capacitor voltages, utilize fewer input sources and use capacitors to create voltage levels. The operation of these converters is such that by connecting the voltage source and capacitors in series according to a switching pattern, voltage levels higher than the input voltage source are generated, and the capacitors discharge during these time intervals.

Additionally, the charging of the capacitors is achieved by connecting the capacitors in parallel with the input voltage source, allowing the capacitor voltages to automatically balance. The main advantages of these structures over conventional ones include fewer input sources, voltage boosting capability, and easier control8. In these structures, during capacitor charging, an inrush charging current is generated, which must be handled by all the switches in the charging path. The current stress on the switches in the capacitor charging path and the losses caused by the high charging currents are the main challenges of switched-capacitor structures9. Reference10provides a solution to address this issue by using a small inductor in the capacitor charging path, which effectively suppresses the inrush currents.

In this paper, considering the nature of switched-capacitor inverters and their primary challenges, an 11-level structure with a boost factor of 2.5, along with reduced voltage and current stress, is proposed. This structure requires a single voltage source, 10 switches, 3 capacitors, and 2 diodes. The advantages of the proposed topology include a single voltage source, fewer power electronic components, automatic capacitor voltage balancing without the need for additional circuits, an output voltage amplitude boosted up to 2.5 times the input voltage, no requirement for an H-bridge to generate bipolar voltage levels, maximum switch voltage lower than the maximum output voltage, fewer active switches needed to produce different voltage levels, and reduced inrush current for capacitor charging.

The structure of the rest of the article is categorized as follows: In Sect. “Proposed structure”, the proposed structure is first introduced, followed by a detailed analysis of the current flow paths and switching states of the proposed configuration. Furthermore, the appropriate capacitance determination and the extended structure are also examined in this section. The third section focuses on evaluating the losses of the proposed inverter. In the fourth section, a comparison with similar structures is conducted. The fifth section presents the simulation and experimental results of the proposed inverter. Finally, in the last section, a concise conclusion and summary are provided.

Figure1illustrates the circuit of the proposed structure, which consists of a single DC source, 10 unidirectional power electronic switches, 3 capacitors, and a diode. Switches S3and S5lack anti-parallel diodes, and their simultaneous activation enables the simultaneous charging of capacitors C2and C3. Additionally, capacitor C1is charged through the activation of switch S8. Using this simple algorithm, an 11-level output voltage is achieved. The switched capacitors stabilize at the desired voltage levels without the need for auxiliary circuits or sensors. The voltage level of capacitor C1equals the input source voltage, while the voltage levels of capacitors C2and C3are half the input voltage. In Fig.1, the maximum blocking voltage (MBV) of the switches and diode is indicated. Despite the output voltage boost factor being 2.5 times the input voltage, the maximum voltage stress on all components is lower than this value, which is a significant advantage of the proposed structure. The switching method for the proposed structure is presented in Table1. In this table, the value “1” indicates that the corresponding switch is ON during the generation of the specified voltage level, while “0” indicates that it is OFF. Besides, “C” means charging, “D” means discharging, and “-” means no change in capacitor voltage.

Switching States of the proposed 11-Level Inverter.

Current paths for load current and capacitor charging current in the proposed structure.

State A: When switches S2, S4, S7, and S9are ON, capacitors C1and C3discharge, generating the voltage level 2.5Vdc.

State B: Current flows through switches S2, S3, S7, and S9, and with the discharge of capacitor C1, the sum of the input source voltage and capacitor C1generates the output voltage.

State C: In this state, switches S2, S4, S8, and S9are turned ON, capacitor C1charges, and capacitor C3discharges to generate the voltage level 1.5Vdc.

State D: Switches S2, S3, S5, and S9are turned ON, and capacitors C2and C3are simultaneously charged to 0.5Vdc. In this state, the voltage level Vdcis generated by the DC source.

State E: Current flows through switches S2, S6, and S9, generating the voltage level 0.5Vdcwith the discharge of capacitor C3. In this state, capacitor C1charges through switch S8, which is connected in parallel with the DC source.

State O: To generate the zero voltage level, switches S2, S3, and S10are turned ON. In this state, capacitors C2and C3are simultaneously charged through switch S5.

Modulation technique (LS-PWM),aPWM signal generation scheme,b)Logical circuit for pulse generation.

One of the key parameters in designing a multi-level switched capacitor inverter is selecting the appropriate capacitor size for the structure being used. If the capacitor size is less than the correct and suitable value, the voltage ripple across the capacitor will increase. This not only reduces the quality of the output voltage but also increases the capacitor charging current and the associated ripple losses. Additionally, if the capacitor size is greater than the correct and appropriate value, the cost and size of the inverter will increase. Therefore, in order to improve the inverter’s efficiency, the design and calculation of the appropriate capacitor size is of high importance. To select the capacitor size, the maximum voltage ripple across the capacitor during the switching process is calculated. For this purpose, the range in which each capacitor experiences the maximum discharge duration (MDD) is considered. To identify these time intervals, Figure4, which illustrates the charging and discharging process of capacitors at different output voltage levels, can be used.

Charging and discharging of capacitors based on output voltage levels.

The selected capacitor capacitance must be higher than the calculated capacitance, and thus, the first standard capacitor with a value greater than the calculated capacitance (according to the capacitor’s datasheet) is chosen.

Equivalent circuit of soft charging of capacitors with a current-limiting inductor,(a)Soft charging of capacitor C1,(b)Soft charging of capacitors C2and C3.

In this section, the losses of the proposed 11-level inverter are analyzed. Generally, the losses of a multilevel switched-capacitor inverter are divided into three parts: conduction losses (PC), switching losses (PS), and ripple losses (PR). Conduction and switching losses are related to the losses caused by the switches and diodes, while ripple losses are associated with the losses in the capacitors27.

Conduction losses, or ohmic losses, are caused by the voltage drop across semiconductor devices when they are in the on-state, as well as the internal resistance of these devices. In calculating conduction losses, the internal resistance of the IGBT or MOSFET and its parallel reverse diode should be considered. Therefore, the conduction losses of the switch (PC, S) and the parallel reverse diode (PC, D) are calculated using Eqs. (10) and (11), where VS, ONand VD, ONrepresent the voltage drop across the switch and its parallel reverse diode, respectively, and RSand RDare the internal resistance of the switch and its parallel reverse diode. i(t) is the current through the switch at the conduction moment, and α is related to the specifications of the switch, as provided in the datasheet of the respective switch27.

In this equation, NONand NOFFrepresent the number of times the switch turns on and off in one cycle. Additionally, EONand EOFFrefer to the loss energy during the turn-on and turn-off moments of the switch, and f is the output voltage frequency.

The ripple voltage losses of the capacitors are caused by the voltage difference between the capacitor voltage and the input voltage source during the capacitor discharge process. The amount of ripple voltage losses for each capacitor can be calculated by considering the capacitance values of each capacitor and the allowable ripple voltage for each one using Eq. (14)29. In this equation, fSis the switching frequency, NCis the number of capacitors, and ΔVciis the ripple voltage percentage for the i-th capacitor.

In this equation, fSis the switching frequency, NCis the number of capacitors, and ΔVciis the ripple voltage percentage for the i-th capacitor. The ripple voltage of the capacitor is calculated using Eq. (15), where tCrepresents the charging time and iCrepresents the capacitor charging current.

The efficiency of the proposed inverter is defined by Eq. (16), where POis the output power of the inverter and PLis the total losses of the inverter29.

Using the relationships provided in this section, the losses of the proposed structure can be simulated, and its efficiency can be calculated.

For the loss simulation, the data provided in the datasheets of the IGBT IKFW60N60DH3E (600 V/50A) and the diode FFPF30U60S (600 V/30A) have been utilized. In this simulation, the input voltage is 100 V, the switching frequency is 5 kHz, the modulation index is 1, the output load is of the resistive-inductive type with an impedance of 50 Ω + 30 mH, the power factor (PF) is 0.98, and the output power is 580 W. Additionally, the level-shifted PWM technique has been employed for switching. Under these conditions, the losses of switches, diodes, and capacitors are obtained as shown in Fig.6(a). The switch losses include both switching and conduction losses. Figure6(b) illustrates the distribution of losses across the different components.

Simulation of the proposed inverter’s losses at an output power of 580 W;(a)Losses of the proposed inverter by component type,(b)Percentage distribution of losses.

Since the proposed inverter is designed with the objectives of reducing the number of circuit components and minimizing the voltage stress on the utilized components, a fair comparison with other 11-level switched capacitor structures has been conducted in this section to evaluate the strengths and weaknesses of the proposed structure. This comparison is presented in Table2, considering key parameters such as the number of input voltage sources (Ndc), the number of power electronic switches (NSW), the number of gate drivers (Ndr), the number of diodes (Nd), the number of capacitors (NC), and the total number of components required (NT). Additionally, key circuit characteristics such as the maximum number of switches conducting in the load path (NP), the voltage boosting ratio (G), the maximum capacitor voltage stress (MCV), maximum Blocking voltage of the switch (MBV), the total switch voltage stress (TSV), the cost factor (Cf), and the requirement for an H-bridge module to generate negative voltage levels are also presented.

Comparison of the proposed structure with existing 11-Level structures.

The comparison graph of the efficiency of the proposed structure with similar 11-level structures is shown in Figure7. Since factors such as the type of modulation used and the parasitic parameters influence the final efficiency, this comparison has been made under equal and identical conditions. The efficiency of structures that use a current-limiting inductor has been calculated and displayed in the presence of the current-limiting inductor. As shown in Figure7, an increase in output power leads to a slight decrease in the efficiency of the structures. The structure from reference19exhibits the same efficiency as the proposed structure at lower power levels. However, as the output power increases, the proposed structure demonstrates better efficiency compared to the other structures.

Efficiency comparison graph for different output power levels.

Table3presents the calculated cost of each component of the proposed inverter, which is then compared with the costs of other similar structures. The component prices were extracted from the Mouser website, based on the required voltage ratings for each structure, and the total cost of the structures was estimated. It is important to note that the cost of the proposed structure and the reference structure19has been calculated considering the cost of the current-limiting inductor. According to this table, the proposed structure has a lower overall cost compared to other 11-level structures.

Cost comparison of the proposed structure with 11-level structures.

Courtesy:www.mouser.com, * prices are subject to change.

To evaluate the performance of the proposed inverter and validate the analyses presented in the previous sections, simulation results in the MATLAB Simulink environment and experimental results are provided in this section. Figures8shows the prototype of the proposed inverter implemented in the power electronics laboratory, using the information available in Table4. The input voltage source is set to 30 volts, and with the theoretical gain factor of 2.5 for the proposed structure, the maximum sinusoidal voltage amplitude obtained is approximately 70 volts. For switching, high-frequency PWM phase-shift modulation is used, with a switching frequency of 5 kHz and a fundamental frequency of 50 Hz. The simulation was carried out under conditions similar to the practical setup, considering the internal resistance of the switches and the parasitic resistance of the capacitors. To generate the switching pulses, the Arduino Mega 2560 microcontroller was used. The MOSFETs employed are all IRFP250 type, capable of handling a voltage of 250 volts. For signal amplification and transmission to the switches, the TLP250 driver was used. A MUR420 diode, with a voltage rating of 200 volts, was utilized. In the proposed structure, the capacitance of capacitor C1is chosen to be 3300 µF, while the capacitance of capacitors C2and C3is set at 4200 µF each. The resistive-inductive load with an impedance of 40Ω + 60mH is provided using a variable resistor and low-frequency inductance. Additionally, the Gw GDS 1074B oscilloscope is used to record the experimental results.

Simulation and experimental parameter Specifications.

The waveform of output voltage and current under resistive-inductive loading with an impedance of 40Ω + 60mH is shown in Figure9. In Figure9-a, the simulation results are presented, where the output voltage has 11 levels, and each voltage step is 14 volts. The output voltage levels, resulting from the low ripple voltage of the capacitors, are equal to each other. Figures9-b illustrates the experimental results for the output voltage and current under the same resistive-inductive loading conditions. According to this figure, the maximum output voltage is approximately 70 volts, and the maximum output current is around 2.1 amps, resulting in an output power of approximately 70 watts. Based on Figures9-a and9-b, the phase difference between the output voltage and current, due to inductive loading, is 25 degrees. Additionally, in Figure9-c, the Total Harmonic Distortion (THD) of the output voltage is presented, which is 11.22% with high-frequency switching. The high quality of the current and voltage waveforms of the proposed inverter can be observed in Figures9-a to9-c. Figures10shows a close-up of the output voltage and current waveforms of the proposed structure under resistive-inductive loading with an impedance of 40Ω + 60mH.

Output voltage and current with resistive-inductive load;(a)Simulation results,(b)Experimental results,(c)Output voltage THD.

Output voltage and current waveform with resistive-inductive load, close-up view;(a)Simulation,(b)Experimental.

Figure11shows the dynamic response of the proposed inverter during a sudden load change from a resistive-inductive to a pure resistive load. The output load changes suddenly from an inductive load with impedance of 40Ω + 60mH to a purely resistive load with impedance of 40Ω. Based on this figure, the output voltage waveform does not encounter any issues after the sudden change in the output load and correctly produces the output voltage levels, indicating the capability of the proposed inverter to supply different loads with varying power factors.

Waveform of output voltage and current in response to the dynamic change of the load from resistive-inductive to pure resistive,(a)simulation,(b)experimental.

The dynamic response of the proposed inverter to the instantaneous and sudden modulation index change is shown in Figures12and13. When the modulation index is equal to 1, the output voltage has 11 levels, with the maximum output voltage and current being 70 volts and 2.1 amps, respectively. As the modulation index decreases to 0.7, as shown in Figure12, the number of output voltage levels reduces to 9, and the peak voltage and current decrease to 56 volts and 1.8 amps, respectively, resulting in an output power of approximately 50 watts. As shown in Figure13, when the modulation index decreases from 0.7 to 0.3, the number of output voltage levels reduces to 5, and the peak voltage and current decrease to 30 volts and 0.8 amps, respectively, resulting in an output power of approximately 12 watts. It can be observed from Figures12and13that the proposed inverter responds appropriately to the instantaneous change in the modulation index, with the waveform of voltage and current decreasing in proportion to the reduction in the modulation index.

Dynamic change of modulation index from 1 to 0.7;(a)Simulation,(b)Experimental.

Dynamic change of modulation index from 0.7 to 0.3;(a)Simulation,(b)Experimental.

The dynamic response of the proposed inverter to a sudden change in output frequency from 50 Hz to 25 Hz is shown in Figure14, and from 50 Hz to 100 Hz in Figure15. Based on these figures, the proposed structure exhibits good performance in response to dynamic changes in output frequency and can supply various loads with different frequencies.

Dynamic frequency change from 50 Hz to 25 Hz;(a)Simulation,(b)Experimental.

Dynamic frequency change from 50 Hz to 100 Hz;(a)Simulation,(b)Experimental.

The simulation and experimental results of the voltage stress on some of the switches in the proposed structure, considering a 30 volts input voltage and a maximum output voltage of approximately 70 volts, are shown in Figures16and17. Figures16shows the voltage waveforms of switches S3, S4, S8, and S10. In this figure, the maximum voltage of the first signal, which corresponds to the voltage stress on switch S3and is shown in blue, is 56 volts. The maximum standing voltage of the second signal, which corresponds to switch S4and is shown in red, is 30 volts. Additionally, the maximum voltage of the third and fourth signals, which correspond to switches S8and S10, are 56 volts and 46 volts, respectively. In other words, the blocking voltage of switch S3is 80% of the output voltage, the blocking voltage of switch S4is 40% of the output voltage, and the blocking voltages of switches S8and S10are 80% and 65% of the output voltage, respectively.

Voltage stress of switches S3, S4, S8, and S10;(a)Simulation,(b)Experimental.

Voltage stress of switches S1and S2;(a)Simulation,(b)Practical.

In Figure17, the simulation and experimental results of the voltage waveforms of switches S1and S2are shown. The first signal of this figure, which corresponds to the voltage stress of switch S1and is marked in blue, has a maximum voltage stress of approximately 30 volts. Additionally, the second signal, marked in red, represents the voltage stress of switch S2, with a maximum value of approximately 30 volts. In other words, the voltage stress of switches S1and S2is approximately 40% of the maximum output voltage. The results of the voltage stress analysis of the switches show that none of the switches in the proposed structure experience the maximum output voltage. The voltage stress on most of the switches is approximately half of the maximum output voltage, which is a significant advantage.

The waveform of the input voltage and input current of the proposed inverter is shown in Figure18. According to Figure18, the input voltage, marked with the blue signal, is set to 30 volts, and the maximum input current is limited to less than 10 amps due to the use of an inductor.

Input voltage and current waveform;(a)Simulation,(b)Practical.

The voltage and current waveforms of the capacitors used in the proposed structure are shown in Figures19,20, and21. In these figures, the signal marked in blue corresponds to the capacitor voltage, while the signal marked in red represents the capacitor current. Figures19illustrates the voltage and current waveforms of capacitor C1. According to this figure, C1is charged to approximately 28 volts, nearly equal to the input voltage source. The peak current of C1is limited to around 4.4 amps due to the use of the limiting inductor. Figures20and21show the voltage and current waveforms for capacitors C2and C3, respectively. The voltage across these capacitors is approximately 14 volts, and their peak current reaches a maximum of about 2.5 amps. According to Figures19to21, the voltage ripple of capacitor C1is approximately 2.4 volts, which corresponds to 8% of its total voltage. Similarly, the voltage ripple of capacitors C2and C3is approximately 1.1 volts, equal to 7.9% of their voltages. Consequently, the capacitor voltage ripples remain within the permissible range, being less than 10%, which is attributed to the proper selection of capacitor values and results in high-quality output voltage.

Voltage and current waveforms of capacitor C1;(a)Simulation,(b)Experimental.

Voltage and current waveforms of capacitor C2;(a)Simulation,(b)Experimental.

Voltage and current waveforms of capacitor C3;(a)Simulation,(b)Experimental.

This paper presented an 11-level structure for a multilevel inverter based on switched capacitor technology. The proposed structure generates alternating, stepped output voltage levels with an output-to-input voltage gain ratio of 2.5. The proposed topology was thoroughly introduced and analyzed, including detailed explanations of output voltage level generation, operating modes, and switching mechanisms. The switching of this structure is based on the high-frequency PWM level-shift modulation method, with the implementation of this modulation and the generation of switching pulses explained in the relevant section. The capacitance values of the used capacitors were calculated and designed using capacitor sizing equations, considering the voltage stress and discharge range of each capacitor. The issue of inrush current in switched capacitor structures has been examined, and to solve this problem, an input inductor has been used in the capacitor charging path to enable soft charging of the capacitors. The losses of the proposed structure have been calculated through simulation in MATLAB, and the overall efficiency for different output powers has been shown. The efficiency of the proposed structure exceeds 95.5% at an output power of 900 W, with a modulation index of 1, a switching frequency of 5 kHz, and a power factor of 0.95. Using various comparative parameters, a comprehensive comparison between the proposed structure and other existing 11-level structures has been made. The result of this comparison shows that the proposed structure generates 11-level output voltage with a voltage gain of 2.5 using the least possible equipment. The cost coefficient of the proposed structure is 3.63%, which is lower than all the compared structures. In a comparative table, the cost of the main components of the structures has been compared, and the cost of the proposed structure is estimated to be around 55 dollars, making it the least expensive among the compared structures. Finally, to validate the proper operation of the proposed inverter, the simulation and experimental results are presented together at a power of 70 watts.