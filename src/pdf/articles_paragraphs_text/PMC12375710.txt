While cancer has traditionally been considered a genetic disease, mounting evidence indicates an important role for non-genetic (epigenetic) mechanisms. Common anti-cancer drugs have recently been observed to induce the adoption of non-genetic drug-tolerant cell states, thereby accelerating the evolution of drug resistance. This confounds conventional high-dose treatment strategies aimed at maximal tumor reduction, since high doses can simultaneously promote non-genetic resistance. In this work, we study optimal dosing of anti-cancer treatment under drug-induced cell plasticity. We show that the optimal dosing strategy steers the tumor to a fixed equilibrium composition between sensitive and tolerant cells, while precisely balancing the trade-off between cell kill and tolerance induction. The optimal equilibrium strategy ranges from applying a low dose continuously to applying the maximum dose intermittently, depending on the dynamics of tolerance induction. We finally discuss how our approach can be integrated with in vitro data to derive patient-specific treatment insights.

Cancer is the result of a complex evolutionary process which results in cells gaining the ability to divide uncontrollably1,2. While genetic mutations have long been understood to be important drivers of cancer evolution, it has more recently become clear that epigenetic mechanisms such as methylation and acetylation are sufficient to fulfill the traditional hallmarks of cancer3–6. Epigenetic mechanisms are both heritable and reversible, and they can enable cells to switch dynamically between two or more phenotypic states, which commonly show differential responses to drug treatment. In fact, tumor cells in many cancer types have been observed to adopt reversible drug-tolerant or stem-like states in vitro, which enables the tumor to temporarily evade drug treatment and sets the stage for the evolution of more permanent resistance mechanisms7–14. While these drug-tolerant states can exist independently of treatment7,11,15, recent evidence indicates that common anti-cancer drugs can also induce or accelerate their adoption, a phenomenon we refer to asdrug-induced plasticity8,11,12,15–17. Drug induction is already well known in the context of genetic mutations, where both anti-cancer and anti-bacterial drugs have been observed to cause genomic instability ormutagenesis, referring to an elevated mutation rate occurring as a result of the stress imposed by the treatment18–21.

Anti-cancer drug treatment has traditionally been administered under the “maximum tolerated dose” (MTD) paradigm, where the goal is to eradicate the tumor as quickly as possible and minimize the probability of spontaneous resistance-conferring mutations22,23. Non-genetic cell plasticity fundamentally confounds the reasoning behind this strategy, especially if it is induced by the drug. First, if drug-tolerant states are adopted independently of the drug, it is likely that drug-tolerant cells will preexist treatment in large numbers, even if they form only a small fraction of the tumor bulk5. In addition, since non-genetic mechanisms usually operate much faster than genetic mutations4,5,24, a non-negligible fraction of drug-sensitive cells will adopt drug tolerance under treatment. This means that it can be impossible to kill the tumor, no matter how large a dose is applied14. Second, if the drug induces tolerance adoption in a dose-dependent manner, applying larger doses with the aim of maximizing cell kill has the downside of promoting resistance evolution. This trade-off has been explored in several recent mathematical modeling works, which generally find that continuous low-dose or intermittent strategies outperform MTD treatment25–30. However, these works usually focus on one potential model of drug-induced tolerance and some only consider the case of irreversible genetic resistance. In addition, many of these works only consider constant or intermittent strategies. Overall, there is a lack of generalized insights into how different potential forms of drug-induced tolerance influence optimal treatment decisions.

In this work, we seek a more systematic understanding of optimal dosing strategies under drug-induced cell plasticity. We seek both a qualitative understanding of the characteristics of optimal strategies and simple quantitative methods for computing them. We consider many different possible forms of drug-induced tolerance and explore how and why different forms lead to different optimal strategies. Our work differs from previous work in several important ways. First, whereas prior work generally assumes that tolerance is induced through elevated transitions from drug-sensitivity to drug-tolerance, it is also biologically plausible that the drug inhibits transitions from tolerance back to sensitivity, or that it affects both transitions simultaneously. For example, hypermethylation in the promoter regions of tumor suppressor genes has been associated with gene silencing and drug resistance in many cancers1,4,31,32. When a cell divides, existing methylation patterns are preserved by the maintenance methyltransferase DNMT1, while de novo methylation is carried out by the methyltransferases DNMT3A/3B33,34. If a drug-tolerant state is conferred via methylation, drug-induced upregulation of DNMT3A/3B will induce the adoption of the tolerant state, while drug-induced upregulation of DNMT1 will inhibit transitions out of it. The notion that the drug may not only elevate transitions from sensitivity to tolerance is further supported by experimental evidence indicating that the drug can influence all possible phenotypic transitions simultaneously8,12,16. Second, whereas many prior works assume that the level of tolerance induction is linear as a function of the drug dose, we also consider the case where tolerance is induced uniformly in the presence of drug. These two forms of drug-induced tolerance were observed in a recent experimental work by Russo et al.17, and they emerge as limiting cases of a more general Michaelis-Menten form of tolerance induction (Methods). Third, while most previous work is computational in nature, we establish mathematical results which provide generalized insights that apply across all biologically relevant parameter regimes. Finally, whereas some previous works focus on irreversible transitions from drug-sensitivity to drug-resistance, we study the case of reversible phenotypic switching between sensitivity and tolerance. Our results are compared with previous work in more detail in Supplementary Note1.

We propose a mathematical model of a tumor undergoing anti-cancer drug treatment, in which cells are able to transition between two cell states, a drug-sensitive (type-0) and a drug-tolerant (type-1) state. Cells of type-idivide at ratebiand die at ratedi, with net division rateλi=bi−di. Each drug-sensitive cell is assumed to transition to the drug-tolerant state at rateμ, and each tolerant cell transitions back to the sensitive state at rateν(Fig.1a). To model the effect of the drug on cell proliferation, we assume that the sensitive cell death rated0(c) increases with the drug dosec(Fig.1b). Equivalently, it can be assumed that the drug decreases the division rate of sensitive cells (Methods). To model drug-induced tolerance, the transition ratesμ(c) andν(c) between sensitivity and tolerance are assumed to depend on the drug dosec, either in a linear or uniform fashion (Fig.1c, d). A detailed description of the mathematical model is provided in the Methods section.

aIn the mathematical model, cells transition between two states, a drug-sensitive (type-0) state and a drug-tolerant (type-1) state. Sensitive cells divide at rateb0, die at rated0and transition to tolerance at rateμ. Tolerant cells divide at rateb1, die at rated1and transition to sensitivity at rateν. The sensitive cell death rated0and the transition ratesμandνdepend on the drug dosec.bThe sensitive cell death rate follows a Michaelis-Menten equation of the formd0(c)=d0+(dmax−d0)c/(c+1), whered0is the death rate in the absence of drug anddmaxis the saturation death rate under an arbitrarily large drug dose. The dosecis normalized to the EC50dose ford0, meaning that the drug has half the maximal effect at dosec= 1.cThe transition rateμ(c) from drug-sensitivity to drug-tolerance is assumed either a linearly increasing function ofcor to be uniformly elevated in the presence of drug. These two forms of drug-induced tolerance were observed in a recent study by Russo et al.17and they also emerge as limiting cases of more general Michaelis-Menten dynamics.dThe transition rateν(c) from drug-tolerance to drug-sensitivity is similarly assumed either a linearly decreasing function ofcor uniformly inhibited in the presence of drug.

Thus, under a constant dosec, it is possible to maintain the tumor at a stable intratumor composition, which leads to a fixed exponential growth rateσ(c) (Methods).

We consider a dosing strategy (c(t))t∈[0,T]optimal if it minimizes the total number of cells,n0(T) +n1(T), at the end of a finite time horizon [0,T]. When analyzing which dosing strategy is optimal in the long run, we also consider an infinite-horizon problem where the goal is to minimize the long-run average tumor growth rate (Methods). We can show that to determine the optimal strategy, it is sufficient to consider its effect on the proportion of sensitive cellsf0(t) over time, as opposed to its effect on the individual subpopulation countsn0(t) andn1(t) (Methods). This enables us to reduce an optimal control problem involving two state variablesn0(t) andn1(t) to a single-state-variable problem, which simplifies our computational algorithms and mathematical analysis. In line with this insight, we use the proportion of sensitive cells over time to demonstrate the effects of optimal dosing strategies on tumor evolution in the following sections.

We now investigate optimal dosing strategies under linear induction of tolerance. We consider three cases, depicted in Fig.2a, depending on whether the drug only affects transitions from sensitivity to tolerance (Case I), it only affects transitions from tolerance to sensitivity (Case II), or it affects both transitions simultaneously (Case III). In Fig.2b, we show the optimal strategy for each case, computed using our own implementation of the forward–backward sweep method in MATLAB (Methods). For Case I, the optimal strategy applies a constant low dosec* from the beginning. For Case II, the optimal strategy starts with the maximum dosecmax, and then gradually decreases it to a constant low dosec*. In this case, higher doses can be used at the onset of treatment to reduce the predominantly sensitive tumor more quickly, without the downside of promoting transitions from sensitivity to tolerance. For Case III, the optimal strategy has characteristics of both previous cases, as it does apply larger doses in the beginning, but it does not start with the maximum dose.

aIn our investigation of linear induction of tolerance, we consider three cases. In Case I, the drug only increases the transition rate from sensitivity to tolerance (μ(c) =μ0;+kcandν(c) =ν0), in Case II, the drug only decreases the transition rate from tolerance to sensitivity (μ(c) =μ0andν(c) =ν0−mc), and in Case III, the drug does both (μ(c) =μ0+kcandν(c) =ν0−mc).bOptimal dosing strategies under linear induction of tolerance computed using the forward-backward sweep method. In all cases, the optimal dosing strategy involves both a transient phase and an equilibrium phase. During the equilibrium phase, a constant dosec* is applied, which minimizes the long-run tumor growth rateσ(c) under a constant dosec, as indicated by the dotted lines. The grayed-out part of each dosing strategy is a boundary effect which arises due to the optimization goal of minimizing the tumor size at a specific timeT, with no regard for what is best in the long run. If we were to extend the treatment horizon beyond timeT, the period applying the constant dosec* would be extended (Supplementary Fig.1). We therefore ignore this boundary effect and focus on what is optimal over a longer time horizon.cProportion of sensitive cellsf0(t) over time under the optimal dosing strategy. The constant equilibrium dosec* maintains the tumor at a fixed proportion between sensitive and tolerant cells.dTumor size evolution under the optimal strategy compared with the tumor size evolution under the constant-dose strategy applyingc* throughout. For Case I, the two strategies are the same. For Cases II/III, the optimal strategy results in 85.6%/55.4% greater tumor reduction during the initial stages of treatment, and 59.4%/24.2% greater reduction long-term.eIf the proportion of sensitive cellsf0(0) at the start of treatment is changed, only the transient phase of the optimal treatment is affected, whereas the optimal equilibrium dosec* remains the same. For Case I, the transient phase is independent of the initial condition.

By combining these results with mathematical analysis, we can derive several general treatment insights. First, the optimal dosing strategy always involves both a transient phase and an equilibrium phase. During the equilibrium phase, a constant dosec* is applied, which maintains the tumor at a fixed proportion between sensitive and tolerant cells (Fig.2(c)). This is true irrespective of the model parameter values (Supplementary Note1). To demonstrate the importance of distinguishing these two treatment phases, we compare in Fig.2d the optimal strategy with the constant-dose strategy applying the equilibrium dosec* throughout. Eventually, the tumor reduces at the same exponential rate under both strategies. However, during the transient phase, the optimal strategy reduces the tumor much faster for Cases II and III, and this difference in tumor size is maintained throughout the course of treatment.

Second, we can prove mathematically that the optimal equilibrium dosec* minimizes the long-run tumor growth rateσ(c) under a constant dosec(Supplementary Note1). This means that the explicit expression (1) forσ(c) has clinical value on its own, as it can be used to address questions concerning ultimate treatment success. For example, if for a particular cancer type and a particular drug, we are interested in knowing whether there existsanydosing schedule capable of driving long-run tumor reduction (however complicated), we simply need to check whether there exists a constant dosecsuch thatσ(c) < 0. We also note that since the equilibrium dosec* is determined by long-run tumor growth dynamics, it is not affected by changes in the initial proportion between sensitive and tolerant cells (Fig.2e).

whereu(c,f0) = (λ0(c) −λ1)f0+λ1is the instantaneous tumor growth rate (Supplementary Note1). Applying the maximum dosecmaxthroughout the transient phase would kill the sensitive cells as quickly as possible, which would lead to the lowest possible growth rateu(c,f0) and thus the largest possible numerator in (3). However, the maximum dose would simultaneously induce a large number of sensitive cells to adopt tolerance, which would lead to a large reduction−f0′in the proportion of sensitive cells in the denominator of (3). Overall, expression (3) describes precisely how the optimal strategy must balance the trade-off between sensitive cell kill and tolerance induction as it steers the tumor to the optimal equilibrium composition.

Finally, our mathematical analysis suggests a simple and efficient method to compute the optimal dosing strategy, which simultaneously provides an insight into how the doses are selected. First, the optimal equilibrium dosec* can be derived by minimizing expression (1), and the associated equilibrium proportion of sensitive cellsf¯0(c*)can be computed using expression (2). Then, the transient phase of the optimal strategy can be computed by iteratively determining the maximizing dosecin (3) and updating the value off0, as visualized in Supplementary Fig.2a. In Supplementary Fig.2b, we confirm that the transient phase computed using this approach agrees with the transient phase shown in Fig.2(obtained using the forward-backward sweep method).

Under linear induction of tolerance, it is optimal in the long run to expose the tumor continuously to the drug at a majority drug-tolerant composition. We are next interested in investigating how the optimal treatment compares with pulsed treatments, where the tumor is taken periodically off drug to allow tolerant cells to revert back to sensitivity. This comparison is made using the long-run average growth rate of the tumor (Methods).

We consider a pulsed schedule as a triple (c,tcycle,φ) encoding the drug dosec, the duration of each treatment cycletcycle, and the proportion of timeφthe drug is applied during each cycle. A constant schedule is considered a pulsed schedule withφ= 1. It is relatively simple to show that in our model, for any pulsed schedule (c,tcycle,φ1), there exists a schedule (c,tcycle/2,φ2) with half the cycle length which yields the same or lower long-run growth rate (Supplementary Note1). Therefore, when investigating pulsed schedules, it is sufficient to consider idealized schedules with an arbitrarily short cycle length. However, it is also simple to show that once the cycle length has become sufficiently small, the long-run average growth rate becomes effectively invariant to the cycle length (Supplementary Note1). Thus, even if the best pulsed schedule involves switching arbitrarily fast between drug and no drug, a comparable outcome can be obtained using a much longer cycle time. This is an important insight, as it means that the model-recommended pulsed schedule is more clinically feasible.

For a given pulsed schedule (c,φ) with an arbitrarily short cycle length, the long-run average growth rate of the tumor can be computed using the relatively simple formula (24). In Fig.3a, we show the long-run growth rate for a wide range of possible pulsed schedules (c,φ) under Cases I, II and III. The red lines show for each proportionφof drug exposure the optimal dosec*(φ) to administer, and the red dots indicate the optimal schedules. As expected, a constant low dose is optimal in the long run. Figure3b, c show that for all three cases, the optimal schedule is quite sensitive to the duration of drug exposure. Instituting treatment breaks of 20–30% or longer results in a significantly larger tumor growth rate and a larger average dose being required to achieve that growth rate. From a clinical perspective, understanding to what extent the optimal strategy can be perturbed to insert treatment breaks can be useful for reducing potential side effects of continuous drug exposure. Plots like those in Fig.3could help a clinician understand the implications of instituting treatment breaks of a certain length, and to determine which dose is best for that length.

aLong-run average growth rate of the tumor under a range of possible pulsed schedules of the form (c,φ), wherecis the drug dose applied andφis the proportion of drug exposure. The red curves show for each exposure proportionφthe optimal dosec*(φ) to give. The red dots show the optimal pulsed schedules, which are continuous for Cases I, II and III, consistent with our results in Fig.2.bLong-run average growth rate under the optimal dosec*(φ), shown as a function of the proportionφof drug exposure.cAverage dose applied during each treatment cycle under the optimal dosec*(φ), shown as a function of the proportionφof drug exposure, normalized to the average dose under the optimal schedule.

We now consider the case where drug tolerance is induced in a uniform fashion, meaning that the drug effect is constant whenever the drug is present. In this case, the forward–backward sweep method does not converge to a unique solution, due to the discontinuity of the transition rate functionsμ(c) andν(c). We therefore rely on mathematical analysis.

First, we can show that in the long run, it is optimal to apply a pulsed schedule alternating arbitrarily quickly between the maximum dosecmaxand no dose (Supplementary Note1). To verify this result computationally, we compare in Fig.4b the long-run average tumor growth rate over a wide range of possible pulsed schedules (c,φ). For each given proportion of drug exposureφ, it is optimal to apply the maximum dosecmaxwhenever the drug is present, as indicated by the red lines. For Case I, it is optimal to apply the maximum dose continuously, and for Cases II and III, it is optimal to alternate between the maximum dose and no dose, as indicated by the red dots. Thus, whereas low continuous dosing is optimal in the long run for linear induction of tolerance, for uniform induction, it is optimal to apply the maximum dose either continuously or intermittently. This result is intuitive since under uniform induction, once any drug dose is applied, there is no downside in applying a larger dose.

aIn our investigation of uniform induction of tolerance, we consider three cases. In Case I, the drug only increases the transition rate from sensitivity to tolerance (μ(0) =μ0andμ(c)=μmaxforc> 0,ν(c) =ν0forc≥ 0), in Case II, the drug only decreases the transition rate from tolerance to sensitivity (μ(c) =μ0forc≥ 0,ν(0) =ν0andν(c)=νminforc> 0), and in Case III, the drug does both (μ(0) =μ0andμ(c)=μmaxforc> 0,ν(0) =ν0andν(c)=νminforc> 0).bThe heatmaps show the long-run average tumor growth rate for a range of possible pulsed schedules of the form (c,φ) for Cases I, II and III. The red curves show each for exposure proportionφthe optimal dosec*(φ) to give, and the red dots show the optimal pulsed schedules. For each possible exposure proportionφ, it is optimal to apply the maximum dosecmax. For Case I, where the drug only affects transitions from sensitivity to tolerance, it is optimal to apply the maximum dose continuously. For Cases II and III, it is optimal to alternate between the maximum dose and no dose.cUnder uniform induction of tolerance, we can prove that during the transient phase, it is optimal to apply the maximum dose throughout, and during the equilibrium phase, it is optimal to apply a pulsed schedule(cmax,φ)alternating between the maximum allowed dosecmaxand no dose (possibly withφ= 1). Examples of optimal strategies are shown for Cases I, II and III. For Case I, where the drug only increases transitions from sensitivity to tolerance, it is optimal to apply the maximum dose continuously throughout the entire treatment period.dProportion of sensitive cellsf0(t) over time under the optimal dosing strategy. Same as for linear induction of tolerance, the optimal dosing strategy maintains the tumor at a fixed proportion between sensitive and tolerant cells in the long run.

Second, we can show that the optimal transient strategy is to apply the maximum dosecmaxcontinuously under Cases I, II and III (Supplementary Note1). This enables us to derive optimal dosing strategies for all cases under uniform induction of tolerance (Fig.4c). For Case I, it is optimal to apply the maximum dosecmaxcontinuously from the beginning. This implies that drug-induced tolerance does not necessarily call for low or intermittent dosing. For Cases II and III, it is optimal to start with the maximum dose and then alternate between the maximum dose and no dose. For all cases, the optimal strategy eventually maintains the tumor at a fixed composition between sensitive and tolerant cells (Fig.4d). Thus, same as for the case of linear induction, the optimal strategy involves a transient and an equilibrium phase, where the goal of the transient phase is to steer the tumor to a desired composition, and the goal of the equilibrium phase is to maintain it at that composition.

In this section, we have referred to a strategy alternating arbitrarily quickly between the maximum dose and no dose as the optimal long-run strategy. Since this is an idealized schedule, it is more precise to say that there exists a sequence of pulsed strategies which achieve the optimal long-run growth rate astcycleapproaches zero. However, same as for the case of linear induction, the cycle length can be extended significantly without affecting the long-run average growth rate of the tumor (Supplementary Note1).

Linear and uniform induction of tolerance represent extreme cases where the level of tolerance induction either increases gradually with the dose or is insensitive to the dose. In the former case, lower doses are generally preferred, whereas in the latter case, the maximum dose should be applied whenever the drug is present. If a clinician understands which case applies better to a particular cancer type, for example, based on experience with prior patients, these general insights can help guide clinical decision-making. If the biological mechanism of drug-induced tolerance is furthermore known, it may become possible to distinguish between Cases I, II and III. For linear induction, this can help decide whether to apply low or high doses during the initial stages of treatment, and for uniform induction, it can help decide whether to apply the maximum dose continuously or intermittently in the long run.

Our approach can yield even more specific clinical insights when integrated with experiments involving in vitro models of patient tumors. Technologies to derive clinically relevant cell culture models from patient tumor samples are advancing rapidly35–39, and their development has recently been put into focus by the FDA Modernization Act 2.0, which seeks to replace animal models in drug safety and effectiveness testing by in vitro human cell models and in silico computational modeling40–42. As a case study, we now apply our insights to in vitro experiments from Russo et al.17, where the authors treated two colorectal cancer cell lines with increasing doses of anti-cancer agents. They found that when BRAF V600-E mutated WiDr colorectal cancer cells were treated with a combination of dabrafenib and cetuximab, the drugs linearly induced transitions from a drug-sensitive to a drug-persistent state (Case I under linear induction). For RAS/RAF wild-type DiFi cells treated with cetuximab, the drug uniformly induced the same transitions (Case I under uniform induction). We assume that the drug does not affect transitions from persistence to sensitivity, since no such effect is indicated in ref.17.

According to our analysis in the previous section, we already know that for the DiFi cells, it is optimal to apply the maximum dose continuously. We therefore focus on the WiDr cells and compare the optimal strategy with dosing regimens considered in ref.17. For the purposes of this analysis, we adopt the model of drug effect on cell proliferation from ref.17(Methods). As expected from our analysis in the section on linear induction of tolerance, the optimal strategy over a treatment horizon ofT= 100 days applies a constant dose from the beginning (Fig.5a). The optimal dose is even smaller here than for the examples considered in Fig.2orc* = 0.85 as a proportion of theEC50ddose (in absolute terms, theEC50ddose is 2.3779 × 10−7Mand the optimal dose is 2 × 10−7M). One reason that the optimal dose is lower than theEC50ddose in this case is that the dose at which the net sensitive cell division rateλ0(c) becomes negative is much smaller than theEC50ddose, meaning that the tumor reduces in size even atc* = 0.85 (Methods).

aFor BRAF V600-E mutated WiDr cells, Russo et al.17observed linearly increasing transitions from sensitivity to tolerance under dabrafenib + cetuximab treatment. Under a sufficiently long time horizon, the optimal dosing strategy applies a low constant dose equal to 85% of theEC50ddose.bIn ref.17, the authors consider both a constant strategy and a linearly increasing strategy with average dosec¯=4.2(relative to theEC50ddose) using a time horizon ofT= 10 days. The optimal strategy overT= 10 days applies small doses during most of the period and increases the dose towards the end of the horizon.cThe linearly increasing schedule with average dosec¯=4.2outperforms the constant-dose schedule with the same average dose in terms of tumor reduction overT= 10 days, which is consistent with the results of ref.17. However, the optimal strategy overT= 10 days achieves a 19% greater tumor reduction while applying half as much dose. Moreover, the optimal long-run constant dosec* = 0.85 achieves similar tumor reduction to the linear strategy at less than 20% of the cumulative dose.dOut of the four schedules considered in partb, the optimal long-run constant dosec* = 0.85 induces the fewest sensitive cells to adopt persistence overT= 10 days.

In ref.17, the authors considered a shorter time horizon ofT= 10 days, and they compared a constant dose schedule withc= 4.2, relative to theEC50ddose, with a linearly increasing dose schedule involving the same average dosec¯=4.2over the horizon (Fig.5b). They observed that the linearly increasing schedule significantly outperformed the constant-dose schedule, which is confirmed by our analysis (Fig.5c). However, we note that the considerable preference for the linear schedule is due to the constant-dose schedule withc= 4.2 being significantly suboptimal. For example, the long-run optimal dosec* = 0.85 leads to a similar tumor decay overT= 10 days as the linear schedule withc¯=4.2(Fig.5c). The optimal short-term strategy overT= 10 days applies small doses for most of the period, starting atc= 0.90, before increasing the dose at the very end (Fig.5b). The optimal short-term strategy achieves a 19% greater tumor reduction than the linear strategy, while applying less than half as much cumulative dose, orc¯=2.0on average.

Here, we have evaluated the treatment schedules in terms of the tumor size at the end of the treatment horizon. In ref.17, the authors considered a different metric of treatment success, the number of persister cells induced under treatment, assuming no persister cells at the beginning of treatment. Even under this metric, the optimal short-term strategy outperforms the linearly increasing schedule, and in fact, the optimal long-run dosec* = 0.85 performs the best (Fig.5d). From one perspective, this is not surprising, since if the goal is to minimize the number of sensitive cells that the drug induces to adopt persistence, it is optimal to give no drug and thus induce no sensitive cells to adopt persistence. On the other hand, the fact that the optimal long-run dose induces fewer persister cells than the other three schedules in the short term is precisely why it is better in the long run.

In summary, the constant-dose strategy withc= 0.85 is both successful at restricting persister evolution in the short term and optimally controlling the tumor in the long term. In addition, it applies around an 80% lower cumulative dose than the linear schedule with average dosec¯=4.2. These results show how applying our approach to experiments involving in vitro models of patient tumors can yield individualized clinical insights. Determining the optimal dose, understanding how it affects the tumor in the short and long term, and comparing it with other potential dosing strategies would be difficult without the mathematical model.

In this work, we have investigated optimal dosing of anti-cancer treatment under drug-induced plasticity. We found that the optimal strategy always involves both a transient phase and an equilibrium phase, where during the equilibrium phase, the tumor is maintained at a fixed intratumor composition that minimizes its long-run growth rate. Under linear induction of tolerance, the optimal equilibrium strategy is to apply a low constant dose, while under uniform induction of tolerance, it is optimal to apply the maximum dose either continuously or intermittently. We proved this mathematically and provided simple methods for computing the optimal strategies. We also showed that during the transient phase, the optimal strategy steers the tumor to the desired long-run composition while precisely balancing the trade-off between cell kill and tolerance induction. We discussed how these general insights can help guide clinical decision-making, and we showed how more specific insights can be obtained by integrating our methodology with experiments involving in vitro models of patient tumors.

We view this work as an initial step towards a more complete understanding of optimal dosing under drug-induced plasticity. We have left many important questions unaddressed which serve as a guide for future work. First, we have only considered the extreme cases where drug tolerance is induced in a linear or uniform fashion. If the transition rate functionsμ(c) andν(c) follow more general Michaelis-Menten or Hill dynamics43, it may be difficult to apply optimal control analysis, but the optimal pulsed strategy can always be determined using the explicit expression (24). Second, while we have assumed that cells transition directly between a drug-sensitive and a drug-tolerant state, these transitions may occur through intermediate states or in a more continuous fashion. In addition, there is evidence that prolonged drug exposure can induce epigenetic reprogramming of tolerant cells and eventually lead to stable drug resistance7,11. Tolerant cells can furthermore form a reservoir for the evolution of eventual genetic resistance9,10,17. This suggests the need to include more cell states in the model, which is easily accommodated within our framework and we plan to do in future work. Alternatively, the cell state can be treated as a continuous variable, representing gradual evolution towards resistance44–48. Nevertheless, we believe that our analysis of the dynamics between sensitive and tolerant cells yields valuable insights that will be useful for understanding the more complex dynamics. Third, we have considered an exponential growth model without competitive or cooperative dynamics. If tumor growth is constrained by a carrying capacity, our insights will continue to hold whenever it is possible to kill the tumor, since then the carrying capacity will not significantly affect the dynamics. However, if recurrence cannot be avoided, it may become optimal to keep the tumor close to the carrying capacity, in order to avoid releasing tolerant cells from competition with sensitive cells25,27,49. This will be important to explore in future work. Finally, we have equated drug dose with drug concentration throughout and ignored the effect of pharmacokinetics, as well as unwanted toxic side effects of the drug. Confirming the clinical applicability of our approach would require an investigation of these dynamics, particularly for the case of uniform tolerance induction, where the dynamics are significantly different depending on whether the drug is present or not.

Taking full advantage of our approach for a specific cancer type or a specific patient requires understanding the quantitative dynamics of drug induction for that specific case. Russo et al.17have suggested a Bayesian approach for inferring the transition rate functionμ(c) from sensitivity to tolerance using in vitro tumor bulk data, but their work only distinguishes between the extreme cases of linear and uniform induction of tolerance. In a recent work, we have suggested a maximum likelihood framework for inferring more general dose-response dynamics forμ(c) based on the Hill equation50. However, as we have discussed, it is also plausible that the drug inhibits the transition rateν(c) from tolerance back to sensitivity, or that the drug simultaneously affects both rates. In general, the present work shows that the optimal strategy varies significantly depending on the exact dynamics of tolerance induction. This suggests the need to develop integrated experimental and mathematical tools capable of jointly inferringd0(c),μ(c) andν(c) from experimental data, which may require data on the phenotypic composition of the tumor51. Ultimately, these integrated tools can help usher in a new era of precision medicine, where the dynamics of drug induction are determined and dosing strategies are optimized on an individual patient basis52,53.

Our baseline model is a multi-type branching process model in continuous time54. In the model, cells switch stochastically between two distinct cell states, a drug-sensitive (type-0) and a drug-tolerant (type-1) state. In the absence of drug, a type-0 cell divides into two type-0 cells at rateb0, it dies at rated0,and it transitions to the tolerant type-1 state at rateμ> 0. More precisely, each type-0 cell waits an exponentially distributed amount of time with ratea0≔b0+d0+μbefore it either divides with probabilityb0/a0, dies with probabilityd0/a0, or transitions to type-1 with probabilityμ/a0. A type-1 cell divides at rateb1, it dies at rated1, and it reverts to type-0 at rateν> 0 (Fig.1a). The net birth rates of the two types are denoted byλ0≔b1−d1andλ1≔b1−d1.

Here,d0is the sensitive cell death rate in the absence of drug,dmaxis the saturation death rate under an arbitrarily large drug dose,Δd0:=dmax−d0≥0is their difference, andEC50dis the dose at which the drug has half the maximal effect on sensitive cell proliferation. Note that we write simplyd0instead ofd0(0) to signify the death rate in the absence of drug. The function in (4) is concave, but it is worth noting that if the the drug dose is viewed on a log scale, then (4) becomes anS-shaped dose-response curve which is characteristic of viability curves in the biological literature (Fig.6).

The Michaelis-Menten function (4) describing the drug effect on cell proliferation is concave in the drug dosec(left panel). When the dosecis viewed on a log scale, the function becomes takes on anS-shape which is characteristic of viability curves in the biological literature (right panel).

In other words,μis effectively constant in the presence of drug.

μ(c) =μ0+kc, wherek≥ 0 (tolerance is linearly induced).

μ(0) =μ0andμ(c)=μmaxforc> 0 (tolerance is uniformly induced).

The reason we focus on these two extremes is twofold. First, these two exact forms were observed empirically in the recent investigation by Russo et al.17, which is the only work we know of which has attempted to quantify drug-induced tolerance in a dose-dependent manner using in vitro data. Second, due to their simplicity relative to the general case (7), we are able to establish rigorous mathematical results on optimal dosing strategies.

By assumption,νis a decreasing function ofc, since we are modeling the case where the drug inhibits transitions from drug-tolerance to drug-sensitivity.

Throughout, we assume thatμ0> 0 andν0> 0, meaning that cells are able to transition between the two states even in the absence of drug.

which will be an important quantity in our investigation of optimal treatment strategies.

When we are considering a constant treatment,c(t) =c, we will writeσ(c) andf¯0(c)to explicitly denote the dependence on the dosec. For detailed derivations of the above formulas, we refer to Appendix A.2 of our previous work14.

wherec:[0,∞)→[0,cmax]is considered a treatment with an infinite time horizon.

We discretize time and consider a set of time pointsT=[0,t1,t2,…,T].

We make an initial guess for the optimal policy(c(t))t∈T. We simply usec(t) = 0 for allt∈T.

We solve (19) using the initial conditionf0(0) =α, assuming the initial guess for(c(t))t∈T.

We solve (20)backwards in timeusing the initial conditionγ(T) = 0, assuming the initial guess for(c(t))t∈Tand the trajectory for(f0(t))t∈Tfrom step (3).

Figure2shows optimal dosing strategies under linear induction of tolerance computed using our implementation of the forward-backward sweep method. These results are consistent with computations obtained using the Dymos optimal control library in Python together with the IPOPT solver, as shown in Supplementary Fig.3.

Our computational results are shown using a parametrization of the model inspired by experimental investigations of drug tolerance in cancer and bacteria. The parameter values are shown in Table1. First, we assume that in the absence of drug, the proliferation rate of sensitive cells isλ0= 0.04, and that the maximal drug effect on the death rate is Δd0= 0.08. Our motivating example is PC9 cells treated with a large dose of erlotinib, for which the proliferation rate of sensitive cells in the absence of drug has been estimated asλ0= 0.04 per h and the drug effect as Δd0= 0.08 per h14. We note that for a cohort of patients with metastatic melanoma treated with vemurafenib, the typical value ofλ0was 0.01 per day and the typical drug effect was Δd0= 0.04 per day. Thus, the time unit for the baseline regime can be considered to be hours in the in vitro setting and days in the clinical setting.

Second, we assume that in the absence of drug,λ1≪λ0, meaning that the drug-tolerant cells proliferate much slower than the drug-sensitive cells, and that they only make up a small proportion of the tumor at the start of the treatment. This is consistent with experimental evidence showing that drug-tolerant cells are generally slow-cycling7,10,11,15,57,58. Third, we assume thatμ0≪λ0, meaning that transitions from sensitivity to tolerance are rare compared to cell divisions. This is consistent with evidence that epigenetic modifications are commonly retained for 10 − 105cell divisions59–61. Fourth, we assume thatν0is significantly larger thanμ0, meaning that the tolerant state is lost faster than it is adopted. This is consistent with experimental evidence both from cancer62,63and bacteria64.

In Figs.2and3, we assume thatk=m= 0.0004 and that the maximum allowable dose iscmax=10as a proportion of theEC50ddose. In Fig.4, we assume that Δμ= 0.004, Δν= 0.003 andcmax=10. Unless otherwise noted, we assume that the proportion of sensitive cells at the start of treatment is the equilibrium proportionf¯0(0)in the absence of drug.

We note that with this parametrization, the net growth rate of tolerant cells taking phenotypic switching into account isλ1−ν0= −0.003 < 0. Thus, in the presence of drug, the tolerant population decays over time, but much slower than the sensitive cells.

We note that this version ofd0(c) is concave inc, same as the functional form we assume in the section on the drug effect on cell proliferation above.

which yieldsc=−log(−b/a)/log(2). This is the solution we use in the fifth step.

In Russo et al.17, the authors assume no transitions from sensitivity to tolerance in the absence of drug,μ0= 0. For the WiDr cell line (clone B7), their point estimate for the proportion of sensitive cells at the start of treatment is 0.992, which would indicate transitions between phenotypes before treatment. However, the proportion is indistinguishable from zero when statistical uncertainty is taken into account. The authors point out that transitions from tolerance to sensitivity may occur even in the presence of drug, but that these transitions would effectively contribute to the death rate of tolerant cells. Overall, it is uncertain to what extent cells transition between sensitivity and tolerance in the absence of drug.

To be consistent with our modeling framework, we assume transitions between types do occur in the absence of drug, so that they lead to an equilibrium proportionf¯0(0)=0.992of sensitive cells in the absence of drug. This leads us to takeμ0= 0.001,λ1= 0 andν0= 0.073, which is still consistent with Russo et al.’s finding that drug tolerance is primarily induced by the drug and thatλ1−ν0= −0.073. A summary of the parameter values used for our analysis of the Russo et al. model is given in Table2.

The work of E.B.G. was supported in part by NIH/NCI grant R01 CA241137. The work of J.F. was supported in part by NSF grants CMMI-2228034 and DMS-2052465.