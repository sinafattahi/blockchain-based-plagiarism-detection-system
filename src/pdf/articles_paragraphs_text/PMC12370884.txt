Effective management of non-specific chronic lower back pain (ns-cLBP) requires nuanced prescription decisions within evolving guidelines for conservative treatment. This study developed comprehensive LBP patient profiles from electronic medical records (EMR), integrating clinical charts (demographics, social determinants, diagnoses, medications) and radiology reports (MRI-confirmed diagnoses) to predict pharmacological management strategies. One-vs-one and one-vs-rest classification frameworks systematically evaluated treatment decisions across three prescriptions: no medication, NSAIDs, and opioids. Real-world complexity and heterogeneity in ns-cLBP management was reflected in modest yet clinically meaningful performance metrics (balanced accuracy = 0.58, AUC = 0.62, F1-score = 0.42). Chart-documented diagnoses marginally outperformed MRI-reported pathology as predictors, though this difference was within the range of variability, which suggests the importance of diagnoses informed by patient-reported symptoms in shaping treatment pathways. SHAP feature importance analysis identified consistent predictors (year_at_first_imaging) and variable factors (spinal_stenosis,disc_pathology,race_ethnicity,negative_psych_state,osteoarthritis_osteoarthrosis) in prescriptions, with higher associations observed in those with anxiety or depression, partnered individuals and females. By leveraging explainable AI, this study quantifies the interplay between biological and psychosocial drivers of prescribing decisions, offering a transparent, data-driven monitoring tool for understanding in chronic pain care. These findings demonstrate the potential of multi-modal EMR data and interpretable models to guide more personalized, equitable ns-cLBP management and opioid prescriptions.

Lower back pain (LBP) represents a global health crisis, affecting 619 million people worldwide as the leading cause of years lived with disability. This debilitating condition incurs considerable socioeconomic burden due to healthcare costs and individuals’ loss of productivity1–3.

The challenge of managing LBP arises in its complex, multifaceted nature. While some cases are attributed to specific pathologies, many persistent cases are classified as non-specific chronic low back pain (ns-cLBP), where traditional diagnostic approaches fail to reveal a single causative and addressable pathology4,5. Current clinical practice guidelines advocate for a biopsychosocial approach6, acknowledging the complex interplay between patient-reported symptoms, imaging findings, and intervention risks7,8consistent with general pain management9. This comprehensive framework relies primarily on physical examination and patient history5,10, reserving imaging for cases with red flags or persistent pain beyond 4–6 weeks5,11. However, time constraints can limit discussion of thorough patient history and treatment options, and imaging findings have shown weak correlation with LBP12. Despite existing research-supported guidelines, their implementation in clinical practice remains inconsistent13–15with imaging often overutilized5, highlighting a critical gap between recommended and actual care.

The treatment landscape for LBP presents an even more compelling challenge. Standard conservative approaches often prove insufficient for many patients who experience chronic pain in conjunction with multi-tissue degeneration of the spine4, with minimal advancements in treatment options16. This therapeutic void has led to increased reliance on pharmacological interventions, particularly non-steroid anti-inflammatory drugs (NSAIDs) and opioids. However, the role of opioids ns-cLBP management has come under intense scrutiny due to limited evidence supporting their long-term efficacy and established concerns about addiction and overdose risks4,17. While current guidelines recommend alternative medications as a first line of defense, actual opioid prescription patterns appear to be heavily influenced by individual clinical behavior18and social determinants of health19,20, suggesting a more complex decision-making process than previously recognized.

Recent technological advances offer a promising path towards personalized medicine through the assessment of patient characteristics that influence pharmacological management in ns-cLBP. The emergence of multi-modal electronic medical record (EMR) databases and explainable AI21,22have created unprecedented opportunities to analyze real-world ns-cLBP treatment patterns at scale23. Modern large language models (LLMs) can now extract nuanced pathology descriptors from clinical notes24, while interpretable AI frameworks, like SHapely Additive ePlanations (SHAP)25, provide quantitative assessments of factors influencing clinical outcomes26. Despite these innovations, no prior study has attempted to predict opioid medication prescription for LBP management, rather most classification studies focus on LBP diagnosis or prognosis27. The only related work assessed opioid prescription in the context of opioid use disorder28.

This study provides the first comprehensive evaluation on how tissue pathology interacts with social determinants of health in driving medication prescriptions for clinical ns-cLBP patients, through systematic comparison of machine learning models and SHAP-based feature importance.

Comprehensive clinically informed LBP patient profilesconstructed from multi-modal electronic medical records (EMRs), including structured tabular medical chart data and radiology report texts.

Tree-based classification algorithmstrained to predict no, NSAID, and opioid medication prescription using one-vs-one (OVO) and one-vs-rest (OVR) strategies, offering a data-driven perspective on the biopsychosocial factors influencing ns-cLBP intervention. Unlike conventional methods that focus primarily on treatment efficacy, these algorithms reveal medical policies shaping historical prescription patterns.

SHAP-based feature importance assessmentquantified key characteristics associated with medication prescription pathways, offering population-level benchmarks to compare with evidence-based guidelines and to identify underserved target populations for prescribing interventions.

By leveraging advanced natural language processing and machine learning approaches, we aim to uncover associations between patient characteristics and treatment selection behavior. This work presents a transparent, data-driven framework for clinical insights into both pathological and psychosocial drivers of opioid prescription practices, identifies specific EMR documentation improvements needed for AI-assisted decision making, and provides a reference for future initiatives to advance conservative care in ns-cLBP.

Clinically informed selection criteria identified 4,077 ns-cLBP patients from the EMR of whom 3,286 had a radiology report. Patient prescription distributions aligned with clinical guidelines that favor conservative management spanning no pharmacological intervention (52%), NSAIDs (37%), or opioids (11%) (Fig.1).

Schematic of Pipeline for EMR Patient Profile Drivers of Medication Prescriptions. (a) Cohort selection criteria for suspected non-specific chronic low back pain (ns-cLBP) patients from our institution’s electronic medical records (EMRs). Inclusion (solid orange) and exclusion (dashed gray) criteria were defined with clinical experts to identify patients with lumbar spine MRI between 2012–2024, excluding those with prior interventions, surgery, or underlying conditions requiring specific treatments. Exclusion rational is described in detail in the methods 4.1.1. and exclusion sample sizes (N) are subsets of all patients with lumbar spine MRI. The final cohort included 4,077 ns-cLBP patients, of whom 3,663 had available radiology reports. (b) Patients were categorized by the most potent pain medication class (none, NSAID, or opioid) prescribed within one year following their first lumbar spine MRI. (c) Patient profiles were constructed from demographic, psychosocial, and diagnostic features up until a month after their first lumbar spine MRI, extracted as numerical, categorical, or binary variables from medical records and radiology reports. Feature selection was guided by clinical expertise and current research recommendations. (d) Structured SQL queries were used for tabular data extraction, while large language model (LLM) prompting was applied to text data to construct clinical patient profiles for ns-cLBP. (e) Tree-based classifiers were trained for six binary outcome variables and six predictor datatypes specified along the x-axis in the UpSet Diagram. One-vs-one (OVO) comparisons assessed relative medication potency, while one-vs-rest (OVR) comparisons evaluated prescription trends for specific drug classes by comparing each drug class (black circle) to its mathematical complement (green square). Predictor datatypes were defined to assess the influence of biopsychosocial factors and documentation methods with y-axis categories corresponding to patient characteristics in (c). Models were optimized based on the highest validation balanced accuracy across model architectures (random forest, bagging, adaboost, and XGBoost) and hyperparameters via grid search. (f) SHAP values quantified feature importance, providing insights into clinical predictors of medication prescription. A variational Broca Count method aggregated feature importance across OVO and OVR models to summarize general prescribing patterns beyond pairwise comparisons.

For big-data analysis, a LLM prompt previously developed on radiology reports from our institution extracted the presence of LBP-related pathology from radiology reports. Initial prompt validation on a random sample of 20 reports across 10 pathologies yielded an average 0.956 ± 0.041 F1-score, 0.029 ± 0.035 FPR, and 0.030 ± 0.041 FNR between the LLM extraction pipeline and human annotation (Supplemental Table 1). Such performance metrics demonstrated strong agreement which justified proceeding with processing the entire cohort. Documentation of diagnoses differed between clinical charts and radiology reports with low agreement (Cohen’s kappa = 0.102 ± 0.0183) and more frequent reporting in tabular data where physicians account for patient-reported symptoms (Supplemental Table 2).

Complete patient profile features and statistical distributions of values across medication outcomes are summarized in Table1.

Non-specific chronic lower back pain patient profiles.

For patients with radiology reports (n= 3,663), patient profiles were derived from both clinical chart (demographics, psychosocial, and diagnoses) and radiology report (mri_diagnosis). Categorical patient profile values were mapped to an integer “ID” for downstream modeling and interpretation. Descriptive statistics report the count and percentage prevalence of each value overall and stratified by medication outcome. Statistical comparisons across medication classes were conducted using chi-squared tests with Bonferroni correction for categorical and binary features, and one-way ANOVA for numerical features. P-values < 0.05 indicated statistical significance in NSAID and opioid prescriptions among demographics (age at first imaging,year at first imaging,obesity), psychosocial determinants (race/ethnicity,smoking status,social support,primary insurance,history of anxiety or depression), medical chart diagnoses (LBP duration,LBP laterality,numbness / tingling,radiculopathy disc pathology,spinal stenosis,facet joint arthropathy,sacroiliac joint,sciatica,osteoarthritis / osteoarthrosis,osteopenia / osteoporosis,fibromyalgia), and radiology report diagnoses (disc pathology,spinal canal stenosis,lateral recess stenosis,foraminal stenosis,curvature). Significant associations in medication from clinical chart derived features are consistent across patient profiles comprised of only clinical chart features (n= 4,077).

In total, 36 finetuned models predicted medication for patients with ns-cLBP across six feature subsets (datatype) and six medication class comparisons (outcome) with optimal hyperparameters listed inSupplemental Table 3. Bootstrapped test-set performance metrics and 95% confidence intervals are presented in a parallel coordinates plot (Fig.2) andSupplemental Table 4.

Parallel coordinates plot of test-set performance metrics for 36 finetuned models, with 95% confidence intervals from bootstrapping (n= 1000). Each color represents a one-vs-one or one-vs-rest classifier to compare relative differences in medication classes (none_vs_nsaids, none_vs_opioids, nsaids_vs_opioids) and the likelihood of a specific class (rest_vs_none, rest_vs_nsaids, rest_vs_opioids) for non-specific chronic LBP treatment. The x-axis specifies patient profile compositions (datatype), detailed in Fig.1(e), with the most comprehensive profile (tabular_text) positioned near the center. Overall, models distinguishing opioid prescriptions (none_vs_opioid, nsaid_vs_opioid, rest_vs_opioid) exhibited lower precision suggesting greater variability in opioid usage, although this trend did not persist over recall and balanced accuracy metrics. Models incorporating clinical chart-derived diagnoses achieved the highest balanced accuracy, particularly for certain classifications (none_vs_opioids, none_vs_nsaids, rest_vs_none). Social determinants of health improved predictive performance when combined with pathological diagnoses but performed relatively poorly in isolation. These findings emphasize the dominant role of pathology in medication classification and the moderate contribution of social determinants.

Bidirectional (OVO:none_vs_nsaids,none_vs_opioids,nsaids_vs_opioids) and class-specific (OVR:rest_vs_none,rest_vs_nsaids,rest_vs_opioids)comparisons shown no dominant strategy, mirroring real-world challenge of tailoring prescriptions to individual patient needs. Noterestlabels encompass the mathematical complement of the one label, for examplerest_vs_nonecompares NSAID or opioid to no medication. Predictive performance was quantified using the area under the curve (AUC) (mean [min, max] = 0.62, [0.53, 0.71]) and balanced accuracy (mean [min, max] = 0.58, [0.51, 0.68]), ensuring a thorough assessment of discrimination. Additionally, precision (mean [min, max] = 0.39, [0.12, 0.64]), recall (mean [min, max] = 0.53, [0.06, 0.75]), specificity (mean [min, max] = 0.64, [0.41, 0.98]), and F1-score (mean [min, max] = 0.42, [0.09, 0.65]) offered a comprehensive evaluation on classification performance. In relation to other clinical applications29, AUC and balanced accuracy values suggest weak (0.50–0.60) to acceptable (0.60–0.80) performance. Results reflect the inherent complexity of medication prescription patterns for non-specific chronic LBP patients and provide an initial benchmark for future investigations.

Performance trends across feature subsets revealed that documentation method for diagnoses influenced prescription prediction differently, when demographic and psychosocial features were held constant. Models trained with diagnoses from clinical charts (tabular) outperformed baseline models trained with all documented diagnoses (tabular_text) by 3% (SD = 7%) across all six pairwise outcomes and all six metrics, meaning the contribution of imaging-confirmed pathology marginally reduced predictive power. Furthermore, models trained with diagnoses from MRI-interpreted radiology reports (text) underperformed by 3% (SD = 16%) compared to baseline models (tabular_text), indicating imaging pathology alone provided less consistent information for prescription discrimination.

When isolating biopsychosocial effects on medication prescriptions with demographics held constant, ablating psychosocial determinants from clinical features (tabular_diagnoses) reduced performance only modestly by 4% (SD = 11%), while removing diagnoses (tabular_psychosocial) incurred a larger 11% (SD = 14%) reduction. This asymmetry implies diagnostic features primarily but not exclusively influence decision making. Nonetheless, diagnosis-free models leveraging demographics and psychosocial factors (tabular_psychosocial) achieved 53–59% balanced accuracy across OVO and OVR outcomes, underscoring how social determinants of health partially mitigate diagnostic uncertainty in real-world treatment pathways.

Feature importance extraction utilized the best performing models in Fig.3, which presents normalized confusion matrices for performance and misclassification context. True positive rates exceeded chance for all classifications exceptrest_vs_opioids(TPR = 0.53) and false positive rates were below chance for all classifications exceptnsaids_vs_opioids(FPR = 0.48), potentially reflecting clinical shifts towards reducing opioid prescription. SHAP violin plots in Fig.4rank feature importance in descending order and illustrate each feature’s influence (SHAP_value) on the likelihood of predicting the event class (reference_vs_event). Feature rankings are quantified in Supplemental Fig.1.

Normalized confusion matrices for the best-performing models across medication classification tasks (reference_vs_event). Class labels were assigned so that the event label (1) corresponds to higher medication potency, except forrest_vs_nonewhen the event represents no medication prescription. Matrices display prediction distributions, with diagonal elements representing correct classifications, off-diagonal elements showing errors, and sample sizes specified in the axis label. Models generally achieve moderate discrimination with true positive rates (TPR, lower right) exceeding false positive rates (FPR, upper right), indicating reliable classification with minimal false alarms despite a few exceptions.Rest_vs_opioidsexhibit a low TPR and FPR, suggesting conservative prediction criteria that miss some opioid prescriptions.Nsaids_vs_opioidsexhibits high TPR but FPR of 0.48, indicating the model captures opioid prescriptions but generates many false positives, potentially due to reductions in prescriptions to curb the opioid epidemic.

SHAP (SHapley Additive exPlanations) values quantify the relative importance of patient profile features for each one-vs-one (OVO) and one-vs-rest (OVR) medication prediction task. SHAP violin plots illustrate the distribution and directionality (positive / negative) of feature effects on model predictions, where the width reflects observation frequency, x = 0 indicates no impact on likelihood, and the colorbar corresponds to the values in Table1. Overlapping SHAP distributions (e.g.,year_at_first_imaging,race_ethnicity,primary_insurance) suggest complex decision boundaries, while distinct distributions whether symmetric (e.g.,disc_pathology) or skewed (e.g.,negative_psych_state) indicate more deterministic relationships. Presence of spinal pathologies (disc,stenosis,sciatica) andsocial_supportwere consistently associated with higher drug classes.LongerLBP_durationcorrelated positively with NSAIDs and negatively with opioids while documenting either unilateral or bilateralLBP_lateralitycorrelated positively with NSAIDs compare to no specification. Female sex (0) was linked to a higher likelihood of medication (none_vs_nsaids,rest_vs_opioids) although the magnitude of effect was relatively small compared to other patient characteristics. These insights suggest complex interactions between clinical and sociodemographic factors in medication decision-making for non-specific chronic lower back pain.

Temporal and pathological features consistently emerged among the most influential predictors of medication prescription pathways. Most notably,year_at_first_imagingaveraged the highest SHAP value magnitudes across most models, suggesting a strong association with shifts in opioid prescription practices following guideline changes. In contrast,spinal_stenosis,disc_pathology,negative_psych_state,osteoarthritis_osisandrace_ethnicityshowed variable importance depending on the classification task, underscoring potential interactions between patient characteristics and prescription decisions.

For pathology-related features, the presence of spinal stenosis, disc pathology, radiculopathy, sciatica, lateral recess stenosis, spinal canal stenosis, sacroiliac joint pathology, endplate changes, and osteoarthritis / osteoarthrosis all increased the likelihood of stronger medication prescriptions. Interestingly, facet joint arthropathy and increased the likelihood of a NSAID prescription (rest_vs_nsaid) but decreased the likelihood of an opioid (none_vs_opioid). The same effect was observed for specification of LBP duration (chronic or acute, vs. unspecified) and LBP laterality (unilateral or bilateral, vs. unspecified) (none_vs_nsaid,nsaid_vs_opioid,rest_vs_none,rest_vs_nsaid,rest_vs_opioid).

Among psychosocial factors,year_at_first_imagingconsistently reduced the likelihood of any or escalated medication. However, the effect of earlier or later years were unclear due to complex value distribution patterns. In contrast, female patients or those with anxiety or depression consistently associated with stronger medication than their counterparts. Furthermore, patients having a partner were more likely to receive some prescription than those who were single or separated (none_vs_nsaid,,rest_vs_none,rest_vs_nsaid,rest_vs_opioid).Sexandsocial_supportdemonstrated opposing and symmetrically distributed effects on classification tasks, whilenegative_psych_stateandsmoking_statushad opposing and skewed effects with negative perceptions exerting stronger influence. These findings provide insight into clinical decision making and reinforce the importance of incorporating biopsychosocial patient information when modeling prescription patterns.

Feature importance across all bi-directional (OVO) and class-wise (OVR) medication prescription decision are summarized in Table2. Rank aggregation analysis revealed that temporal factors, specificallyyear_at_first_imaging, demonstrated the strongest association with medication prescriptions across all model variants, consistent with substantial updates to prescribing guidelines over the past decade.

Feature importance rankings were aggregated across all one-vs-one (OVO) and one-vs-rest (OVR) medication prescription classification tasks using variational Borda Count methodology. The top ten predictive features are presented for models incorporating: (1) the highest balanced accuracies, (2) the complete predictor dataset, (3)tabularpredictors excluding text-derived features (mri_“diagnosis”), and (4)textpredictors excluding tabular-derived diagnoses (“diagnosis”). Physiological features are bolded with psychosocial determinants are not. Rankings reveal key associations between patient characteristics and prescriptions for non-specific chronic lower back pain, within the constraints of finetuned model performance. Abbreviations are as follows: lbp – lower back pain, lr_stenosis – lateral recess stenosis, sc_stenosis – spinal canal stenosis, f_stenosis – foraminal stenosis.

Highly ranked features were fairly evenly distributed between physiological and social determinants of health, reflecting alignment with multifaceted prescribing recommendations.Race_ethnicity(high importance),negative_psych_state(low importance), andprimary_insurance(low importance) demonstrated consistent associations, suggesting potential disparities in opioid prescription, although specific class associations were not analyzed. Among pathology features,LBP_laterality,disc_pathology, andspinal_stenosisranked prominently, corroborating other findings in this study.

Through comparative analysis of diagnoses documentation sources (tabular_text), clinician-documented pathologies in structured clinical charts (stenosis,radiculopathy) showed stronger associations than their counterparts extracted from radiology report (mri_spinal_canal_stenosis,mri_lateral_recess_stenosis). However, certain radiological findings, specifically facet joint and lateral recess pathology (mri_facet_joint,mri_lateral_recess_stenosis), were uniquely predictive when extracted from imaging reports. Additionally, chart-documented pain descriptors (LBP_duration,LBP_laterality) demonstrated high predictive value despite offering less detailed and standardized information than formal questionnaires.

This study is the first to systematically evaluate ML models for predicting medication prescriptions in patients with ns-cLBP, leveraging multimodal EMR data that spans biopsychosocial features. By applying OVO and OVR models with SHAP interpretation, we offer a transparent approach to understand the complex interplay of pathological, psychosocial, and demographic factors influencing prescription decisions. Our findings establish a benchmark on who is currently prescribed medications for ns-cLBP and demonstrate the potential of explainable AI to characterize decision-making in complex conditions like pain management. This framework can serve as a practical institutional monitoring tool to identify characteristics associated with pharmacologic interventions, misalignment between treatment pathway predictors and established guidelines, and underserved target populations for future resource allocation and policy changes.

Tree-based models were selected because they capture non-linear interactions among multiple predictors more effectively than traditional logistic regression, while maintaining interpretability and achieving performance comparable to deep learning models30–32. Despite model complexity and predictors curated from clinically-relevant EMR2,8,10, our models showed only weak to acceptable discrimination (AUC: 0.53–0.71; balanced accuracy: 0.51–0.68). Our model underperformed compared to general opioid prescription and misuse models (AUC: 0.93–0.94)28. This performance gap likely reflects fundamental differences in study design and priorities. While we focused on ns-cLBP patients across all care settings and prioritized model interpretability, the high-performing opioid models targeted a more homogeneous hospitalized population and incorporated broader patient features including laboratory results and clinical note embeddings using transformer model architectures. Although these design choices enhance predictive accuracy, they sacrifice the clinical interpretability essential for understanding prescribing patterns.

Our model performance was comparable to existing models that predict 10–12 week prognosis for patients with chronic musculoskeletal pain or new onset LBP, using patient questionnaire responses on pain (location, intensity, duration, interference), mobility (walking distance, hours of paid work), and psychological factors (cognitive flexibility, depression) (AUC: 0.49–0.71)33,34. These results reflect nuanced decisions about biopsychosocial factors involved in medication prescription for LBP19and chronic pain management which is challenging for practitioners in 14% of encounters35. Modest performance suggest that prescription decisions are driven by diverse factors not fully captured by this study, including detailed pain descriptors and possible NSAID co-medication known to prescribing physicians but not documented in the EMR36. Nevertheless, even modest prediction accuracy can inform retrospective analyses of prescribing trends and guide prospective interventions to align practices with evolving guidelines.

Quantifying model performance through machine learning revealed unexpected limitations in the contribution of radiological information towards medications for ns-cLBP. Integration of “tabular_text” features reduced prediction performance by 3% with high variability (SD = 7%) compared to models using “tabular” data alone, while exposing substantial disparities in diagnostic documentation (κ = 0.102 ± 0.0183 with 2–9 times higher frequencies in tabular medical charts). The low prevalence of diagnoses in radiology reports may be attributed to radiologists’ limited knowledge of symptoms during reporting37,time limitations, and liability considerations. Meanwhile diagnoses from medical charts span the patient’s entire history and physicians can ask about patient symptoms. These findings align with evidence-based guidelines that advocate for the selective use of conventional imaging, given that MRI findings often correlate poorly with current or future LBP12and can contribute to increased healthcare utilization without clear benefits14,15. Prescribing patterns alongside prior research on perceived benefits of diagnostic imaging38suggest that currently medications may target pain perception and suspected pathology more so than image-confirmed pathology.

When assessing biopsychosocial factors contribution to “tabular” model performance using ablation techniques, “diagnoses” contributed 11% to performance metrics followed by “psychosocial” features at 4%, with notable dependence on specific metrics indicated by large standard deviations (11–14%). The limited relative contribution of psychosocial features may be partly due to sparse documentation in de-identified EMRs, which lack the depth of patient-reported questionaries or psychosocial narratives in clinical reports present in other studies39,40. These findings reinforce the need for comprehensive patient assessments in chronic pain management, where prescription decisions extend beyond pathology to include psychological and social influences. However, challenges remain for clinicians in determining how to allocate time when treating patients with chronic pain41, as these cases often require prolonged management and image-derived pathology may not always provide clear clinical guidance.

The strong influence of temporal features, particularly “year_at_first_imaging”, aligns with measurable reductions in opioid prescription practices following updated clinical guideline aimed at curbing the opioid epidemic5,6,42. Our results suggest that pathology-driven prescriptions remain dominant, as structural abnormalities were consistently associated with stronger medications. This aligns with a meta-analysis that found spinal stenosis and disc degeneration had the highest probability of being related to LBP7,12. The higher feature importance of stenosis compared to radiculopathy may reflect differences in baseline prevalence (15–38% of patients seeking care43vs. 5–10% of LBP patients44), documentation patterns (consistency reporting severe stenosis vs spectrum of radiculopathy severity), imaging visibility (canal narrowing is more identifiable than nerve root compression), and available non-surgical treatment alternatives (stenosis patients may escalate to stronger medications earlier while radiculopathy patients often respond well to paraspinal injections, nerve blocks, and physical therapy44). Notably, “facet_joint_pathology” was associated with NSAID use but not opioids, potentially reflecting differences in clinical management strategies for mechanical versus inflammatory pain sources. These findings highlight the ongoing impact of evolving clinical guidelines on prescribing trends and the role of pathology in shaping treatment decisions.

The observation that specific LBP laterality and duration increased the likelihood of stronger prescriptions may reflect clearer symptom communication and enhanced patient-physician alignment. Well-defined symptom presentations indicate effective communication, including clearer treatment plans and expectations, which are strongly associated with improved patient satisfaction and health outcomes compared to low-agreement settings45,46. When patients present with specific, well-characterized symptoms, clinicians and patients may more appropriately select interventions and establish realistic expectations. These observations emphasize the importance of comprehensive symptom assessment in clinical decision-making and warrant future investigations incorporating questionnaire-based pain descriptors.

Prior research has also highlighted the role of race, ethnicity, and psychological state in opioid prescribing patterns and LBP, despite challenges in defining social determinants of health47,48. In this study, the variable importance of demographic and psychosocial factors highlights context-dependent prescribing behaviors, supporting a more nuanced, patient-specific approach. The association between female “sex”and stronger medication prescriptions raises questions about potential gender biases in pain management, warranting further investigation. This aligns with prior studies that found higher chronic LBP prevalence among females47and higher healthcare costs for smokers within a year after LBP presentation49,50, but challenges the finding that men incur high healthcare costs49,50.

Similarly, we found the SHAP directional influence of “smoking_status” indicated that current and former smokers were more likely to receive opioids but not NSAIDs although the predictive power was weak. The association in a “negative_psych_state” and stronger prescriptions, along with the link between “social_support” (being partnered rather than single/separated) and increased medication use, suggests that clinicians consider psychosocial distress when prescribing. This prescription pattern is consistent with previously found associations in depression and being married / windowed / separated / divorced increased chronic LBP prevalence47. These findings underscore the need for integrated pain management strategies that extend beyond pharmacologic interventions to incorporate evidence-based approaches such as cognitive-behavioral therapy, physical therapy, and self-management education consistent with prior work5,9–11.

Altogether, these findings offer healthcare institutions with an actionable framework to systematically evaluate their ns-cLBP management practices and identify opportunities for guideline-concordant care. The therapeutic void in managing non-specific, chronic pain is reflected in low model precision (mean: 0.39) despite using expert-curated LBP patient profiles, which underscores the lack of consensus on pharmacological interventions. Nonetheless, data-driven insights provide a starting point for further intervention. Three specific areas of focus target conservative opioid prescriptions, reducing imaging overutilization, and encouraging biopsychosocial patient assessments. While educational efforts had no effect on the rate of low-value spinal imaging rates51, communicating benchmark prevalence metrics of normal MRI findings improved guideline concordance through decreased subsequent imaging52, opioid prescription53, and patient perceived severity of spinal pathology54. Similarly, clinicians and researchers can use global SHAP-based feature importance metrics as an accessible, data-driven reference to compare real-world prescribing patterns against guideline-specific risk indicators. Comparisons provide feedback on incorporation of the biopsychosocial model into treatment planning and identify target populations that may benefit from focused interventions.

The interpretation of our findings was constrained by several limitations of the EMR database. The database lacked patients’ primary complaints, prescribing rationales, and treatment response metrics that typically guide clinical decision-making. These limitations were mitigated through clinically informed selection criteria and the characterization of prescription patterns instead of prescription efficacy, which varies with individuals’ pain perception including neuropathic, nociceptive, and nociplastic subtypes55. Our findings require comparison with other studies to assess prescription appropriateness and cannot be used prospectively. Future research may address these gaps by refining the outcome variable to include prescription details (e.g. frequency, duration, dosage), prescription adjustments over time, prescription department, and patient-reported outcomes (e.g. pain scores, days lost from work, disability adjusted life years). This comprehensive approach could offer a holistic understanding of treatment decision-making and help identify low-efficacy prescriptions, which remains poorly understood for ns-cLBP patients.

LBP patient profiles were also limited to characteristics available in our EMR database. The cohort contained only patients who had a lumbar spine MRI between 2012 and 2024 in San Francisco, California. Thereby we excluded broader LBP populations that differ by imaging, timeframe, or location despite over-utilization of imaging compared to clinical guidelines (31–54%)5. Additionally, we did not require comprehensive chart reporting or image annotations to reflect standard clinical practice, which may have obscured detection of infrequently documented diagnoses with emerging value (i.e. endplate changes) or imaging insights. Other variables unavailable in our de-identified EMRs for future investigation include patient weight, BMI, pain descriptors, and socioeconomic status. Standardizing comprehensive EMR documentation of pain characteristics and treatment outcomes would better capture biopsychosocial factors relevant to pain management and facilitate development of advanced prognostic assessment tools beyond current monitoring capabilities.

While tree-based models were prioritized for interpretability, emerging ML architectures could better model multimodal biopsychosocial interactions. Future modeling investigations should pursue developing standardized reporting of quantitative imaging measures56, investigating advanced natural language processing techniques that can better interpret unstructured reports, and exploring direct image encoding to bypass documentation limitations altogether. Future studies may integrate longitudinal patient data, raw data such as through latent space encoding or quantitative imaging57,58, and validate models prospectively in diverse care settings. Feature importance is constrained by historical patterns that may encode regional and institutional biases, such that emerging clinically relevant features on frequently documented ones.

In conclusion, this study provides an analytical framework to characterize medication prescription decisions in ns-cLBP using multimodal patient profiles. While performance metrics highlight the inherent uncertainty in treating this challenging condition, our findings illuminate addressable patterns in current prescribing practices and demonstrate the promise of multi-modal data integration in chronic pain management algorithms. This approach offers a valuable tool for monitoring clinical decision-making, as guidelines related to imaging, psychosocial factors, and opioid use evolve. This transferable pipeline can be applied to diverse datasets with SHAP feature importance adapted to local patient populations, enabling comparisons across institutions and time periods. By identifying prescription pattern misalignments that may reveal systematic biases in pain management, these analyses enable healthcare systems to implement corrective measures toward more consistent, equitable, and personalized care strategies.

All research procedures were conducted in accordance with relevant guidelines and regulations. Under the UCSF Institutional Review Board’s guidance, IRB review was not required due to the use of de-identified data.

UCSF’s de-identified “Info Commons” database enabled the integration of large multi-modal clinical datasets for retrospective analysis in accordance with relevant guidelines59. Strict selection criteria in Fig.1(a) minimized LBP subtype heterogeneity while ensuring a representative cohort to reduce the likelihood to identifying characteristics for well characterized LBP subtypes.

Exclusion criteria:To maintain focus on unresolved pain cases (chronic or significant enough to warrant imaging), the study excluded patients with prior spinal surgery or paraspinal injections, which often indicate specific, operable conditions. Additional exclusions removed patients with fracture, cancer, infection, trauma, or stroke were to eliminate red flags symptoms that suggest a more serious underlying pathology. Patients younger than 18 were excluded due to fundamental differences psychosocial states and prescription practices between adult and pediatric populations.

Outcomes:Viable metrics were carefully considered since clinical data lacks healthy controls to allow for meaningful interpretation. To investigate non-invasive strategies for ns-cLBP management, outcome variables were defined as the most potent medication received within one year of the lumbar spine MRI where levels are defined as none, NSAIDs, or opioids5,11,13,42,60,61in Fig.1(b). Specific selection criteria are included in Supplemental Code Snippet 1.

Predictors:Patient profiles were constructed by concatenating biopsychosocial factors from multi-modal documentation sources up to one month after their first lumbar spine MRI. Demographics, psychosocial determinants, and diagnoses were extracted from medical charts, while imaging-confirmed diagnoses were extracted from radiology reports. Patient profile characteristics are summarized in Fig.1(c) and Supplemental Table 5, while the extraction pipeline is detailed in Fig.1(d).

We considered the complexity, quality, and consistency of each data type to motivate an extraction strategy for clinically informed patient profiles. Tabular medical charts offer structured diagnostic and psychosocial data47,48, MRIs provide visualization of tissues and quantitative metrics, and radiology reports offer nuanced image insights from expert annotations. To streamline feature extraction in alignment with expert clinical assessments, we derive imaging features associated with LBP directly from annotated radiology reports, bypassing the need for intermediary model development on MR images.

To create LBP patient profiles from tabular data, clinical chart information was mapped to each patient category using a one-to-one or many-to-one approach. One-to-one mappings were applied when there were a limited number of labels and patients only belonged to one label within a category with usefulness for demographic data (i.e. sex, race/ethnicity,...). Many-to-one mappings were defined for patient pathology to combine numerous labels together into meaningful categories. This data cleaning strategy required careful query design in collaboration with clinical experts to reconcile differences in medical terminology and maintain confidence in the label extraction (i.e. disc pathology encompasses herniated disc, disc degeneration, discogenic pain, ruptured lumbar disc, but notdischarge).

Missing demographic variables described in Supplemental Table 6 were assessed to determine the type of missingness and guide the selection of an imputation method. Little’s MCAR test was used to evaluate whether data were “missing completely at random” (MCAR), and logistic regression assessed whether data were “missing at random” (MAR) based on a binary missingness indicator (y_miss) (Supplemental Table 7). After initial analyses determined the data were “missing not completely at random” (MNAR), attempts to identify auxiliary variables that could account for the missingness pattern and render the data MAR were unsuccessful. As a result, maximum likelihood imputation using the expectation-maximization based KNNImputer was applied to infer missing values forrace_ethnicity(6.5%),social_support(8.3%),smoking_status(12.7%), andprimary_insurance(32%), using the features:sex,age_at_first_imaging,year_at_first_imaging, andpreferred_language.

We adopted a target approach to create patient-feature vectors from multi-modal data by pre-selecting relevant MRI features to extract from radiology reports. An LLM data extraction pipeline VERSA-spine62was used to summarize the presence of clinically relevant spinal pathology7,8identified in radiology reports. This collection of prompts was run using GPT-4.0 on an internal PHI-compliant environment using an API key for $450. Since the algorithm was refined and validated on clinical reports from our institution, we did not anticipate difference in data distributions. Nonetheless, validation was performed on a subset of 20 notes with human-annotated labels for quality assessment (Supplemental Table 1) and consistency with clinical chart diagnoses was evaluated using Cohen’s kappa across all notes (Supplemental Table 2). Two minor prompt modifications were made to extract pathology with the granularity of mild / moderate / severe as opposed to absent / present, and provide prompt context that guides interpretation when pathology is not indicated.

Prior to ML modeling, hypothesis testing identified significant differences in categorical medication outcomes across each patient profile predictor. Chi-squared test of independence was used for categorical predictors and one way ANOVA was used for continuous predictors. The threshold for statistical significance was set top< 0.05.

We implemented random forest63, bagging, adaboost64, and XGBoost65tree-based classification algorithms to mathematically model medication prescription pattens by using rule-based splitting. Training incorporated 5-fold cross validation for robustness and grid-search hyperparameter finetuning for trees count, maximum depth, minimum samples per split, minimum samples per leaf, bootstrapping, and estimator count. The best models were selected based on highest validation balanced accuracy. Thirty-six models were finetuned across medication outcomes (n= 6) and patient profile predictor datatypes (n= 6) (Fig.1(e)).

Models predicted bidirectional one-vs-one outcomes (OVO:none_vs_nsaids,none_vs_opioids,nsaids_vs_opioids) and class-wise one-vs-rest outcomes (OVR:rest_vs_none,rest_vs_nsaids,and rest_vs_opioids) for no, NSAID, or opioid prescription. Following machine learning convention, we encoded event labels as “1” and reference labels as “0.” Clinically, the event represented stronger medication classes while the reference indicated lower medication classes, except when any medication served as reference relative to no prescription (rest_vs_none).

Patient profile vectors concatenated a combination of demographics, psychosocial determinants, and diagnoses from tabular clinical chart, and diagnoses from MRI radiology reports. Thetabular_textset included all predictors, while variations limited diagnoses to be exclusively from clinical charts (tabular) or radiology reports (text). Health determinant stratification created subsets of demographics with psychosocial features from clinical charts (tabular_psychosocial), diagnoses from clinical charts (tabular_diagnoses), or diagnoses from radiology reports (text_diagnoses).

To evaluate ns-cLBP prescriptions, we assessed whether tree-based models could predict medication prescription. We then evaluated multi-modal documentation sources and biopsychosocial features by training classifiers with different feature combinations and comparing performance.

Model evaluation on test-set data was assessed by precision, recall, specificity, F1-score, balanced accuracy, and AUC with bootstrapping (n_bootstraps= 1000,n_samples= length ofy_test) to determine 95% confidence intervals from the 2.5-97.5th percentile range66,67.

Variability across patient profiles was then quantified by averaging the percent differences across all performance metrics and outcomes, and calculating the standard deviation.

Feature importance was determined using Shapley Additive exPlanations (SHAP) feature rank aggregation from the six best-performing models for each pairwise medication outcome Fig.1(f). Based on cooperative game theory, SHAP calculates the average marginal contribution of each feature on the model output, by measuring the positive or negative effect with and without the feature25. For EMR-based prediction models, the magnitude and directionality of SHAP values reveal which patient characteristics most strongly influence prescription recommendations, enhancing model interpretability and clinical trustworthiness.

To consolidate important features associated with LBP medication prescriptions, feature contributions were aggregated across OVO and OVR models using a variational Borda count method68,69. We quantified feature importance within each model by the mean SHAP value, ranked features with a mean SHAP value above 0.01 in descending order, assigned missing features a rank of zero, and normalized rankings to sum to one. This strategy leverages prior knowledge to assign and tolerate missing rankings (rank 0) unlike the traditional Borda count method. The final ranking summed normalized ranks across models, with higher totals indicating greater importance.

We performed rank aggregation for all best-performing OVO and OVR models to capture relative feature effects across interacting documentation sources (tabular_text), clinical chart features (tabular), and radiology report features (text). While SHAP values are not directly comparable across models, this rank aggregation approach effectively summarizes clinically relevant feature associations rather than absolute effect sizes which may be better represented through weighting terms. A ranked list provides a consolidated summary of feature importance. Downstream assessment will compare these findings with existing clinical care guidelines to better understand the discrepancy between guidelines and practice.

All analyses were performed using Python 3.11.9 on a Linux workstation running Red Hat Enterprise Linux release 9.5 (Plow) with an AMD EPYC 9354P 32-Core Processor CPU (64 threads) and 512 GB RAM. Analyses were conducted using duckdb (1.0.0), scikit-learn (v1.5.2), and shap (v0.46.0).

Below is the link to the electronic supplementary material.

The authors acknowledge the use of the UCSF Information Commons computational research platform, developed and supported by UCSF Bakar Computational Health Sciences Institute in collaboration with IT Academic Research Services, Center for Intelligent Imaging Computational Core, and CTSI Research Technology Program.