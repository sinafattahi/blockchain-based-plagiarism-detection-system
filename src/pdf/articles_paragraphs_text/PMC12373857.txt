Metal halide perovskite (MHP) nanocrystals (NCs) offer extraordinary tunability in their optical properties, yet fully exploiting this potential is challenged by a vast and complex synthesis parameter space. Herein, we introduce Rainbow, a multi-robot self-driving laboratory that integrates automated NC synthesis, real-time characterization, and machine learning (ML)-driven decision-making to efficiently navigate MHP NCs’ mixed-variable high-dimensional landscape. Using parallelized, miniaturized batch reactors, robotic sample handling, and continuous spectroscopic feedback, Rainbow autonomously optimizes MHP NC optical performance—including photoluminescence quantum yield and emission linewidth at a targeted emission energy—through closed-loop experimentation. By systematically exploring varying ligand structures and precursor conditions, Rainbow elucidates critical structure–property relationships and identifies scalable Pareto-optimal formulations for targeted spectral outputs. Rainbow provides a versatile blueprint for accelerated, data-driven discovery and retrosynthesis of high-performance metal halide perovskite nanocrystals, facilitating the on-demand realization of next-generation photonic materials and technologies.

The full potential of tunable perovskite nanocrystals is limited by complex synthesis space. Here, authors developed a self-driving lab that autonomously discovers and produces optimal scalable nanocrystals for next-generation photonic technologies.

Metal halide perovskite (MHP) nanocrystals (NCs) have arisen as a highly promising class of semiconducting materials for a myriad of photonic applications encompassing displays, solar cells, light-emitting diodes, photocatalysis, and quantum information science applications1–7. These quantum-confined and solution phase-synthesized NCs exhibit unique optical properties, such as near-unity photoluminescence quantum yields (PLQY), narrow emission linewidths (full-width-at-half-maximum, FWHM), and tunable bandgaps controlled by altering their compositions, shapes, and sizes8–11. On-demand synthesis of high-performing MHP NCs with tailored bandgaps will significantly benefit the performance of MHP NC-based devices. A high-quality MHP NC is defined as the NC with the maximum PLQY, the narrowest possible emission linewidth, and single emission peak at a target peak emission energy(EP).

The surface ligation of MHP NCs relies on an acid-base equilibrium reaction12,13, which is commonly utilized to not only stabilize the resulting NCs in an organic solvent and control their growth, but also to tune their optical properties14–16. Decreasing the alkyl chain length of the organic acid used would result in the formation of MHP nanocubes with increasing edge lengths15. In addition to the one-pot synthesis process, post-synthesis halide exchange reactions provide a facile approach to precisely tailor the optical/optoelectronic properties of MHP NCs. The post-synthesis halide exchange reactions can fine-tune the bandgap of MHP NCs to cover the near ultraviolet/visible (UV-vis) spectral region. The solution-phase exchange of bromide anions (Br-) within cesium lead bromide (CsPbBr3) NCs with chloride (Cl-) or iodide (I-) anions can readily alter the composition and thereby the optical properties of MHP NCs.

Therefore, the mixed-variable and intercorrelated nature of acid/base ligands, as well as the high dimensionality of both the input and output parameter spaces of ligand-mediated MHP NCs, have complicated the unraveling of the underlying ligand structure-synthesis-properties relationship of MHP NCs. The slow progress in fundamental and applied studies of ligand-mediated MHP NC synthesis and bandgap engineering can be attributed to (i) the inefficient one-parameter-at-a-time manual experimentation techniques that are employed in a traditional chemistry and material science lab, which suffer from batch-to-batch variation and characteristically low throughput, and (ii) a lack of informed decision-making in exploration/exploitation of MHP NC synthesis spaces. In addition, current experimental workflows of MHP NCs are operated in siloed format (i.e., physical disconnection between NC synthesis and characterization) and suffer from a time-gap between performing an NC synthesis, characterizing the product, and deciding the next experiment. Consequently, these challenges hinder the pace and depth of synthesis science studies and optimization of MHP NCs with the aim of attaining the highest performing NCs.

The implementation of experimental automation serves to expedite the sampling process in high-throughput experimentation by integrating design of experiment (DOE) methodologies for the systematic exploration of the chemical space. However, acquiring a comprehensive understanding of a complex and high-dimensional reaction system (e.g., MHP NCs) still necessitates the generation of substantial volumes of experimental data with combinatorial screening or DOE-based approaches.

The recent integration of rapidly evolving artificial intelligence (AI) tools with lab automation and robotics to establish self-driving labs (SDLs) has introduced a powerful research acceleration framework in chemical and material sciences8,11,17–26. SDLs aim to leverage a powerful closed-loop feedback mechanism that can adapt to the dynamic evolution of the current belief of the reaction system, thereby enabling the efficient selection of new experimental conditions and consequently minimizing the overall experimental cost incurred when exploring a new reaction system. SDLs have risen to the challenges posed by conventional chemistry and material research, and can accelerate both the elucidation of underlying mechanisms, and the material discovery process11,27–31. SDLs are capable of reproducible experimentation and expeditious navigation through vast chemical spaces to reach user-defined objectives, accomplishing as much as 10×−100× acceleration of the discovery of novel materials and synthesis strategies vs. the status quo in experimental chemistry and material science labs32–36. Example applications of SDLs include the rapid synthesis and fabrication of high-performance NCs (metallic and semiconductor) and thin film materials, as well as discovery and optimization of organic compounds17,22,24,37–39.

The performance of SDLs for rapid and efficacious exploration depends on the quality and quantity of generated experimental data, with the entire process being orchestrated by an AI agent. In each experimental campaign, based on a human-defined goal, the AI agent emulates the existing experimental data and iteratively proposes the input conditions of the next iteration of experiments (exploration/exploitation) for a defined objective until the target has been reached. For instance, MacLeod et al. defined a quantity called pseudomobility to represent the hole mobility of an organic hole transport material, and their SDL, ada, conducted closed-loop fabrication of thin films until the pseudomobility target reached the global maximum identified by the Phoenics global Bayesian Optimization (BO) algorithm22. In another example, Jiang et al. utilized a fitness function defined as the combination of local sparseness and similarity toward the target UV-Vis absorption spectrum, and employed an evolutionary-algorithms-powered AI-EDISON to iteratively synthesize gold nanoparticles with desired physicochemical properties37. Volk et al. implemented a trajectory reward function and applied a reinforcement learning agent to propose the next injection/washing step in colloidal atomic layer deposition chemistry of core/shell semiconductor NCs, identifying and optimizing a novel multi-step synthesis route with up to 40 process parameters17.

The paucity of comprehensive experimental data (successful and failed trials) and metadata (detailed reaction configurations) for MHP NC synthesis, paired with the difficulty of generating such data manually, necessitates the development of a robust materials acceleration platform for generating reproducible data with minimum experimental noise that can then be fed into the AI agents of SDLs.

Although flow reactors have been successful in accelerated MHP NC synthesis optimization—reaping the benefits of continuous control of reaction conditions, enhanced heat and mass transfer, and reduced chemical consumption and waste production—they suffer from inherent complexity in dealing with discrete parameters. Batch reactors are more suitable for handling discrete parameters in SDLs, particularly when exploring room temperature reactions. Batch reactors possess the capacity to selectively exclude particular species from the reaction process by simply abstaining from sampling their reservoirs. This unique aspect of batch reactors enables parallel and accelerated research on the impacts of continuous and discrete parameters on the optical properties of MHP NCs via a multi-step synthetic route. This versatility of miniaturized parallel batch reactors makes them suitable for closed-loop autonomous experiments with discrete chemical spaces. Moreover, miniaturized batch reactors can be readily scaled up for room temperature NC synthesis reactions, and hence the knowledge gained from operating an SDL can directly carry over to large-scale production.

In this work, we present arobotic andAI-assistednanocrystalbandgapoptimizationworkflow (Rainbow). Rainbow combines a multi-robot NC synthesis and characterization platform with an AI agent to autonomously investigate the synthesis landscape of colloidal NCs and unlock new frontiers in their exploration. Rainbow’s fusion of parallelized miniaturized batch reactors with a benchtop NC characterization instrument, customized labware feeding system, robotic sample transfer, workflow automation, and AI-assisted experimental planning techniques enables fast-tracked parameter space mapping and retrosynthesis of high-performing colloidal NCs. Rainbow’s intensified research framework allows for accelerated and comprehensive synthesis of science studies of the room-temperature, solution-processed NCs that are ubiquitous in materials science. Specifically, with Rainbow, we demonstrate that SDLs can significantly enhance the speed and experimental efficiency of chemical space exploration for similar reaction systems by enabling robust and fast-tracked evaluation of MHP NCs’ experimental design space. In addition, Rainbow unveils the pivotal role of ligand structure in controlling the PLQY, FWHM, and peak emission energy of MHP NCs via a two-step synthetic route.

Following the development and characterization of Rainbow’s physical hardware, we first investigate different aspects of the AI agent used for autonomous parameter space exploration and retrosynthesis of MHP NCs. Next, we employ Rainbow to autonomously map the ligand structure-synthesis-properties relationship of cesium lead halide (CsPbX3, X=Cl, Br, I) NCs utilizing different organic acids in multiple campaigns, with each campaign corresponding to a specific target peak emission energy. Rainbow navigates a 6-dimensional input/3-dimensional output parameter space of MHP NCs, and successfully unveils scalable retrosynthesis knowledge of high-performing MHP NCs for a targeted peak emission wavelength. Rainbow’s ability to conduct autonomous Pareto-Front —a comprehensive representation of achievable PLQY vs. FWHM at a target peak emission energy— exploration of MHP NCs and simultaneous identification of the optimal ligand structure and NC synthesis conditions offers resource- and time-efficient means of benchmarking NC ligands and accelerating the synthesis science studies and development of MHP NCs. Herein, we report reaction data and metadata for experimental Pareto-Front mappings of MHP NCs with 6 different organic acids. Next, we demonstrate Rainbow’s knowledge transferability through a scaled-up NC synthesis. Rainbow opens the door to benchmarking and designing new ligands, optimizing MHP NC properties, and expanding the domain of colloidal nanoscience.

The multi-robotic NC synthesis and characterization platform (i.e., Rainbow’s hardware, Fig.1), consists of four robots, including a liquid handling robot tasked with NC precursor preparation, multi-step NC synthesis, and other liquid handling tasks (e.g., NC sampling for characterization, waste collection/management); a characterization robot that acquires the UV-Vis absorption and emission spectra of the automatically synthesized NCs; a robotic plate feeder for labware replenishment; and a robotic arm for connecting functionalities of the other three robots by facilitating transferring samples and labware between them. Alongside the first-step reaction conditions (continuous variables)8,40and the structure of the capping ligands (discrete variable) controlling the morphology and optical/optoelectronic properties of CsPbBr3NCs, the halide ratio (continuous variable)15of the second-step reaction (halide exchange) also plays a key role in tuning the optical/optoelectronic properties of the resulting MHP NCs. The liquid handling robot is equipped with 12-well reservoirs dedicated to the storage of the NC precursors (Cs, Pb, and organic acid [i.e., ligand] precursors), 2-well reservoirs for the storage of halide precursors (Br, I/Cl), and one-well reservoirs for the reaction solvent (o-xylene) and liquid waste accumulation. In order to decouple the lead precursor addition (i.e., isolate the lead acetate as the only source of lead precursor) during the NC synthesis, zinc salts (zinc chloride, ZnCl2, and zinc iodide, ZnI2) are utilized as the halide source for the one-pot, two-step bandgap engineering of MHP NCs, and 1-dodecanethiol (DSH) is used to not only solubilize the zinc salts, but facilitate the surface defects passivation for an enhanced PL and environmental stability of MHP NCs41. A mid-well 96-well plate is used for miniaturized parallel batch NC synthesis on a heater-shaker module, which utilizes orbital shaking to rapidly mix the solution in each well. Also present is another short-well 96-well plate for sampling the reference (i.e., the reaction solvent, xylene) and the as-synthesized NCs for characterization purposes. During the idle time of the NC precursors, they are automatically capped by a one-well reservoir for long-term operation. The precursor reservoirs are automatically unsealed by the robotic arm before the NC synthesis, and immediately resealed after the synthesis step is concluded. More details about space allocation and the internal configuration of the liquid handling robot can be found in Fig. S4.

aRainbow is composed of a characterization robot (robot 1), a pipetting robot (robot 2), a robotic arm (robot 3), a labware refreshment robot (robot 4), and an AI agent. Rainbow’s hardware enables automated (i) multi-step synthesis, (ii) sampling, (iii) characterization, and (iv) labware restocking.bA picture of Rainbow’s hardware, including pipetting robot (red), characterization robot (magenta), robotic arm (cyan), and labware refreshment robot (green).

Following the loading of precursors into Rainbow’s liquid handling robot, the user specifies the goal (targetEP) of the autonomous experimentation campaigns and the total number of experimental cycles to be conducted (experimental budget). Rainbow’s automated workflow consists of automated multi-step NC synthesis, online characterization/data processing, and labware refreshment. The initial training set of Rainbow’s AI agent is generated by Latin hypercube sampling (LHS) of the accessible experimental space—LHS slices each input variable of the accessible NC synthesis space uniformly to a set number of subspaces and selects up to one sample from each subspace42for a balanced reaction sampling. The experimental NC synthesis data generated by Rainbow via LHS is then used to train a Gaussian Process regression (GPR) model of the AI agent, which utilizes a custom BO algorithm for autonomous MHP NC synthesis space mapping. The AI agent utilizes the surrogate model’s prediction and uncertainty quantification along with an application-specific decision-making policy (exploration and/or exploitation)—fine-tuned based on the goal of the autonomous robotic experimentation campaign -- then automatically suggests new experimental conditions to be tested by Rainbow to rapidly navigate the high-dimensional synthesis space of MHP NCs. Upon receiving the new experimental NC synthesis results (UV-Vis absorption and emission spectra), Rainbow’s AI agent updates its surrogate model (current belief) and sends the new experimental conditions from the edge server to be automatically executed by the hardware. In order to maximize Rainbow’s experimental operation efficiency, multiple tasks in the workflow are parallelized using a scheduling scheme conceptually akin to the computer engineering method of instruction pipelining43. For example, the AI agent model training and experiment-selection process are carried out at the same time as the reference spectra preparation and data acquisition. The liquid waste collection and labware refreshment are also pipelined, being completed during the characterization of the as-synthesized NCs. Consequently, Rainbow can automatically perform one complete cycle of multi-step NC synthesis workflow within 150 min, saving over 30 min compared to a purely sequential workflow execution. A detailed discussion of Rainbow’s workflow orchestration can be found in theMethodssection and a full-cycle experiment recording can be found in Supplementary Movie1.

Rainbow’s reactor is a 96-well plate (glass-coated polypropylene) with 1 mL working volume per well. 4 replicates of each experimental condition are used in each well plate column to reduce experimental variance; hence 24 different NC synthesis conditions can be tested at each cycle, which translates into 230 different NC synthesis conditions per day. A total reaction volume of 650 µL is used for each NC synthesis per well. This miniaturized parallel batch synthesis workflow significantly reduces chemical consumption as well as waste generation compared to traditional NC synthesis techniques using large volume flasks or vials (5 mL-150 mL).

The accuracy of generated data is critical when using automated sampling and analysis systems that directly feed into an AI agent that conducts modeling and experimental suggestion44. Hence, the characterization robot is benchmarked against a standard benchtop spectrometer (FS5 Spectrofluorometer) with a higher resolution (Fig. S5). Next, we characterize the reproducibility of the well-plate reactor. The reproducibility of a single reaction condition across the 4 replicates in Rainbow’s reactor well plate is shown in Fig. S7with the plate-average (24 conditions) coefficient of variation (CV) of 0.16%, 3.96%, and 1.07% for peak emission energy (EP), proxy PLQY(PPLQY), and FWHM, respectively (Fig. S7 c-e). The proxy PLQY is defined as the normalized ratio of the emitted photons (represented by the area under the PL spectra) and the absorbed photons (represented by the absorbance at the excitation energy). The stability of the NC precursors is also evaluated. The same 24 reaction conditions are tested for 4 consecutive cycles of experiments over 10 h and the CV across the experimental conditions is found to be 0.10%, 3.56%, and 0.88% forEP, FWHM, andPPLQY, respectively (Fig. S7f–h). This superior optical property stability indicates Rainbow’s synthesis robustness. Following Rainbow’s hardware validation for well-to-well reproducibility and precursor stability, it is then utilized to perform accelerated multi-objective optimization of target NC properties and complex parameter space explorations via long-term autonomous continuous experiments requiring no human intervention.

The first-step synthesis of MHP NCs (CsPbBr3) relies on the spontaneous reprecipitation that occurs immediately upon injection of didodecyldimethylammonium bromide (DDAB) into a homogeneous precursor mixture of cesium carbonate (Cs2CO3), lead acetate (Pb(OAc)2), and an organic acid (ligand). The controllable morphology of the as-synthesized NCs is ascribed to a dual ligand (DDA+and organic acid) surface defect passivation45. The tight binding of surface ligands on the NCs and DDA+ cations to the negative surface sites enhances the stability of the NCs. Next, the automatically synthesized CsPbBr3NCs undergo a halide exchange reaction upon halide precursor (ZnI2or ZnCl2) injection into the reactor wells. Depending on the ligand structure and precursor concentrations, MHP NCs with distinctEP,PPLQY, and FWHM can be synthesized. Due to the ionic nature of MHP NCs, polar solvents are excluded from Rainbow’s NC synthesis workflow7. To map the underlying ligand structure-synthesis-properties relationship of MHP NCs with Rainbow, a rational library of organic acid ligands with diverse alkyl chain lengths is selected (Fig.2).

aChemical structures of a library of organic acid ligands, including butyric acid (C4), hexanoic acid (C6), heptanoic acid (C7), octanoic acid (C8), 2-hexyldecanoic acid (C16), and oleic acid (C18).bThe transmission electronic microscopy images and Ultraviolet-visible (UV-Vis) absorption and photoluminescence (PL) spectra along with the photoluminescence quantum yield (PLQY) and full-width-at-half-maximum (FWHM) of the MHP NCs capped by C4, C8, and C18 ligands. The experiments are repeated 3 times to measure the PLQY and FWHM values. Source data are provided as a Source Data file.

Recent SDL platforms have showcased either continuous-parameter optimization of perovskites using single-objective BO or categorical-parameter exploration of metallic nanoparticles with evolutionary strategies37,46. Rainbow integrates these concepts by treating continuous process variables and discrete ligand chemistries within one mixed-variable, multi-objective BO framework. This advance enables direct mapping of the PLQY–emission linewidth Pareto fronts for MHP NCs while retaining strict sample and cost efficiency through parallelized microreactors. Rainbow’s AI agent suggests a new set of experimental conditions, including the target ligand (discrete variable) and the reaction conditions (continuous variables), by analyzing the estimated prediction and uncertainty of a surrogate ML model trained on the in-house generated experimental dataset (Fig.3). First, the target peak emission energy along with the precursor library accessible to the Rainbow hardware are defined by the human user (Fig.3a). Next, Rainbow’s AI agent initiates the generation of the surrogate ML model initialization data via LHS (Fig.3b). Following the surrogate ML model initialization step, the operation mode switches from the model initialization experiments to the autonomous Pareto-Front mapping experiments (Fig.3c). Once the results of each set of experimental conditions becomes available from the characterization robot, the MHP NC properties—includingEP,PPLQY, and FWHM—are automatically extracted, added to the existing dataset, and used for the surrogate model (re)training and uncertainty quantification. A mixed-variable GPR model with uncertainty is trained with normalized experimental conditions (inputs) and measured NC properties (outputs) to map the ligand structure-synthesis-properties relationship of MHP NCs (Fig.3d). Since experimental conditions generated by LHS cannot guarantee the emissive synthesis of NCs, the initial experimental dataset includes both emissive and non-emissive synthesis results (Fig.S8). Reaction products with an emission intensity within the baseline noise region of the characterization robot are artificially assigned to the non-emissive NC synthesis conditions, which would harm model accuracy if the surrogate model was trained with the entire dataset. To avoid introducing bias into the surrogate model, the model is only trained with emissive NC synthesis data. However, the surrogate model trained with only emissive NC synthesis data can converge to a non-emissive region of the parameter space. To avoid sampling from the infeasible regions of the experimental space, a classifier (another GPR model) is trained with the two classes (emissive NC synthesis: 1, non-emissive NC synthesis: 0) derived from the entire LHS dataset and is tasked with predicting the probabilistic emissive synthesis with uncertainty of a sampled input space (Fig.S9). The classifier is initially trained on the LHS data and is constantly retrained after each closed-loop autonomous experimentation iteration. With each successive incorporation of Rainbow’s experimental data, the classifier’s predictive uncertainty progressively diminishes, yielding higher accuracy and reliably steering the exploration away from the non-emissive synthesis region (Fig.S17).

aThe human scientist defines the target peak emission energy (EP), objectives, and specifies precursors, followed bybLatin hypercube sampling initializationcexperiments.dRainbow’s AI agent (re)trains the surrogate models,epartitions over the current observations and calculates the current hypervolume (HV) of proxy photoluminescence quantum yield (PPLQY) and full-width-at-half-maximum (FWHM) at the current target EP,fsamples the feasible parameter space,gperforms optimization,hranks the optimized candidates based on their expected hypervolume improvement (EHVI) and selects the next set of experimental conditions to be tested by Rainbow’s hardware.iThe closed-loop experiments output the experimental Pareto-Front, reduction in time-to-solution, metal halide perovskite (MHP) nanocrystal (NC) data/meta library, on-demand synthesis and scalable manufacturing.

Following the surrogate ML model’s training, a partitioning of the 3-dimensional objective space (EP,PPLQY, and FWHM) is conducted for the hypervolume calculation (Fig.3e). Next, 512 sets of randomly selected NC synthesis conditions (ML model inputs) are generated by Sobol Sampling (Fig.3f), a quasi-Monte Carlo method47, and optimized individually via the sequential least squares programming optimization method48–50which maximizes an acquisition function (Fig.3g), namely, noisy expected hypervolume improvement (NEHVI)51, which is calculated based on the distance to the targetEP,PPLQY, and FWHM. During the synthesis optimization step, ligand structures are constrained to the list of available ligand library within Rainbow. To map the Pareto-Front for a targetEP, a constraint is implemented during the NEHVI maximization step to guide the sampled points to close proximity of the targetedEP. Rainbow’s AI agent treats all sampled experiments with predictedEPvalues within a specific range (±2% of the targetEP) similarly to the targetEP. The implemented constraint sets the distance score to zero if the distance between the targetEPand predictedEPis outside the target band (i.e., targetEP±2% of the targetEP) in order to make the calculated NEHVI zero. This step is intended to ensure that the corresponding input condition resulting in an NC outside the targetEPrange will not be ranked high when selecting the next closed-loop cycle experiments based on NEHVI values. The implemented constraint enables Rainbow’s AI agent to explore the experimental conditions that result in NCs with targetEP, and thereby rapidly identify the Pareto-Front ofPPLQYand FWHM. Meanwhile, the classifier is involved in the NEHVI maximization procedure by scaling the NEHVI value with the predicted NC emissive synthesis probability to help reject the input conditions with a high probability of non-emissive synthesis. In the next step, the individually-optimized 512 input NC synthesis conditions are ranked based on their NEHVI value and the top 24 candidates are selected as the new set of experimental conditions for automatic testing in the next iteration by Rainbow (Fig.3 h, c).

In order to fine-tune Rainbow’s AI agent, multiple benchmarking tests of closed-loop experiments are performed. Initialized with 5 cycles of LHS, two groups of 4 cycles of BO for a targetEPof 1.9 eV are conducted by Rainbow; one group without the classifier and another one with the classifier integrated within the BO algorithm. The distribution of theEPof the synthesized MHP NCs at each BO cycle, shown in Fig.S10 a, b, illustrates the success of Rainbow’s AI agent both with and without the classifier. However, the AI agent without the classifier consistently samples from the non-synthesizable regions of the parameter space (> 4 eV, an artificially assigned value as an indicator of non-emissive synthesis), while the AI agent with the classifier obtains a higher emissive NC synthesis rate (12.5% higher emissive rate with the classifier). This result demonstrates the importance of the classifier and its continuous refinement (retraining) after each BO cycle. The Pareto-Front evolution also verifies the superior performance of the AI agent with the classifier vs. without the classifier (Fig.S10c–e). The Pareto-Front at the target peak emission energy evolves in the direction of higherPPLQYand lower FWHM after 4 cycles of BO, and the hypervolume (pink area above the Pareto-Front) from BO with the classifier is also larger than the BO without the classifier, demonstrating that the AI agent with the classifier more efficiently explored the Pareto-Front of MHP NCs within a constant experimental budget.

Next, a virtual benchmarking test is conducted to evaluate the performance of the implemented constraint on the Pareto-Front exploration using Rainbow’s digital twin. Rainbow’s digital twin is a virtual representation of its physical operation that can emulate its NC synthesis process and provide the response for a given set of inputs, which significantly reduces the time and resource consumption for the AI agent fine tuning. Rainbow’s digital twin is a GPR model trained with in-house generated experimental data, with its trustworthy prediction capability shown in Fig.S11. Initialized with three cycles of LHS, two groups of virtual BO campaigns are conducted on a local server, one with and one without the constraint. Rather than performing actual experiments with Rainbow’s hardware, the new set of selected conditions proposed by the AI agents (with and without the constraint) are instead tested using Rainbow’s digital twin to predict the sampled NC properties. The distribution of the virtually sampled NCs’EP, presented in Fig.S12a, b, demonstrates the superior performance of the constrained AI agent compared to the unconstrained one. The unconstrained AI agent is biased toward the highPPLQYvalues and misses the targetEPband. The digital Pareto-Front campaigns (Fig.S12c–e) also reveal that the constrained AI agent results in a larger hypervolume and a higher density of sampled input conditions within the targetEPband. In contrast, the Pareto-Front of the AI agent without the filter evolves at a slower pace than the constrained AI agent, impeding the identification of the high-performing NCs for a targetEP. Accordingly, the constrained AI agent is better able to effectively explore the accessible experimental space (both continuous and discrete parameters) and accelerate the Pareto-Front mapping for a targetEP.

After developing and fine-tuning Rainbow’s AI agent, we studied the role of sample allocation between surrogate model initialization and autonomous experimentation campaigns for a given limited experimental budget. For a constant total number of experiments, a higher number of initialization experiments can provide the surrogate ML model with a more holistic view of the experimental space, while limiting the number of BO experiments, which might not be sufficient for effective Pareto-Front mapping. On the other hand, fewer initialization experiments can accommodate more BO experiments, while the sparse initial data might lead to biased sampling during the BO experiments, which can also impede the targeted navigation through the high-dimensional parameter space of MHP NCs. To investigate Rainbow’s sample allocation strategy, we utilized the trained digital twin to perform a virtual benchmarking on the orchestration structure and identify a proper allocation of the total available experimental budget (e.g., 12 cycles) to LHS (model initialization) and BO (exploration/exploration). Three virtual BO campaigns with 3, 5, and 7 LHS cycles and a constant total number of NC synthesis cycles (12) were virtually tested for a targetEPof 1.9 eV (650 nm peak emission wavelength). The resulting hypervolume evolutions (Fig.S13) illustrated that the BO campaign with 3 LHS cycles achieved the highest hypervolume within the lowest total number of NC synthesis cycles (8), outperforming the other two allocations and random sampling results. Therefore, 3 LHS + 5 BO cycles were used as the optimal sample allocation strategy for Rainbow’s AI agent initialization and autonomous exploration/exploitation to autonomously map the Pareto-Front of MHP NCs for any targetedEP. Considering a ~ 80% emissive rate of the experimental NC synthesis generated by LHS (Fig.S8), an extra LHS cycle was added to the surrogate model initialization in the experimental campaigns to match the dataset used for the surrogate model initialization of the virtual BO campaigns.

Following the sample allocation optimization of Rainbow’s AI agent, an array of autonomous experimental campaigns was performed by Rainbow to rapidly explore the accessible experimental space of MHP NCs and unveil the Pareto-Front of high-performing MHP NCs with different targetEPranging from 1.9 to 2.9 eV. Figure4a, bpresents well plate images (under UV illumination) of the automatically/autonomously synthesized MHP NCs by Rainbow after each LHS and BO cycle for a targetEPof 1.9 eV. The 4 LHS initialization cycles exhibit a diverse set ofEPvalues (visualized by different colors in Fig.4a), with dark wells indicating non-emissive NC synthesis conditions. In contrast, an intense red color emission and fewer non-emissive reactions are observed in the following five BO cycles (Fig.4b), demonstrating the ability of Rainbow’s optimized and constrained AI agent as equipped with the classifier to rapidly map the ligand structure-synthesis-properties relationship of MHP NCs and unveil thePPLQYvs. FWHM Pareto-Front of MHP NCs for a targetEP(Fig.4c). The sampled MHP NCs gradually converged to the brighter red colors whilst lowering the number of non-emissive reactions (dark wells) as the BO cycles progressed, which is attributed to the continuous refinement of Rainbow’s AI agent with an enriched dataset.

Pictures of well plate under Ultraviolet (UV) illumination of (a) initial conditions generated by Latin hypercube sampling (LHS) and (b) recommended conditions by Bayesian Optimization (BO) towards highest Proxy photoluminescence quantum yield (PPLQY) and narrowest full-width-at-half-maximum (FWHM) for 1.9 eV EP. (c) Evolution of PPLQYvs. FWHM Pareto-Front for 1.9 eV EP. The experiments followed the arrows’ directions. Source data are provided as aSource Datafile.

The next set of autonomous Pareto-Front campaigns (2.1 eV and 2.3 eV) were initialized with the existing dataset from both LHS and all former campaigns. All Pareto-Front mapping campaigns (Fig.5) started with little prior knowledge at their targetEP(limited Pareto-Front and small hypervolume area from 4 LHS cycles experiments and prior autonomous campaigns) and rapidly explored and unveiled the experimental Pareto-Front after 5 BO cycles. The autonomous MHP NC synthesis campaigns with targetEPof 1.9, 2.1, and 2.3 eV map the Pareto-Fronts of CsPbBrxI3-xNCs, while the other 3 campaigns (2.5, 2.7 , and 2.9 eV) focus on CsPbBrxCl3-xNCs. The rapid MHP NCs’ Pareto-Front mappings of all targetedEPvalues Fig.5b–f) demonstrates the transfer learning capability of Rainbow’s AI agent to apply the mapping knowledge obtained from one task (i.e., a prior autonomous Pareto-Front mapping campaign) to a related task, thereby significantly reducing time and material consumption, and thus accelerating the overall material discovery and development process.

Evolution of proxy photoluminescence quantum yield (PPLQY) vs. full-width-at-half-maximum (FWHM) Pareto-Front fora1.9 eV,b2.1 eV,c2.3 eV,d2.5 eV,e2.7 eV, andf2.9 eV EPby Latin hypercube sampling (LHS), LHS and 1 iteration of Bayesian Optimization (BO), LHS and 3 BO iterations, LHS and 5 BO iterations. Source data are provided as aSource Datafile.

Autonomously-mapped Pareto-Fronts of CsPbBrxCl3-xNCs revealed a lowerPPLQYthan CsPbBrxI3-xNCs, which is attributed to the intrinsic defects of Cl-rich MHP NCs, arising from the smaller chloride ion-induced atom dislocations or vacancies in the corner-shared (PbCl)6octahedra of MHP NCs52. Next, we analyzed the ligand structure of the sampled NC synthesis conditions by Rainbow’s AI agent. It was found that oleic acid (C18) was heavily sampled during the BO cycles of MHP NC synthesis campaigns with targetEPvalues of 1.9–2.5 eV (Fig.S14), which is attributed to the enhanced stability and improved surface defect passivation enabled by the long alkyl chain of C18. Interestingly, shorter alkyl chain ligands, such as heptanoic acid (C7) and butyric acid (C4), resulted in some of the top-performing MHP NCs atEPvalues of 2.7 and 2.9 eV, respectively (Fig.S14). Based on the hard soft acid base (HSAB) theory53,54, C4 is classified as hard acid due to the short hydrophobic alkyl chain and highly localized electron density around the carboxyl group; while C18 falls into the soft acid category given its longer alkyl chain and lower localized electron density. Meanwhile, the smaller-sized Cl-is a relatively hard anion compared to the relatively soft and larger-sized I-anion. Consequently, the hard acid C4 possesses a stronger binding to the surface of CsPbBrxCl3-xNCs, while the soft acid C18 has a stronger interaction with the surface of CsPbBrxI3-xNCs.

The colloidal stability of C4- and C7-capped MHP NCs is enhanced via the introduction of DSH41, which is demonstrated to increase the success of emissive NC synthesis (Fig.S15) due to its ability to bind strongly to the NC surface41. Shorter alkyl chain ligands are more desirable for photonic and optoelectronic devices due to their enhanced charge transport—resulting in improved conductivity—compared to longer alkyl chain ligands.

To ensure complete reproducibility, the entire optical dataset—UV–Vis absorption and PL spectra (400–700 nm, 1 nm resolution) for all 3648 NC synthesis experiments as well as the associated reaction conditions—is provided as Supplementary DataS1. No data points were omitted; the main-text figures are distilled information of this complete set, filtered only by the emissive/non-emissive classifier described inMethods.

Rainbow’s digital twin, trained with data from all experimental campaigns, is utilized to investigate the influence of continuous reaction variables on the NCs’ optical properties. C4 and C18 are heavily selected by the AI agent to obtain high-quality CsPbBrxCl3-xand CsPbBrxI3-xNCs, respectively. Snapshots of the entire parameter space are captured to understand the role of precursor concentrations on the MHP NC properties for both ligands. Under moderate halide precursor concentrations and low ligand concentrations—with respect to the initial stock solution concentrations—reducing the DDAB concentration resulted in a narrower FWHM, indicating improved monodispersity in the synthesized MHP NCs (Fig.6a, d). DDAB serves dual functions as a bromide source and the organic base ligand. The acid-base equilibrium reaction of the organic acid and base results in a weak hydrogen bonding to the NC surface, while the labile ammonium moiety can remove halide ions from the NC surface, leading to surface defects and degradation of NCs’ optical properties55–57. Thus, minimizing excessive amines in the reaction system enhances colloidal stability.

Surface plots presenting the impact of synthesis conditions onafull-width-at-half-maximum (FWHM),bproxy photoluminescence quantum yield (PPLQY), andcpeak emission energy (EP) of MHP NCs capped by butyric acid (C4); the impact of synthesis conditions ondFWHM,ePPLQY, andfEPof MHP NCs capped by oleic acid (C18) for three different normalized concentrations(X) of other parameters listed on the surface plots (low = 0.2, medium = 0.5, and high = 0.8) with respect to their dosage upper limit. Source data are provided as aSource Datafile.

In addition, FWHM reached its minimum at a Pb:Cs molar ratio of approximately 2.5:1 across all DDAB levels. A moderate excess of lead prevents vacancy defects within the NCs, thereby improving colloidal stability and enhancing the resulting NCs’ optical properties. ThePPLQYexhibited a complex dependence on the concentrations of Cs and Pb precursors (Fig.6b, e), presenting significant challenges for comprehensive human-dependent exploration, precision synthesis, and optimization. Nevertheless, a Pb:Cs ratio of ~2.5:1 consistently maximizedPPLQYfor both C4 and C18 across varying DDAB levels, which is attributed to decreased vacancy defects inside of NCs due to the moderate excess amount of lead58,59. Additionally, with all other variables held constant, NCs capped with C18 exhibited higherPPLQYcompared to those capped with C4. This enhancement is attributed to the stronger binding and superior surface passivation afforded by the longer alkyl chain of the C18 ligand. Considering that halide exchange is governed by a diffusion-limited transformation mechanism60, increasing the concentration of the halide source is expected to shift the Br–X (X = Cl, I) equilibrium toward the formation of pure CsPbX3NCs (Fig.6c, f).

The >3600 reactions executed by Rainbow reveal a chemically consistent picture of MHP NC formation. First, the continuous decrease in FWHM and concomitant rise in PLQY as the Pb:Cs ratio approaches 2.5 link a moderate excess of Pb to vacancy suppression in the perovskite lattice (Fig.6a, b, d, e). This trend, emergent from thousands of statistically independent trials, is consistent with the defect-chemistry model proposed by Pan et al.15. Second, mapping PLQY across six carboxylic acids of increasing chain length reveals an HSAB crossover: short-chain butyric acid (harder donor) maximizes optical quality for Cl-rich NCs, whereas softer, long-chain oleic acid is optimal for I-rich compositions (Fig.S14). The autonomously generated experimental data by Rainbow, therefore, support an HSAB-rationalized binding hierarchy in which ligand softness must match the polarizability of the terminating halide to minimize surface trap states. Finally, digital twin sensitivity analysis (Fig.S19) and Shapley analysis (Fig.S20) elucidate the role of processing conditions on the optical properties of MHP NCs which, including (1)EP, strongly relied upon DDAB and halide concentrations, with DDAB anchoring the bandgap of pristine CsPbBr3NCs and halide modulating the bandgap with halide exchange reactions; (2) ligand identity and Cs-Pb-halide synergistic modulation are the most critical parameters in tuning MHP NCs’ PLQY, with ligand structures affecting the binding energy, thereby leading to distinct surface defect passivation, whilst the participation of Cs-Pb-halide refines the surface passivation and structural vacancy; (3) with the DDAB concentration playing a dominant role vis-à-vis emission linewidth (FWHM) with >70% contribution to the variance. For example, a DDAB-poor environment induces the narrow emission linewidth suggested by Shapley analysis (Fig.S20). These findings demonstrate that Rainbow’s closed-loop strategy not only optimizes, but also extracts mechanistic rules from high-dimensional data.

To demonstrate the knowledge scalability of Rainbow, 30-fold scale-up NC synthesis is conducted for the identified best-performing MHP NCs for every targetedEP. The best-performing MHP NC for every targetEPis identified as the NC with the highestPPLQYwith the FWHM below 0.11 eV, which is considered as a uniform NC size distribution61. Figure7presents the spectral analyses of the scaled-up MHP NCs vs. Rainbow’s autonomous results, indicating its knowledge scalability. Figure7also shows images of the scaled-up MHP NC samples under UV illumination for all targetedEpvalues. Replicate statistics confirm that the optical trends reported above are not artifacts of automation. Across 24 independent conditions (4 replicates each), the coefficient of variation is 0.16% for peak emission energy, 1.07% for FWHM, and 3.96% for proxy PLQY (Fig.S7). To corroborate these optical metrics with structural evidence, we performed ex-situ TEM/EDS (Fig.S21) and powder X-ray diffraction (Fig.S16) on the best-performing NCs at each target bandgap: all samples exhibit the expected cubic perovskite phase with lattice constants that scale smoothly with average halide radius, and no secondary phases are detected within the instrument limit of 2 wt%. These orthogonal measurements confirm that the surrogate model’s predictions—derived solely from high-throughput spectral data—correctly capture changes in defect density and composition, validating the reliance on high-throughput optical read-outs for closed-loop control in lieu of low-throughput techniques such as time-resolved PL or Small-angle X-ray scattering (SAXS). The diversity of the discrete (ligand structure) and continuous (reaction conditions) parameters of the best-performing MHP NCs, along with their distinct morphologies (nanocubes, nanoplatelets) for different targetEPvalues demonstrate Rainbow’s efficiency in navigating such a complex and high-dimensional NC synthesis space. Additionally, the unique processing parameters for different targetEPvalues reveal the complicated and inter-related ligand structure-synthesis-properties relationship of MHP NCs. Precision synthesis of semiconductor NCs while dealing with such a multivariate reaction space becomes an extremely time- and resource-intensive challenge for solely human-dependent experimental material science strategies that might need more than 10-12 months to identify the optimal processing parameters for a targetedEp. However, Rainbow’s autonomous robotic experimentation workflow was able to discover the Pareto-Front of MHP NCs for a targetedEpwithin one day, achieving over 350× material discovery acceleration.

Comparisons of Ultraviolet-visible (UV-Vis) absorption (abs) and photoluminescence (PL) spectra between autonomous (Rainbow) and scaled-up synthesis of the best-performing metal halide perovskite (MHP) nanocrystals (NCs) for all target EPs values ofa1,9 eV,b2.1 eV,c2.3 eV,d2.5 eV,e2.7 eV, andf2.9 eV. The inserts show the pictures of scaled-up MHP NC synthesis products under UV illumination. Source data are provided as aSource Datafile.

In this work, we developed Rainbow, an intelligent multi-robot SDL, to autonomously explore the experimental Pareto-Front of semiconductor NC properties for any user-defined targetEP. Rainbow was able to autonomously identify both the discrete (ligand structure) and continuous (reaction conditions) NC synthesis parameters needed for the best-performing MHP NCs within one day of autonomous robotic experimentation. We established a closed-loop MHP NC synthesis and development strategy by integrating a modular robotic experimentation platform with data-driven modeling and a fine-tuned experiment-selection algorithm. Rainbow’s efficient navigation through the mixed-variable parameter space accelerates the fundamental understanding of the complex ligand structure-synthesis-properties relationship of semiconductor NCs as well as the identification of the best-performing MHP NCs. Rainbow unraveled the intricate combination of ligand structure and reaction parameters for MHP NCs with a tailoredEP. The short alkyl chain organic acids were proven to be effective in producing high-quality MHP NCs. In addition, the ambient environment compatibility of the MHP NCs materials chemistry explored by Rainbow facilitated the synthesis scale up. The scaled-up NC synthesis confirmed the scalability of the synthesis science knowledge generated by Rainbow, illustrating the potential for large-scale NC production for next generation clean energy and display technologies. Rainbow’s modular hardware and flexible automation make it generalizable for research acceleration of other solution-phase processable nanomaterials beyond MHPs.

o-xylene (Thermo Fisher, 99%), lead acetate trihydrate (Thermo Fisher, 99 + %), cesium carbonate (Thermo Fisher, 99%), didodecyldimethylammonium bromide(DDAB, Thermo Fisher, 99%), butyric acid (C4, Thermo Fisher, 99 + %), hexanoic acid (C6, Thermo Fisher, 99%), heptanoic acid (C7, Thermo Fisher, 98 + %), octanoic acid (C8, Thermo Fisher, 99%), 2-hexyldecanoic acid (C16, TCI, 98.0 + %), oleic acid (C18, Thermo Fisher, tech.90%), zinc iodide (ZnI2, Thermo Fisher, ultra dry, 99 + %), zinc chloride (ZnCl2, Thermo Fisher, ultra dry, 99 + %), oleylamine (Sigma, tech.70%), and 1-dodecanethiol (DSH, Thermo Fisher, 98%) were used as received.

60 mg of lead acetate trihydrate was dissolved in 10 mL of organic acid L (L: butyric acid, hexanoic acid, heptanoic acid, octanoic acid, 2-hexyldecanoic acid, or oleic acid) and 500 mL of o-xylene under vigorous stirring.

25 mg of cesium carbonate was dissolved in 10 mL of organic acid L (L: butyric acid, hexanoic acid, octanoic acid, 2-hexyldecanoic acid, or oleic acid) and 500 mL of o-xylene under vigorous stirring.

107 mg of DDAB was dissolved in 500 mL of o-xylene under vigorous stirring.

10 mL of organic acid L (L: butyric acid, hexanoic acid, heptanoic acid, octanoic acid, 2-hexyldecanoic acid, or oleic acid) was added to 30 mL of o-xylene under vigorous stirring.

600 mg of zinc iodide was dissolved in 10 mL of oleylamine and 30 mL of DSH, then 6.15 mL of the prepared solution was added to 500 mL of o-xylene under vigorous stirring.

320 mg of zinc chloride was dissolved in 10 mL of oleylamine and 30 mL of DSH, then 6.15 mL of the prepared solution was added to 500 mL of o-xylene under vigorous stirring.

The multi-robot self-driving lab (SDL) consisted of (1) a pipetting robot (Opentrons OT-2) equipped with a multi-channel pipette (Opentrons P-300 GEN2) accompanied by a heater-shaker module (Opentrons Heater-Shaker Module, with Universal Flat Adapter); (2) a robotic arm (DOBOT CR5) equipped with a gripper (OnRobot RG6); (3) a characterization robot (Agilent BioTek Cytation 5); and (4) a bespoke labware refreshment robot we refer to as a plate feeder (see Fig.S3).

The formulation and synthesis robot used a 96-well mid-well plate (Thermo Fisher 60180P350), 96-well plate (Thermo Fisher 267334), 12-well reservoir (USA Scientific 1061-8150), 2-well reservoir (Agilent 203852-100), 1-well reservoir (NEST 360206), and 12-well reservoir ‘lids’ (Thermo Scientific 260254) to automatically prepare MHP nanocrystal (NC) precursors and conduct the synthesis and sampling.

Rainbow’s entire automation workflow is controlled by a custom-developed Python script and no human intervention is required. In order to maximize Rainbow’s experimental operation efficiency, multiple tasks in the workflow were parallelized using a scheduling scheme conceptually akin to the computer engineering method of instruction pipelining43. Fig.S6illustrates Rainbow’s parallelized workflow with each task along with the executing hardware module.

At the beginning of each experimental iteration, the edge server updates the belief model (i.e., current understanding of the NC synthesis reaction) and recommends a set of experimental conditions to move towards the identified objective identified by the human operator. If there is no available data for ML model training of the belief model, the experimental conditions are generated using the Latin Hypercube Sampling approach. The generated experimental conditions data is stored in.csv files and uploaded to the pipetting robot. Simultaneously, the pipetting robot transfers the synthesis solvent (o-xylene) to a short-well 96-well plate (characterization well plate), and the robotic arm ferries the loaded characterization well plate to the characterization robot. The precursor allocation on the deck of pipetting robot is shown in Fig.S4.

Following the completion of the experimental conditions’ generation, the plate reader commences the reading of the UV-Vis absorption spectra (300–800 nm) with a 1-nm resolution in sweep mode. Concurrently, the synthesis of MHP NCs begins in the pipetting robot. The robotic arm removes the lids covering the precursor reservoirs and the heater-shaker module starts shaking at 1000 rpm till the end of synthesis, during which the precursors are injected whilst the module shakes to ensure uniform mixing of the precursors. Then, the pipetting robot transfers the organic acid precursors, Pb and Cs precursors, and o-xylene to the mid-well 96-well plate (reactor well plate) located on the heater-shaker module of the robotic NC synthesizer. The pipetting robot waits 10 min for a uniform mixing of the precursors and then transfers DDAB precursors into the reactor well plate. Immediately after injection of the DDAB precursor into to the reactor well plate, a yellow-green color emerges that can be observed under ambient light, indicating the synthesis of CsPbBr3NCs. The second synthesis step, the halide exchange process, starts 20 min after the CsPbBr3NC synthesis step. Immediately after injection of the halide precursors into the reactor wells containing as-synthesized CsPbBr3NCs, a color change can be observed under ambient light, confirming the production of the mixed halide MHP NCs. The heater-shaker module continues shaking the reaction mixture for an extra 10 min to allow the completion of the diffusion-based halide exchange reaction. Concurrently, the automated acquisition of the reference spectra from the reaction solvent (o-xylene) is completed.

Following the completion of the parallelized NC synthesis step, the robotic arm recaps the precursor reservoirs and transports the characterization well plate from the characterization robot to the pipetting robot. The pipetting robot empties the o-xylene initially contained therein, before sampling the as-synthesized NCs. The robotic arm then transports the NC-loaded short well plate to the characterization robot and starts the NC characterization, i.e., acquiring the UV-Vis absorption spectra from 300–800 nm with a 1 nm resolution in sweep mode and the emission spectra from 400–700 nm using a 365 nm excitation wavelength with a 1 nm resolution in sweep mode. Whilst the NCs are under characterization, the pipetting robot collects the remaining unsampled crude solutions in the reactor well plate and transfers them to the liquid waste reservoir. The robotic arm then disposes of the reactor well plate and pipette tip rack into two dedicated solid waste containers. Following this step, the robotic arm picks up a fresh reactor well plate and pipette tip rack from the plate and tip rack feeders, readjusts their positions relative to the robotic arm’s gripper with an L-shaped bracket that we refer to as a position fixer, (in order to compensate for any positional irregularities that may have arisen during transfer), and then places them in their designated slots in the pipetting robot. Meanwhile, the plate feeders’ microcontrollers raise the feeders’ linear actuators until the next piece of labware on the rack touches a sensor, thereby ensuring that the robotic arm will always find fresh labware at the exact same position. More details of the plate feeders are provided in theSupplementary Materials.

After completing the NC characterization step, the robotic arm retrieves the characterization well plate from the characterization robot, whereupon the pipetting robot transfers the solutions inside the short well plate to the waste reservoir. The robotic arm then disposes the characterization well plate in the solid waste container and fetches a fresh characterization well plate from the plate feeder, again availing itself of the position fixer, and places it into the designated slot in the pipetting robot. The spectral data generated by the characterization robot are stored in.csv files and processed by a custom-developed Python script. The replacement of the short well plate marks the completion of the current experimental iteration.

Further information on research design is available in theNature Portfolio Reporting Summarylinked to this article.

MA gratefully acknowledge the financial support from the University of North Carolina Research Opportunities Initiative (UNC-ROI) and National Science Foundation (award no. 1940959 and 2208406).