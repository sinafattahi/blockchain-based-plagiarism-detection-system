Plants sequester carbon in their aboveground components, making aboveground tree biomass a key metric for assessing forest carbon storage. Traditional methods of aboveground biomass (AGB) estimation via Forest Inventory and Analysis (FIA) plots lack sufficient sampling intensity to directly produce accurate estimates at fine granularities. Increasing the sampling intensity with additional FIA plots would be labor and time intensive, particularly for large-scale carbon studies. Utilizing remote sensing (RS) data, such as Airborne Light Detection and Ranging (LiDAR), aerial imagery, and satellite images can significantly enhance the efficiency of forest carbon monitoring efforts. The principal objective of this study is to utilize the random forest (RF) algorithm to build predictive AGB models. We utilized 67 explanatory variables, which were extracted from three RS sources resulting in nine RF models. Each RF model was subjected to variable selection, hyperparameter tuning, and model evaluation. The optimum model considered 28 explanatory variables, with root mean square error (RMSE) of 27.19 Mgha−1and R2of 0.41. Combining LiDAR with image metrics increased the accuracy of prediction models, serving as a pivotal tool for large area biomass mapping and carbon related decision making.

The online version contains supplementary material available at 10.1038/s41598-025-15585-6.

Forests span over 410 million hectares globally, serving as vital carbon sinks that store atmospheric carbon mainly as above-ground biomass1. Understanding carbon sources and their sequestration is crucial for mitigating actions against global climate change2. Aboveground biomass (AGB) of trees in the forest is the foundation of estimating above ground carbon and understanding the carbon sink and source balance3. Forests and woodlands occupy over one third of the United States landscape, containing approximately 1 trillion cubic feet of wood volume4. An estimated 58% of the land area of the state of Connecticut meets the Forest Inventory and Analysis (FIA) definition of forest land. Connecticut encompasses 1.8 million acres of forested land, which bears approximately 135.69 million tons of oven-dry AGB5.

There are two primary methods of calculating above ground biomass, (i) direct and (ii) indirect methods6. The direct (or destructive) method measures the oven-dry weight of the entire plant above ground material. Destructive sampling is a complex, time-consuming method used primarily to develop and calibrate allometric equations of AGB from tree structural parameters. Indirect methods utilize those allometric equations to provide AGB estimates from field inventories of tree structural characteristics7,8. In forests indirect estimation is almost always the method used due to the practical infeasibility of directly estimating AGB. As applied indirect estimation uses species-specific allometric equations to calculate the approximate AGB of trees and forested areas9,10. The FIA program, which has been conducting comprehensive forest inventories for over seven decades from local to national scales11provides a statewide database of AGB estimates for inventoried trees, subplots and plots. FIA has historically used the component ratio method (CRM) to calculate the AGB estimates, but in 2023 the National Scale Volume Biomass (NSVB) model was introduced for more accurate biomass estimations12,58.

A rapid and accurate estimation of large area (e.g., statewide) forest AGB using field inventory data remains challenging in the forestry research sector13. Utilization of remote sensing (RS) techniques in forestry has been increasing due to efficiency, accuracy and predictability when studies require largescale and high temporal resolution data13,14. RS data facilitates building large-area maps in different spatiotemporal scales, particularly when field sampling is insufficient for statistical estimation for state or landscape level modeling15.

Combining RS data with FIA data is one of the popular techniques that has frequently been utilized16–18. Light Detection and Ranging (LiDAR) data is often employed to build random forest (RF) models to predict forest AGB16. Hu et al.19used spaceborne LiDAR, satellite images, climate surfaces, topographic data, and optical imagery to build 1 km resolution AGB density maps at global scale with R2of 0.56 and RMSE of 87.53Mgha−1. Hudak et al.20built a carbon monitoring system utilizing 3805 field measured plots for mapping regional, annual aboveground biomass across the northwestern USA achieving R2of 0.8 and RMSE of 152 Mgha−1. Tang et al.21published a multi-state level forest carbon map with 30 m level predictions with R2of 0.38. Tang et al.21utilized 1986 FIA subplot locations, LiDAR, and National Agriculture Imagery Program (NAIP) data. Other studies have utilized synthetic aperture radar (SAR), vegetation indices (VIs), and Moderate Resolution Imaging Spectroradiometer (MODIS), to create a range of machine learning (ML) and multiple linear regression models (MLR)18,22–24.

Integrating FIA data with both passive and active remote sensing technologies, (such as LiDAR, Landsat, Sentinel-2, and NAIP), enhances large-area biomass predictions by providing valuable details at higher temporal and spatial resolutions that are particularly relevant for canopy cover and disturbance characteristics25. According to Mancini et al.26remotely acquired data enhances the information in field data and reduces the need for additional extensive fieldwork. LiDAR provides a comprehensive characterization of forest structure, canopy height information, vertical profile, and tree density16,27,28. Such detailed 3D representation enables a precise estimation of AGB and carbon stocks due to the strong linear relationship between tree height and tree diameter29. In terms of RS image observations, Sentinel-2 data provides high temporal resolution and NAIP offers high spatial resolution (0.6 m). Variables developed from remotely sensed imagery have become crucial data for characterizing forest health, composition, and qualitative characteristics. For example, grey-level co-occurrence matrix (GLCM) textures30inform canopy complexity and spatial heterogeneity, which are important for distinguishing biomass variation31,32. The vegetation indices provide valuable information about the vegetation characteristics, vegetation vigor, moisture content, canopy density, and distribution32,33. Principal Component Analysis (PCA) has been employed to reduce the large number of variables and redundant information into a more manageable set of variables while preserving the primary information dimensions available in the original data34.

Among previous AGB modeling efforts, Sheridan et al.27and Li et al.15built linear regression models, linear dummy variable models, and linear mixed-effects models. Previous studies have extensively explored different parametric and non-parametric algorithms to model forest AGB18,35. The RF algorithm has been frequently used in forest AGB modeling16,27,36,37but in addition to RF Li et al.15used gradient boosting and Sivasankar et al.38used a support vector machine (SVM) regression to predict forest AGB. Johnson et al.18and Wolpert39, developed stacked ensemble models for previously developed prediction models. In addition to pure statistical models, Ma et al.40estimated AGB using the ecosystem demography (ED) model. Other studies further utilized other image composites and percent tree cover, land cover proportions, and climate parameters to build tree-based algorithms41,42.

For large-area estimations, traditional forest inventory approaches are time and labor intensive, which limits their effectiveness for high-resolution AGB assessment. This limitation underscores the need for scalable, accurate, and cost-effective methods to estimate forest AGB across large and heterogeneous landscapes. Previous studies have leveraged remote sensing data and ML algorithms as potential solutions. Despite the growing use of ML algorithms such as random forest (RF) for AGB prediction, critical knowledge gaps remain16,43–45. Notably, the implications of Forest Inventory and Analysis (FIA) data policies which restrict access to georeferenced field plots are not well studied. Furthermore, the utility and structural optimization of RF models with limited training data conditions remain underexplored in the context of forest AGB estimation. These gaps limit the generalizability and robustness of RF based approaches, particularly in data-sparse or policy constrained regions. In this study, we hypothesize that optimizing the tree structure of random forest (RF) models through variable selection and hyperparameter tuning, combining with the integration of multimodal remote sensing (RS) data, can significantly improve the accuracy and robustness of aboveground biomass predictions. This approach is expected to be especially effective in scenarios with limited training data access and necessary for generating reliable AGB estimates across large, forested landscapes.

We utilized FIA data for both model training and validation, applying FIA-developed methods to evaluate the consistency between our biomass estimates and those generated by FIA. To achieve a spatially explicit representation of AGB across Connecticut, we employed a model-based approach that translated FIA’s discrete plot-level measurements into spatially continuous AGB predictions at a minimum of 15 m resolution. We addressed several common challenges associated with combining FIA and RS data for large-scale, fine-resolution biomass modeling and mapping. We employed the Random Forest (RF) algorithm, a method commonly utilized by researchers for estimating AGB due to its robustness in handling collinear data and spatial autocorrelation effectively44,45In this study we also investigated the effectiveness of using detailed hyperparameter tuning and variable importance analysis to optimize RF model and to identify the most meaningful set of input variables16,43. We attempted to identify an effective method for integrating multi-modal remote sensing data and auxiliary spatial products with FIA subplot data. Our goal was to build robust models with improved accuracy of AGB estimates in Connecticut forests compared to previous efforts in literature17,27. We developed a comprehensive framework to address the challenges associated with utilizing FIA data, emphasizing its critical value in large-scale biomass estimation. Finally, we evaluated the agreement between our spatially explicit AGB estimates and FIA-derived biomass estimates with existing AGB map products18,46.

Our study was the state of Connecticut (41.6° N, 72.7° W), located in the northeastern United States and spanning approximately 13,023 km²47. Connecticut is characterized as a humid continental climate with cold winters and warm, humid summers within the Northeastern coastal zone and lower New England ecoregion48. We focused on the forests of the state of Connecticut, United States (Fig.1) dominated by the Oak and Hickory species. As defined by the Global Forest Resources Assessment49a forest is characterized as land covering more than 0.5 ha, with trees exceeding 5 m in height and a canopy cover greater than 10%, or with trees that have the potential to naturally meet these criteria. In 2016, Connecticut’s forested land was estimated at 7,274.35 km² (1.8 million acres). Of this, 71% is privately owned, while 28.59% is owned by state and local governments. Federal ownership accounts for 0.46%, excluding developed and agricultural lands50.

The study area. Forests of Connecticut extracted using Connecticut 1 m landcover map 2016. Publicly available forest inventory and analysis (FIA) plot locations were demarcated in dark purple points available for 2016, phase 01 FIA inventory. The bottom right corner is a graphical visualization of FIA subplot design identical for all the FIA plot locations.

The methodology (Fig.2) involves identifying FIA plot locations belonging to the 2016 collection year, and creating raster layers from LiDAR, Sentinel-2 images, NAIP images, CT soil maps, and CT forest cover types51. The study consisted of 42 FIA true plot locations (168 subplots) and 67 explanatory variables derived for each subplot location corresponding to 2016 data collection. Each explanatory variable was meticulously selected by a thorough literature review to represent forest and vegetation characteristics (i.e. tree height, slope, forest heterogeneity, and tree health). Prior to model training, candidate remote sensing variables underwent a rigorous selection process to reduce dimensionality and identify the optimal subset of variables for RF models given the sample size.

Research workflow. The framework consisted of four major steps: calculating aboveground biomass using forest inventory and analysis field data, identifying remote sensing data layers, and data extraction, random forest model training, and application.

The FIA process integrates two active phases as outlined in the FIA user guide58. According to the 1998 legislation, a five-year data collection cycle is required for permanent phase two plots nationwide11,52,53. The FIA program measured and recorded 320 sample plots with some forested conditions (plot status code = 1) in Connecticut from 2011 to 2016. Approximately 14% out of 320 were measured annually resulting in 42 plots for 2016. The FIA plot design consists of a systematic cluster of four subplots, as shown in Fig.354,55.

(a) Phase 02 and phase 03 forest inventory and analysis (FIA) subplot design and assigning subplot numbers58. (b) True LiDAR points cloud of Forest Inventory and Analysis plot location as a 3D local scene. (c) A raster layer of 95th percentile derived using 2016 LiDAR point cloud.

We used the 2016 FIA data to align with Connecticut’s 2016 LiDAR mission. This ensured efficiency and the project completion within the timeline since the entire analysis was done remotely. Additionally, growth adjustments were not integrated, as we used single-year data to avoid introducing further uncertainties into the analysis. In 2016, the Northern Research Station Forest Inventory and Analysis program (NRS-FIA) utilized Rockwell Precision Lightweight GPS Receivers. The GPS readings have an average discrepancy of 8.0 m between the observed coordinates and the known reference points56. We utilized true locations of 42 FIA plots, resulting in 168 FIA subplots (Fig.3a)16,27. The public FIA data is perturbed to reduce plot coordinate accuracy to maintain landowner privacy via fuzzing and swapping57. Fuzzing involves shifting the plot coordinates to within 1.0 mile of the actual location. In addition, up to 20% of private plot coordinates are swapped with similar plots within the same county to prevent linking data to specific landowners. Obtaining true FIA subplot locations was essential for this study because of the fine spatial resolution of the analysis and imagery used, however this posed challenges due to FIA’s data consent policies. To work with this situation, all R codes were written and initially tested using the publicly available data through FIA’s Spatial Data Services. The final development of R code and model tuning was run remotely using FIA true plot locations via a collaboration with FIA scientists.

We used the FIA subplot-level AGB estimates calculated using the component ratio method (CRM) for 168 FIA subplots27. The CRM calculations were already recorded on FIA database following the exact methods following FIA user guide Version 9.0.1 for Phase 258. The subplot locations allow for a better assessment of heterogeneity within the forested areas. This approach increased our ability to extract high-resolution RS data and to improve the model predictions12,16,57–59. The FIA data tables with tree measurement records were used to calculate the cubic foot volume of each tree stem in all 168 subplots57,58. Afterwards, tree-level AGB was totaled to get the AGB per subplot58. Allometric estimates of AGB were calculated by using Eq.1>9for tops and limbs as a proportion of the merchantable bole.

bm= total aboveground biomass for trees 12 cm and larger16.

In our study, we only considered the trees with diameter at breast height (dbh) ≥ 12.7 cm (≥ 5 in) for the AGB calculations18. Moreover, 892.17 lbac−1equivalent to 1 Mgha−1was the conversion factor of AGB60,61. Although non-forest areas in CT are known to contain trees, in this study we assumed that non-forested areas consist of 0 Mgha−1AGB to align with the definition of FIA forestland16,18. The FIA estimated AGB values were the response variable of our study. After excluding subplots in non-forested areas12,29other spatial outliers generated from instrument errors and geolocation uncertainties of the field dataset were identified and removed by comparing discrepancies between observed and expected values16. We excluded the locations with smaller field biomass estimates (< 50 Mgha−1) with high LiDAR heights (> 30 m) or subplots with zero AGB but had LiDAR heights greater than 10 m29. This resulted in reducing the training data set from 168 to 142.

The state of Connecticut has a statewide airborne LiDAR data set, which was collected from March 11, 2016, through April 16, 2016, with USGS quality Level 2. The point density is 2 points/m2covering about 13,567 km2(5240 miles2), producing 23,381 tiles. LiDAR data and derived 1 m resolution digital elevation models are referenced to the Connecticut State Plane NAD83 (2011) feet horizontal coordinate system, and NAVD88 feet vertical datum62. We derived63LiDAR metrics using ArcGIS Pro 3.1.2 and FUSION/LDV processing software (version 4.40)27. We extracted mean raster values of each LiDAR metrics listed in Appendix 1 at subplot level. The canopy height model (CHM) was one of the input variables derived from LiDAR first returns provided tree heights to the model13,32,64. We created rasters for LiDAR height percentiles, height bins, and height densities using the distribution of Z Cartesian coordinate from point cloud. These elevation metrics were used to train the model with the information of vertical structure and complexity of the forest vegetation17,20,24,27,65.

We utilized the National Agriculture Imagery Program (NAIP) data acquired in 2016 (with leaf-on condition) at a nominal resolution of 0.6 m24,31. We built the second order GLCM textural rasters of NAIP green and near-infrared (NIR) bands24,31,66, VIs24,64,67and first four PCA rasters based on remaining NAIP bands31,34(Appendix 2). We employed Sentinel-2 satellite images from spring 2016, coinciding with the LiDAR data collection period. The considered Sentinel-2 images only consisted of ≤ 10% cloud coverage and were preprocessed68,69. The VIs and spectral responses of image bands were derived from bottom of atmosphere reflectance (BOA) within selected Sentinel-2 images (Appendix 3)13. We derived a series of VIs including normalized difference vegetation index (NDVI)24,64,67, normalized difference red edge (NDRE)70,71, and normalized difference moisture index (NDMI)71to represent the vegetation health, greenness and moisture content. The existing National Oceanic and Atmospheric Administration (NOAA) Coastal Change Analysis Program 1 m land cover map and Connecticut soil type shape file were also employed to extract categorical variables72.

We grouped the explanatory variables based on their original RS data source32. We identified three distinctive groups; i) Group-1: all 67 metrics combined (LiDAR, NAIP and Sentinel-2), ii). Group-2: LiDAR metrics, and iii). Group-3: image metrics (Appendix 1–3). This categorization enabled us to gauge the contribution of different RS sources to AGB modeling24,32. We tested nine RF model configurations to systematically evaluate the effects of different variable combinations, aiming to balance model efficiency and accuracy during tuning and training. Following the approach suggested by Erdody and Moskal73.This process also helped us identify the most important variables for training and reduce model complexity.

Although the Random Forest (RF) algorithm is widely used in AGB research, its performance with limited training datasets remains underexplored19–21. Due to the FIA data non-consent policy, we conducted our analysis off-site using the computing infrastructure of the USDA Northern Research Station, without direct access to precise plot coordinates. Our innovative approach included the following treatments: i) grouping of remote sensing (RS) variables based on RS data source32and ii). feature selection based on cross-validated R² and IncNodePurity metrics to reduce the multicollinearity, dimensionality and overfitting risk32ii). meticulous hyperparameter tuning to optimize model performance13,16,32,43. This integrated strategy allowed us to effectively train the RF model despite limited access to ground-truth data.

The RS data extraction produced 67 explanatory variables as inputs for the RF models, with FIA-AGB estimates serving as the response variable. We identified three explanatory variable groups based on RS data source: i) Group-1: all 67 metrics combined, ii). Group-2: LiDAR metrics, and iii). Group-3: image metrics24,32. Per each group, we used increase in node purity (IncNodePurity)74and the coefficient of determination (R²) from the 5-fold cross-validation (CV) to identify the most important set of variables for all the RF models in a forward selection process43,75. We trained a series of RF models using repeated K fold cross-validation by adding one variable at a time from the most important to the least important variable based on IncNodePurity13,32,43. As the last step, partial dependency curves were plotted to illustrate contribution of the most important variables for AGB prediction76.

The RF algorithm is known for making robust predictions even if the predictor variables are highly correlated77. Further, we incorporated bootstrap sampling to reduce the effect of spatial autocorrelation among the subplots. The tree-based structure of RF algorithm utilizes different training datasets to build each decision tree, minimizing spatial dependency among subplots78. We implemented the RF algorithm using therandomForestpackage in R version 4.3.136,79. The identified groups i) Group-1: all 67 metrics combined, ii). Group-2: LiDAR metrics, and iii). Group-3: image metrics24,32separately went through a careful hyperparameter tuning process resulting in nine models.

We employed an 80:20 split strategy to divide 142 subplot data into training and testing subsets ensuring a robust training process and providing a separate dataset for testing for all three variable groups18. Given the relatively small size of the dataset (142), hyperparameter tuning (Table1) was tasked to strike a balance without overfitting32. We initially trained a default RF model for each group. Secondly, we optimized two key parameters: Mtry(number of independent variables per split) and Ntree(number of regression trees) to identify the requirement of an exhaustive hyperparameter tuning43. Finally, a complete hyperparameter optimization was done by usingtuneRFfunction of therandomForestpackage in the R environment32,43. The final hyperparameter optimization employed theexpand.gridfunction in the R environment, providing a sequence of values representing each hyperparameter of the parameter space (Appendix 5). The grid search involves exhaustive exploration with a stopping metric equals to 20 to streamline the process. This procedure resulted in nine individual RF models, three for each variable group32. We tasked a 5-fold CV for tuning and variable selection without requiring a separate validation set43(Table1).

Hyperparameter combinations for each model belong to all three variable groups.

The study utilizes exhaustive parameter tuning for RF03 models with grid search technique with 5-fold cross validation. Each technique was followed to maximize the robustness of the models in future utilization.

We used the hold-out 20% of data for the RF model testing which was never integrated in model training or validation process. The testing evaluation metrics, such as root mean square error (RMSE), mean square error of the out-of-bag errors (MSE), coefficient of determination (R2, and percentage variance explained were utilized to compare model performances17,27,32. This approach ensures robust evaluation and enhances model generalization to unseen data and grants a platform for comparative analysis43.

Finally, we compared the prediction performance of our RF model with three existing regional and landscape-level AGB map products: (i) a 90 m resolution map by Ma et al.40which employed the Ecosystem Demography (ED) model (Map_1), (ii) a 250 m resolution map developed by Blackard et al.41using tree-based algorithms (Map_2), and (iii) a regional map created by Menlove and Healey42(Map_3). Our plot-pixel assessment was based on absolute difference (i.e. mean, range) and similarity metrics (RMSE, R235to understand the possible improvements that our RF has at FIA sublot level. We compared all four predicted AGB values with growth adjusted FIA-CRM calculated biomass values of 28 subplot testing data with resampling if necessary (Appendix 4).

This study considered IncNodePurity value during the variable importance analysis for all three variable groups. We identified the most important set of variables to build the RF models followed by the ranking of variables based on IncNodePurity and forward selection of mean R2of 5-fold CV (Fig.4). The most important variable of both Group-1 (Combined) and Group-2 (LiDAR_metrics) was the 95th percentile derived from LiDAR point clouds (Fig.4a,b). From the cohort of image metrics in Group-3, the short-wave infrared (SWIR) band of Sentinel-2 leaf-off images was identified as the most important predictor variable for building RF models (Fig.4c). Out of all the explanatory variables (Group-1), 68% of the most important variables were LiDAR height-related metrics. The SWIR (1610 nm) band of Sentinel-2 and correlation texture rasters from the NAIP green band were the only image-derived metrics in the top 10 explanatory variables of Group-1 RF models.

Mean R2value for 5-fold cross-validation (a) all 67 variables, (b) Light Detection and Ranging metrics only (c) Image metrics only. In all three plots, X-axis represents the ranking of variables according to the IncNodePurity value, from left to right decreasing the importance. Main blue line shows the mean R2value of adding one variable at a time, from the most important to the least important explanatory variable. The Y-axis represents the changes of mean R2with 5-fold cross validation (CV) with error bars. The red highlighted points illustrate the highest CV R2value obtained.

Finding the best subset of the predictor variables is crucial to reduce dimensionality and overfitting of RF algorithm80. Group-1 reported the maximum cross validation R2value of 0.3364 for the first 28 explanatory variables. Group-2 and Group-3 yielded the maximum cross validation R2of 0.2265 and 0.2039, respectively using their top 16 variables. At this stage, we were able to reduce overfitting and ultimately reduce the complexity of variables.

A careful comparison of hyperparameter tuning was considered for all three groups as mentioned in Table1. All nine models were cross-validated and tested using a 20% hold-out dataset. Model test results are shown in Table2. We identified the grid tuned (grid search technique with 5-fold CV) RF models as the highest performing models through a comparative analysis of R2RMSE and percentage variance explained for each variable group. The Group-1, the grid tuned model (All_RF03) reported RMSE of 27.19Mgha−1, R2of 0.41, and 40.54% of percentage variance explained. The Group-2 grid tuned model (LiDAR_RF03) reported RMSE of 27.88 Mgha−1, R2of 0.23, and 23.49% of percentage variance explained. Lastly, The Group-3 grid tuned model (Img_RF03) showed RMSE of 26.50 Mgha−1, R2of 0.31, and 30.85% of percentage variance explained. We observed the smallest mean absolute error (MAE) and confidence interval (CI) for the All_RF03 model.

Evaluation metrics of random forest regression models.

The values were calculated by comparing the random forest model predicted biomass with the Forest Inventory and Analysis estimates of the left out 20% of the testing data. Performance metrics of the model with the highest R2are marked in bold.

When considering Group-1, the grid tuning process improved the R2from 0.19 to 0.40 while the RMSE decreased by 23.71%. Similarly for Group-2, the R2increased from 0.01 to 0.23 with RMSE reduction by 12.16%. Because of grid tuning, Group-3 also exhibited an increase in R2from − 0.01 to 0.31 whilst RMSE reduced by 18.06%. Increasing only the number of trees (Ntree) in the RF model does not necessarily result in improved performance, rather it escalates the computational burden43. A comparison between FIA-based AGB estimates and all the RF model estimates for different hyperparameter and variable spaces are illustrated in Fig.5.

Performance of random forest (RF) models for all three variable groups. The X-axis of the plots represents the aboveground biomass (AGB) values predicted from each RF model while the Y-axis represents the Forest Inventory and Analysis AGB estimates named as the Actual AGB in the plots. (a) RF Model predictions for all LiDAR and image metrics, (b) RF Model predictions for LiDAR metrics, and (c) RF model predictions for image metrics.

Upon studying the evaluation metrics outlined in Table2alongside the residual plots in Fig.6, the tuned RF models (All_RF03, LiDAR_RF03, and Img_RF03) of each group represented the lowest RMSE and the highest R2values comparing to their default RF counterparts. We selected All_RF03 model as the optimal RF model after comparing its evaluation metrics with the next best model, Img_RF03. The Img_RF03 model showed a decrease in R2by 24.39%, even with the 2.54% reduction in RMSE compared to the counterparts of All_RF03 model (Table2). An examination of residuals was conducted for the best models chosen from each group. Figure6shows that all the RF models give smaller residuals for AGB values below 100 Mgha−1, which demonstrates that tuned models represent poor agreement with actual data for the areas with higher AGB. Figure6a shows the smallest dispersion of residuals from the x axis, which is the FIA-AGB estimates. Concluding the results of evaluation metrics and the residual analysis, the All_RF03 model was selected as the optimal RF model for estimating forest aboveground tree biomass within the study area.

Residual vs. actual aboveground biomass (AGB) plots for the best random forest (RF) models of each group of variables. (a) Residual plot for the All_RF03 model for all LiDAR and image metrics (Group-1), (b) Residual plot for the LiDAR_RF03 model for LiDAR metrics (Group-2), and (c) Residual plot for Img_RF03 model for image metrics (Group-3). The field estimated biomass was considered as the actual biomass of the residual plots.

The partial dependency curves (PDC) of the All_RF03 model depict the average relationship between individual predictor variable and AGB prediction of the optimal RF model. In this study the top four explanatory variables from the optimum RF were documented, considering interactions and non-linearities captured by the ensemble of the RF decision trees. In Fig.7, PDCs display the explanatory variables on the X-axis, while the Y-axis represents the mean RF predictions of AGB. According to Fig.7a–c mean AGB response increases steadily, yet at different rates as the 95th percentile (P95th), 90th percentile (P90th), and Sentinel-2 SWIR band (sen_swir) increases until it flattens out. This suggests that higher variable values increase in the predicted AGB up to a certain point, after which the response stabilizes. However, the GLCM correlation from NAIP green band (green_layer8) exhibited a negative slope indicating the predicted AGB declines steeply with higher values of correlation of NAIP green band (Fig.7d).

Partial dependency curves (PDC) for the top four variables of optimal RF model (All_RF03). The X-axis represents the response of predicted aboveground biomass while the Y-axis shows the change of each explanatory variable while other variables remain constant. (a) Partial dependency curve for p95th LiDAR percentile, (b) Partial dependency curve for p90th LiDAR percentile, (c) Partial dependency curve of the short-wave infrared band of Sentinel-2 images, and (c) Partial dependency curve for correlation raster of NAIP green band.

This section presents the results of comparing our RF model performance and the three existing AGB map products against FIA-CRM estimates. The All_RF03 model achieved the lowest RMSE of 28.33 Mgha−1and highest R2value of 0.41, demonstrating better predictive accuracy than the existing regional and national maps (Table3). The Map_01 (regional 90 m) had the highest RMSE (145.35 Mgha−1) and the lowest R2(0.01), while the Map_02 (regional 250 m) and the Map_03 (national scale) performed slightly better but still exhibited higher RMSE values (82.47 Mgha−1and 81.84 Mgha−1, respectively) compared to our optimal RF model. This suggests that the optimal RF model significantly outperforms coarse-resolution AGB maps for plot-level biomass estimation in Connecticut.

Evaluation metrics of the plot-pixel analysis among the existing map products and the optimum random forest model biomass predictions with forest inventory and analysis field biomass estimates.

According to Fig.8, the wider confidence intervals for the available maps, particularly at higher AGB values, further highlight the advantages of the RF approach for finer-scale forest biomass predictions. The RF model (in red) shows the closest alignment with the 1:1 reference line indicating better agreement with FIA estimates across a wide range of biomass values. In contrast, MAP_1 consistently overestimates AGB estimates at FIA subplot level. MAP_2 and MAP_3 demonstrated more moderate overestimations but still deviate from the 1:1 line compared to RF. The RF model had a narrower uncertainty range at lower and moderate AGB values. These results suggest that our RF model outperforms the existing products in estimating plot-level AGB under restricted data conditions.

The results of the plot-pixel comparison of the performance of optimal random forest (RF) model and existing map products. Scatter plot of the Forest Inventory and Analysis aboveground biomass (AGB) estimates (X-axis) with RF predicted aboveground biomass AGB values of RF models and three available map products (Y-axis). Considered map products are Map_140, Map_241and Map_342. RF denotes the AGB prediction of our optimum RF model. The grey shaded area represents CI = 95% for each distribution and the 1:1 reference line is the dashed grey line.

The study aimed to evaluate the predictive capability of remotely sensed variables derived from a combination of multi-modal sources (LiDAR, Sentinel-2, and NAIP) and FIA data for enhancing state-wide forest aboveground biomass (AGB) estimation at fine spatial scales via the random forest (RF) algorithm. Initially, we leveraged the utilization of publicly available RS data combined with single year FIA data. This step prevents adding growth increment-related uncertainties into the model prediction18yet resulted in a small sample size to start with. We utilized the 2016 FIA data to align with Connecticut’s 2016 LiDAR mission, optimizing the project timeline and addressing the challenges associated with using FIA true plot data. Accurate estimation of forest AGB is essential for a range of ecological research areas, including carbon cycling, forest management, and forest dynamics81. The RF algorithm is widely used in forestry sector analysis due to its ability to work with multicollinearity and spatial autocorrelation problems82,83. We studied the importance of variable selection and hyperparameter optimization of the RF algorithm in estimating AGB. The AGB values (response variable) in this study were estimated using the FIA-CRM technique. As of September 2023, FIA has transitioned to the National Scale Volume and Biomass Estimators (NSVB) for more consistent and accurate tree structure accounting84.

Hyperparameter tuning led to a significant improvement in R2across all three groups, particularly the optimal RF model with a 115.79% increase in R2compared to its default counterpart. Negative R2values indicate that the model fit is poor. Johnson et al.16provides a comprehensive framework in utilizing RF algorithm to achieve R20.49 with a RMSE (91.5 Mgha−1). Our study achieved R2of 0.41, demonstrating the value of meticulous hyperparameter tuning and variable optimization even though the sample size is small (N= 142). Torre-Tojal et al.43provides recommendations to enhance AGB estimate accuracy, with hyperparameter tuning for small datasets (N= 55), achieving high geolocation accuracy and using area-specific allometric equations.

A majority of our estimates fall outside the 95% confidence interval at the upper end of the AGB distribution, indicating an underestimation compared to the FIA-estimated AGB at the upper levels of the reference distribution (Fig.5). This behavior can be a result of the smoothing characteristics of the RF algorithm85predictions for extreme values. We had only few field AGB samples exceeding 100 Mg ha-1in both training and testing datasets. Therefore, making data augmentation or splitting analysis was infeasible86. Synthetic data generation or multi-year data acquisition was challenging due to FIA plot data restrictions87. To avoid bias, we did not apply imbalance handling techniques such as oversampling.

In this study, LiDAR metrics were employed to quantify forest structural attributes, including tree height percentiles and slope, which are critical indicators of forest vertical complexity60. In contrast, the RS image metrics, obtained from sources, such as Sentinel-2 and NAIP, provided information on vegetation heterogeneity and overall vegetation health31. Combining image data with LiDAR data increased the overall performance of the model by 24% based on R2due to the inclusion of both forest vertical structure and heterogeneity related information. These complementary datasets allowed us a more comprehensive understanding of forest dynamics and contributed to the improved predictive accuracy of AGB estimation at subplot level.

Our study also focused on reducing the dimensionality via identifying the best variable subset for model tuning43. We employed IncNodePurity as the determination factor. Increase in IncNodePurity increases the overall performance of the RF model by improving the homogeneity at each node74. Of the most important variables from Group-1 RF models, 68% out of the 28 selected variables were LiDAR-derived while 18% and 14% of the selected variables were derived from NAIP and Sentinel-2, respectively. The prominence of top-level LiDAR height metrics, such as P95th or P99th, in RF models for biomass estimation can be attributed to their strong correlation with canopy structure and tree height. Tree height is one of the most crucial parameters to calculate AGB despite the diameter (DBH)88,89. According to Wang et al.90, tree height and AGB has an R² of 0.77. Riggins et al91., achieved R2of 0.72 only using LiDAR height percentiles with highly accurate field AGB values. But they mentioned that it is extremely difficult to achieve such accuracy in complex forested environments. As a solution, most of the recent studies use an array of LiDAR height metrics (percentiles, densities, and height bins) to train models17,27,32. We observed a strong influence of LiDAR height metrics in our RF model as 68% of selected predictors were LiDAR derived. LiDAR height percentiles provide a statistical summary of canopy height distribution within the plot. These metrics reflect important structural characteristics such as, the central tendency (mean and median), variability, and asymmetry of tree heights92,93. The selected LiDAR percentiles, 95th to 60th represent the upper canopy structure, with the 95th percentile indicating the tallest trees, which strongly correlate with mean AGB of plot level90. The height bins provide a normalized measure of the number of points27when density metrics represent the cumulative frequency of LiDAR returns of above specified height bins that include all points at or exceeding each threshold. They represent the canopy closure, density, and layering of the plots94. Generally, taller and mature trees have a greater biomass accumulation88. This explains the strong contribution of LiDAR metrics to the predictive accuracy of the RF model.

The tree aboveground biomass mainly consisted of organic matter and water stored in above ground components. The Sentinel-2 SWIR band is sensitive to vegetation water content95and to tree structural organic matter such as nitrogen, lignin, and cellulose96. Dang et al.97proved that the SWIR was the best response variables of AGB prediction with an R2of 0.81. Traditional vegetation indices such as NDVI, which primarily reflect greenness and chlorophyll concentration but often saturate in closed canopy or mature forest conditions2,98. Partial dependency curves (PDCs) illustrate the relationships between predictor variables and the predicted outcome while holding all other variables constant. PDCs provide valuable insights into how RF predictions change as a function of each predictor variable, allowing us to identify the importance and influence of each variable in RF regression models99. In our analysis soil-related and landcover classes were also examined. The importance of these values was less than the LiDAR heights and image metrics.

Our study systematically addressed and mitigated uncertainties associated with machine learning model selection, training, and geolocation error of FIA field measurements. In the publicly available FIA data, up to 20% of private FIA plot coordinates are swapped with another similar private plot within the same county and fuzzed up to 1 mile on a small subset of them58. Even when using the true FIA subplot data, the average centroid GPS location error is about 8 m. Therefore, removing non-forested areas and treating for obvious spatial outliers by comparing LiDAR heights and FIA-AGB estimations were necessary to maintain the consistency and accuracy of AGB predictions29.

Trees can be found in both forested and non-forested land use areas in Connecticut17. The AGB estimates of trees outside of the forests (non-forested areas) may not be accurately estimated when the model is applied because those areas were not represented in the model training and selecting the allometric Equations63. Therefore, Our RF models only suitable to predict the AGB of forested areas. Adding trees outside of the forest could significantly improve the estimations of total AGB in Connecticut17. Adjusting tree increment factors is useful to increase the number of samples of FIA subplots. However, this study was concluded only using the FIA data collected withing 2016 since it exceeds the expected timeline of the project in these circumstances43.

Most of the previous research attained R2values in between the ranges of 0.30–0.60, even with less restrictions and more flexible access to FIA data19,43. Our research achieved a moderate R2value of 0.41, yet within the range of previous research accuracy. The main reason for the moderate R2is the restrictions on using actual plot locations, which substantially plummeted the size of the training data. RF models typically perform better with larger datasets. However, we only considered single year data since our codes were run on off-site USDA-FIA computers. Also, the true FIA plot locations potentially have a geolocation error of 8 m (± 2 m) which adds an unknown error to the predictions and noise to the RS variables56. The research can be improved by adding more subplots and using growth increment factors to provide more generalization investigating the entire data cycle. Torre-Tojal et al.43and Luo et al.34conducted biomass estimations in various forest age classes using airborne LiDAR data with a significantly higher pulse density (4.1pulses/m2) than that utilized in our study. They achieved superior results with full-waveform metrics (R2between 0.81 and 0.84) compared to discrete-return metrics (R2of 0.8), guiding the potential improvements to our RF models. The scale of analysis could be investigated thoroughly by considering FIA subplot, plot, or hectare plot scales. But the size of the data set and FIA plot coordinate related restrictions limited our ability to use the above techniques in our analysis27.

In this study careful consideration was given to the RF tuning grids since both the sample size and test data size were smaller. Additional analysis (Moran’s I) for spatial autocorrelation can clarify the specific effects of subplot-level autocorrelation beyond the assumptions and treatments used in our RF model structure. Integrating ecology-based biomass modeling concepts can enhance RF model accuracy by accounting for variations in site quality, tree age, or available nutrient content. The current study compares with 90 m AGB map40: trained by LiDAR, NAIP, NLCD, and FIA data using ecological modeling, 250 m AGB map by Blackard et al.41and Menlove and Healey42. Wider grey shaded areas of CI indicate higher uncertainty, while narrower ones suggest more precise estimates (Fig.8). Furthermore, our study was unable to provide an in-depth analysis of which forest types of the model predict best. This prohibits us from using a representative stratified random sampling technique for our study of different forest types. But the incorporated forest type information from the CT 1 m landcover (Cover_type) was ranked amongst the least important variables based on IncNodePurity, likely because of two reasons; i). The dataset lacked sufficient representation to differentiate forest types (Fig.4a), or ii). existing set of explanatory variables were already sophisticated enough to achieve the current accuracy without additional contribution from forest type information. But future studies could consider methods such as destructive sampling, integrating non-forested tree data, or establishing FIA-like plots outside the federal data system to enable more spatially robust validation strategies to increase ecological representation in training and validation32,43.

We compared our AGB estimates with three existing biomass map products (Appendix 4) to evaluate the potential benefits of fine-resolution models. However, the differences in spatial resolution and data sources can significantly influence comparison metrics we compared (Table3). For instance, our RF model achieved the lowest RMSE (28.33 Mgha−1) and highest R² (0.41), while Map_1 showed the highest RMSE (145.35 Mgha−1) and lowest R² (0.01), likely due to scale mismatches at broader spatial extents. Additionally, mean and variance suggest that these coarser-resolution maps tend to overestimate biomass and show higher variability (Map_1: variance = 5170.04 Mgha−1), while our RF model produced estimates more aligned with growth adjusted FIA-CRM estimates (mean = 43.92Mgha−1; variance = 277.78 Mgha−1). These results highlight how spatial resolution and model selection influence accurate AGB predictions, supporting the value of high-resolution AGB modeling for capturing local characteristics.

Finally, we acknowledge that ML models are fundamentally data driven. Our study addressed this challenge through extensive hyperparameter tuning, variable grouping and variable selection. But recent strategies, such as data augmentation, ensemble modeling, or theory-guided constraints100101may further enhance predictive accuracy in future research. Also, transformer-based foundation models such as Pritivi-WXC102and SatCLIP103show promising improvements to future AGB context. Our research will be instrumental for future researchers to identify the areas to develop, using improved ML and DL models not only to evaluate spatial context but as a guide to build a protocol when the data access is limited.

The study utilized the RF algorithm to estimate forest AGB in Connecticut, showcasing the algorithm’s robustness even with a limited training data set. Employing grid search for hyperparameter optimization and cross-validation revealed promising results, with RMSE of 27.19 Mgha−1and R2of 0.41. Combining RS image data with LiDAR metrics improved R2by 34.78% compared to exclusively using LiDAR. Out of all, 68% of the most important variables are LiDAR height related variables. Integrating LiDAR data with RS image data and hyperparameter tuning significantly enhanced model performance. The optimum RF model shows high accuracy within the inter-quartile range of field CRM-AGB. Future research could focus on increasing testing, refining plot locations, spatial autocorrelation and leveraging high-density LiDAR/RS data for improved performance in biomass mapping.

Below is the link to the electronic supplementary material.

The work reported in this paper was fully funded by USDA-NIFA Mclnire-Stennis Capacity Grant (#CONS01050), USA (2022-2024). We are grateful to the US Forest Service, U.S. Department of Agriculture, Northern Research Station, United States for sharing the data and expertise. We extend our gratitude to Andrew J. Lister and Charles Paulson of the U.S. Forest Service, Northern Research Station, for their insightful comments and invaluable support during the data extraction process.