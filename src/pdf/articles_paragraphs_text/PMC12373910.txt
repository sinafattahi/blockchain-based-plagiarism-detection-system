Virus-host competition drives evolution of diverse antivirus defenses, but how they co-operate in wild bacteria and how bacteriophages circumvent host immunity remains poorly understood. Here, using a functional screening platform to systematically explore the functions of phage accessory genes, we describe how cell-surface barriers can obscure the phenotypes of intracellular defenses inE. coliisolates. LPS modification emerged as a major theme, with the discovery of several small phage proteins that modify specific O-antigen structures, removing barriers to phage adsorption. Bypassing O-antigen in wildE. colistrains revealed another layer of defense: Type IV restriction endonucleases (RE) that target modified DNA of T-even phages (T2, T4, T6). We further show how injected proteins Ip2 and Ip3 of T4 inhibit distinct subtypes of these Type IV REs. Extensive variability in Type IV REs likely drives the emergence of subtype-specific inhibitors through multiple rounds of adaptation and counter-adaptation.

Virus-host competition drives evolution of diverse antiviral defences in bacteria and antidefense systems in their viruses (phages). Here, Silas et al. use a functional screen of phage accessory genes to show how bacterial cell-surface sugars can be major determinants of phage host-range, and how some phage proteins injected into bacterial cells inhibit host immunity.

Recent systematic surveys of virus-exclusion mechanisms in prokaryotes revealed a cornucopia of distinct antivirus defense systems1–5. Phage-host co-evolution evidently drives diversification of these systems6–10. Some defenses strategies (like CRISPR-Cas11) exhibit especially diverse repertoires, with a corresponding diversity of virus-encoded anti-defense effectors (such as anti-CRISPR proteins12). However, specific phage factors that counter-act many other bacterial defense systems remain elusive, especially, in the context of phage infections in the wild where multiple defenses often operate together6,13.

We recently built an integrated computational and experimental platform to identify the strategies employed by phages to thwart immunity in wild bacterial strains. Wild isolates more accurately represent the pan-genomic diversity of a species especially with respect to anti-phage immunity mechanisms, which can vary substantially between strains13. By systematically testing diverse phage accessory genes (AGs) in diverseE. coliisolates, we discovered that the same AG-encoded proteins which inhibit specific immune systems can also trigger programmed-cell-death mechanisms in bacteria14. Here, we present the results of parallel screens where we explore how diverse AGs affect phage susceptibility inE. coliisolates (Fig.1A). We report the discovery of phage AGs that encode proteins to compromise a multi-layered host defense architecture, including barriers to phage adsoprtion on the cell surface and bacterial restriction enzymes.

ASchematic of a computational pipeline to identify phage AGs (described in detail elsewhere14), and high-throughput screening platform to assay AG functions in multiple wild strains of bacteria.BHeatmap of log2-transformed fitness scores comparing infected and uninfected samples. Of 196 AGs tested, only AGs with a host-sensitizing phenotype are shown on the X-axis. All genes listed on the X-axis were tested in at least one host by plaque assays performed in parallel by two different experimenters, and hits thus validated were further verified by additional plaque assays in triplicate. Red boxes/bold names highlight counter-defense AGs selected for further study. Named AGs areorf1:ocr, orf48:gnarl1, orf63:gnarl2, orf87:ral, orf92:gnarl3, orf116:abc1, orf143:ip2andorf169:ardA. Mean fitness scores are presented from three independent replicates of the entire screen (see Supplementary Data1).

Lipopolysaccharides (LPS) are among the first cellular structures encountered by phages. The outermost LPS structure is a highly variable polysaccharide known as O-antigen. At least 176 distinct O-antigen structures have been identified inE. coliand are used to serotype Gram-negative strains for epidemiological purposes15. O-antigens play roles in virulence, niche adaptation, and escape from predation16. The remarkable diversity of these surface polysaccharides likely evolved through a multifaceted interplay between bacteria, their environment, animal hosts, and their viruses17. In the context of phage-host competition, O-antigens can obscure phage receptors on the outer membrane18, but some phages, such as T5, can use specific O-antigen structures as primary receptors19. Following a successful infection, some phages can also modify O-antigens in a process known as seroconversion18,20. The seroconversion strategies identified so far involve enzymes that typically mimic enzymes of the host’s own O-antigen biosynthetic pathway21–26.

Should the O-antigen be permissive for cell adsorption and receptor access in a given phage-host pair, DNA injection follows, with some phages also injecting proteins into the host. Although the specific functions of most of these proteins remain enigmatic, they are hypothesized to disrupt host-encoded antiviral defenses. Bacteriophages of theTequatrovirusgenus (with prominent members T2, T4, and T6) contain several non-essential genes that encode “internal proteins” (Ip). Phage T4 carries three such proteins, Ip1, Ip2, and Ip3, that are encoded in two distinct loci. Related phages encode many more Ips, with at least 10 reported so far27. These internal proteins contain a characteristic N-terminal signal sequence that directs their packaging into the capsid27, and they are injected into the host cell along with phage DNA at the onset of infection28. Manyipgenes had been identified in T-even phage genomes by detection of the signal sequence, but only one had been functionally characterized: Ip1 in phage T4 is an inhibitor of a Type IV restriction endonuclease (RE) known as GmrSD, which specifically cleaves glucosyl-hydroxymethylcytosine (g-hmC)-modified DNA typical of T-even phages (T2, T4, T6)29.

Here, we report that O-antigen is a critical barrier to phage infection in wildE. coliisolates (but not K12-derived lab strains, which lack O-antigen15), but that several small phage proteins can alter O-antigen structures without using known seroconverting enzymes. These genes were observed in our AG screens as they serendipitously enhanced the sensitivity toTequatrovirusand other phages (which do not naturally encode them). However, a second line of defense awaits these phages inside the bacterial cell, namely, a diverse repertoire of Type IV REs with GmrS-like effectors. T4-like phages therefore encode a suite of apparently non-homologous inhibitors of these systems (Ip1, Ip2, Ip3) that block distinct GmrSD variants in a non-overlapping way. These outcomes were initially only discerned in wild bacterial isolates once O-antigen barrier defenses were removed or overwhelmed. We further explore the diversity of GmrSD systems that co-evolve with injected proteins of T4-like phages.

To discover new mechanisms by which phage AGs increase phage fitness against recalcitrant hosts, we infected 20 wildE. coliisolates30with 8 model phages and selected 45 phage-host combinations where phage replication was highly attenuated compared to growth on BW25113 (100–1000 fold, although the attenuation was typically more severe; see Supplementary Fig.1a). We excluded phage-host combinations where no plaquing or zone of clearing was observed to help ensure at least partial compatability with phage receptors. This phenotype suggests that an antiviral mechanism was blocking phage infection, such that expressing a phage gene that inhibits the relevant defense in the host could alleviate restriction. To this end, we employed a high throughput screening system to bioinformatically identify diverse phage accessory genes (AGs) from highly variable regions of phage genomes, and test their functions in multiple bacterial strains in parallel14(Fig.1A). We induced the expression of 196 distinct phage AGs in a pooled format, in each strain represented in the 45 phage-host combinations to identify genes that enhanced phage reproduction (Supplementary Data1). This experiment was executed in triplicate. Although only 8 model phages were used in our infection-based screens, the AGs were selected from an analysis of 1706 Enterobacteriophage genomes as described previously14.

To identify AGs with putative counter-defense phenotypes, we compared infected samples with uninfected controls and identified several host-phage-AG combinations that were depleted from the infected pools (Fig.1B). Each AG that enhanced infection by any phage in a wild strain was then individually conjugated into that strain and tested against all 8 phages by plaque assays. Single plaques were often not observed in many phage-host combinations, making it impossible to calculate precise phage titers and efficiencies-of-plaquing (EOP). Therefore, we measured phage infection scores, defined as the last 10-fold dilution of the phage lysate that still produced a clearing on the bacterial lawn.

Because these validation experiments were performed with the entire phage set, we observed additional phage-enhancing effects of some counter-defense AGs in phage-host combinations that were omitted in the initial screen (Supplementary Fig.1b). Some AGs, which had produced intermediate fitness defects in liquid-culture screens (e.g.,orfs 7, 68, 107, 151, 153; see Fig.1B) failed to reproducibly increase phage titer on relevant ECOR strains in plaque assays. Such discrepancies between liquid and solid culture screening have been observed previously31. In all, increased plaquing of several phages was observed in 28 phage-host combinations upon expression of 3 known Type I R-M inhibitors (Ocr, Ral, ArdA)32,33, 6 previously uncharacterized AGs found in phages ofEscherichia, Salmonella, and Klebsiella(Supplementary Data2), and the T4 internal protein 2 (Ip2)27. These AGs likely antagonize host defenses that block phage adsorption or reproduction.

To identify bacterial defenses inhibited by AGs, we employed two unbiased approaches: (1) transposon-mutagenesis screens to pinpoint gene disruptions in hosts that phenocopy AG expression (i.e. increased phage reproduction) (Fig.2A, Supplementary Data3) and (2) affinity-purification and mass spectrometry (AP-MS) of AGs to identify binding partners in the wild strains (Supplementary Data4). We performed these assays for every host found to be sensitized to infection by any AG.

ASchematic of follow-up transposon screens, performed in native hosts without AGs. Graphs show fitness of transposon mutants in infected (Y-axis) and uninfected (X-axis) Tn5-libraries from three representative hosts challenged by T5. Red dots are gene-disruptions that lower bacterial fitness upon infection (e.g., disruptions in O-antigen biosynthesis).BMedian T5 infection scores in wild hosts ECOR1 (green), ECOR3 (orange), ECOR22 (blue) withgnarlgenes (orf48:gnarl1, orf63:gnarl2, orf92:gnarl3) repressed (left) or induced (right). Infection scores from triplicate plaque assays are depicted by circles.CLipopolysaccharide (LPS) visualized by electrophoresis (n= 1) from host-AG combinations in (B) where AGs produced a phage-sensitizing effect. (D) As in (B), Median T5 infection scores with or withoutgnarl3in ECOR hosts, with UDP-glucose biosynthesis pathway genesgalU, galE, galF, and Enterobacterial Common Antigen (ECA) precursorwecBcloned onto a plasmid and overexpressed.EGST-immunoprecipitation and western blotting (n= 2) with anti-GST (white background) and anti-FLAG (black background) antibodies to test association of Gnarl3 and GalU proteins. GalU (lane 2) or GST-GalU (lanes 1, 3) expressed from a plasmid (pBAD), and FLAG-Gnarl3 (lanes 1, 2) expressed from a single-copy chromosomal insertion (pLlacO-1). Input lysate controls were loaded onto the same gels (lanes 1-3) as the GST-IP eluates (lanes 4-6). Anti-FLAG images are from the same Western Blot, but eluate lanes (4-6) were visualized separately with longer exposure times as FLAG signal in input lysates (1-3) was substantially brighter. Source data for (C,E) are provided as a Source Data file.

We first focused on six previously uncharacterized AGs –orf48,orf63,orf92,orf116(previously namedabc134),orf126, andorf148that increased fitness of several phages in multiple host strains (Fig.2B, Supplementary Fig.2a–c). Because the broad-spectrum effects of these AGs did not correlate with the presence of any specific immune systems within the variable defense repertoires of these wildE. colistrains (Supplementary Fig.1c), we sought to determine whether they targeted core cellular pathways.

Genome-wide transposon-mutagenesis screens indicated that disrupting the host O-antigen or capsule genes phenocopied the phage-sensitization effects of all 6 broad-spectrum counter-defense AGs with almost all tested phages (Supplementary Data3). The most pronounced phenotypes were that transposon-mediated disruption of O-antigen biosynthesis genes (Fig.2A) or expression oforf48,orf63, ororf92(Fig.2B) all enhanced reproduction of phage T5 (which does not natively encode these AGs). We hypothesized that T5 attachment to its secondary receptor FhuA19was blocked by the wild-type O-antigen structures in theseE. colistrains, whereas heterologous AG expression enabled infection by modifying or removing the O-antigen. We therefore examined LPS preparations from every host strain where any AG exhibited a counter-defense phenotype. Hosts expressingorf48,orf63, ororf92(but notorf116,orf126, ororf148) exhibited subtle downshifts in the O-antigen banding pattern (Fig.2C, Supplementary Fig.2d), as observed previously in some seroconverting prophages as a mechanism to exclude superinfecting phage23. Specifically, the following host-AG combinations showed visible downshifts in O-antigen bands (Fig.2C):orf63andorf92in ECOR1,orf48andorf92in ECOR3, andorf48andorf63in ECOR22, which were also the host-AG pairs where T5 infection was especially strongly (105-6-fold) enhanced (Fig.2B). We reasoned that the AGs might interfere with O-antigen biosynthesis, and tentatively (because we do not yet know their direct targets) namedorf48,orf63andorf92,gnarl1, 2, and3, respectively, after the skin-eating demon in the popular TV seriesBuffy the Vampire Slayer.

All known seroconverting prophages modify O-antigens through the activity of large enzymes such as glycosyltransferases and acetyltransferases21–26.Pseudomonasphage D3 encodes a small gene(iap) that blocks the host O-antigen polymerase, but seroconversion requires two other phage enzymes, an O-acetylase and a ß-polymerase24.Gnarl-encoding phages in our genomic dataset do not encode any such seroconverting enzymes. Furthermore, Gnarl proteins (40aa – 90aa) are much smaller than typical enzymes and thus are unlikely to exhibit any enzymatic activity themselves. These proteins might affect the activity of bacterial O-antigen-modifying enzymes, constituting a distinct mode of host seroconversion by phages. Intriguingly,gnarlgenes are found in both lytic and lysogenic phages;gnarl1andgnarl3are present in lytic phages (Supplementary Data2), whereasgnarl2is present in the classical temperate phage Mu (gene E6/Mup07). Gnarl-mediated LPS modification cannot of course enhance entry ofgnarl-encoding phages into the host; rather, it can provide an advantage to phages that have already established a lysogenic or persistent virulent state35, for instance by excluding superinfection from kin-phages or preventing reattachment to cell debris post-lysis. However, our screen results indicate thatgnarlexpression also serendipitously opens the door to phages that do not encodegnarlssuch as T5.

To identify the cellular targets of Gnarl proteins, we analyzed AP-MS data we had generated for all confirmed counter-defense AGs discovered in our AG screens. Each accessory gene product bound distinct host proteins (Supplementary Fig.3) but no clear patterns were discernable for any AG (gnarl1, gnarl2, abc1, orf126, Ip2, ororf148) exceptgnarl3. Gene Ontology pathway analysis identified UDP-glucose biosynthesis factors as significantly enriched in thegnarl3set, suggesting thatgnarl3affects a step in this pathway. Among these, GalU catalyzes the formation of UDP-glucose36that is used in the formation of the LPS outer core37; GalF regulates the levels of UDP-glucose38; and GalE reversibly converts UDP-glucose to UDP-galactose (also an LPS outer core component)39. Overexpression ofgalU, but notgalE,galF, orwecB(an unrelated control; WecB is involved in the synthesis of enterobacterial common antigen), completely reversed T5-sensitization bygnarl3in ECOR1, ECOR3, and ECOR22 (Fig.2D), suggesting a specific interaction betweengalUandgnarl3. We confirmed that Gnarl3 and GalU proteins associate stably by immunoprecipitation (IP) of GST-tagged GalU and Western blotting to assay co-IP of 3xFLAG-tagged Gnarl3 (Fig.2E). Infection by an unrelated phage T4 was also enhanced bygnarl3in some strains and this phenotype was similarly reversed bygalUoverexpression (Supplementary Fig.4), indicating that the effect of thegnarl3-galUinteraction was not limited to phage T5. OverexpressinggalUwithoutgnarl3did not affect phage sensitivity except in ECOR22, where it partially potentiated infection for unknown reasons. Coupled with LPS electrophoresis and AP-MS data, these data suggest thatgnarl3may inhibit GalU, reducing the availability of UDP-glucose and resulting in a modification of the cell envelope that potentiates T4 or T5 infection. More generally, it is notable that the most prevalent and potent phage sensitization phenotype for multiple, distinct AGs appears to hinge on removing barriers on the cell surface through diverse mechanisms.

Next, we focused on the four other AGs that produced counter-defense phenotypes in our screen. As the targets of Ocr, Ral, and ArdA are known32,33, we performed whole-genome transposon-mutagenesis in strain ECOR21, where Ip2 increased fitness of phage T2. However, this was not solely due to an O-antigen barrier, as disruption of the O121-specific O-antigen pathway40sensitized the strain to T5, Lambda vir, and T4, but not T2 (Fig.3A). We wondered if this discrepancy could be explained by the existence of an additional defense mechanism in ECOR21 which complements the O-antigen barrier by restricting T2 infection (Fig.3B). In the AG screen, internal-protein Ip2 partially sensitized ECOR21 to T2 (Fig.1B), suggesting that T2 is blocked by an Ip2-inhibited system, in addition to O121 O-antigen. Although phage T2 itself does not encode Ip2, related phage T4 encodes Ip2 as well as the only internal-protein from T-even phages with a known function, Ip1. Ip1 is packaged into the phage capsid and disables a Type IV RE upon co-injection with phage DNA29(the original system fromE. colistrain CT596 was previously misannotated; it consists of a single GmrSD protein, and not two separate proteins GmrS and GmrD41).

AFitness of transposon-mutants in infected and uninfected Tn5-libraries of ECOR21 challenged by various phages.BSchematic of ECOR21 defense against T2 through both barrier defenses and a defense system which is putatively blocked byorf143/Ip2.CLPS visualized (n= 1) from WT ECOR21 (left), and ECOR21 with the O-antigen biosynthesis initiatorwecAdeleted by allelic exchange (right).DWhole-genome transposon-mutagenesis screens as in (A) but with ECOR21::∆wecA.EVariants of the BREX/GmrSD operon cloned onto a plasmid along with their native promoters and tested in a lab strain ofE. coli(TOP10) against T-even phages (T2, T4, T6) in triplicate plaque assays. Removal of the PglX gene inactivates BREX. Active-site mutations that disable GmrSD are shown as two parallel red bars (GmrSD* double mutant; D474A, H475A). Ocr, Ip1 and Ip2 are expressed from single-copy chromosomal insertions. Bar graphs show median log10 infection scores.FGmrSD and its inactive variant GmrSD* cloned onto a plasmid and tested in TOP10 for restriction activity against T-even phages as in (E). “pBAD” indicates the defense construct was overexpressed from the plasmid (no “pBAD”: same promoter but no arabinose induction). Infection scores from triplicate plaque assays are depicted by circles. Source data for (C) are provided as a Source Data file.

To identify the Ip2-inhibited system, we eliminated ECOR21 O-antigen by deletingwecA42gene (Fig.3C, Supplementary Fig.5) and repeated the whole-genome knockout screen, looking for transposon mutants in the ECOR21∆wecAbackground that became sensitized to T2. With T2 infection, several sensitizing transposon insertions emerged in an atypical BREX system43(Fig.3D, Supplementary Data3) in which a GmrSD enzyme (also known as BrxU) is embedded44. Notably, the same screen with T4 did not yield these hits, suggesting that this system is not an impediment to the Ip2-encoding T4. The entire ECOR21 BREX-GmrSD system cloned into a lab strain and expressed from its native promoter blocked T2 infection, but an active-site mutant in GmrSD (denoted GmrSD*) did not (Fig.3E). By contrast, inactivation of the BREX system (∆pglX) had no impact on T2 inhibition, confirming that GmrSD alone inhibits T2 and is the likely target of Ip2. Consistent with this conclusion, expression of Ip2, but neither Ocr (which inhibits BREX and Type I R-M45) nor Ip1 (which inhibits GmrSD inE. coliCT59629), abolished GmrSD/BrxU defense (Fig.3E).

To test for sufficiency, we expressed GmrSD from ECOR21 or its catalytically inactive variant GmrSD* alone in the lab strain. Overexpressing GmrSD was sufficient to block all T-even phages, whereas the catalytically inactive mutant had no effect (Fig.3F). Leaky expression of GmrSD from the uninduced plasmid still inhibited replication of T2 and T6 (which do not encode Ip2), but not the Ip2-encoding phage T4 (Fig.3F). Of the many described T-even phage internal proteins27, Ip2 is only the second (after Ip1) with an identified target.

We wondered whether the observed redundancy between cell-surface barriers and restriction systems obscured phenotypes of other anti-restriction AGs as well. Although the wild strain ECOR17 was not included in our AG screen, Srikant et al. recently observed that mutants of phage T4 in which Ip3 was eliminated lost their ability to infect this strain and hypothesized that a defense system in ECOR17 targeted T4 but was blocked by Ip346. We performed genome-wide transposon screens to identify this system, reasoning that its disruption would render ECOR17 susceptible to infection by Ip3-deficient T4.

Various transposon insertions in ECOR17 facilitated infection by a T4 mutant lacking bothip2andip3genes (Supplementary Data3), including disruptions of genes responsible for biogenesis of cell-surface polysaccharides, particularly O-antigens. We hypothesized that O-antigens were again obscuring an underlying defense system. Since we struggled to obtain ∆wecAmutants of several ECOR strains for unknown reasons, we repeated the transposon screens with increasing concentrations of phage to attempt to overwhelm and bypass the surface barrier (Fig.4A). In general, higher phage concentrations resulted in more significant hits while still recapitulating the hits found at lower concentrations. We found that transposon insertions in a GmrSD gene (containing a signature DUF262 domain41,44homologous to the N-terminal NTPase domain (ParB_n) of ParB-like proteins involved in a variety of defense mechanisms, and an HNH nuclease domain) were sensitized to infection by T4∆ip2∆ip3, but only at high phage concentrations (Fig.4A, Supplementary Data3). Inspection of this genetic locus revealed an unusual Type IV RE with two GmrS homologs, GmrS1and GmrSD2(Fig.4B). Both genes encode a ParB_n domain, but only GmrSD2(identified in our transposon screen) contains an HNH endonuclease domain (Supplementary Fig.6).

AFitness of the same transposon-mutant library of ECOR17 (2.31e7 cfu) challenged by various amounts of a ~ 5.5e9 pfu/ml lysate of phage T4∆ip2∆ip3. Tn5 insertions that compromise phage resistance (red dots) in low-phage-input screens are listed in Supplementary Data3.BSchematic of ECOR17 locus that encodes defense system putatively blocked by Ip3.CPlaque assays to measure anti-phage activity of GmrS1and GmrSD2components individually (with overexpression) and of the full system (without overexpression). T4 and T4∆ip2phages naturally encode Ip3.DPlaque assays to measure anti-phage activity of constructs (without overexpression) with truncated GmrS1or GmrSD2with E582A H583A mutations in its active site. Images in (C), (D) are representative images from plaque assays performed in triplicate.

We sought to determine whether both GmrS genes were required for phage defense. We cloned the genes in an expression vector into a lab strain ofE. coliand tested their ability to provide defense against model T-even phages (T2, T4, and T6) and T4 mutants lacking eitherip2, or bothip2andip3. Overexpression of either GmrS1or GmrSD2alone provided no protection against any of the phages, and inducing both genes together (hereafter, GmrSDECOR17) resulted in gross cellular toxicity. However, the GmrSDECOR17construct was tolerated well without induction, and provided robust defense against T2, T6, and T4∆ip2∆ip3, while T4 and T4∆ip2could both still replicate (Fig.4C). This result suggested that leaky expression of the two-gene GmrSDECOR17construct was sufficient to restrict replication of T-even phages that do not encodeip3.

Overall, Ip2 and Ip3 block GmrSD variants from wildE. colistrains (ECOR21 and ECOR17, respectively) that also produce O-antigens which can interfere with phage adsorption and obscure the phenotype of the underlying anti-phage defense systems.

GmrSDECOR17could not restrict T-even phages that carried Ip3, namely, T4 and T4∆ip2. To test whether Ip3 was sufficient to block restriction, we expressed each T4 internal protein (Ip1, Ip2, Ip3) individually inE. colicarrying GmrSDECOR17. Ip3 restored plaquing by T2, T4∆ip2∆ip3, and T6 to wild-type levels, whereas Ip1 and Ip2 had no effect (Fig.5a). T4 and T4∆ip2could infect as usual in all three conditions. Therefore, Ip3 specifically inhibits GmrSDECOR17.

Plaque assays to measure anti-phage activity of (A) GmrSDECOR17(CLS_003/004) (B) GmrSDECOR21(CLS_010), and (C) GmrSDCT596(CLS_006) with heterologous expression of Ip1-3 (red borders indicate GmrSD variant is paired with itsipinhibitor).ipgenes are expressed from single-copy chromosomal insertions. Ip1 is naturally present in T4, T4∆ip2, and T4∆ip2∆ip3, Ip2 in T4, and Ip3 in T4 and T4∆ip2. All plasmid-encoded GmrSD genes were tested without over-expression.

Ip1 and Ip2 of phage T4 are also inhibitors of Type IV REs comprised of GmrSD nucleases, hereafter GmrSDCT59629and GmrSDECOR21(this study),respectively. We wondered why a single phage would need to carry three distinct GmrSD inhibitors. Given that only Ip3 could inhibit GmrSDECOR17, we tested if any of the T4 internal proteins provided cross-protection. Assaying all three T4 Ips against the targets of Ip1 and Ip2 (GmrSDCT596and GmrSDECOR21), we found that eachipgene specifically disabled only one system, with no cross-protection observed (Fig.5B, C). Therefore, Ip1, 2, and 3 are all Type IV RE inhibitors, but each specifically blocks a distinct GmrSD effector. We note that WT phage T4 was unable to disarm GmrSDECOR21unless additional Ip2 was supplied exogenously (Fig.5B), but could naturally overwhelm GmrSDCT596and GmrSDECOR17in our assays (Fig.5A, C). This is likely due to a difference in GmrSD expression levels. Since GmrSDECOR21is embedded in a BREX operon and expressed from its native promoter from a multi-copy plasmid, it is likely present at much higher concentrations in the cell than GmrSDCT596and GmrSDECOR17, which are both extremely toxic and could only be tested under leaky expression conditions (without their native promoters).

To further investigate the specificity of Ip effectors for their GmrSDs, we constructed and examined pairwise alignments of the GmrSD protein sequences. The GmrSD targets of Ip1 and Ip2 are highly diverged (Supplementary Data5). Similarly, the two components of GmrSDECOR17are also extremely diverged from GmrSDCT596and GmrSDECOR21(Supplementary Data5). Except for the DGQQR motif that is conserved in almost all GmrSD proteins41, there was virtually no similarity between any of the sequences.

Previous phylogenetic analysis identified many highly diverged sub-types of GmrSD-encoding Type IV REs41. To explore this diversity, we retrieved sequences matching DUF262/ParB_n profiles (pfam03235 and COG1472) from the conserved domain database (CDD) assignments precalculated for 24,757 completely sequenced genomes48. To identify major groups within the GmrSD family, the retrieved proteins were clustered by sequence similarity using MMseqs249, and domain composition and gene neighborhoods of the 20 most common GmrSD family proteins (named CLS_001-020) in Enterobacteria were examined in detail to identify potential additional components of these systems (Supplementary Data6). CLS001-020 GmrSD variants were arranged in two predominant Type IV RE architectures: (a) 12 single-gene systems encoding a GmrSD protein containing a ParB_n domain and an endonuclease domain (from either HNH or predicted nuclease DUF1524 of His-Me finger endonuclease superfamily), and (b) 3 two-gene systems consisting of twogmrSDgenes from different clusters where one of the components is a two-domain protein containing ParB_n and an endonuclease domain whereas the second gene contains a ParB_n domain only. Of the 12 single-gene systems, two are closely similar to GmrSDCT596(CLS_006) and GmrSDECOR21(CLS_010), and among the three two-gene systems, one is similar to GmrSDECOR17(CLS_003/CLS_004).

We synthesized representative systems from all 15 GmrSD groups, and tested them against our panel of T-even phages. Five systems (in addition to GmrSDCT596, GmrSDECOR21, and GmrSDECOR17) showed apparent anti-phage activity against T-even phages. We tested tenipgenes from T4-like phages against these new systems but identified no new inhibitory interactions (Supplementary Figs.8,9). Together, the intimate association betweenipgenes and the highly diversified GmrSD enzyme family reveals a strong arms race is underway. Further, these data underscore the importance of O-antigen barriers that can obscure the immune repertoire of wild strains.

Identification of phage AGs and characterization of their interactions with host defenses can tease apart the layers of bacterial anti-phage immunity, providing a holistic view of the salient defense mechanisms across multiple bacterial strains. In a previous work, we showed that phage accessory genes (AGs) can activate bacterial immunity pathways that lead to cell death or dormancy14. Here, we extend our high-throughput functional screening platform to investigate how AGs facilitate phage infection by interacting with the multi-layered antivirus defense architecture in wild bacterial strains. Assaying 196 Enterobacteriophage AGs in 20 wild isolates ofE. coli, we found that AG-encoded proteins modify the cell surface to alter phage sensitivity, disable antiviral restriction systems inside the cell.

The most common counter-defense phenotype in our screens involved “broad-spectrum” AGs that interfered with cell-surface barriers such as O-antigens which are broadly conserved across many strains of the host species (as opposed to strain-specific defense systems). The commonly used K12 lab strain ofE. colidoes not produce O-antigen, but most wild strains ofE. colido15. By performing our screens in wildE. coliisolates, we discovered several AGs (gnarl1-3) that modify O-antigens. These phage proteins appear to function via a previously uncharacterized mechanism of seroconversion wherein Gnarls can modify O-antigens in various wild bacterial strains as stand-alone effectors, without the involvement of any known phage-encoded seroconverting enzymes. Indeed, none of the lytic or temperate phages that carrygnarlgenes encode any such enzymes. Therefore, if LPS modification is the primary function ofgnarlgenes, seroconversion of bacterial hosts by their phages could be a much more widely distributed phage strategy than previously thought21–26. O-antigen modification cannot facilitate the entry of the initialgnarl-encoding phage into the cell, however, it could benefit lysogens by excluding superinfecting phages, and lytic phages by receptor-masking to prevent newly synthesized virions from unproductively binding fragments of lysed cells (indeed, a similar function is attributed to the Llp protease in phage T550). Persistent infection by lytic phages may also be more common than is presently believed35, and seroconversion could be a useful superinfection-exclusion strategy in such instances. Whereas the precise role ofgnarlgenes in the phage lifecycle remains a subject for future work, our AG screening approach allows us to identify such capabilities in the genomes of phages that we do not currently have in the laboratory, and pinpoints which phages should be procured to further study these novel functions.

One of thegnarlgenes encodes a small phage protein Gnarl3 which binds GalU (UDP-glucose pyrophosphorylase) and its expression results in O-antigen alteration. Although we cannot rule out that Gnarl3 binds to GalU to effect another metabolic function, previous work has identified phages that could not adsorb onE. coliwithgalUmutations51, nor onB. subtiliswith mutations in thegalUhomologgtaB52, suggesting a widespread, ancient link between glycosylation of cell-surface structures and phage tropism. We hypothesize that O-antigen diversification is driven in part by selection pressures from phage-encoded LPS modification mechanisms53such as interference with GalU function by Gnarl3. More extensive functional genomics screens can be expected to reveal that many phage AGs can cause cell-surface modifications via diverse mechanisms.

By removing or overwhelming the O-antigen barriers in specific wild strains ofE. colipinpointed by our AG screen, we discovered that injected proteins in T4-like phages27disable various GmrSD-encoding Type IV REs. In particular, the internal proteins Ip1, Ip2 and Ip3 of phage T4 are all injected into the host cell along with phage DNA and specifically inhibit different GmrSD systems. The enormous diversity ofgmrSDgenes and the strict specificity of their respective inhibitors could explain why a single phage (T4) encodes multiple inhibitors (Ip1-3) of the same family of defense systems. Type IV restriction is evidently a major frontier in the arms race between Enterobacteria andTequatrovirus.

Our discovery of the inhibition of specific Type IV RE systems by Ip1-3 prompted us to test whether these genes might also block other GmrSD variants. We found that Ip1-3 specifically inhibit only their cognate GmrSD enzymes. Apparently, extensive co-evolution of Type IV REs with T-even phages has driven the emergence of new GmrSD variants, as well as the evolution of the corresponding diversity of injected anti-defense proteins in this phage genomic hotspot. Ip1-3 share no sequence homology other than an N-terminal leader sequence that directs their packaging into capsids. Notably, the GmrSD nucleases they target also share extremely limited sequence homology, suggesting that these inhibitors might make extensive contacts with their target enzymes, as was observed in structural studies with Type I R-M inhibitors33. As in the case of anti-CRISPR proteins co-resident in genomic hotspots in aPseudomonasphage family54, it seems likely that the accessory proteins encoded in the twoIploci in T-even phages all target different variants of the same bacterial immune system, namely, GmrSD-encoding Type IV restriction enzymes.

In summary, we show that O-antigens in wild host strains obscure the phenotypes of counter-defense phage AGs at subsequent stages of infection. The GmrSD targets of Ip2 and Ip3 in phage T4 had remained elusive for decades27and overcoming O-antigen barriers in strains that naturally encode these GmrSD enzymes was necessary to observe underlying anti-phage immunity. Incompatibility between diverse O-antigens and phage adsorption mechanisms is not considered a canonical mechanism of phage defense. However, its dominant role in systematic screens with wild bacterial strains suggests that this incompatibility may well turn out to be one of the most important variables governing the success of phage therapy. That several phage AGs can affect O-antigen modification in wild strains in a manner that serendipitously benefits phages we used in our screens further suggests that a limited set of seroconversion strategies could be employed strategically to potentiate adsorption of a variety of different phages in a therapeutic cocktail. This leaves the door open for a reductionist and rules-based approach to phage therapy design.

This section contains expanded versions of previously published protocols; where appropriate, we have provided the protocols in entirety for completeness, retaining relevant text from the original14. Details of key materials are provided in Supplementary Table1.

TheE. coliReference (ECOR) collection of wildE. colistrains was obtained from the STEC Center (Michigan State University). Lab strains were obtained as follows: MG1655 (from Dr. Carol Gross, UCSF), C990 (from Dr. Ry Young, Texas A&M), DH5α (NEB), DH10ß/TOP10 (Life Technologies), BW25113 and BW25141 (from Dr. Vivek Mutalik, LBNL), and WM6026 (from Dr. Jason Peters, UW-Madison). All strains were cultured at 37 °C with shaking (180–225 rpm) in lysogeny broth (LB) (10 g/l tryptone, 5 g/l yeast extract, 10 g/l NaCl with 15 g/l agar for plates) supplemented with 100 µg/ml of ampicillin/carbenicillin, 10–20 µg/ml gentamicin (except WM6026, which yielded more consistent colony sizes with 50 µg/ml), 50 µg/ml kanamycin, and 0.5% w/v glucose, 0.1% w/v L-arabinose, and 1 mM IPTG (isopropyl-b-D-thiogalactopyranoside) as needed. The WM6026 strain required diaminopimelic acid (DAP) for growth, which was supplied at 300 µM. All strains were stored in 20% glycerol at −80 °C for long term storage.

R6K-origin pTn7 plasmids (from Dr. Jason Peters, UW-Madison) – the pJMP1039/pTn7C1 helper plasmid (carbenicillin) and the pJMP1360/pTn7C185 transposon vector (gentamicin, carbenicillin) – were used for integration of phage AGs into theE. coligenome. IPTG was used in all cases as the inducer for phage AGs from the plLacO-1 promoter encoded on pJMP1360/pTn7C185 and integrated into the host genome by Tn7 transposition (see below). All host defense systems identified in the various screens were placed under the araBAD promoter (arabinose inducible) in the pBAD Myc/His A vector (Invitrogen). Conjugative allelic exchange was carried out using R6K-origin pKEK2201 (kanamycin) (from Karl E. Klose, UT San Antonio). All plasmids were constructed by Gibson Assembly.

R6K-origin plasmids were maintained in BW25141 (routine cloning) and WM6026 (conjugative donor strain). All other plasmids were maintained in DH5α or TOP10. All plasmid sequences were verified by Sanger or whole-plasmid sequencing (Plasmidsaurus, Primordium) and are available upon request. Frequent plasmid dimerization during the Gibson Assembly procedure (especially when using the NEBuilder reagent) was ameliorated by using 10-fold less of one of the insert DNA fragments in a reaction involving at least 2 insert fragments (not including the backbone).

AGs were delivered toE. colihosts by Tn7 transposition via conjugation performed by triparental mating as described previously55. Briefly, the transposon and helper plasmids were delivered to the recipient from WM6026 donor strains by overnight incubation on LB agar plates supplemented with 300 µM DAP and 0.5% glucose to repress AG expression. The next day, cells were scraped and resuspended in 1 ml LB, and 1000X-20000X dilutions of this conjugation mixture were plated on LB plates (lacking DAP) supplemented with the appropriate antibiotics and 0.5% glucose. All strains were maintained under strict glucose repression of the pLlacO-1 promoter at every step until screens were performed. Thus, all AGs were maintained as single-copy chromosomal inserts at the same attTn7 site in the genomic region betweenglmSandpstSgenes.

Efficient Tn7 transposition is necessary to construct an AG library in any givenE. colihost. Tn7 conjugation-transposition efficiencies were determined in 44 ECOR stains containing an intactglmS-pstSregion (we note that other strains can support Tn7 integration as well). Tn7 transposons carried only a barcode sequence and the gentamicin-resistance gene to minimize payload-dependent variation in conjugation efficiency between strains. Efficiency of conjugation was determined by streaking the conjugation mixture on two different gentamicin concentrations (25 µg/ml and 10 µg/ml) to account for possible differences in natural antibiotic resistance between the wild strains. The barcode sequence was verified by Sanger sequencing and both flanks were checked by PCR to ensure proper integration of the Tn7 transposon at the expected attTn7 site. Strains that supported Tn7 transposition at high levels and were amenable to agar-overlay plaque assays were selected for further experiments.

Genomic DNA was extracted using a modified SDS–proteinase K method: Briefly, cells pelleted from 50 µl of saturated culture (or 5 µl of the cell mixture scraped from selective plates during AG library construction) were re-suspended in 200 µl of lysis buffer (10 mM tris, 10 mM EDTA, 400 µg/ml proteinase K, 0.5% SDS) and incubated at 50−55 °C for 1 hour. Subsequently, the temperature was lowered to 37 °C and RNase A (Thermo Scientific) was added to a concentration of 1 mg/ml. After 30−60 min of incubation, the digests subsequently purified using the Genomic DNA Clean & Concentrator Kit (Zymo Research). DNA was prepared for whole-genome sequencing using the Nextera Flex Library Prep Kit (now, the Illumina DNA Prep Kit) according to manufacturer’s instructions, except that we lowered the volumes of all tagmentation reactions 5-fold, and used a custom dual-indexed primer set JSW-SS-22:33 (CAAGCAGAAGACGGCATACGAGAT NNNNNNNN GTCTCGTGGGCTCGG) and JSW-SS-34:41 (AATGATACGGCGACCACCGAGATCTACAC NNNNNNNN TCGTCGGCAGCGTC) to amplify libraries for 11-13 cycles using Phusion High Fidelity PCR Master Mix (NEB) instead of the Illumina-supplied PCR reagents. The N8 sequences correspond to reverse-complemented Nextera DNA indexes N701 to N712 and N501 to N508, respectively (Illumina). Libraries were resolved by agarose gel electrophoresis and DNA was excised in the 300-400 bp range. Gel slices were purified using the Zymo Gel DNA Recovery Kit and sequenced on the Illumina MiSeq using 150-cycle v3 or 600-cycle v2 reagent kits.

Sequencing adaptors were trimmed from reads using cutadapt, mapped to reference genomes using bowtie2, and visualized using IGV. Reference genomic contigs of ECOR strains were obtained from the USDA56.

High-titer phage stocks were generated by growth in liquid culture. All phage infections were performed at 37 °C in LB supplemented with 10 mM MgSO4and 5 mM CaCl2.E. coliBW25113 or C990 were grown to an optical density (at 600 nm; OD600) ~ 0.5 (1−5 × 108 cfu/ml) and infected with the desired phage at MOI ~ 5. Infections were allowed to proceed at 37 °C with agitation for 5−6 h until the cultures were clear. Lysates were clarified by centrifugation (8000 × g for 2 min) and sterile-filtered using a 0.45 µm SFCA syringe filter (Millipore). Phage lysates were stored at 4 °C.

Bacteriophages T2, T3, T4, T5, T6, T7, P1vir were obtained from Dr. Vivek Mutalik (LBNL), and λvir was obtained from Dr. Ry Young (Texas A&M). To the extent possible, all phages were grown onE. coliC990 which lacks restriction-modification. T4 and P1vir could not be grown on C990 and were instead grown onE. coliBW25113. To ensure that our phage lysates were free from ancestral Type I R-M methylation marks or other host-passage derived DNA modifications, we serially passaged all phages in the desired hosts 3 times. All phage genomes were subsequently verified by Nextera high-throughput sequencing.

Phage titers were determined against various hosts by the agar-overlay method with LB top agar containing 0.7% agar, 10 mM MgSO4and 5 mM CaCl2. Phage spot-titration assays were performed with 10-fold serial dilutions of phage lysates (3−5 µl of each dilution pipetted onto bacteria immobilized in top-agar overlay using a multichannel pipette).

200 AGs with unique 10 bp DNA barcodes were synthesized (Twist and IDT) and cloned individually under pLlacO-1 control (IPTG inducible, repressed by glucose) into a modified pTn7C185 vector (with mobile CRISPRi components sgRNA and dCas9 removed). Plasmid assembly reactions were performed in 96-well format using the 2X Gibson assembly master mix (NEB) and transformed into chemically-competent BW25141 cells in 96-well format. Transformations were individually plated on LB agar supplemented with 20 µg/ml gentamicin and 0.5% glucose and one colony was initially checked by Sanger sequencing from each plate. Where a successful transformant could not be obtained on the first attempt, more colonies were sequenced in successive rounds until a plasmid with no mutations in the region spanning the pLlacO-1 promoter, the AG ORF, and the barcode sequence was obtained. Verified vectors were miniprepped using the ZR Plasmid miniprep – Classic kit (Zymo) and transformed into chemically-competent WM6026 cells in 96-well format, and each transformation was plated individually on LB agar supplemented with 50 µg/ml gentamicin, 300 µM DAP, and 0.5% glucose.

One colony from each of the 200 WM6026 transformants was grown in 2 ml square-well 96-well plates with shaking overnight, and 100 µL of each culture was then pooled together to yield ~20 ml of the donor mixture. This mixture was concentrated down to 10 ml by centrifugation at 6000 g for 10 min, and 5 ml of 60% glycerol (20% final) was added to yield the donor library. The 15 ml library was divided into single-use 50 µL aliquots (each containing >50 M cells, i.e., >300 K of each donor strain) and stored at −80 °C.

Genomic DNA was extracted from one of the library aliquots and all constructs in the final pool were verified by Nextera high-throughput sequencing. This allowed us to assess library evenness as well as verify the fidelity of our cloning, colony picking, and strain pooling process. Overall, 195 AGs were cloned successfully. One AG (orf88) never yielded any colonies in multiple cloning attempts, possibly due to its cytotoxicity. Three AGs (orf36, orf52, orf94) were dropouts during the WM6026 growth step, and another two (orf25, orf84) were discovered to contain mutations upon high-throughput sequencing that had been missed by Sanger sequencing.Orf25had previously presented difficulties in cloning, and did not yield a mutation-free construct even after checking >12 colonies (whereas most transformations yielded a correct construct on the first attempt). Theorf84construct contained a mixed base at the last position of the second repeat of the Lac-operator sequence upstream of the ORF, which would not be expected to affect any downstream assays significantly.

The donor library was conjugated into MG1655E. coliaccording to the Tn7 transposition procedure (above) and a 1000X dilution of the conjugation mixture was plated on LB agar supplemented with 20 µg/ml gentamicin and 0.5% glucose. We routinely use multiple 150 mm × 15 mm bacteriological petri dishes (Corning) to obtain sufficient numbers of transconjugant colonies to assemble libraries. The next day, >>2000–20,000 transconjugant colonies (10-100X the number of AGs in the library) were scraped and combined thoroughly, and the thick cell mixture was directly frozen at −80 °C in 20% glycerol. Genomic DNA was extracted from this mixture and the distribution of DNA barcodes corresponding to individual AGs was measured in both this post-conjugation strain mixture as well as the genomic DNA extracted from the WM6026 donor library aliquot.

To amplify barcodes for high-throughput sequencing, genomic DNA was subjected to two successive rounds of PCR. The DNA barcodes were amplified from genomic DNA using universal primers JSW-SS-170 (CGACGCTCTTCCGATCTNNNNNTGATGTCGTTGTTGCCATCG) and JSW-SS-171 (ACTGACGCTAGTGCATCACTTTCTGAGCCAGTGTTGCT) and the Q5 Hot Start High-Fidelity 2X PCR master mix (NEB) according to manufacturer’s instructions. Sequencing adaptors were attached in a second round of PCR using amplicons from the first PCR round as the templates, with dual-indexed primer sets JSW-SS-42:53 (CAAGCAGAAGACGGCATACGAGAT NNNNNNNN GTGACTGGAGTTCAGACGTGTGCTCTTCCGATCTACTGACGCTAGTGCATCA) and JSW-SS-54:61 (AATGATACGGCGACCACCGAGATCTACAC NNNNNNNN ACACTCTTTCCCTACACGACGCTCTTCCGATCT), where the N8sequences correspond to reverse-complemented TruSeq HT indexes D701 to D712 and D501 to D508, respectively (Illumina). Template-matching regions in the primers are underlined. Cycling conditions for round 1 were as follows: one cycle at 98 °C for 1 min; two cycles at 98 °C for 10 s, 66 °C for 30 s, and 72 °C for 10 s; 22 cycles at 98 °C for 10 s, and 72 °C for 20 s; and one cycle at 72 °C for 2 min. Conditions for round 2 were one cycle at 98 °C for 1 min; two cycles at 98 °C for 10 s, 64 °C for 30 s, and 72 °C for 10 s; 4 cycles at 98 °C for 10 s, and 72 °C for 20 s; and one cycle at 72 °C for 2 min. 0.5–1 µL of unpurified 1stround reaction product was used as template for the 2ndround of PCR. Amplicons from the 2ndround were gel-purified by electrophoresis (3% agarose gel, 4.2 V/cm, 2 hours) and quantified using the 1X dsDNA HS kit with the Qubit 4.0 Fluorometer (Invitrogen). Amplicons were sequenced on a MiSeq using the 150-cycle v3 reagent kit (Illumina) in single-end format (100 bp) with two (8 bp) index reads. DNA barcodes were trimmed from the reads and the proportions of various AGs in the mixtures were determined using the prevalence of the corresponding barcode sequence.

Concordance between the Nextera whole-genome sequencing and the barcode sequencing of the WM6026 donor mixture showed that barcode representation was a suitable proxy for the true distribution of AGs in the mixture and that amplification biases during library preparation were not a significant source of noise. Concordance between barcode sequencing in the WM6026 donor and MG1655 post-conjugation recipient mixtures indicated that the Tn7 transposition and colony scraping process does not meaningfully bottleneck AG distribution.

The AG library was then conjugated (in triplicate) into ECOR strains that were previously confirmed to support robust Tn7 transposition. Strain mixtures were prepared in a procedure analogous to library construction in MG1655, except higher dilutions of the ECOR + AG conjugation mixtures (10,000–20,000X) were plated and the gentamicin concentration on selective plates was lowered to 10 µg/ml to account for higher steady state cell densities and higher gentamicin sensitivity of the wildE. colistrains. As with the MG1655 library, thick cell mixtures comprised of >>2000–20,000 colonies scraped from each replicate conjugation were directly stored at −80 °C in 20% glycerol and used to seed cultures for the AG screens (below). Genomic DNA was extracted from each mixture and barcode sequencing was performed to measure the AG distribution in every replicate of all ECOR strain derived libraries. The replicates were very highly correlated, and AG distributions in all libraries were confirmed to be free of significant bottlenecking. These datasets are the reference libraries that serve as the baseline for AG induction and phage infection screens.

Phage adsorption to host cells may be inefficient in very dilute cultures (106-7cfu/ml). Therefore, the apparent multiplicity of infection (MOI-a) might be lower than the expected MOI (MOI-e). We added 2x serial dilutions of a λvir lysate to a 1:100 dilution of a saturated culture ofE. coliBW25113 that had been allowed to acclimate at 37 °C with shaking for 15 min. The proportion of surviving cells was determined (relative to uninfected controls) after a 60–75 min incubation (one phage replication cycle) by plating on LB agar. An apparent MOI value was calculated using the Poisson distribution function with zero occurrencesMOIa=−ln(MOIe)for each phage dilution, assuming that all infected cells would be killed by the virus (i.e., the proportion of surviving cells would be the zero class in the Poisson distribution). The apparent and expected MOI values were plotted against each other and the inverse of the slope (1/m) of the line (MOI-a = m*MOI-e + 0) fit through the data was determined as the fold-change reduction in MOI-a as compared to MOI-e for these experimental conditions. This fold-change reduction was determined to be ~26x. Hence, all phage infection screens were targeted to an MOI-a value of ~100 to ensure efficient phage adsorption and infection within the timeframe of a single phage replication cycle.

Thick cell mixtures from each of the three replicates of the various ECOR + AG libraries were thawed on ice and diluted into LB supplemented with Mg2+, Ca2+, and 10 µg/ml gentamicin. Typically, 1–5 µl of the library mixture was diluted in 2 ml broth to yield an initial OD600of 0.1–0.15. The cultures were immediately split x2, with one tube used to monitor OD600values as the experiments progressed, and the other left untouched for the screen. AG expression was induced by the addition of 1 mM IPTG after acclimatization for 15 min at 37 °C in a shaking incubator and OD600values were measured again for each ECOR + AG library at time of induction. Libraries were then grown for ~80–120 min depending on the relative growth rates of the various ECOR strains, to OD600~ 1.2–1.5. A 10−5dilution of each late-log phase culture was then plated on LB agar (with 10 µg/ml gentamicin and 0.5% glucose to repress AGs and avoid fitness costs) to obtain a count of viable colony forming units (cfu). Cultures were immediately diluted ~1:20 in fresh LB (with IPTG, Mg2+, Ca2+, and 10 µg/ml gentamicin) and 1 ml aliquots were gently mixed with phage lysates at an MOI-e of ~30–100 (the actual MOI-e values were recorded the next day when cfu counts were obtained and are indicated in Supplementary Data1). Parallel uninfected controls were maintained for each experiment, even when the same ECOR + AG library was being tested against different phages and the uninfected controls would be interchangeable. AG induction was limited to 1–2 h and subsequent infections were only allowed to proceed for ~1 phage replication cycle (30–35 min for T-phages and 60–70 min for P1vir and λvir) to prevent prolonged induction of various AGs from biasing the results. For example, this setup also avoids biases resulting from epigenetic modification of phages by widespread restriction-modification (R-M) defenses inE. coli. However, we note that allowing sufficient time for the phages to complete cell lysis was necessary as fast-growing cells were sometimes able to form colonies on LB agar despite having been infected. These colonies had an uneven size distribution and a “splotchy” appearance, perhaps due to ongoing infection on the plate that was nevertheless not able to outpace colony formation. After the infection period was complete, the cultures were vortexed, diluted 1:100, vortexed again, and 50 µl of the dilution was plated on 2 large (150 mm × 15 mm) LB agar plates (with 10 µg/ml gentamicin and 0.5% glucose to repress AGs and avoid fitness costs). The next day >>2000–20,000 colonies were scraped from each infected and uninfected set of plates. 5 µl of the thick resulting cell mixtures was reserved for genomic DNA extraction, and the rest was frozen at −80 °C in 20% glycerol as a backup. A full technical record of our screens is provided in Supplementary Data1.

AG barcodes were amplified and sequenced as with the WM6026 donor library, with a slight modification. The three biological replicate sets of ECOR + AG experiments were amplified using JSW-SS-171 and different versions of primer JSW-SS-170 containing extra N’s at the start of the sequencing read. The first replicate was amplified with JSW-SS-170 (containing 5 N’s), the second replicate with JBD-SS-254 (CGACGCTCTTCCGATCTNNNNNN TGATGTCGTTGTTGCCATCG) with 6 N’s, and the third replicate with JBD-SS-255 (CGACGCTCTTCCGATCTNNNNNNN TGATGTCGTTGTTGCCATCG) with 7 N’s. This ensured that reads from the three sets would not cross contaminate analyses of replicate experiments. Amplicons were sequenced to the same depth as the baseline libraries on Illumina MiSeq and NextSeq instruments in single-end format (100 bp) with two (8 bp) index reads.

We required exact matches for the 20 bp primer-derived invariant sequences flanking the barcodes. These sequences were trimmed and the proportions of various AG-encoding strains in the mixtures were determined using the prevalence of the corresponding 10 bp barcode sequences. Barcode counts per AG were normalized by dividing each count by the median of each experiment, which would represent neutral AG fitness. A log2 transformation was subsequently applied to obtain fitness scores. Care was taken to sequence each library to similar depth such that fitness scores across experiments were distributed in the same range. Poorly represented AGs were identified in the baseline libraries as well as the infected and uninfected experimental samples using a low read cutoff of 100, or if the log2 normalized average read counts across the three replicates for any AG were >3x the median absolute deviation below the median for that experiment. Reproducibility was determined using T-tests across the three replicates, and we enforced aP-value cutoff of 0.2. The magnitude of the AG fitness effect was determined by (a) subtracting the AG fitness scores in the uninfected library from the infected libraries to assess whether AGs changed host sensitivity to phage infection, and (b) subtracting the AG fitness scores in the baseline library from the uninfected libraries to assess whether AGs change host fitness directly. AGs were selected for further study if they were not poorly represented to begin with, produced reproducible effects across replicates, and changed host fitness by at least 4-fold. Although we had targeted our experiments to phage-host combinations where the host was mostly resistant to the phage in order to find counter-defense AGs, a few hosts turned out to be more sensitive to certain phages in liquid infection than suggested by agar-overlay plaque assays. In these cases, our platform was also able to robustly identify AGs that conferred a protective advantage to the host (e.g., Imm and Cor, which both block phage DNA entry57,58). In practice however, these effects can be very variable and the reproducibility filters typically needed to be relaxed in order to find such “superinfection exclusion” AGs.

All counter-defense AGs were subsequently conjugated into the wild ECOR hosts where they demonstrated an effect, and tested against all 8 phages (not just the ones that were used in the screen with that host). In several hosts, the AG was found to additionally sensitize the host to phages that were omitted in the screen. Not all the screen phenotypes could be confirmed in agar-overlay plaque assays, possibly due to variations in cell growth between liquid and solid media, or due to the requirement for successive complete infection cycles and sufficient burst sizes for the formation of visible plaques that would render plaque assays less sensitive than single-infection cycle dynamics in our screen. Nevertheless, further experiments were performed only in phage-host-AG combinations that could be confirmed by plaque assay due to ease of follow up testing.

Conditional lethal AGs were identified directly from the heatmap of fitness scores, with a subset selected for further experimentation using an arbitrary fitness cutoff of ~6–7 ( ~ 100-fold).

Tn5 whole-genome knockout strain libraries were constructed using the RB-TnSeq donor library (pKMW7-derived strain APA766 from Dr. Adam Deutschbauer) conjugated with the recipient ECOR strain in a biparental mating on LB plates supplements with 300 µM DAP. The next day, cell mixtures were scraped and resuspended in 1 ml LB and 1000X dilutions of this conjugation mixture were plated on 10 large (150 mm × 15 mm) LB plates (lacking DAP) supplemented with 50 µg/ml kanamycin. Approximately 0.5–1 million colonies were scraped taking care to break colonies apart on the surface of the plates, mixed very thoroughly, aliquoted and stored at −80 °C with 20% glycerol, with ~5–10 µl reserved for genomic DNA extraction and reference library preparation.

RB-TnSeq allows the same mutant library to be challenged under various conditions such as challenge by various phages, and simplifies the downstream sequencing-library preparation by substituting barcode sequencing for all experimental conditions after initial characterization of the reference library. For completeness, we describe the RB-TnSeq procedures here as implemented in our lab.

To characterize the Tn5-knockout reference libraries in the various ECOR strains, genomic DNA was extracted from 5 to 10 µl of the cell-scrape and prepared for sequencing using the NEBNext Ultra II FS DNA Library Prep Kit (NEB) with the following modifications. 500 ng DNA was fragmented for 25 min according to manufacturer’s instructions. The adaptor ligation step was performed as directed albeit with a custom pre-annealed oligo adaptor comprising of YL001 (/5Phos/GATCGGAAGAG/3ddC/) annealed to one of YL002:005 (AGCGGCAATTTCACACAGGACAAGCAGAAGACGGCATACGAGATNNNNNNNNAGTGGTGACTGGAGTTCAGACGTGTGCTCTTCCGATC*T) where the 4-base underlined sequence serves as a variable barcode unique to each oligo. The USER Enzyme steps post-ligation were skipped and the bead-cleanup was performed using 40 µl and 20 µl of Sample Purification Beads successively as instructed for library size selection in the 150–250 bp range. The PCR amplification of transposon-genome junctions was performed using the cycling parameters described in the kit for 11 cycles with Q5 Ultra II FS Master Mix (NEB) using primers YL006 (AGCGGCAATTTCACACAGGA) and JBD-SS-272/oAD493 (ACACTGGCAGAGCATTACGCCCT) instead of the kit-supplied primers. A second nested-PCR enrichment step was performed for 11 cycles using the same cycling parameters as before, using the entire bead-purified reaction product from the first step as a template with primers YL009 (CAAGCAGAAGACGGCATACGAG) and JBD-SS-273:280 (AATGATACGGCGACCACCGAGATCTACAC TATAGCCT ACACTCTTTCCCTACACGACGCTCTTCCGATCT NNNNNNN GCAGGGATGTCCACGAGGTCTCT) where N8barcodes correspond to reverse-complemented Illumina TruSeq HT D501-508 indexes. Bead-purified amplicons were quantified using the 1X dsDNA HS kit with the Qubit 4.0 Fluorometer (Invitrogen) and sequenced on Illumina MiSeq and NovaSeq instruments in single-end format (150 bp) with two (8 bp) index reads.

The first 100 bp of these reads contain transposon derived sequences and a DNA barcode that uniquely identifies a particular Tn5 insertion. The last 50 bp of these reads contain host-genome derived sequence that help determine the location of the transposon insertion and hence construct a map between the Tn5 barcode and the insertion site (IS) in the genome. Briefly, 20 bp barcodes and 16-50 bp IS sequences were trimmed from the sequencing reads. To isolate the barcode and IS, we allowed 3 mismatches in the 23 bp invariant sequence upstream and up to 6 mismatches in the 50 bp downstream of the barcode using a Hamming distance function to compare the expected and actual sequences. Any reads failing these sequence-fidelity requirements were discarded. Reads containing an IS that matched the Tn5 transposon vector in the donor strain were also discarded. The 4 Ns adjacent to the underlined index sequences in YL002:005 were also sequenced as part of one 8 bp index read and served as a tag to remove PCR duplicates. This allowed us to distinguish between sequencing “reads” and DNA “fragments” present in the sample at the adaptor ligation step. Thus, reads containing unique combinations of barcode, PCR tag, and IS were entered into the barcode/IS map for each Tn5 library, each representing a distinct DNA fragment (but also machine errors in sequencing, chimeric PCR amplicons, 3’ truncations etc.). The filtered ISs were then mapped to genes within their respective host genomes. As described previously59, it is possible for transposon barcodes to map to the genomes ambiguously. Barcodes associated with multiple distinct ISs were retained only if their most frequently represented IS accounted for over 90% of the fragments containing that barcode. We then counted the number of DNA fragments recovered per gene and used this as a reference library for subsequent BarSeq experiments to assay depletion of strains with mutations in specific genes upon phage infection.

Tn5 mutant strain libraries of the various ECOR strains were then challenged by various phages in a procedure analogous to the ECOR + AG screens. Cultures of Tn5 libraries were initiated with 100 µl of thick cell scrape mixture in 100 ml LB supplemented with 50 µg/ml kanamycin, Mg2+, and Ca2+, to an initial OD600value of 0.1–0.15. Cultures were grown at 37 °C with shaking for 80–90 min to an OD600of 0.7–1. A 10−5dilution of each late-log phase culture was then plated on LB agar (with 50 µg/ml kanamycin) to obtain a count of viable colony forming units (cfu). Cultures were immediately diluted ~1:10 in fresh LB (with Mg2+, Ca2+, and 50 µg/ml kanamycin) and 1 ml aliquots were gently mixed with lysates of the appropriate phages at an MOI-e of ~30–100 (the actual MOI-e values were recorded the next day when cfu counts were obtained and are indicated in Supplementary Data3). Since the parental ECOR strains were typically quite resistant to phage infection to begin with, only mutants with transposon-inactivated defense systems would be expected to drop out upon infection. In practice however, some strains exhibited more pronounced mortality upon prolonged phage infection in the Tn5 screens. In particular, in experiments with T2 and the Tn5 library constructed with the ∆wecAstrain of ECOR21 (which was generally more susceptible to infection by T2 and other phages), MOI was titrated in three parallel infection screens (with varying amounts of phage lysate added: 350 µl, 100 µl, and 25 µl) to empirically ensure specific depletion of only the phage-sensitive mutants. Similarly, in experiments with T4∆ip2∆ip3and the Tn5 library constructed with ECOR17 (which resists infection by T4∆ip2∆ip3using both O-antigen and GmrSDECOR17), MOI was titrated in five parallel infection screens (with varying amounts of phage lysate added: 200 µl, 50 µl, 12.5 µl, 2.5 µl, 1 µl). Uninfected controls were maintained for each experiment, and each set of experiments was performed in biological duplicates. Infections were allowed to proceed for 5 min at the benchtop without shaking, and 75 min at 37 °C with shaking. Since an interaction between the host and phage had already been identified in the earlier AG screen, infections were not restriction to a single phage replication cycle, but allowed to proceed further to achieve full depletion of the phage-sensitive Tn5-knockout mutants in the pool. After the infection period was complete, the cultures were vortexed, diluted 1:10, vortexed again, and 100 µl of the dilution was plated on 2 large (150 mm × 15 mm) LB agar plates (with 50 µg/ml kanamycin). We note that this dilution yields bacterial lawns and in our experience this preserves diversity of surviving colonies without degrading the signal of dropouts by phage-killing in the experiment. The next day, bacterial lawns were scraped from each infected and uninfected set of plates. 5 µl of the thick resulting cell mixtures was reserved for genomic DNA extraction, and the rest was frozen at −80 °C in 20% glycerol as a backup. A full technical record of our screens is provided in Supplementary Data3.

To amplify barcodes from the post-selection infected and uninfected Tn5 libraries, we followed a modified BarSeq98 method59, with two successive rounds of PCR. The transposon barcode sequence was amplified by PCR using Q5 Ultra II FS Master Mix (NEB) with primers JBD-SS-310 (CGACGCTCTTCCGATCTNNNNNNNGATGTCCACGAGGTCTCT) and JBD-SS-311 (ACTGACGCTAGTGCATCAGTCGACCTGCAGCGTACG). Template-matching regions in the primers are underlined. Sequencing adaptors were attached in a second round of PCR using amplicons from the first PCR round as the templates, with dual-indexed primer sets JSW-SS-42:53 and JSW-SS-54:61 (sequences already provided in section describing AG screening). Cycling conditions for round 1 were as follows: one cycle at 98 °C for 4 min; two cycles at 98 °C for 30 s, 63 °C for 30 s, and 72 °C for 30 s; 22 cycles at 98 °C for 30 s, and 72 °C for 30 s; and one cycle at 72 °C for 4 min. Conditions for round 2 were one cycle at 98 °C for 1 min; two cycles at 98 °C for 10 s, 64 °C for 30 s, and 72 °C for 10 s; 4 cycles at 98 °C for 10 s, and 72 °C for 20 s; and one cycle at 72 °C for 2 min. 0.5–1 ul of unpurified 1stround reaction product was used as template for the 2ndround of PCR. Amplicons from the 2ndround were gel-purified by electrophoresis (3% agarose gel, 4.2 V/cm, 2 hours) and quantified using the 1X dsDNA HS kit with the Qubit 4.0 Fluorometer (Invitrogen). Amplicons were sequenced on Illumina MiSeq and NovaSeq platforms in single-end format (150 bp) with two (8 bp) index reads.

DNA barcodes were trimmed from the reads and the proportions of various Tn5-knockout mutants in the mixtures were determined using the prevalence of the corresponding barcode sequence. Briefly, we allowed 3 mismatches in the 18 bp invariant sequence upstream, and 4 mismatches in the 18 bp downstream of the transposon barcodes using a Hamming distance function to compare the expected and actual sequences. The frequency of occurrence of each barcode (representation number) was counted. Transposon barcodes were matched to those found in the reference libraries, inferred to represent knockouts in the genes containing the corresponding ISs, and the various barcode representation numbers were added together for each gene. Cumulative transposon insertions per gene were then compared statistically between the infected and uninfected samples (with the reference library as a baseline to filter out poorly represented, presumably essential genes) using the same data analysis procedure as for the AG screen, albeit with two biological replicates instead of three.

Lipopolysaccharide was prepared from liquid overnight cultures of wildE. colistrains expressing the relevant AGs (LB + IPTG). Briefly, 50–100 µl of saturated culture was spun down and cells were thoroughly resuspended in 100–200 µl of lysing buffer (62.5 mM Tris-HCl, pH6.8, 10% glycerol, 2% SDS, 4% ß-mercaptoethanol). We routinely supplement 1X Laemmli Buffer (BioRad) with SDS and ßME to make lysing buffer. Samples were boiled at 100 °C for 15 min, and allowed to rest at room temperature for 15 min. 100 µg of Protease K were added to each sample and protein was digested at 60 °C for at least 1 h. 15 µl of each sample were run onto a 12% polyacrylamide TGX Mini-Protean Precast gel (BioRad) at 200 V for 35 min, and visualized using the Pro-Q Emerald 300 LPS stain kit (Thermo Fisher) precisely according to manufacturer’s instructions.

FLAG-tagged AGs were conjugated into ECOR strains by Tn7-transposition (above) according to Supplementary Data4. Each strain was grown overnight at 37 °C in 2 mL of LB supplemented with 0.5% glucose and 10 µg/mL gentamicin, then diluted 1:100 into 100 mL LB supplemented with 10 µg/mL gentamicin and grown at 37 °C for 30 min. The media was then supplemented with 1 mM IPTG and grown for another 2.5 h. “Popcorn” pellets were collected by centrifugation for 30 min at 4000 × g, resuspension in 100 µL of ice-cooled lysis buffer [50 mM Tris pH 7.4, 150 mM NaCl, 1 mM EDTA, 1 mM MgCl2, 0.5% NP40 (Research Products International), 125 U/mL Benzonase (Millipore), 1x protease inhibitor cocktail (Roche, cOmplete ULTRA tablets, mini, EDTA-free), 0.5 mg/ml lysozyme (Fisher Scientific)], followed by dropwise addition into liquid nitrogen and stored at −80 °C. Popcorn pellets60were lysed by 10 cycles of cryomilling for 2 min at 12 counts per second in a SPEX SamplePrep 6870D Freezer/Mill and stored at −80 °C.

For each phage-host combination, 3 replicate lysates were reconstituted using 200 mg of the cryomilled powder resuspended in 750 µL of lysis buffer. Lysates were cleared by centrifugation at 16,000 × g at 4 °C for 15 minutes. Anti-FLAG magnetic agarose beads (Pierce) were washed on a magnet with 1 mL of ice-cooled IP buffer (50 mM Tris pH 7.4, 150 mM NaCl, 1 mM EDTA, 1 mM MgCl2) twice and resuspended to their original volume in IP buffer. Cleared lysates were incubated with 30 µL of FLAG beads on an end-over-end tube rotator at 10 rpm at 4 °C overnight. The supernatant was separated from the beads on a magnet. Beads were washed once with 700 µL of 0.05% NP-40 and 1x protease inhibitor cocktail in IP, once with 700 µL of 0.05% NP-40 in IP, and 3 times with 700 µL of IP. Proteins were eluted by incubation with 25 µL of 100 µg/ml 3xFLAG peptide (Sigma) in 0.05% RapiGest (Waters Corp) in IP buffer on an end-over-end tube rotator at 10 rpm at 4 °C overnight. The eluate was separated from the beads on a magnet. The elution step was then repeated with the same beads and fresh elution buffer at room temperature for 1 h. The eluates were combined and stored at −20 °C.

Samples were prepared for Mass Spectrometry (MS) as described previously in the Filter-Aided Sample Preparation Protocol61with the following modifications. Before transferring to an AcroPrep Advance 10k Omega plate, each eluate was resuspended in 100 µL of 8 M Urea (Thermo Scientific) dissolved in 50 mM ammonium bicarbonate (MP Biomedicals) and 5 mM TCEP (Aldrich), followed by centrifugation to dryness. During alkylation of cysteine residues, 10 mM chloroacetamide (Thermo Scientific) was used instead of 10 mM iodoacetamide. Wash steps prior to proteolysis were carried out with 200 μL of 20 mM ammonium bicarbonate (instead of 100 μL). Proteolysis was performed without the addition of lysyl endopeptidase. Proteolysis was quenched by addition of 10% trifluoroacetic acid (Thermo Scientific) to reach ≈ pH 2. Peptides were then purified over a BioPureSPE Mini 96-Well Plate (Nest Group). Briefly, C18 columns were activated by washing once with 400 µL of acetonitrile (Fisher Scientific) and twice with 400 µL of 0.1% formic acid (Thermo Scientific) in water solution, LC–MS grade (Thermo Scientific). Samples were loaded and centrifuged at 1500 X g for 2 min. The bound peptides were washed 3 times with 400 µL of 1% formic acid before elution with 150 µL of 50% acetonitrile in 0.1% trifluoroacetic acid. Peptides were vacuum dried and stored at −80 °C.

Samples were resuspended in 15 µl of 0.1% formic acid prior to loading for MS. The MS acquisition was performed as described62with same MS parameters and LC configuration.

Raw files were processed in FragPipe63using the LFQ-MBR workflow with minor modifications. The files were searched against a combined database of protein sequences from ECOR1, ECOR3, ECOR15, ECOR21, ECOR22, ECOR6656, and MG1655 with duplicate entries removed and common contaminants added. Decoys were generated by pseudo-inversion. Protein and peptide FDR was fixed to 1% and MBR was disabled. Cysteine carbamylation was set as fixed modification while N-term acetylation, methionine oxidation and pyro-glu formation were set as variable modification with a maximum of 3 modifications per peptide.

MaxLFQ intensities were used for statistical analysis64. Each triplicate set of host-AG samples was quantile normalized against a triplicate set of samples from the same host expressingorf74as it did not produce any phenotypes in the AG screen. For quantile normalization, all proteins in each sample were ranked according to their MaxLFQ intensity. Next, the mean value of the intensities of proteins occupying a given rank was calculated, then each protein’s value was replaced with the mean value according to its rank. Fold changes were calculated by taking the log2 ratio of average normalized values between the test set and the control set. For each host-AG sample, all positively enriched proteins were ranked according to their fold change. For each AG, proteins were assigned “summed rank” values by calculating the sum of the ranks of each protein across all hosts where that AG was tested. P-values were calculated by student’s t-test on the normalized sets of replicates from the test and control samples. Top enriched candidates for each AG were selected based on their summed ranks andp-values.

The R6K-origin pKEK2201 vector (from Prof. Karl E. Klose) carrying the desired genetic modification (eg. awecAdeletion) flanked by 1000 bp homology arms was prepared by Gibson assembly, and delivered as a suicide vector into wildE. colistrains via conjugation from the WM6026 auxotrophic donor. Conjugation was performed using the same method used to deliver AGs, albeit with biparental instead of triparental mating. Successful transconjugants (containing a chromosomally integrated plasmid after the first homologous recombination event HR1) were selected by incubation on LB plates supplemented with kanamycin. The second recombination event HR2 to complete the allelic exchange was selected viasacB-mediated counterselection on LB plates supplemented with 300 mM sucrose after overnight growth of HR1 transconjugants. Successful allele exchange was verified by PCR, and by LPS electrophoresis to assay for the absence of O-antigen in the case of thewecAdeletion.

Cells were collected from a saturated overnight culture of anE. coliTOP10 strain expressing an N-term GST-GalU fusion construct from a plasmid (pBAD promoter) and a C-term Gnarl3-3xFLAG fusion construct from a Tn7 single-copy chromosomal insertion (pLlacO-1 promoter). Cells were grown to mid-log phase (1:20 dilution of overnight cultures into 7 mL fresh LB with 100 µg/ml of ampicillin and 10 µg/ml gentamicin, grown at 37 °C for 1 h) and GST-GalU expression was induced by the addition of 0.1% w/v L-arabinose. Gnarl3-3xFLAG expression was induced by the addition of 1 mM IPTG one hour later, and cells were centrifuged at 8000 × g for 10 min after another hour. Whole cell lysates were prepared by resuspending cell pellets in 1 mL lysis buffer (50 mM Tris pH 7.4 at 4 °C, 150 mM NaCl, 10 mM EDTA, 1 mM MgCl2,0.5% NP40, 125 U/mL Benzonase, 1x protease inhibitor cocktail (Roche, complete ULTRA mini EDTA free), 0.5 mg/ml Lysozyme, 5 mM DTT), and sonicating with the samples continuously immersed in a circulating 4 °C water bath. Sonication was performed with a Bioruptor Pico bath sonicator for a total of 10 min (20 sec ON, 40 sec OFF, for a total of 30 cycles). Whole cell lysates were incubated with magnetic Glutathione agarose beads (Pierce) for 1 hour at room temperature with end-over-end rotation. Beads were then washed 2x in batch format with wash buffer 1 (50 mM Tris pH 7.4, 150 mM NaCl, 10 mM EDTA, 1 mM MgCl2,0.05% NP40) and then 3x with wash buffer 2 (same as wash buffer 1 but without detergent). Bound protein was eluted with 50 mM reduced glutathione prepared immediately before use in wash buffer 2 and adjusted for pH. Western blotting of cell lysates and eluates was performed as follows. Samples were heated at 95 °C for 5 min with 4x Laemmli buffer supplemented with ß-mercaptoethanol, resolved by SDS-PAGE, and transferred to PVDF membranes using the Bio-Rad Trans-Blot Turbo Transfer System according to the manufacturer’s instructions. Membranes were blocked for 1 hr in blocking buffer (5% w/v solution of non-fat dry milk in TBS-T: 1X Tris-buffered saline (20 mM Tris, 150 mM NaCl) supplemented with 0.1% Tween-20 detergent). Membranes were then incubated with a primary antibody (Rabbit anti-GST (Cell Signaling Technology 91G1) diluted 1:2500, or Mouse anti-FLAG (Sigma F1804) diluted 1:1000 in blocking buffer for 1 h, washed 3x with 25 mL TBS-T, then incubated with a secondary antibody (Anti-Rabbit HRP-linked IgG (Cell Signaling Technology 7074S) diluted 1:2000, or Anti-Mouse HRP-linked IgG (Invitrogen 62-6520) diluted 1:2000) for 1 hr, and washed 3x again with 25 mL TBS-T per wash. Membranes were developed using the Clarity Western ECL substrate kit (Bio-Rad) and imaged on an Azure bio-imaging system.

T4 5 hmC (lacking the glucosyl- modification) and T4 C (lacking both glucosyl- and hydroxymethyl- modifications) were received from the Bushman lab. T4 5hmC was propagated in DH10b, while T4 C was propagated in CR63. Prior to plating, T4 C was propagated in DH10b to ensure lack of modifications on its genome. Strains expressing various GmrSD enzymes were grown overnight in LB supplemented with 10 mM Mg2+and 100ug/ml carbenicillin. 100ul of the overnight cultures was mixed with 5 ml of 0.4% top agar with or without arabinose inducer where indicated. Serial dilutions of propagated phages were then spotted before plates were allowed to dry and incubated at 37 °C overnight.

Further information on research design is available in theNature Portfolio Reporting Summarylinked to this article.

S.S. was supported by the Damon Runyon Fellowship Award (DRG 2352-19). Experiments were funded by awards to J.B.D. by the Vallee, Searle, and Kleberg Foundations. J.B.D. and D.S. were also supported by NIH (R01 AI167412). K.S.M. and E.V.K. are supported by intramural funds of the US Department of Health and Human Services (National Institutes of Health, National Library of Medicine). We thank Venigalla Rao for ∆Ipmutant T4 phages, Frederic Bushman for hypo-modified T4 phages, and Tami Tolpa for support with figure schematics.