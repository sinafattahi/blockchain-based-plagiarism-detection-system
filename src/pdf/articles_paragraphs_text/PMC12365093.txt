The utilization of thermodynamics-based modeling emerged as a valuable technique to simulate various complex phenomena and their interactions occurring in a thermodynamic system. This paper presents a thermodynamics-based modeling approach aimed at simplifying the understanding and simulation of various in-cylinder phenomena in spark ignition engines. These phenomena include gas exchange, compression and expansion processes, heat transfer from cylinder walls, combustion, emission formation, mixture composition, properties calculation and frictional losses, which collectively impact the overall engine performance. The paper begins with a brief description of these in-cylinder phenomena and their effects on engine performance, and then thermodynamics-based sub-models and their validations are presented. For a more realistic assessment of engine performance, these sub-models are integrated, and full engine cycle simulations under different operating conditions are carried out. The developed model showed that the simulation results are in close agreement with the experimental results, which ensures that the insights gained from these simulations are trustworthy and can be used effectively for research purposes.

Internal combustion (IC) engines are highly essential to meet the world’s energy needs in the power generation and transportation sectors. Research and development initiatives in the fields related to combustion engines in the past century have contributed significantly to obtain better performance and emission characteristics. However, the recent emission regulations and concerns over climate change still compel OEMs to design IC engines with superior efficiency and ultra-low emission levels. In general, the design of an IC engine is a challenging task as it involves measurement and optimization of various in-cylinder phenomena such as fuel-air mixing, turbulence generation, combustion, emission formation, etc. These phenomena happen rapidly and in a confined and harsh environment. Obtaining the required information during the early stage of engine design through experimental investigations is a difficult and expensive task. For this reason, researchers and engineers oftentimes tend to use mathematical models along with experiments to design IC engines1. Mathematical models for simulating IC engine processes are mainly of two types: computational fluid dynamics-based models2and thermodynamics-based models3. Both models have their merits and demerits in comparison, and their application particularly depends on the type of problem being investigated. CFD-based models offer high spatial resolution and accuracy but require extensive computational time. In contrast, thermodynamics-based models deliver faster results but lack spatial detail.

To better understand the simulation procedural details involved in the thermodynamics-based modeling approach, it is important to comprehend the different phenomena that happen during an engine cycle and their impact on the engine performance. The following text briefly provides these details. In general, a four-stroke SI engine cycle consists of four strokes, namely intake, compression, expansion, and exhaust, to produce one power pulse. During the different strokes of the engine cycle, various phenomena take place. During the intake stroke, the opening of the intake valve and the downward motion of the piston create a pressure difference between the intake manifold and cylinder regions. This pressure difference enables fresh air and fuel to flow into the cylinder region from the intake manifold side (referred to as the gas exchange process). This stroke is primarily responsible for determining the quantity of fuel and air available for the combustion process, thus directly influencing the power output of the engine. With the closure of the intake valve, the gas exchange process ceases, and the mass entered remains trapped inside the cylinder and undergoes compression due to the upward motion of the piston. The compression process raises the temperature and pressure of the in-cylinder charge. It is during these two strokes that the fuel and air mix and get ready for the combustion process. Near the end of the compression stroke, the introduction of spark onsets the combustion process by initiating a turbulent flame front, which moves across the combustion chamber by rapidly combusting the charge. The whole combustion process essentially brings about changes in two ways. One, the in-cylinder pressure and temperature increase as the fuel’s chemical energy gets converted into thermal energy. Second, the mixture composition significantly changes as the initial reactants (fuel and air) turn into combustion products (CO2, H2O, etc.) during oxidation. During combustion, some harmful emission species such as NOx, CO, and unburned hydro-carbon formation also happen and need to be accounted4,5. Modeling both combustion and emission formation phenomena is essential to accurately estimate the combustion efficiency and emission levels. The combustion of fuel generates high-pressure and high-temperature gases, which expand against the piston and result in a work transfer and power output of the engine. During the expansion stroke, the expansion of the in-cylinder volume lowers the in-cylinder temperatures and pressures, and consequently, the combustion process ceases. Towards the end of the expansion stroke, the exhaust valve opens, and the combustion products start flowing from the cylinder region to the exhaust manifold side (gas exchange process). This flow continues to happen till the end of the exhaust stroke, and eventually, some amount of exhaust gases get trapped inside the cylinder. During all the processes mentioned above, a temperature difference exists between in-cylinder gases and in-cylinder surfaces, which results in heat transfer. Higher heat transfer from in-cylinder surfaces would decrease the engine’s thermal efficiency. Further, due to relative motion between the engine components, frictional losses occur during engine operation, which also affects the engine’s efficiency. All these physical processes have to be modeled to simulate the full engine cycle of a spark ignition engine. In addition to these physical processes, the computation of thermodynamic characteristics (specific heat at constant volume and pressure, specific heat ratio, and characteristic gas constant) for different gases and the entire mixture are necessary for simulations. In conclusion, for the full SI engine cycle simulation, seven phenomena must be modeled primarily: mixture composition and properties calculation, heat transfer, gas exchange process, compression and expansion processes, combustion process, emissions formation, and frictional losses.

In most previous research works, the modeling of the seven above-mentioned phenomena has been validated either using cylinder pressure data or emission data from full-cycle simulations. The accuracy of thermodynamics-based modeling depends on the choice of sub-models or methods used to simulate specific engine phenomena. However, in these works, the sub-models developed for these phenomena were not validated individually, which may introduce significant errors in the predicted results. Any error incurred while developing any sub-model impacts and reduces the accuracy of full-cycle simulation results. For these reasons, the development of 0D-based modeling has to be performed very carefully6,7. Hence, to accomplish this, the authors suggest validating every developed sub-model against results obtained from experiments, CFD simulations, or other reliable sources as appropriate. This unique approach of validating each sub-model individually helps identify potential errors or discrepancies at early stages, thereby improving the robustness and accuracy of the final model. The developed and validated sub-models for every phenomenon can then be systematically integrated to accomplish a full-cycle simulation. The thermodynamic model thus built becomes trustworthy and effective for research and design purposes.

Comprehension of different methods and accumulating essential details for modeling the above-mentioned seven phenomena is the next crucial step to simulate the SI engine operation using thermodynamics-based modeling approach. To this end, in Sect. 3, the various methods/sub-models that are available in the literature to model a particular phenomenon and the details required for modeling are discussed in a detailed and simple manner, which is extension of our previous work8. Validation of individual sub-models is also provided using results from the CFD model or from other sources. The details regarding the employed CFD model and its validation and the experimental setup used for conducting engine experiments are briefly specified in Sect. 2. In Sect. 4, the procedure followed for integrating developed sub-models to accomplish full engine cycle simulation is presented. Finally, Sect. 5 presents the results of the fully developed model and its efficacy in capturing the effects of engine operating parameters.

This section encompasses the following information: details regarding engine specifications and the operating conditions at which thermodynamics-based modeling is performed, the configuration of the experimental setup, the modifications implemented for conducting experiments, and the instruments employed for measurements.Additionally, it outlines the particulars of the Computational Fluid Dynamics (CFD) model, including its validation, as the results derived from the CFD model are used in evaluating and validating sub-models of thermodynamics-based modeling.

Table1lists the engine specifications and the operating conditions at which experimental data is acquired to construct the thermodynamics-based model and validate the CFD model. The engine used is a retrofitted SI engine converted from a production diesel engine of 661 CC with combustion chamber comprised of a hemispherical-shaped bowl-in-piston and flat cylinder head. The initial compression ratio of the base production engine under CI mode of operation is 17.5:1. However, the present engine is incorporated with a variable compression ratio system along with the following modifications to operate in SI mode. A Bosch twin-electrode spark plug was fitted in the original diesel injector hole and a high-energy ignition coil capable to ignite the CNG-air mixtures was employed. Modifications were made on the intake manifold side to incorporate a throttle body and fuel delivery. Fuel was inducted into the intake manifold using a gas flow adjuster. Figure1provides a schematic representation that details the experimental setup and outlines the modifications implemented for methane fuel operation. In general, the methane gas is available in individual cylinders but only at high pressures (110–180 bar). Hence, a two-stage pressure regulator was employed to reduce methane gas pressure to below 10 bar. With very precise regulation, the mass flow controller permits a certain flow rate of methane gas to enter the buffer chamber. The controller determines the setpoint values (flow rate values) for the mass flow controller. The pressure sensor downstream of the buffer chamber sends the real-time pressure values as feedback to the controller. Based on the difference between real-time pressure values and the desired value, the controller determines the setpoint for the mass flow controller. Finally, the methane gas is made available in the buffer chamber at the desired pressure level (less than 6 bar). Following that, a gas-flow adjuster (needle valve) is used to induct the desired flow rate of methane into the intake manifold. The use of a pressure regulator, mass flow controller, and pressure sensor facilitates accurate measurement, close monitoring, and safe induction of methane fuel into the intake manifold. For testing the engine at different loading conditions, it is coupled to an eddy current dynamometer. In-cylinder and intake manifold pressure measurements were made using Kistler piezo-electric and piezo-resistive transducers respectively. A lambda sensor and a K-type thermocouple were fitted in the exhaust manifold. Exhaust emission species concentrations were measured using a Horiba MEXA emission analyzer. For more details on the experimental setup, readers may refer to our previous articles9,10.

For the above-specified engine, a CFD model is built and comprehensively validated against experimentally measured in-cylinder pressure, exhaust species concentrations, and air and fuel flow rates at the operating conditions specified in Table1. These complete details regarding the CFD model development, its validation, and other details, such as mesh settings, etc., are available in our previous articles11–13. However, the CFD model details, which are relevant to this study, are mentioned here briefly as they help readers distinguish the differences in approaches used in 0D and CFD modeling while comparing the results. In CFD simulations, the combustion process of methane fuel is modeled using a detailed chemical kinetics approach. The SAGE combustion model and the GRI Mech3.0 reaction mechanism, consisting of 53 species and 325 reactions, were employed for combustion modeling. The thermodynamic properties, such as specific heat at constant pressure, enthalpy, and entropy of gas species, were computed using species-specific polynomial coefficients available in the thermodynamic data file (therm.dat). NOx emissions were modeled using both the Zeldovich mechanism (with equilibrium assumption for O and OH radicals) and the detailed chemistry model. The heat transfer from the combustion chamber is accounted using the O’Rourke and Amsden’s model. The evolution of pressure, temperature, and fluid flow dynamics with respect to variation in crank angle (CAD) is computed by solving a set of Reynolds-Averaged Navier Stokes (RANS) equations along with the energy equation and Redlich-Kwong equation of state. The Re-normalization Group (RNG) k-ε turbulence model is employed to compute the unknown terms of turbulent stresses in the RANS equations. The Pressure Implicit with Splitting of Operators (PISO) method is used for pressure-velocity coupling. CFD Simulations were started by initializing the values pertaining to the exhaust valve opening condition. Full geometry full-cycle simulations were performed for six consecutive cycles, and only the last two cycle results were considered for analysis.

This section provides comprehensive details for modeling various in-cylinder phenomena. In this work, the method followed to accomplish full engine cycle simulation is by first establishing and validating each sub-model (for each phenomenon) independently. This way of modeling process would help to identify potential errors or discrepancies (if involved) with ease and at the early stages. The developed and validated sub-models for every phenomenon can be finally integrated to accomplish full-cycle simulation. To this end, this section will initially outline methods for calculating mixture composition and properties, followed by detailed discussions on modeling heat transfer, intake and exhaust strokes, compression and expansion strokes, the combustion process, and frictional losses, presented in a systematic order. Further, the work presented in this section is structured as follows. Each subsection, dedicated to each individual phenomenon, starts with a brief introductory description to provide insights about the phenomena under consideration. Following that, mathematical formulations essential for modeling the given phenomenon are presented, along with different methods that are available in the literature. Additionally, data requirements necessary for implementing the mathematical models are also provided. Finally, the validations of the sub-models are provided, which involves a thorough comparison of results obtained from sub-models with simulations based on computational fluid dynamics (CFD) or plots available from the literature. For computational purposes, either MATLAB or Python can be utilized.

The gas composition that prevails inside the cylinder region during various strokes of an engine cycle can be classified primarily into two different compositions, namely unburned gas mixture composition and burned gas mixture composition. The term “unburned gas mixture composition” refers to a combination of fuel, air (entering during the intake stroke) and a portion of exhaust gases remaining from the previous cycle. Whereas the term “burned gas mixture composition” refers to the combustion products of fuel and air. The analysis for estimating both the unburned and burned mixture compositions is presented below. For analysis, the mixture compositions can be treated as a mixture of various ideal gases.

During an engine cycle, the unburned mixture composition prevails from the start of intake process CAD to the start of combustion CAD. In general, the temperature of unburned gases is very low, well below 1700 K. The low temperatures cause the chemical reactions (between the mixture of gases) to proceed at an extremely slow rate14, and hence, the mixture composition (species concentrations) does not change significantly. Thus, the unburned mixture composition can be safely assumed to be frozen, i.e., the same mixture composition with respect to CAD. To determine the composition of unburned gas, only low-temperature combustion (only major combustion products) of hydrocarbon fuel (CxHy) is sufficient as shown in Eq. (1).

Whereis the equivalence ratio, andis the number of moles of the ithspecies.

After simplification, Eq. (1) is written for per mole ofreactant and presented in Eq. (2).

Where, y1is the molar H/C ratio, ψ is the molar N/O ratio (for air 3.7274).

The right-hand side of Eq. (2) comprises all major combustion products. For lean fuel-air mixtures, due to the presence of excess air, C and H atoms in the fuel molecules completely oxidize toand, respectively; therefore,andcan be neglected. The number of moles of the four remaining species (CO2, H2O, O2, and N2) in Eq. (2) can be determined by solving the four mass balance equations of reacting atoms (C, H, O, N). The final obtained formulae are provided in the second column of Table2. In the case of rich fuel-air mixtures, the available oxygen is insufficient for the complete oxidation of carbon and hydrogen. Consequently, CO and H2levels are significant and cannot be ignored, while O2can be neglected as it is fully consumed in the oxidation of carbon and hydrogen. For rich fuel-air mixtures, the number of unknowns (moles of products) exceeds the elementary mass balance equations for reacting atoms. Therefore, in addition to the mass balance for each reacting atom, the water-gas equilibrium reaction (as given in Eq. (3)) is also utilized to calculate the mixture composition.

Composition of unburned gas mixture (in moles per moles ofreactant)14.

Whererepresents the equilibrium constant for Eq. (3), determined through curve fitting of JANAF table data15, and mentioned in Eq. (5) as a temperature-dependent function14.

Where T is the temperature of the in-cylinder gas mixture in Kelvin. Therefore, the number of moles of different products present in an unburned mixture of rich fuel-air mixture is determined by solving the mass balance equations of reacting atoms and Eq. (4), and the final obtained formulae are presented in third column of Table2, whereis the burned mass fraction, and c is the root of Eq.6) obtained from atom mass balance equations and Eq. (4), andis the total number of moles of products in the burned gases given in Table3.

Composition of burned gas mixture (in moles per moles ofreactant)14.

The unburned mixture composition that prevails from the start of intake stroke CAD to the start of combustion CAD in the full cycle simulation can be computed using the formulae provided in Table2. To calculate the unburned mixture composition of lean fuel-air mixtures, the equations in the second column of Table2should be used, and similarly, for rich fuel-air mixtures, the equations in the third column of Table2should be used. It is better to encompass all these equations while developing the code. However, only appropriate equations should be chosen based on the defined equivalence ratio.

With the introduction of spark, the unburned gases (fuel, air and residual exhaust gases) start reacting and the in-cylinder gas composition changes significantly due to the formation of radical species and combustion products. Based on the thermodynamic state (primarily on temperature) of the burned gases (after the onset of combustion), the analysis for computing burned gas composition is classified into two parts and is discussed below.

For determining the composition of burned gas, which is under 1700 K temperature, a similar procedural details presented in the above section can be followed by excluding the presence of fuel. The final results of the analysis are presented in Table3.

The reaction products listed in Eq. (2) are insufficient while fuel is getting combusted at high temperatures. During the combustion process, the fuel molecules break down and lead to the formation of new intermediate and radical species before forming the final reaction products. Also, at higher temperatures, the reaction products considered in Eq. (2) dissociate and may react with other species to form new species. Hence, changes in mixture composition during the combustion process should not be ignored. Chemical equilibrium is a reasonable approximation for determining the composition of gases during combustion at high temperatures. Olikara and Borman16have developed a computer program to calculate the equilibrium composition of combustion products of hydrocarbon fuel with air for application in engine cycle simulations. The combustion of a generalized fuel () at an equivalence ratioand 11 major combustion products were considered at equilibrium at a specified temperature and pressure. In the present analysis, Argon is excluded.

Here n, m, l, k are the number of atoms of carbon, hydrogen, oxygen and nitrogen present in the fuel molecule, respectively.torepresents the mole fraction of the corresponding species, andis the number of moles of fuel that gives one mole of combustion products.

Equation (7) contains 12 unknowns. Hence 12 equations would be required to solve it. Out of the 12 required equations, 4 equations can be developed from the mass balance of 4 atoms (C, H, O, N) as shown in the Eqs. (9–12). The summation of all mole fractions should be equal to 1, as shown in Eq. (13).

In total, five equations have been obtained so far, and seven more equations are required to solve the Eq. (7). These remaining seven equations are obtained by using criteria of chemical equilibrium between the products as given in Eqs. (14–20)16.

Equations (14–20) are written in terms of mole fraction of only four species (), to reduce the number of unknowns and presented in Eqs. (21–27).

Where p is the in-cylinder pressure in atmospheres.-are equilibrium constants based on partial pressure for Eqs. (21–27). The procedure to calculate the constant for each equation is provided in Eq. (28).

Where t = T/1000, Table4presents the values of coefficients A1, B1, C1, D1, and E1used in Eq. (28) to calculate values offor Eqs. (21–27), for temperature range of 600 K < T < 4000 K. These equilibrium constants were calculated by curve fitting of data obtained from JANAF thermodynamic tables15.

Constants values used to calculate equilibrium constants16.

To determine the mole fractions of combustion products mentioned in Eq. (7), the values of mole fractionsandare first calculated by solving Eqs. (29–32) through the Newton-Raphson numerical method. In Python and MATLAB, “fsolve” (an in-built function) can also be used to solve the non-linear set of four equations. Subsequently, the obtained values are then substituted in Eqs. (21–27) to get the mole fractions of the remaining species.

Table5presents the validation of the developed thermodynamics-based model. Using the developed code, mixture compositions were calculated for different fuel-air mixtures at different temperatures, pressures and equivalence ratios. For validation of results, an open source GASEQ chemical equilibrium software17is used.

This section covers different models available for calculating thermodynamic properties, such as specific heat at constant pressure and volume (cp, cv), specific heat ratio (γ), and characteristic gas constant (R) of the in-cylinder gas mixture at a given thermodynamic state and their validations. Accurate calculation of these properties is vital for precisely modeling the in-cylinder processes, as they are integral to solving the governing equations for the process under consideration.

Gatowski et al.18proposed correlations for calculating the specific heat ratio of the in-cylinder gas mixture based on studies conducted in different engines and fuel conditions. Equation (33) is derived from experiments conducted in a Ricardo engine using indolene fuel at a stoichiometric air-fuel ratio whereas Eq. (34) is based on investigations performed in a square piston engine with propane/air combustion products at an equivalence ratio of 0.9.

For gasoline engines, Brunt et al.19analyzed the variation of specific heat ratio of the in-cylinder gas mixture with respect to equivalence ratio and temperature. Their findings revealed that the temperature parameter has a more significant impact on the specific heat ratio compared to the equivalence ratio parameter. Consequently, they proposed a second-order correlation (Eq. (35)) between the specific heat ratio of the in-cylinder gas mixture and temperature for gasoline engines.

Hohenberg and Killman20proposed a correlation to calculate specific heat at constant volume of the in-cylinder gas mixture for gasoline and diesel engines and the correlation is provided in Eq. (36).

Wherefor gasoline andfor diesel engine,is the equivalence ratio, T is the temperature in Kelvin.

Once the specific heat ratio and specific heat at constant volume of the in-cylinder gas mixture are calculated, specific heat at constant pressure and characteristic gas constant of the in-cylinder gas mixture can be calculated from Eqs. (37) and (38).

In this approach, at a given temperature and pressure of the in-cylinder gas mixture, firstly, thermodynamic properties of the individual species are calculated using the polynomial fitting as shown in Eqs. (39–41). Then, the mole fraction of each species (calculated using the procedure given in Sect. 3.1) in a mixture is used to compute the mixture properties by Eq. (42). All the in-cylinder gases are considered to be ideal, and their properties are assumed to be a function of temperature only. Molar specific specific heat at constant pressure, enthalpy, and standard state entropy for individual gases as a function of temperature are given in Eqs. (39–41)21.

Whereis the molar specific heat at constant pressure,is the molar specific enthalpy,is the molar specific standard state entropy,,,,,,andare the constants for ithspecies to calculate the thermodynamic properties obtained from the curve fit of JANAF thermodynamic tables15and given in Table6.

Whereis the mole fraction of ithspecies, andis the molar specific thermodynamic property of ithspecies.

All the data in Table6should be given as input during code development and the selection of values should be based on the temperature.

Figure2a,b depict the predicted specific heat ratio and specific heat at constant volume for a methane fuel-air mixture with an equivalence ratio of 1. These predictions are based on the methodologies outlined above and are compared with results from the GASEQ chemical equilibrium software17for a temperature range of 1000–3000 K and 1 atmospheric pressure.

Comparison of (a) specific heat ratio (b) specific heat at constant volume obtained from different models with GASEQ software.

The validation results in Fig.2indicate that property calculations based on composition are more accurate than those based on correlations. Consequently, for the comparison of the specific heat ratio and specific heat at constant volume at the operating conditions given in Table1, the properties calculated based on composition are compared with the results from the CFD model during the closed cycle (from IVC to EVO), as shown in Fig.3.

Comparison of (a) specific heat ratio (b) specific heat at constant volume obtained from 0D model and CFD simulation during closed cycle.

In the introduction section, it was highlighted that a temperature difference exists between the in-cylinder gases and the walls of the combustion chamber throughout four strokes of an engine cycle. This temperature difference causes heat transfer, which must be considered for accurate simulation and estimation of results. The heat transfer between the in-cylinder gases and the cylinder wall occurs through two modes: convection and radiation. As a result, the net rate of heat transfer can be calculated using Eq. (43).

The instantaneous convective heat transfer rate can be calculated using Newton’s law of cooling (Eq. (44)).

Similarly radiation heat transfer is calculated using the Eq. (45).

Whereis the cylinder head surface area,is the piston crown surface area,is the bore diameter,is the stroke length, andis the ratio of connecting rod length and crank radius.

To determine the convective and radiation heat transfer in Eqs. (44) and (45), it is necessary to evaluate the convective heat transfer coefficient () and radiation heat transfer coefficient (). For modeling these coefficients, three well-known models from the literature are provided below.

In this method, the calculation of convection heat transfer is based on dimensional analysis of non-dimensional numbers (Nusselt number, Reynolds number), and a correlation was proposed for Nusselt number, which is given in Eq. (47).

Whereis the mean piston speed and,are thermal conductivity, density and dynamic viscosity of the in-cylinder gas mixture, respectively. The value of constantwas suggested as 0.38 for two-stroke engines and 0.49 for four-stroke engines, constantwas suggested as 0.7.

To calculate the radiation heat transfer, radiation heat transfer coefficient () was suggested asfor diesel engines andfor spark-ignition engines during combustion and expansion processes andfor other strokes.

After the calculation of heat transfer coefficient from Eq. (48) instantaneous heat transfer rate is calculated by Eq. (44), in this method radiation heat transfer was neglected.

After calculating heat transfer coefficient from Eq. (49), instantaneous heat transfer rate is calculated by Eq. (44). In this correlation, radiation heat transfer was neglected.

For the validation of the heat transfer model, a simulation was first performed without considering the heat transfer term (adiabatic process) in Eq. (60) for the specified operating condition detailed in Table1. The pressure calculated under these conditions was observed to be higher than the pressure obtained from the CFD simulation. Following this, the in-cylinder pressure was computed under motoring conditions. For this purpose, the heat transfer term in Eq. (60) was modeled using the models presented in previous sections. A comparison was made with the motoring pressure obtained from the CFD simulation, as illustrated in Fig.4. The results showed that all three models performed well in general. Therefore, users have the flexibility to choose any one of these models for their simulations.

Comparison of in-cylinder motoring pressure obtained using various heat transfer models.

The gas exchange process involves the study of the intake and exhaust processes of a four-stroke internal combustion (IC) engine. The main objective of the gas exchange process is to calculate the mass trapped in the engine cylinder from the exhaust valve opening (EVO) CAD to the intake valve closing (IVC) CAD and the pressure and temperature of the in-cylinder charge during this period.

During the gas exchange phase, the control volume of the engine cylinder involves mass, heat, and work interaction from its boundary. Therefore, to calculate in-cylinder pressure, temperature, and mass during the gas exchange phase, the first law of thermodynamics for an open system, the ideal gas equation, and the mass flow rate equation of compressible fluid are used.

During the exhaust stroke, in-cylinder gases are a mixture of different ideal gases formed as products of fuel combustion.

During the intake stroke, in-cylinder gases are a mixture of air, fuel and recycled burned exhaust gases that remain after the end of the exhaust stroke.

No spatial variation of in-cylinder thermodynamic properties.

The first law of thermodynamics for an open system in differential form as a function of crank angle () is given in Eq. (50).

Whereis the total internal energy,is the net heat transfer from the system boundary,is the work done by the gas,andare specific enthalpy and mass flow from the intake manifold,andare specific enthalpy and mass flow from the exhaust manifold.

Whereis the in-cylinder pressure,is the cylinder volume,is the specific heat ratio of in-cylinder gas mixture,is the characteristic gas constant of in-cylinder gas mixture,andare temperature of gas mixture flowing through intake and exhaust manifold, respectively.

Mass flow rates through the intake and exhaust manifolds, the third term on the right-hand side of Eq. (51) are calculated using isentropic compressible flow equations25.

Whereis the flow area, subscript u denotes upstream, R is the characteristic gas constant of the in-cylinder gas mixture, and F is the expansion factor that depends on flow condition (choked or non-chocked flow).

Kastner et al.26investigated the parameters of valve geometry (Fig.5) that affect the flow area through the valves. As the intake and exhaust valves open and close, the flow area and coefficient of discharge change. Kastner developed a correlation (mentioned below) for the coefficient of discharge as a function of ratio of the valve lift () and inner seat diameter of poppet (D) valve.

For the first stage, when the valve lift has low value, the flow area corresponds to a frustum of a cone. The flow area is calculated by the distance along the conical face of the valve and the seat.

Whereis the seat width,is the valve seat angle, andis the valve head diameter.

In the second stage the flow area is between the seat and the nearest edge of the valve.

Whereis the port diameter,is the stem diameter, andis the mean seat diameter ().

In the third stage the flow area is the area of the port minus the area of the valve stem.

In-cylinder pressure and mass obtained from the results of 0D model are validated with the results of CFD model and presented in Fig.7. In addition, the normalized in-cylinder properties were also calculated to establish a comparison with the data from available literature and presented in Fig.8.

Comparison of (a) cylinder pressure (b) mass of gases inside the cylinder.

Variation of various normalized properties with crank angle during gas exchange period obtained by (a) by 0D model (b) Heywood14.

No mass transfer happens from the engine cylinder region to the crevice region.

At any particular instant of time, pressure and temperature inside the cylinder region are homogeneous throughout the cylinder volume.

During the compression stroke, in-cylinder gases are a mixture of trapped exhaust gases and fresh charge entered during the intake stroke.

During the expansion stroke, in-cylinder gases are a mixture of different burned ideal gases.

Similar to the procedures followed while developing governing equations for gas exchange process, the Eq. (60) can also be written in terms of pressure and volume variables.

The in-cylinder mixture properties are calculated using thermodynamic property calculations as explained in Sect. 3.1.

The combustion process releases the chemical energy stored in the fuel, resulting in an elevation of both in-cylinder temperature and pressure. Subsequently, the combustion products (burned gases) undergo expansion, transferring their energy to the piston. The thermodynamics-based modeling of the combustion process can be categorized into two groups: single-zone models and multi-zone models, and they are explained below.

Yildız and Çeper27employed a single zone combustion model where the combustion chamber is treated as a single control volume, and the analysis is conducted using the first law of thermodynamics and the ideal gas law. The governing equations for in-cylinder temperature and pressure are given in Eqs. (63) and (64).

Where,, andrepresent the in-cylinder pressure, temperature, and volume, respectively, andis the specific heat ratio of the in-cylinder gas mixture. The limitation of the single-zone combustion model is that it provides only the mean in-cylinder temperature. When performing emission analysis using chemical kinetics (as explained in Sect. 3.6), this limitation can lead to significant errors because reaction rates strongly depend on temperature, and a large temperature gradient exists inside the cylinder during the combustion process. Hence, a multi-zone model becomes necessary for the precise calculation of emission formation.

The unburned zone contains a homogeneous fresh fuel-air mixture and some fraction of exhaust gases from the previous cycle.

The combustion products formed during the combustion process are assumed to remain only in the burned zone.

Pressure is uniform in both zones and varies only with time.

Temperature and other thermodynamic properties differ for both zones.

No heat transfer between burned and unburned zones.

Considering the above assumptions, governing equations were derived to compute burned zone temperature, unburned zone temperature, and in-cylinder pressure by applying the first law of thermodynamics and ideal gas equation separately for both zones.

The temperature of gases in the unburned zone is calculated as a function of the crank angle and presented in Eq. (65)28.

Whereis the unburned gas temperature,is the mass of gases in the unburned zone,is the specific heat at constant pressure of in-cylinder gas mixture in the unburned zone,is the volume of gases in the unburned zone,is the in-cylinder pressure, andis the heat transfer through the wall of the unburned zone.

The temperature of gases in the burned zone is calculated as a function of the crank angle and presented in Eq. (66)28.

Whereis the burned gas temperature,is the mass of gases in the unburned zone,is the characteristic gas constant of in-cylinder gas mixture in the unburned zone,is the specific heat at constant pressure of in-cylinder gas mixture in the burned zone,is the volume of gases in the burned zone,is in-cylinder pressure,is cylinder volume,is heat transfer through the wall of the burned zone,is mass burn rate,is the leakage of unburned gas from the cylinder to crankcase, andis the leakage of burned gas from cylinder to crankcase.

In-cylinder pressure is calculated as a function of the crank angle and presented in Eq. (67)28.

To solve Eqs. (65), (66), and (67), the values of,,,,,are required in prior and are calculated as explained in Sect. 3.1. The terms,are neglected because of their minimal influence. The model requires the termas input and can be provided by calculating mass fraction burned. The methods available for computing mass fraction burned are explained below.

In this approach, the variation of mass fraction burned w.r.t. crank angle is computed using the Eq. (68)29.

Whereis the instantaneous crank angle,is the value of crank angle where combustion starts,is the total combustion duration. The limitation of this function is there is no adjustable parameter to fit the mass fraction burned curve close to the experimental curve.

The limitations of the co-sine function can be overcome by the Wiebe function30presented in Eq. (69), which consists of two adjustable model parameters (,).

Whereis called efficiency parameter tuning its value controls the combustion duration,is the form factor. The values ofandshould be tuned to obtain the computed mass fraction burned curve close to the experimental curve.

To calculate the mass fraction burned curve from the models mentioned above, the parameter combustion duration () is required. Two approaches are discussed below to calculate the combustion duration: (a) Correlation based on engine speed and equivalence ratio, (b) By analysis of heat release rate.

(a) Calculation of combustion duration based on correlation - To calculate combustion duration, a correlation was developed by Campbell31based on experimental data reported by Taylor32, which takes engine speed and equivalence ratio as inputs and is presented in Eq. (70).

Where the constant value of the specific heat ratiois assumed.,are the in-cylinder pressure and volume.is the heat transfer through the cylinder wall calculated using Hohenberg’s heat transfer model.

Figure10presents the cumulative heat release curve for operating conditions mentioned in Table1,represents the maximum heat released by the fuel, whereis the mass of the fuel per cycle andis the lower heating value of the fuel.denotes the net heat released, and when heat transfer from the wall is added to the net heat released, it gives the total chemical energy released (). The point at which the chemical heat release rate deviates signifies the start of combustion. It is challenging to precisely determine the end of combustion from the heat release rate curve because, at the conclusion of combustion, the rate of heat released is nearly equivalent to the heat transfer from the cylinder wall. In SI engines, the crank angle corresponding to 90% or 95% of the total heat released from the fuel is typically considered as the end of combustion33. In this study, the crank angle corresponding to 90% heat release is adopted as the end of combustion.

From the analysis of heat release rate for the operating conditions mentioned in Table1, the start of combustion and total combustion duration are found to be −16 CAD and 60 CAD, respectively. Whereas the combustion duration is found to be 59.3 CAD when calculated using correlation model (presented in Eq. (70)). Figure11shows the performance of the cosine and single Wiebe function model (with= 4.448 and= 1.762) and its comparison with experiment mass fraction burn curve. The values ofandof the single Wiebe function are found by minimizing the mean squared error (MSE) between predicted and experimental mass fraction burned.

Comparison of mass fraction burned predicted by the cosine function and Wiebe function with experimental result.

Comparison of (a) in-cylinder, (b) mean cylinder temperature.

In internal combustion engines, during the combustion of fuel, some harmful pollutant species are also formed. These pollutants leave the engine cylinder during the exhaust stroke and enter into the atmosphere, causing harmful health and environmental effects. The major exhaust emissions are unburned hydrocarbons (HC), oxides of carbon (CO and CO2), oxides of nitrogen (NO and NO2), and particulate matter. The total amount of pollutant emission mainly depends on the type of fuel, equivalence ratio, in-cylinder temperature, and other engine operating parameters. For SI engines, unburned hydrocarbons, oxides of carbon and oxides of nitrogen (also called NOX) are the main components of pollutants. This section presents chemical kinetics-based thermodynamics-based modeling and validation of nitrogen oxide (NO), and carbon monoxide (CO) emissions.

It is assumed that O, O2, N2, OH and H are at equilibrium, and due to their low concentration, atomic nitrogen (N) is assumed to be in a steady state.

Whereandrepresent the reaction rate constants in cm³/mol-s for the ithreaction, corresponding to the forward and backward reactions, respectively.

Figure13presents the performance of the thermodynamics-based emission models used for nitrogen oxide and carbon monoxide emissions and its comparison with the CFD model for operating conditions mentioned in Table1.

Comparison between 0D model and CFD model for (a) NO and (b) CO emissions.

Friction within an internal combustion engine is a critical factor that significantly impacts its overall performance and efficiency. The power available at the crankshaft (break power) is significantly lower than the gross indicated power (developed during compression and expansion strokes), and the difference between break power and gross indicated power is called friction power.

Where N is the engine speed in revolutions per minute (RPM). Hence, in the context of friction modeling, Eq. (80) is utilized, taking engine speed as an input to calculate the friction mean effective pressure.

Comparison between experimentally obtained and correlation model predicted friction mean effective pressure.

Where gross indicated work is the work delivered to the piston over the compression and expansion strokes calculated byover the compression and expansion strokes.

Where break work is calculated bywhereis the break torque measured from the experiment andis the number of crankshaft revolutions during one power cycle (1 for two-stroke and 2 for four-stroke engines).

In the previous section, various sub-models to analyze individual in-cylinder processes within a spark ignition engine were discussed. These sub-models offer valuable insights into specific aspects of engine operations under consideration. However, a full-cycle simulation can provide a more accurate representation of the engine performance as it enables us to account for interactions and dependencies between different in-cylinder processes. Since full-cycle simulation is a combination of in-cylinder processes presented in Sect. 3, a flow chart is shown in Fig.15, which connects all the in-cylinder phenomena in order to complete an engine cycle simulation.

The performance of a full-cycle simulation by integrating various in-cylinder phenomena is presented in Fig.16. The engine specifications and operating conditions used for full-cycle simulation are provided in Table1. The performance of the phenomenological model is validated by comparing its performance with the CFD model. As mentioned earlier, the performance of the phenomenological model depends on the accuracy of the sub-model employed for individual in-cylinder phenomena. Therefore, while performing a full cycle simulation, a two-zone model is used for combustion modeling, a single Wiebe function is employed to calculate the burned mass fraction, Hohenberg correlation is utilized to calculate the in-cylinder heat transfer and in-cylinder mixture properties are evaluated based on mixture composition.

Comparison of (a) in-cylinder pressure (b) in-cylinder temperature obtained from full cycle simulation for methane fuel, compression ratio 10.1:1, and load 10 N-m.

Full-cycle simulations are also conducted to assess the model’s capability to accurately depict the impact of variations in operating conditions. In this context, a thermodynamic simulation is executed with the operating parameters identical to those specified in Table1, with the exception of using gasoline as the fuel, setting the compression ratio to 8.5:1, maintaining an equivalence ratio of 1, and at 12 N-m loading conditions. The in-cylinder pressure and NOx emission are predicted using the developed code and compared with the experimentally obtained data (Fig.17) reported by Gupta and Mittal35. Figure17shows that the 0D model is able to predict the results with good accuracy even under different operating conditions.

Comparison of (a) in-cylinder pressure (b) in-cylinder temperature obtained from full cycle simulation for gasoline fuel, compression ratio 8.5:1, and load 12 N-m.

In this paper, various in-cylinder phenomena – including gas exchange, compression, expansion, mixture properties calculation, heat transfer, fuel burn rate, combustion, exhaust emissions, and frictional losses – were modeled using zero-dimensional (0D) thermodynamics-based models. The gas exchange process was modeled by applying the mass conservation law and the first law of thermodynamics for an open system, whereas compression and expansion processes were modeled using the first law of thermodynamics for a closed system. Mixture properties were calculated using established correlations and equilibrium-based models, with validation results indicating that equilibrium-based models provided higher accuracy across a wide range of thermodynamic states. For in-cylinder heat transfer calculations, various empirical correlations were employed. The fraction of fuel burned rate was calculated using a cosine function and a single Wiebe function, with the Wiebe function demonstrating better agreement with experimental data when its parameters were appropriately tuned. Combustion was modeled using both single-zone and two-zone approaches. The burned and unburned zone temperatures obtained from the two-zone combustion model were then utilized in chemical kinetics-based emission modeling, and its performance was compared with results from computational fluid dynamics (CFD)-based models. Frictional losses were estimated using an established correlation dependent on engine speed. Finally, full engine cycle simulations were performed by integrating all sub-models under various operating conditions. The results from these simulations were validated against both CFD-based model results and experimental data, demonstrating the effectiveness of the proposed modeling approach.