Neural Network has been used in approximation of dead zone nonlinearity when modeling the manipulator control systems. However the existed method fail to minimize the possible input saturation effect and the NN mapping accuracy also be degraded, which leads to degrading in tracking precise and accuracy. To establish an accurate control model of the tea picking robot, an adaptive compensator of m-RBF (modified radial basis function neural network) and adaptive law were designed aimed at the nonlinearity units and dead zone. The closed-loop tracking error of the proposed control system is eventually going to be stable and bounded. A simulation was carried out with Simulink, which show that m-RBF provides a good approximation to characteristic of Dead zone nonlinearity, and that the control scheme based on m-RBF had a excellent and stable tracking accuracy. The tea picking experiment with six-axis manipulator verifies the effectiveness of the proposed algorithm, in which the proposed method got a higher score of 95.3, near two times that of traditional PID control methods. It can be drown that the m-RBF has a faster learning rate and can avoid local minima; the control scheme based on m-RBF has a excellent performance on control accuracy, robustness and self-adaption, which is especially appropriate for real-time control, like tea picking robot.

Tea, the Chinese national drink, is the carrier of Chinese culture and an important cash crop in China with an annual output value of more than 150 billion yuan; among them, the output value of famous tea accounts for more than 50%1. Because of the strict requirements on the appearance of famous tea, it still needs a lot of manual labor to pick it. Due to the shortage of agricultural labor force, the cost of picking high-quality tea has exceeded 60% of the production cost2. However, due to the strong seasonal nature of tea, it will cause huge economic losses (due to the decline in quality) when not picked: the development of tea industry is severely restricted. The realization of famous tea picking machine replacement is imminent.

Both domestic and foreign tea picking machinery adopt the integral picking principle of “reciprocating cutting”, which has no selectivity and the buds and leaves are seriously damaged, so it is not applicable for picking famous tea (high quality tea). Due to the unique Chinese characteristics of famous tea, only a small number of studies on tea picking technology have been carried out abroad. Based on feature extraction and object detection, Vu et al.3studied the automatic counting method of tea shoots based on machine vision and realized regional detection of tea leaves. Thangavel et al.4adopted key frame extraction method to identify tea leaves and realized leaf region detection. Karunasena et al.5used machine learning and image processing techniques to identify tea bud and leaf. Jain et al.6designed a picking robot based on double R manipulator, which was equipped with small scissors at the end to cut tea shoot. Combined with the Internet of Things technology, the scheduling control technology of the picking robot was studied. Motokura et al.7conducted a preliminary study on the pose and trajectory planning of the end-effector of tea picking robot. Due to less research, there is no mature and available intelligent tea picking technology abroad.

The research on the picking technology of famous tea mainly focuses on the picking robot technology based on computer vision. In terms of tea bud visual recognition, picture-processed-based methods have been well investigated, such as Yang et al.8, Jin et al.9, Wang et al.10and Qi et al.11. These methods have poor generalization ability for they are relied heavily on artificial target’s features that vary from different tea trees, ripeness and weather conditions. To kill the problem, deep learning began to be applied to tea bud identification, such as Lv et al.12adopted Alex-Net CNN (Convolutional Neural Network), Yang et al.13,14, Li et al.15and Gong et al.16adopted YOLO (you look only once), Chen et al.17adopted deep CNN to identify the tea bud target. Their In-field experiment showed a picking success rate of 65%. Due to the diverse tea varieties, interleaved and dense distribution and complex background, the problem of accurate identification and positioning of tea buds has not been effectively solved.

Refers to picking robot ontology, Chen18carried out the research and design of the parallel mechanism and end-effector of tea picking robot, and developed the prototype. Wei19and Sun20have also carried out researches on tender shoot identification, picking point determination, parallel mechanism, bionic picking finger, robot ontology, intelligent control, etc., and achieved a series of breakthrough results. However, both the picking efficiency and quality of the robot are still relatively low. In the transmission system of picking robot, the main factors affecting the control performance of the system are the existence of a wide range of nonlinearities in the process of power transmission, such as backlash, dead zone, friction and saturation, which become the main factors affecting the control accuracy21. In most cases, these nonlinear phenomena are unknown and time varying, and can have a great impact on the system. As one of the main nonlinear characteristics, dead zone nonlinear has always been one of the main research objects in the field of high precision transmission control. Dead zones have a great impact on the control system, the most common of which is to reduce the accuracy of the static output and make the dynamic output appear “flat top”22. Limit cycles or system instability may also result because the system does not respond within the dead zone. Consequently, it may cause the Tea-picking-manipulator’s shaking and inaccuracy of tracking target, leading to damage to tea leaves and the fail of picking. Therefore, the compensation of dead zone becomes an important subject of high precision control system.

The mathematical description of a dead zone is a static nonlinear function used to describe the insensitivity of a system to small signals23. When the signal enters the dead zone, there will be considerable loss of signal information, which will cause the limit cycle and tracking error of the system. From a feedback perspective, dead zones represent a “loss of information”. Like many other discontinuous nonlinear phenomena, the main cause of dead zone is friction. Due to the non-differentiable nonlinearity of the dead zone, it is very difficult to compensate the dead zone, which greatly increases the complexity of the drive system control24. It is of great theoretical significance and engineering value to study the dead zone nonlinearity in mechanical and electromechanical transmission systems. However, the control problem of robot with unmeasurable constrained states and other unknown nonlinearities is not properly addressed.

In early years, various control methods have been designed to handle deadzone, which enhanced the performance of control systems, such as backstepping control, model predictive control, variable structure control, etc.25. However, These methods work on the condition that some parameters of deadzone functions are known. In practice, these parameters are always hard to measure, especially when considering the effect of time. Deadzone function is inherently nonlinear. Wang et al.26focus on the adaptive control of nonlinear dynamic systems with an unknown deadzone. The fuzzy logic control methods have been employed generally to approximate the nonlinear systems. Tong et al.27investigated the problem of the adaptive fuzzy decentralized output-feedback control for a category of switched nonlinear strict-feedback large-scale systems. Pei et al.28proposed a robust deadzone compensation method against parameter variations based on kalman filter and neural networks. Because the neural network can approximate any nonlinear continuous function with any precision, it has the ability of self-adaptation and self-learning for complex uncertain problems. Lewis et al.29studied the neural network control of the dead zone link in the robot actuator, and adopted network to carry out adaptive compensation for the dead zone in the control system, which is a classic research achievement in neural network control. Zhou et al.30designed a NN(neural network) controller for the robotic manipulators subject to the dead zone. The NN approximation approach is employed to approximate the intermediate control signals with unknown nonlinear functions, reduced the number of estimated parameters. Lu et al.31used RBF to generate several networks to replace the BP network in the original compensator, and designed the RBF(Radial Basis Function) network adaptive robust control with dead zone compensation, which could not only greatly reduce the system parameters, but also make the network initialization more clear and definite. Bensidhoum et al.32used RBF neural network to approximate the unknown nonlinear functions in contrl system of robot manipulators with unknown input dead-zone. The clustering algorithm is used to determine the center of radial basis function in RBF neural network, but how to determine the appropriate number of clusters has not been well solved, which degrads the RBF mapping accuracy. Also, only the proportional action is used in the control scheme to avoid the measurement noise, which fails to minimize the possible input saturation effect (the input exceeds its limit), leading to degrading in tracking precise and accuracy.

Proposed a modified Radial Basis Function (m-RBF) neural network to compensate the dead zone in tea picking robot control system, in which a new clustering algorithm and clustering automatic termination criterion are introduced to improve RBF and the mapping accuracy.

Construct the control system with m-RBF compensator, and design the adaptive law of neural network compensator. Also, Introduce the mathematical concepts of GL (General Linear) matrix and GL multiplication operator to prove the uniformly bounded stability ofnjoint robot system strictly.

The control system with m-RBF compensator is simulated with Matlab, showing the superiority of the control scheme based on m-RBF compensation. And the tea picking experiment verifies the effectiveness of the control system, the tracking becoming rapid and smooth with less breakdown of chattering and being stuck.

The rest of this article is organized as follows. In Section "Tea picking manipulator model", tea picking manipulator model is presented. The adaptive control based on m-RBF neural network and its convergence analysis are given in Section "Model". To show the effectiveness of the proposed control scheme, an simulation example and the picking experiment are conducted in Section "Simulation and experiment". Finally, conclusions and Discussion are drawn in Section "Conclusion and discussion".

where Type offor joint angular displacement quantity,as the inertia matrix,as centrifugal force and Coriolis force,as gravity,for control of torque.

The mathematical expression of the dead zone is a static nonlinear function that describes the insensitivity of the system to small signals, as shown in Fig.1. In most closed-loop systems, the dead zone has a bad effect on both transient and steady-state performance. The signal entering the dead zone is accompanied by information loss, which easily leads to the limit cycle and large tracking error.

whereuis the input signal,handgare two smooth nonlinear functions, andτis the output of the dead zone.

In order to compensate the negative effects of the unknown dead zone, the neural network compensator is put in front of the control input to compensate the nonlinear link of the dead zone.

The structure of robot moment arm control system is shown in Fig.2. The control objective is to expect the outputwof the controller to be the same as the outputτof the actuator. Therefore, RBF neural network can be used to compensate. In Fig.2,wis the ideal control input,uis the actual control input of the robot after dead zone compensation, andτis the control signal after dead zone compensation.

Control system based on neural network compensation.

This section will setup the neural network model to establish the compensator model for the dead zone. Also, the control system stability will be analyzed.

In the mixed calculation of matrix and GL matrix with respect to GL multiplication operator, the GL multiplication is computed first. For example: {A}·{B}C, first calculate {A}·{B}, and then multiply the result withC. For further information about GL matrix and operator, please refer to the work of Ge33.

The neural network can approximate any nonlinear continuous function with any precision and has adaptive and self-learning ability for complex uncertain problems. A Radial Basis Function (RBF) neural network is a three-layer feed-forward network with a single hidden layer. The function of RBF network is a Gaussian basis function, and its value is non-zero in the finite range of input space, so RBF network is a local approximation neural network. The mapping from the input layer to the output layer is nonlinear, while the mapping from the hidden layer space to the output layer space is linear. Due to its local approximation property, it can greatly accelerate the learning speed and avoid the local minimum problem, which is suitable for the application requirements of real-time control. The neural network control scheme composed of RBF network can effectively improve the control precision, robustness and adaptability of the system.

FCM (Fuzzy C-Means) clustering algorithm is often used to determine the center of radial basis function in RBF neural network, but how to determine the appropriate number of clusters has not been well solved. In order to obtain reasonable central parameters of radial basis function, a new clustering algorithm and clustering automatic termination criterion are introduced here to improve RBF and improve the mapping accuracy.

Here, the RBF neural network is improved by two stages: (1) the central parameter of radial basis function is learned by using the Reduced Clustering algorithm34, and the number of RBF basis functions is determined by applying the self-terminating clustering criterion; (2) The output weight is adjusted by gradient descent method. The self-terminating clustering criterion in the first stage is that: If the ratio between the current maximum density value and the initial maximum density value is less than some very small given value, the clustering is terminated. That is, when the current cluster center contains very few data points, you can ignore the cluster center and end the cluster.

Step1: the density index of each data is calculated according to formula (9) and saved in the setA. The data point with the highest density index is selected as the first clustering center.

wheredefine the neighborhood radius of each data.denote theith andjth date of the N-dimensional data space.

Step2: Themth cluster center is determined, the density index of each data is modified by formula (10), and the highest density index is searched.

wheredefine a neighborhood with a significantly smaller density index. Generally,>, which avoid cluster centers that are very close together.

Step3: Substitute the highest density indexinto the criterion. If the criteria are met, the criteria are terminated and go to Step 4. If the criterion is not met, the pointis accepted as them-th cluster center, and it is kept in the setA; updated:,m=m+ 1; then go to the second step.

Apparently, a total ofm-1 clustering centers were identified. After the clustering center is determined, the width parameter can be determined by taking the nearest neighbor average distance to the neighboring points of each cluster center. By these steps we have the m-RBF.

The adaptive neural network compensator consists of two m-RBF neural networks, one m-RBF is used to estimate the nonlinear link in the actuator, and the other m-RBF is used to compensate the dead zone of the feedforward channel of the system. The basic structure of the neural network compensator is shown in Fig.3.

Whereandis the modeling error of neural network,andis the ideal weight,andis the output of the radial basis function.

It can be seen from Fig.2that the purpose of the design of the control system is to make the outputτof the controller and the robot inputwafter the dead zone tend to be as consistent as possible. The mathematical relationship between the two and the corresponding proof are given below.

where,,is a positive definite constant symmetric matrix,.andis thekthgroup weight vector in thengroup weight vector of the compensator (1 ≤k≤n).

whererefers to the estimation off, and the error is,,vis a robust term used to overcome modeling uncertainties.

Given the robotic system (1), it is acceptable to ignore the friction terms and disturbance terms36. Assuming that the neural network has a bounded ideal weight,, select the controller Eq. (34) and the neural network compensator Eq. (17). Taking the adaptive law of neural network as Eq. (30), the closed-loop tracking control error of the control system is globly uniformly ultimately bounded stable, and the tracking error decreases with the increase of the gain Kv.

It is reasonable to assume that the initial states of the robot are all at the zero position, and the parts outside the dead zone are linear functions37. The dead zone parameter is. The expected trajectory is:. The parameters of the neural network controller are set to,, The central value c of the m-RBF neural network is the value uniformly distributed within the input value range of the RBF network.b= 1, The initial value of each element in the weight of m-RBF neural network is 20. The simulink simulation model of the system is shown in Fig.4. The simulation is conducted on an experimental computer, the parameters of which is as follow: CPU Intel(R) Core(TM) i7-4790, @3.60 GHz, number of cores: 8, memory: 4 GB.

Simulation results are shown in Figs.5,6and7. It is illustrated in Fig.5that the tracking performance of the control model is rather exact. The red line is the expected trajectory, while the blue ones denote the tracking trajectory. Both in the position tracking of link 1 and link 2, our control model could track the target within 1 second and copy the expected trajectory with nearly no bias once the expected trajectory is tracked.

Position tracking. L1 denotes Link 1, L2 denotes Link2.

The control input of the control system is shown in Fig.6. The ideal control input without consideration of the dead zone is shown in Fig.6a, in which situation it is assumed that the links are deal ones that has no dead zone. Therefore its control input is with rather less fluctuation, especially for link 2.

However, the impact of the dead zone shouldn’t be neglected, because it has a sever side effect on the tracking performance of the manipulator, such as impairing tracking speed and accuracy. In this work, the dead zone is well modeled with m-RBF, the compensation for the dead zone is integrated into the control input. As shown in Fig.6b, both control input for joint 1 and joint 2 become more fluctuated due to the introduction of the dead zone model. Even so, the variation range is still be confined between ±50 for joint 1 and ±30 for joint 2. Compared with ideal control input variation range ([− 20, 40] for link 1, [− 10,5] for link 2), The variation range increments is still tolerable and physically achievable.

As shown in Fig.1, we know that the characters of dead zone nonlinearity can be estimated by equation (2). When the manipulator is running at a high speed, the nonlinearity of dead zone could be shown with a trapezoidal wave shown in Fig.7with red line. From the figure, it can be seen that our m-RBF model coule model the characotoristics of the nonlinearity of dead zone perfectly. Because the m-RBF is training in an online manner, the Net needs 1~2 seconds to converse to stable state when running for the first time. Although, there is small overshoot for link 1 when it steps in each dead zone, but the model could convers quickly to the target. As a whole, the proposed model could estimate the dead zone well.

In order to simulate the actual picking process as much as possible, we set two more jumping target trajectories: a sine wave of higher frequency (see in Fig.8), and a compound curve of sine wave and square wave as Eq. (41), see in Fig.9.

wheresquare(·) is a MATLab built-in function that produces a square wave.

Tracking a compound curve of sine wave and square wave.

As shown in Fig.8, the target trajectory of higher frequency sine wave simulates the situation of high-speed continuous turning motion. And our mehtod could tracking this kind of motion precisely within about 1s, except for a slight error at the turning point. As shown in Fig.9, the target trajectory composed of a sine wave and a square wave simulates the situations of sudden start, emergency stop and reverse return. As is well known, it is relatively difficult to track step signals. The simulation result indicates that the proposed method could handle the tracking of these motions well. This “jumping” motion could also be tracked within 1s. The simulation of severe situation indicates that the proposed control method is suitable for the robot application of tea picking.

In order to verify the effectiveness of the proposed algorithm, an experiment on tea picking is conducted using the robot test platform. The platform mainly consists of Vision system, Manipulator, Picking mechanism, Computer control center, see in Fig.10. Some tea tree branches are picked and kept in a bucket with some water in it, which analogies the tea tree canopy. The vision system detects the tender tea shoots and provides their three-dimensional coordinate information to robot control system as the target location. The optimal running path is planned and calculated according to the target points by control system. Then the manipulator will be controlled to pick tea shoot along the running path.

In our previous experiments, generally, the arm would be chattering or get stuck when it encountered a dead zone. When the proposed algorithm is applied to the robot test platform, the running of the arm becomes smoother. To illustrate our algorithm’s effectiveness, two sets of comparative experiments are conducted: one group used the traditional control method, and the other group added the death compensation control method proposed in this paper. Each group includes 100 times picking test, tracking one picking point in each test. The breakdown get chattering or stuck) are recorded and a score is given for each control mode, as shown in Table1.

Ch and St denote the breakdown of chattering and being stuck respectively; P is penalty, S is general score of different control mode.

The initial score for each control mode is 100, and a penalty is given for each failure. The penalty is determined by the kind of the breakdown, − 0.3 for chattering and − 0.7 for being stuck. In one test, multiple chattering may occur, but only once is recorded to avoid a negative general score.

From Table1, we know that it is very prone to be breakdown under the traditional control mode, while our control method based on dead zone estimation using RBF could improve this defect significantly, with a high score of 95.3. That is to say, the proposed method for the estimation of manipulator’s dead zone and the compensation of its control is effective.

As one of the main nonlinear characteristics, dead zone nonlinearity has an important effect on the performance of power transmission system. In this study, m-RBF neural network adaptive compensator and adaptive control law were designed for the nonlinear link and dead zone characteristics of feed-forward channel of tea picking robot system. Through the stability analysis of the system, it can be seen that by selecting the controller, neural network compensator and neural network adaptive law designed in this paper, the closed-loop tracking error of the control system is always stable and bounded eventually, and the tracking error decreases with the increase of the gain. Compared with other works, Zhou30, He25, and Bensidhoum32, our method has globally uniformly ultimately bounded stability, which outperforms their semi-globally uniformly ultimately bounded, semi-globally uniformly bounded and asymptotically stable respectively.

To visually demonstrate the performance of the control system, taking the two joints manipulator as an example, the system simulation model is established in MATLAB/Simulink. The simulation results show that the m-RBF neural network has a good approximation performance for the nonlinear system, and can approximate the dead zone nonlinear characteristics well. The control system based on the neural network model can realize the stable tracking control of a manipulator better, and has a strong ability to restrain the load disturbance.

Finally, the proposed algorithm was applied to a six-axis manipulator to carry out tea picking experiments. Compared with the traditional PID control methods (Proportional, Integral, Differential control), the proposed method got a higher score of 95.3 in the comprehensive evaluation, and could effectively deal with the problems caused by the dead zone of the manipulator, making the operation of the manipulator more smooth and efficient.

Because of the local approximation property of m-RBF neural network, the learning speed is fast and the local minimum problem can be avoided, which is especially suitable for the application requirements of real-time control. Therefore, the neural network control scheme of the tea picking manipulator composed of m-RBF network has good control precision, robustness and adaptability. As shown in section "Simulation result", it still takes about 1 s to adjust before tracking stably, which is not good for real-time tracking applications. Therefore, it is necessary to further study the dead zone compensation algorithm and network structure in the future to improve the compensation and tracking performance.

This work was supported mainly by the Key Laboratory of Modern Agricultural Equipment, Ministry of Agriculture and Rural Affairs, P.R., China; the open subject from Key Laboratory of Agricultural Equipment Technology for Hilly and Mountainious Areas under Grant 20224LOP04; the Modern Agricultural Technology System of Tea Industry (Grant No. CARS-19, China), The Innovating Program of the Chinese Academy of Agricultural Science, China; The Key Laboratory for Crop Production and Smart Agriculture of Yunnan Province (2023ZHNY06).