We investigate an epidemiological model that incorporates waning of immunity at the individual level and boosting of the immune system upon re-exposure to the pathogen. When immunity is fully restored upon boosting, the system can be expressed as an SIRS-type model with discrete and distributed delays. We conduct a numerical bifurcation analysis varying the boosting force and the maximum period of immunity (in the absence of boosting), while keeping other parameters fixed at values representative of a highly infectious disease like pertussis. The stability switches of the endemic equilibrium, identified numerically, are validated using an established analytical approach, confirming that the equilibrium is unstable in a bounded parameter region, and stable outside this region. Using recently developed continuation methods for models with discrete and distributed delays, we explore periodic solutions and their bifurcations. Our analysis significantly extends previous findings and reveals a rich dynamical landscape, including catastrophic bifurcations of limit cycles, torus bifurcations, and bistability regions where two stable periodic solutions coexist, differing in amplitude and period. These complex bifurcations have critical public health implications: perturbations—such as non-pharmaceutical interventions—can shift the system between attractors, leading to long-term consequences from short-term measures.

Boosting of the immune system through re-exposure to an infectious pathogen plays a key role in the dynamics of diseases without lifelong immunity, affecting the success of vaccination programmes with imperfect or waning vaccine protection (Schuette and Hethcote1999; Heffernan and Keeling2009; Lavine et al.2011; Dafilis et al.2012).

Waning and boosting of immunity are particularly challenging to describe mathematically as they introduce delayed feedback loops. To keep the models tractable, the waning of immunity is often modeled using a chain of compartments with full or partial immunity. However, various analyses have shown that such models predict periodic outbreaks only if the chain is long enough, while an overly simplified model could disregard interesting dynamical outcomes and predict damped oscillations to an endemic equilibrium (Hethcote et al.1981; Gonçalves et al.2011; Röst and Tekeli2020). For this reason, structured models that capture the within-host dynamics by explicitly keeping track of the time passed since infection or recovery are more appropriate than simple ordinary differential equations, allowing more flexibility in the definition of delay distributions and potentially reproducing more complex dynamics (Diekmann and Montijn1982; Aron1983; Barbarossa and Röst2015; Diekmann et al.2018; Okuwa et al.2021; Yang and Nakata2021).

To describe in a general way the process of waning and boosting of immunity, Barbarossa and Röst (2015) proposed a model where recovered individuals are structured by a simplified one-dimensional variablethat describes the immunity level (thereby avoiding to model the complex details of the immune system response). After natural infection, a host enters the immune compartment with maximum immunity, then their immunity decays in time with some given rate. Immunity can be boosted upon further exposure to the pathogen. When the immune level reaches the lowest threshold, the individual becomes susceptible again.

In a later analysis, Barbarossa et al. (2017) focused on the special case where immunity decays at a constant rate and boosting always restores the maximal level of immunity. For this reason, it is also referred to as the ‘MAXboost’ model (Barbarossa et al.2018). Under the assumption that the population size is constant, this model reduces to a system of two equations, for the susceptible and infected populations respectively, where the inflow into the susceptible compartment due to loss of immunity is mathematically captured by a distributed delay term. In this model, the maximal delayrepresents the maximal duration of immunity when boosting does not occur. The authors showed the existence of an endemic equilibrium that undergoes multiple stability switches depending on the model parameters, with sequences of Hopf bifurcations suggesting the emergence of branches of periodic solutions.

The linearised stability analysis of the endemic equilibrium for the MAXboost model was carried out numerically by Barbarossa et al. (2017). Here, we refine the analysis of stability switches of the endemic equilibrium when the maximum duration of immunity is varied, and fully characterise the stability changes that occur in the MAXboost model. The main difficulty lies in studying characteristic equations where the delay occurs in multiple ways. Delay systems in which the coefficients in the characteristic equation depend on the time delayonly through an exponential termare easier to study, and the theory in such cases is well developed (see, for example, Kuang (1993)). One can usually explicitly compute the delay values for which stability switches occur. A systematic approach to studying characteristic equations with delay-dependent parameters has been developed by Beretta and Kuang (2002) for one constant delay, and extended to multiple delay systems by An et al. (2019). Using this method, we provide geometric and analytical criteria for stability switches with respect to the delay. In addition, this approach provides a rigorous method for finding Hopf bifurcations.

The bifurcation analysis beyond Hopf points for models with discrete and distributed delays has traditionally been limited, due to the complexity of the analytical calculations and the lack of easily accessible software tools. As an example, Taylor and Carr (2009) obtained analytical and numerical results on the delayed SIRS model without boosting of immunity by rigorously studying the small periodic oscillations emerging from a supercritical Hopf bifurcation, and the stable pulse oscillations that coexist with the stable endemic equilibrium near subcritical Hopf bifurcations. This is one of the first examples of bistability in infectious disease models with waning immunity.

In the presence of boosting of immunity, bistability has also been observed by Dafilis et al. (2012) in a SIRWS compartmental model with one intermediate waning immunity compartment. By performing a numerical bifurcation analysis, the authors showed the presence of subcritical Hopf bifurcations when varying the boosting force and the per capita mortality rate, with the emergence of regions of bistability of the endemic equilibrium with a stable limit cycle. Kojakhmetov et al. (2021) then rigorously showed existence of oscillations in the fast-slow SIRWS model proposed by Dafilis et al. (2012) using geometric singular perturbation theory. Strube et al. (2021) further extended the analyses of bistability in the SIRWS model, showing that the region of bistability is relatively small for biologically realistic parameters. Opoku-Sarkodie et al. (2022) generalised the SIRWS model by allowing different expected durations for individuals being in the fully immune compartment and being in the waning immunity compartment, from where their immunity can still be restored upon re-exposure. The modified model exhibits rich dynamics and displays additional complexity with respect to the symmetric partitioning.

In this paper, we further expand the analysis of the MAXboost model by using a recently developed delay equation importer for MatCont 7p6 for MATLAB (Liessi et al.2025), that allows to perform the numerical bifurcation analysis of equations with discrete and distributed delays. Our analysis captures a richer dynamical behaviour than previous ones, including those from Hethcote et al. (1981), Taylor and Carr (2009) and Dafilis et al. (2012), even in the absence of boosting. In particular, we find a series of catastrophic bifurcations that originate from the switch between supercritical and subcritical Hopf bifurcations when varying the boosting force and the maximal duration of immunity, which can result in drastic changes in the epidemiological situation due to small perturbations of parameters. We find interesting bifurcations on the branches of periodic solutions, including Neimark–Sacker bifurcations and the emergence of stable tori, highlighting how waning and boosting of immunity lead to a very complex dynamical landscape. Most importantly, we identify regions of parameters that exhibit bistability, both of one equilibrum and a periodic solutions and of two distinct periodic solutions for the same parameter values. The existence of coexisting stable periodic solutions differing in amplitude and period has important consequences in public health, as perturbations due for instance to the implementation of public health interventions could push the system to a different attractor.

The paper is structured as follows. In Sect.2, we briefly summarise the MAXboost model under consideration and formally study the stability switches of the endemic equilibrium depending on the maximal duration of immunity when not boosted. In Sect.3, we perform a numerical bifurcation analysis with respect to the length of the immune period and the boosting force. We also focus on the special case of waning immunity but no boosting, showing in this case, too, the existence of multiple stability switches and branches of stable periodic solutions with different amplitudes and periods. Finally, we briefly comment on the impact of the expected lifetime on stability. In the last section, we discuss the results and the implications of our findings in the context of public health interventions.

We refer to Barbarossa and Röst (2015) for an equivalent formulation of the model using partial differential equations.

Note that, if, immune boosting following secondary exposure occurs at a lower rate than primary infection. Conversely, if, boosting can occur through exposures that would not induce infection in a susceptible host (Lavine et al.2011). When, the model reduces to a SIRS model with no boosting of immunity. When, the model reduces to a SIR model with no waning of immunity.

The endemic equilibrium can be stable or unstable depending on parameters. Barbarossa et al. (2017) performed a numerical analysis of the stability boundaries of the endemic equilibrium varying the parametersand, with all other parameters fixed so that, using TRACE-DDE, a MATLAB computational tool (Breda et al.2009). The analysis shows that the equilibrium destabilises through Hopf bifurcations. However, no information is given about the dynamical behaviour when the endemic equilibrium is unstable.

In this section, based on the method developed by Beretta and Kuang (2002), we study the occurrence of possible stability switches of the endemic equilibrium as a result of increasing the delay.

andas in (3). Note here the dependence of the polynomialsPandQon the delay, which appears in their coefficients not only explicitly in the term, but also implicitly through the equilibrium component. A systematic approach to study characteristic equations with delay-dependent parameters was developed by Beretta and Kuang (2002). We give here a brief summary of their technique as it applies to our problem.

Since the coefficients depend on the delay, we have that. We find thatsolvesif and only ifis a root ofF, which in turn can have zero, one, or two positiveroots.

Then, the pair of eigenvalues crosses the imaginary axis from left to right if, and from right to left if.

Let us return to our model. We can give explicit conditions on the coefficients of the polynomialin (5), as functions of, such thatFadmits one or two positiveroots. In the next proposition, we characterise the set of time delays for which positive rootsexist.

For the dynamical system (2), the delay interval for whichhas positiveroots is finite.

where. Hence for,is not defined. It is clear that if, thenFhas only oneroot, whereas if, then bothandexist. Note that, due to the continuity of the roots with respect to,andare (connected) intervals. For the remainder of this paper, let(or) and(or). We need to show that.

Since, there existssuch thatfor all, i.e., ifis large enough, we arrive and stay in the right half of the-plane in Fig.1. Since the rootsare continuous, this implies that either there are no positive roots for(in domain I.), then, or there are two distinct ones (in domain III.). In the second case, due to continuity,forfor someor.

If, i.e.,changes sign at, then again by continuity, this is only possible if we first cross thecurve at somevalue, i.e., there exists a, such that. At this value of the delay, the two roots collide, yielding that.

If, i.e.,for all, then in (8),. Since, it follows that, which implies due to the continuity ofthat there existssuch that. Therefore,, which completes the proof.

it is straightforward to see thatfor allandfor all. Then we can determine the direction of which eigenvalues cross the imaginary axis, i.e., the sign ofin (7), only by analysing the derivative ofandat, respectively.

In the next lemma we describe, using Fig.1, how stability switches can occur, which will also determine the direction in which eigenvalues cross the imaginary axis.

The endemic equilibrium may undergo stability changes, and eventually it becomes stable for any value of the boosting.

We prove this lemma in more steps, depending on the number of feasible rootsof.

Case 1.Assume that, i.e., only one rootis feasible for(or). We need to show that for alllarger than the last zero offor some, all eigenvalues have passed and remain on the left half of the imaginary axis.

This, together with the monotonicity property ofin (10), implies thatcan only have an even number of sign changes for eachn, so there is an even number of possible stability switches on. Moreover, since the equilibrium is stable at, the first switch is towards unstable. From Remark1, we have thatwhenever, so by the monotonicity property of, it is straightforward to see that the last switch is at, the zero of, and that, which completes this part of the proof.

Case 2.Supposeand. Then the switches in the intervalare determined by the zeros of. This means that as we increasein this interval, onlychanges sign, which does not affect the existence of. Atwe have,andchanges sign as we continue to increase. Thus we enter region III in Fig.1, where bothandexist up to. Two things can happen here, either the two roots collide and then disappear, or onlyremains feasible as we further increase. In the first case,andfor, and in the second caseand.

If this limit is positive andandhave sign changes, then the last zero atis at the zero of. In this case, bothandhave an odd number of sign changes, so there are an even number of eigenvalue crossings in total. If the limit in (11) is negative, thenhas an even number of sign changes andcan have none or an even number for all. Thus, the total number of zeros will also be even.

It remains to discuss the case where, that is, only the rootis feasible for. On the interval, we can apply the arguments of case 1 to count the number of sign changes of.

To summarise, in case 2 the number of eigenvalue crossings is even. Then Remark1and the monotonicity properties in (10) prove the statement of the lemma.

and in the limit(11) holds, so it is easy to check that the total number of eigenvalue crossings is also even in this case, and use the same arguments as before to complete the proof of this lemma.

In the next section, we will use this technique to compute the stability switches for a given set of parameters inspired by pertussis, and different values of.

To investigate the dynamical behaviour of the system beyond the equilibria, in this section we perform a numerical bifurcation analysis for the parameter set considered by Lavine et al. (2011) and Barbarossa et al. (2017), which is plausible with a highly infectious disease like pertussis. We take,(), corresponding to an average infectious period of 21 days, and per capita death rate(), corresponding to an average lifetime of 50 years. The parameteris then fixed through (2) (). We perform stability and bifurcation analyses varying the parametersand, which represent the maximal duration of immunity in the absence of boosting and the boosting force, respectively. Since, the endemic equilibrium exists for alland, with the susceptible population equal toat equilibrium.

The numerical continuation is performed with MatCont 7p6 running on MATLAB (Liessi et al.2025). For the approximation of the history in the delay interval we chose a collocation degree ofor, depending on the required accuracy and the other parameter values. The distributed delay is approximated with a quadrature rule on the same collocation nodes. We refer to Breda et al. (2016) for further details on the numerical approximation.

Figure2shows the computed stability regions of the endemic equilibrium in the parameter plane, which is consistent with the results presented by Barbarossa et al. (2017, Fig. 1). The endemic equilibrium is stable outside the outermost boundary curve, and unstable inside (shaded region). Note that, as theoretically expected, the equilibrium is always stable on the axis(corresponding to an SIS-type model with individuals immediately susceptible upon recovery).

The boundary separating the stable and unstable regions is the union of different segments of Hopf bifurcation curves corresponding to different pairs of complex eigenvalues crossing transversally the imaginary axis. The parameter values at which two different pairs of complex eigenvalues cross the imaginary axis correspond to Hopf-Hopf bifurcations (HH), and lie at the intersection of distinct Hopf curves. Moreover, generalized Hopf points (GH) are detected along each curve, corresponding to changes in the criticality of the Hopf bifurcation. We refer to Kuznetsov (1998, Chapter 8) for further details on these bifurcations.

GH points are often associated with the emergence of limit points of cycles (LPC) (Kuznetsov1998, Sect. 8.3.3) and hence with bistability of equilibria and periodic solutions. Similarly, HH points are associated with the emergence of Neimark–Sacker bifurcations (NS) and invariant tori (Kuznetsov1998, Sect. 8.6.3). Figure2therefore suggests the emergence of rich and complex dynamics. We further explore such complex dynamics by studying the one-parameter continuation of the periodic orbits emerging from Hopf and their bifurcations, fixing, 3.2, 2, 1, and varying the duration of immunity(along the dashed lines indicated in Fig.2).

Figure3shows the one-parameter bifurcation diagram with respect tofor(left), and the corresponding estimated period along the branch of limit cycles (right). Four Hopf bifurcations are detected along the equilibrium curve, at approximately, 2.86, 3.15, and 4.59. The equilibrium is unstable between the first two points and between the last two points. A bubble of stable limit cycles exists forbetween 3.15 and 4.59 (both supercritical bifurcations), with a period between 2.2 and 2.8 years. When computing the limit cycle branch emerging from, the amplitude of the branch diverges quickly, and the numerical continuation stops. This branch is therefore not shown in the figure.

Figure4(left) shows how the rootsandofin (5) vary as a function ofin their maximal interval of existence, which for this set of parameters areand, respectively. Let us analyse this with reference to Fig.1. When, we are in the second quadrant of the-plane, sois the only root. As we increase, onlychanges sign, which does not affect the existence of. At,,andchanges sign as we continue to increase. Thus we enter region III, so bothandexist up to, where they collide and then disappear. This is an example of case 2 in the proof of Lemma2.

This limit is positive for, for whichandhave a sign change, so bothandhave an odd number of zeros, and therefore together they have an even number. The last zero is at, the zero of.

As we can observe in Fig.5, the numerical computation of the rightmost eigenvalue crossings asvaries (bottom left panel), aligns perfectly with the computation of possible stability switches, which are the zeros of,(top left panel). The zeros were calculated using (9) on the corresponding intervalsand. This also confirms Lemma2, which implies that the endemic equilibrium will be stable for all.

To illustrate the emergence of bistability through the GH point, Fig.6shows the one-parameter continuation for. In this case, we still observe a bubble of limit cycles forbetween the Hopf points 2.11 and 5.37 (first supercritical, second subcritical). An LPC and an NS bifurcations are detected on the branch of limit cycles, and the limit cycles are stable between those bifurcations. Bistability occurs for values ofbetween the Hopf and LPC bifurcations (i.e., forbetween 5.37 and 6.16), where a stable limit cycle coexists with the stable endemic equilibrium, so the asymptotic behaviour of the system depends on the initial condition.

Note that, once again, the Hopf bifurcations correspond to those found analytically: in Fig.4(right) the rootsandare plotted as functions ofon their maximal interval of existence, i.e.,,. The stability switches and rightmost eigenvalue crossings can be observed in the right panel of Fig.5.

Figure7shows the emergence of a stable invariant torus through the NS bifurcation: the long-term orbits in the plane (S,I) are plotted for values oftaken on opposite sides of the NS (and). The left panel shows the coexisting stable equilibrium and limit cycle, while the right panel shows the orbit of a stable invariant torus.

An even more complex dynamical picture is shown in Fig.8for, with two different closed limit cycle curves connecting different pairs of Hopf bifurcations, one with larger amplitude and larger period than the other. Each branch is stable in an interval of values between an LPC and an NS bifurcation. Two regions of bistability appear: one with a stable equilibrium coexisting with a stable limit cycle, and one with two different stable limit cycles. These regions are shaded in Fig.8. Figure9shows the orbits of the limit cycles in the small- and large-amplitude branches, as well as their time profiles. The figure highlights the differences in both amplitude and period. Following the LPC and NS curves for each bubble of limit cycles in the planeone can get some insights about regions of parameters where two stable periodic solutions coexist, or one stable periodic solution coexists with the stable endemic equilibrium. These curves are sketched in the right panel in Fig.2.

Figure10shows theandcurves expected from the analysis with, as well as the stability switch curves that predict the Hopf bifurcation points.

Asbecomes smaller, the bifurcation diagrams become more and more complicated, with several nested limit cycle bubbles emerging from longer sequences of Hopf bifurcations. Figure11shows the stability switch curves for, and the corresponding bifurcation diagram. In the left panel, we can see five different curves crossing the horizontal axis, giving rise to ten Hopf bifurcations. The last bifurcation, which corresponds to a stability switch from unstable to stable, is at approximately. The four rightmost bubbles of limit cycles are shown in the right panel. As before, the branch of limit cycles emerging from the smallest Hopf point is not shown, as it quickly diverges and the computation stops.

Similar models with a fixed immunity period and no boosting of immunity have been considered for instance by Hethcote et al. (1981), Taylor and Carr (2009), and more recently applied to COVID-19 transmission by Pell et al. (2023).

This corresponds to case 3 in the proof of Lemma2. With our set of parameters,. Since this interval is very large, we have covered only the region close toand, whereare feasible and collide at both ends, see Fig.12(top panels). There are 72 possible stability switches, so in Fig.12(bottom panels) we show only the first and last fewcurves. The last switch is at the zero ofat, Fig.12(bottom right).

Since the model has only one discrete delay, we performed the bifurcation analysis with the package DDE-BIFTOOL for MATLAB (Engelborghs et al.2002). Figure13(left) shows the rightmost Hopf bifurcations and the two rightmost limit cycle bubbles. In this case we did not detect bistability, but two stable limit cycles with different amplitudes exist for parameter values that are in a relatively small interval aroundyears. The right panel in Fig.13shows the stable orbits in the (S,I) plane, for(large amplitude) and(small amplitude). The convergence to the stable limit cycles was confirmed by performing a long-time integration of the system using the built-in functiondde23for MATLAB.

Finally, we stress that, due to the large values of the delay at the stability switch when, the numerical analysis with MatCont becomes challenging as large discretisation indices are needed to obtain sufficient accuracy. Figure14compares the approximation error of the rightmost Hopf bifurcation detected by MatCont, forand, depending on the degreeMof the collocation polynomial used in the approximation of the delay system in MatCont 7p6. The right panel shows that a collocation degree of the order of 150 is needed to approximate the Hopf bifurcation for, which occurs at approximately. This is much larger than the collocation degree required to approximate the Hopf bifurcations for larger(left panel), which is of the order of 20.

The previous analyses were carried out for fixed demographic parameters, and in particular for a rather short life expectancy (50 years). However, life expectancy is known to play an important role in the emergence of oscillatory dynamics: using a compartmental SIRWS model, Dafilis et al. (2012) showed that increasing life expectancy can cause sustained oscillations in the presence of waning and boosting of immunity. With this motivation, we conclude this study with a brief discussion on the sensitivity of our stability results to the life expectancy of individuals.

The left panel of Fig.15shows the stability and instability regions of the endemic equilibrium in the parameter plane(similarly as Fig.2) when the per capita death rate is, corresponding to an average lifespan of approximately 75 years. While the qualitative picture remains the same, decreasing the mortality ratedenlarges the region of instability compared to Fig.2(left). The destabilising effect of increasing life expectancy is also evident from the right panel of Fig.15, which shows the stability and instability regions in the plane, for fixedyears and, so thatvaries withdaccording to (2). We observe that, asddecreases, the system undergoes a Hopf bifurcation with the emergence of stable periodic solutions. These results qualitatively agree with the analyses by Dafilis et al. (2012) (see for instance Fig.4in that reference).

In this paper, we extended the analysis of the dynamics and bifurcations of the model with waning and boosting of immunity proposed by Barbarossa et al. (2017), formulated as a system of equations with discrete and distributed delays. Bifurcation analyses for such models are scarce in the literature, due to the technicalities and complexities in the calculations. Our analysis was performed with a recently developed software release, MatCont 7p6 for MATLAB (Liessi et al.2025).

For parameter values describing a highly infectious disease like pertussis, our analysis uncovered a much more complex dynamical picture than previous ones, including catastrophic bifurcations and parameter regions with bistability of different attractors. While bistability in waning-boosting models has been observed previously (for instance Dafilis et al.2012and Opoku-Sarkodie et al.2024), our work is the first to analyse a delayed model and find evidence of bistability not only of the endemic equilibrium and a limit cycle, but also of two distinct stable limit cycles differing in amplitude and period, for the same parameter values.

Catastrophic bifurcations and bistability have practical relevance in public health, as disturbances of the system’s state or parameters by non-pharmaceutical interventions can push the system to a different basin of attraction, hence potentially changing its long-term dynamics. Pertussis transmission, for instance, is highly influenced by waning-boosting dynamics, and post-pandemic outbreaks have sparked significant concern (Kang et al.2025).

Our work helps to better understand the role of duration of immunity and boosting force in shaping disease dynamics, further corroborating the evidence that waning-boosting infection dynamics is highly nonlinear, extremely complex, and public health interventions may have unintended consequences.

The research of FS was supported by the Engineering and Physical Sciences Research Council via the Mathematical Sciences Small Grant UKRI170: “The dynamics of waning and boosting of immunity: new modelling and numerical tools”. FS is a member of the Computational Dynamics Laboratory (CDLab, University of Udine), of INdAM research group GNCS, of UMI research group Modellistica Socio-Epidemiologica, and of JUNIPER (Joint UNIversities Pandemic and Epidemiological Research). The research of MP and GR was completed in the National Laboratory for Health Security, RRF-2.3.1-21-2022-00006. Additionally, their work was supported by the Ministry of Innovation and Technology of Hungary from the National Research, Development and Innovation Fund project no. TKP2021-NVA-09 and KKP 129877. FS is grateful to Stefan Ruschel and Jan Sieber for helpful insights on the analysis with DDE-BIFTOOL.