Recent advances in population-specific high-quality reference databases have significantly improved the performance of forensic panel development for personal identification, parentage testing, and biogeographical ancestry inference. However, the discriminative power of previously developed AISNP panels remains limited in applications involving regional Chinese population substructures.

We used the high-quality Chinese population-specific genetic resource to develop six nested C5ClusterTag-50/100/250/500/1000/2000 ancestry-informative SNP panels focused on inferring population stratification among geographically and genetically distinct Chinese populations. We used comprehensive bioinformatics approaches and machine learning to validate the effectiveness of these panels in both the testing and training datasets. A total of 2,772 individuals were screened across different AISNP panels based on theInvalue. Ancestry inference power was assessed via principal component analysis (PCA), ADMIXTURE, and uniform manifold approximation and projection (UMAP) across the 2000-AISNP, 1000-AISNP, 500-AISNP, 250-AISNP, 100-AISNP, and 50-AISNP panels. The 1000-AISNP panel demonstrated the optimal balance between the SNP count and discriminative power for forensic applications. The accuracy of the random forest model was confirmed through a confusion matrix based on machine learning.

These panels can differentiate ethnolinguistic Chinese populations into five subgroups based on geographical divisions or linguistic affiliations, achieving a high average accuracy rate in machine learning models. This work not only developed a robust ancestry inference panel and new tools for predicting the ancestry of ethnolinguistic Chinese populations but also created a comprehensive reference dataset and machine learning model applicable to population and forensic uses globally.

The online version contains supplementary material available at 10.1186/s12864-025-11947-6.

China, the largest country in East Asia by area, exhibits significant ethnic, genetic, and linguistic diversity [1,2]. Previous genetic and archaeological studies have revealed complex migration patterns and the admixture history of East Asian populations [3–9]. Large-scale genetic studies, such as the Pan-Asian SNP Project, have demonstrated a strong correlation between the genetic structure of Asian populations and their linguistic classifications [8,10–15]. Recent anthropologically informed genomic resources from autosomal and uniparental perspectives further confirmed the geography-related genetic substructure, which was also associated with multiple social-cultural factors [15–18]. The northern region of China is home to a variety of language families, including Mongolic, Tungusic, Turkic, Japanese, and Korean, which are collectively referred to as “Transeurasian” families [8,19,20]. In Central China, the Sino-Tibetan language family, comprising both Sinitic and Tibeto-Burman branches, is the most widespread and populous [21–26]. The Hmong-Mien and Tai-Kadai language families are prevalent in southern East Asia [7,9,27,28]. Additionally, the Austronesian language family dominates the southeastern coastal regions of China, whereas the Austroasiatic language family is found in inland areas. China’s rich ethnic diversity is also reflected in its 55 officially recognized ethnic minority groups and Han Chinese, as well as many unrecognized groups, such as the Chuanqing, Xijia, and Gejia peoples.

In investigating various criminal and civil cases within multiethnic communities, determining the population origin of biological materials can provide valuable leads, especially when STR profiling of samples collected from crime scenes does not yield matches in DNA databases or when doubts persist regarding eyewitness testimonies. Such information is crucial for narrowing the scope of investigations and increasing the likelihood of case resolution. Single nucleotide polymorphisms (SNPs), which are located in various genomic regions, including coding sequences of genes, noncoding regions, and intergenic regions, are highly polymorphic and stable [29–33]. These markers can be effectively analyzed even in highly degraded samples and possess significant potential for discerning biogeographical ancestry [34,35]. In forensic science, SNPs used as genetic markers are categorized into identity-informative SNPs, lineage-informative SNPs, ancestry-informative SNPs (AISNPs), and phenotype-informative SNPs. These markers are vital for complex parentage testing, reconstructing family lineages, inferring geographic ancestry, and predicting individual phenotypes, which are prominent research areas in forensic genetics [36–39]. Widely used genetic ancestry-informative markers (AIMs) include SNPs [40–43], triallelic insertion-deletions [44], diallelic insertion-deletions [45–47], multiple insertion-deletions [48,49], and microhaplotypes [50]. Different detection systems select genetic markers according to the target populations, but there is often little overlap in loci shared between different systems, and reference population data are frequently lacking for each system [51]. Over the past several decades, AIMs have been developed to infer an individual’s continental or biogeographic origins. For example, Kidd et al. developed a panel of 55 AISNPs for distinguishing global populations [52], whereas Seldin et al. developed a panel of 128 AISNPs specific to Native American populations [43]. Chen et al. developed four nested AISNP panels capable of discriminating between phenotypically and genetically similar neighboring East Asian populations, such as Han Chinese, Japanese, and Korean populations [53].

The identification and distribution patterns of fine-scale genetic substructures within Chinese populations provide a robust theoretical foundation for precise biogeographic tracing in forensic studies [6–8,11,12,35]. Xu et al. used whole-genome sequencing techniques to investigate the population history of Han Chinese individuals and revealed distinct genetic substructures, categorized as Northern Han and Southern Han, which closely correspond to geographical regions [54]. These findings were further validated through large-scale Chinese genomic resources [55–59] and anthropologically informed studies [8,23–25]. Li et al. developed a system of 74 AISNPs for global populations, enabling the classification of these populations into ten distinct genetic subgroups [60]. He et al. assessed the effectiveness of biogeographic ancestry inference via 165 AIM genetic markers among major ethnic groups in China [61–63]. These studies suggest that while current ancestry inference systems effectively distinguish populations at the intercontinental level, their ability to differentiate populations within the same continent remains limited. Consequently, there is a critical need to develop more refined ancestry inference panels for diverse populations in China.

An optimal SNP panel of ancestry-informative SNPs (AISNPs, a subset of AIMs) should consist of a minimal set of SNPs that exhibit significant allele frequency differences across diverse populations. The selected SNPs should collectively ensure the highest discriminatory accuracy for ancestral inference [53]. However, a notable limitation of AIMs is their ability to distinguish only among previously studied populations [52]. Current whole-genome chip designs are primarily based on population-specific variations, and the presence of ascertainment bias can diminish the efficiency and accuracy of ancestry analysis using whole-genome loci. Thus, identifying a set of AIMs that effectively capture interpopulation differences for specific populations is crucial for facilitating rapid and accurate individual ancestry analysis and localization. In this study, high-quality Chinese population-specific genetic resource was used to develop six nested AISNP panels tailored for ancestry inference [11]. Comprehensive bioinformatic approaches and machine learning techniques were employed to validate the effectiveness of the panels in both the training and testing datasets.

Saliva samples of 2,772 Chinese individuals were obtained from the anthropologically informed 10 K Chinese People Genomic Diversity Project. The extracted DNA was genotyped via the Infinium Global Screening Array (Illumina, CA, USA). All participants provided written informed consent, and the study was conducted in accordance with the Declaration of Helsinki and approved by the Medical Ethics Committees of West China Hospital of Sichuan University (2023 − 306). Family relationships were assessed via KING2 [64] by estimating kinship coefficients. All the participants reported having parents and grandparents from the same ethnic group, with no consanguineous marriages for at least three generations. Quality control filtering was conducted via PLINK 1.9 [65] with parameters set to --mind 0.1, --geno 0.1, --hwe 0.001, and --maf 0.01. Individuals with more than 10% missing genotypes were excluded, as were those with SNPs missing data in more than 10% of the samples or those in Hardy-Weinberg disequilibrium (P< 0.001). SNPs on sex chromosomes were not included. A genome-wide SNP dataset consisting of 434,143 clean SNPs was compiled for 2,772 unrelated individuals, including 1,097 Han_North, 898 Han_South, 365 Hmong-Mien (HM), 154 Tibeto-Burman (TB), and 258 Tai-Kadai (TK) individuals. This dataset generated an ancestry-informative panel (Fig.1, TableS1). After quality control filtering, a total of 434,143 Illumina SNPs remained, which were selected on the basis of the presence of a dbSNP reference ID number for the Illumina platform. The data was submitted to the public databases in the Genome Variation Map (GVM) [66] at the National Genomics Data Center [67].

The AIM generator (Python script, AIMs_generator.py) [68] was used to identify the top 50, 100, 250, 500, 1000, and 2000 AIMs. The program accepts genotype files and allele frequency files from PLINK, performs LD pruning, and selects AIMs based on Rosenberg’sInStatistic [69], which defines the informativeness of SNPs. AIMs were selected according to the following criteria: (1) exclusion of duplicate SNPs and SNPs located on sex chromosomes; (2) maintenance of a minimum distance of 1 Mb between SNPs on the same chromosome to reduce linkage disequilibrium effects; and (3) computation of theInvalue for each SNP across the five populations. The AIMs were then ranked in descending order according to theirInvalues. On the basis of these criteria, a maximum of 2,020 SNPs were filtered. AIM panels with the top 50, 100, 250, 500, 1000, and 2000 AIMs were subsequently generated (Figs.2, S1, and TableS2−3). The performance of these AIM sets in differentiating the five populations was then examined and evaluated.

The efficacy of these AIMs in delineating population stratification among various regional populations was evaluated via principal component analysis (PCA), uniform manifold approximation and projection (UMAP) and ADMIXTURE analysis. PCA was performed with the smartpca package [70] from EIGENSOFT, which employs default parameters for both the screened AIMs and the raw data. Non-linear dimensionality reduction and visualization of complex population structures were performed using UMAP analysis via the umap and ggplot2 packages in R v4.3.2. ADMIXTURE analysis [71] was then conducted to evaluate and visualize population relationships and individual ancestral proportions. We performed the model-based ADMIXTURE analysis with K values ranging from 2 to 20, using the default 10-fold cross-validation (CV = 10) and 100 bootstrap replicates. Cross-validation was used to identify the optimal number of clusters, revealing that the admixture model with five ancestral sources (K = 5) provided the best fit (FigureS2).

The outcomes of the PCA and ADMIXTURE analyses were used as input features to construct random forest (RF) models, which were implemented via the randomForest package in R version 4.3.2. Models 1 through 5 were constructed based on the top 50, 100, 250, 500, 1000, and 2000 SNPs with the highestInvalues, respectively. A stratified random sampling approach was applied, with 70% of the samples from each designated population forming the training dataset and the remaining 30% serving as the testing dataset for predicting individuals’ biogeographical origins. To enhance model robustness, 5-fold cross-validation was employed during training. The predictive accuracy of each model was evaluated to determine ancestry within the five Chinese subpopulations. Finally, a parameter tuning process was conducted to identify the optimal hyperparameters for each model.

The performance of the AIM panel in differentiating among five population groups was assessed via five metrics: sensitivity (=), specificity (=), positive predictive value (PPV=), negative predictive value (NPV=), and accuracy (=). Here, TP represents true positives, TN represents true negatives, FN represents false negatives, and FP represents false positives. Sensitivity and specificity describe the distribution of classifications based on true outcomes, whereas PPV and NPV provide the probabilities of true outcomes given the classifications. The random forest model was validated through a confusion matrix to determine the sensitivity, specificity, PPV, and NPV. Additionally, the performance of each model was evaluated via Receiver Operating Characteristic (ROC) analysis and average accuracy (AAC). These metrics provide a comprehensive evaluation of the panel’s effectiveness in distinguishing between different population groups.

From an extensive dataset comprising 434,143 SNPs from 2,772 individuals across five distinct geographical and linguistic subgroups, we identified AIMs. We then developed six nested panels containing 50, 100, 250, 500, 1000, and 2000 AISNPs to effectively differentiate among the five Chinese subpopulations: Han_North, Han_South, Hmong-Mien, Tibeto-Burman, and Tai-Kadai. Our goal was to design a nested AIM panel, named C5ClusterTag-50/100/250/500/1000/2000, based on a series of bioinformatics screening and validation strategies, as outlined in the following sections.

PCA and ADMIXTURE analyses were conducted to explore genetic admixture and relationships among the five Chinese subpopulations. Using genome-wide data, ADMIXTURE (K = 2) classified these populations into two major groups: southern (red) and northern (blue) (FigureS3). PC1 highlighted genetic differentiation between northern populations, represented by the Han_North and TB-speaking groups, and southern populations, which included the Han_South, TK-speaking, and HM-speaking groups (FigureS5G). The TK-speaking population was positioned at the southernmost end of the southern cluster. PCA on six AIM panels revealed partial overlap in the genetic profiles of Han_North and Han_South, suggesting genetic integration among Sinitic-speaking populations, with increased discriminative power as the number of SNPs increased. Notably, relatively close genetic affinity was observed between parts of the HM- and TB-speaking populations. We used cross-validation to identify an “optimal” number of clusters (K = 5). At this optimal K value, five distinct ancestry components were observed among the studied populations. Each component corresponds to a regionally and ethnolinguistically relevant ancestral source: The teal component was predominantly observed in TK-speaking populations, primarily distributed in southern China and parts of Southeast Asia. The indigo component was maximized in northern Han and the turquoise blue component was enriched in southern Han, reflecting differentiated gene flow events from northern and southern East Asian ancestries. The royal blue component was predominant in TB-speaking groups, such as Tibetan and Qiang populations, consistent with their genetic distinctiveness and adaptation to high-altitude environments. The vermilion component was maximized in HM-speaking groups, typically located in southwestern China. We found that subpopulations belonging to the same linguistic group generally exhibited similar ancestry profiles, suggesting shared genetic backgrounds within groups. ADMIXTURE analysis of 2,772 individuals confirmed the effectiveness of panels containing 50, 100, 250, 500, 1000, and 2000 SNPs in differentiating the genetic structure of the five subpopulations, with the 1000 and 2000 AISNP panels showing high discriminative power (Figs.3and4). To evaluate the consistency of ancestry inference across different SNP subsets, we calculated pairwise cosine similarity between the ADMIXTURE outputs at K = 5. For each pairwise comparison, all possible permutations of ancestry components were considered, and the highest average diagonal similarity was retained. The results revealed high concordance among SNP subsets, with average cosine similarity values ranging from 0.853 to 0.991, indicating stable and reliable ancestry estimation across different marker sets (FigureS4and TableS4). Genome-wide data (434,143 SNPs) were also compared with the six panels in both the PCA and ADMIXTURE analyses (K = 2 to 5) (FiguresS5−6). UMAP was used to provide a detailed visualization of genotypic information at fine scales. UMAP revealed clusters that were challenging to identify via PCA plots or ADMIXTURE analyses, such as a linguistically restricted cluster within Han_North and Han_South (Fig.5). While PCA is effective in capturing the global structure of the data, UMAP excels in illustrating both the global structure (overall shape and distances) and the local structure (clusters and nearest neighbors) of the data [72]. The combined use of these methods offers a comprehensive understanding of the data.

To develop the most effective ancestry-predictive models, we utilized PCA and ADMIXTURE results as input features to construct a series of RF models labeled Models 1 through 5. These models were built using the top 50, 100, 250, 500, 1000, and 2000 high-InSNPs, respectively. We assessed the discriminative power of the selected SNPs on the basis of their cumulative accuracy in assigning individuals to their regions of origin [53]. Our findings revealed that the accuracy of ancestry inference increased with the inclusion of more SNPs in the model. Notably, the model that included the top 100 high-InSNPs exceeded the 90% accuracy threshold, demonstrating a substantial improvement in predictive performance. Further addition of AISNPs improved the assignment accuracy from 89.18% for 50 AISNPs to 98.44% for 2000 AISNPs. The RF model with 2000 SNPs (Model 5) demonstrated the highest predictive accuracy for the five subpopulations, reaching approximately 98.44%. Using these AISNPs, we developed a nested ancestry-informative panel to differentiate among the Han_North, Han_South, HM, TB, and TK populations, with overall accuracies of 89.18%, 90.99%, 94.59%, 95.43%, 97.36%, and 98.44%, respectively (Fig.6). Details of these panels are presented in Table1. The discrimination between the Han_North and Han_South, TB and HM, and TK and Han_South populations was more prone to error. For example, with the 50 AISNP panel, 6.37% of Han_South individuals were misclassified as Han_North, 15.79% as TK, and 10.00% of HM individuals were misclassified as TB. However, incorporating more AISNPs into the panels consistently reduced the error rates. Notably, the maximum error rate in distinguishing Han_South from TK decreased from 15.79% with the 50 AISNP panel to 2.63% with the 2000 AISNP panel.

The panels showed strong performance in cross-validation assessments, exhibiting high sensitivity, specificity, PPV, and NPV (Table2). The average values for these metrics were as follows: 0.9211 for the 50 AISNP panel, 0.9339 for the 100 AISNP panel, 0.9550 for the 250 AISNP panel, 0.9570 for the 500 AISNP panel, 0.9737 for the 1000 AISNP panel, and 0.9888 for the 2000 AISNP panel.

The ROC curve illustrates the relationship between the true-positive rate and the false-positive rate of the test. The area under the curve (AUC) serves as an indicator of classification power, with values closer to one reflecting superior classification performance. We conducted ROC analysis on six sets of SNPs and plotted the corresponding ROC curves. The results indicate that the performance of the RF model improved as the number of AISNPs increased (Fig.7). Specifically, the AUC values for the panel with 2000 AISNPs ranged from 0.991 to 1.000, demonstrating excellent classification accuracy. Even with the smallest panel size of 50 markers, the AUC for each population was no less than 0.961, highlighting the robustness of our classification model.

Genetic studies utilizing whole-genome sequencing and high-density SNP chip detection have revealed significant genetic substructures within East Asian populations, which closely correspond to linguistic classifications and geographic distributions [14,18,59,73,74]. Despite extensive research on ancestry inference in forensic and medical genetics, challenges persist owing to variations in target populations across studies and the lack of high-coverage reference datasets [75]. As a result, developing population-specific ancestry inference systems based on finer-scale genetic structures, along with the creation of comprehensive reference databases, could enhance the effective integration of ancestry inference into judicial practice.

In this study, we identified an optimal subset of AIMs for ancestry inference among five major Chinese populations by analyzing whole-genome SNP data from 2,772 individuals. We then constructed six AISNP panels and applied a random forest algorithm to model the data, aiming to identify the optimal ancestry inference model for Chinese subpopulations based on metrics such as accuracy, sensitivity, and specificity. While the greatest degree of differentiation among the five populations was achieved via genome-wide data, which included over 434,143 SNPs, this approach is not feasible for forensic investigations. In contrast, the AISNP panels demonstrated strong discriminative power (Table1) and exhibited high sensitivity, specificity, PPV, and NPV in analyzing the five populations, as detailed in Table2. These results suggest that increasing the number of AISNPs enhances the accuracy of ancestry inference. Notably, the model using 1000 AISNPs showed greater accuracy in distinguishing the five subpopulations than the genome-wide approach with 434,143 SNPs. Thus, inferring ancestry through specific genetic markers is crucial for narrowing the search scope and improving investigative efficiency.

The increasing number of genome-wide studies on these populations has revealed a north-south admixture pattern, as well as distinct genetic substructures across various geographical regions [76,77]. Our PCA revealed partial genetic overlap between the Han_North subgroup, comprising individuals from Henan and Shandong Provinces, and the Han_South subgroup, including individuals from Fujian and Guangdong Provinces. Our findings support the hypothesis that the primary ancestry of modern southeastern coastal Han Chinese individuals is derived from northern China, which is consistent with previous genome-wide analyses of Han Chinese individuals [24]. The five ancestry components inferred at K = 5 not only reflect genetic differentiation but also correspond closely to known linguistic and geographic structures in East Asia. Furthermore, our UMAP analysis revealed significant local genetic structures, particularly within HM-speaking populations. These findings suggest the existence of genetic substructures that are influenced by linguistic affiliations, even within the context of larger geographical and linguistic populations, highlighting the complex genetic diversity and historical population dynamics within the Chinese population. Previous research has demonstrated significant genetic interactions between Hainan TK-speaking populations and adjacent Han Chinese regions [78]. Such genetic interactions could lead to inaccuracies in ancestry predictions. Notably, when ancestry inference panels are used to identify individuals from populations not represented in the training dataset, there is an increased risk of bias or error.

Currently, systematic genetic studies on the Chinese population are limited, and no publicly available platforms, such as GEDMatch or consumer genomic databases, such as FamilyTree, provide ancestry-related data for forensic applications [35]. Additionally, forensic ancestry inference systems specifically tailored to Chinese ethnic groups are still underdeveloped. Addressing these gaps requires large-scale and representative population sampling to establish a high-quality reference database that can support both forensic and population genetic studies [14,15,17]. In this study, we developed an ancestry inference panel and introduced innovative tools for predicting the ancestry of ethnolinguistic Chinese populations. Moreover, we compiled a comprehensive reference dataset and constructed a machine-learning model applicable to both population genetics and forensic investigations. However, challenges remain in optimizing ancestry inference efficiency, particularly concerning the applicability of the 1000 and 2000 AISNP panels in forensic contexts. Our findings also highlight the need for further investigation into additional subpopulations and the identification of genetic markers with greater discriminatory power to enhance future ancestry inference models.

We successfully developed six nested AISNP panels (C5ClusterTag-50/100/250/500/1000/2000) that demonstrate robust discriminative power in distinguishing five major Chinese populations: Han_North, Han_South, TB, HM, and TK-speaking populations. Notably, the 1000-AISNP panel offers an optimal balance between SNP density and discriminatory power, making it the most suitable for forensic applications. These six AISNP panels have proven valuable for population stratification within China, significantly improving the ability to differentiate closely related subpopulations. The RF ancestry-predictive models demonstrated high specificity and sensitivity, enabling precise differentiation and inference of the five ethnolinguistic subpopulations in China. These panels have successfully classified the populations into five distinct subgroups based on geographical regions or linguistic affiliations, achieving a high average accuracy rate in machine learning models. The developed AISNP panels are valuable tools for providing investigative leads and narrowing the scope of forensic investigations. Our findings contribute a new, highly effective method for ancestry inference in Chinese populations, with potential applications extending to both population genetics and forensic analysis.

Below is the link to the electronic supplementary material.