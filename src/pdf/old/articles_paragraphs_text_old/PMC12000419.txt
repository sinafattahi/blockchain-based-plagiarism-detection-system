Proton-coupled electron transfer (PCET) is the key step for energy conversion in electrocatalysis. Atomic-scale simulation acts as an indispensable tool to provide a microscopic understanding of PCET. However, consideration of the quantum nature of transferring protons under an exact grand canonical constant potential condition is a great challenge for theoretical electrocatalysis. Here, we develop a unified computational framework to explicitly treat nuclear quantum effects (NQEs) by a sufficient grand canonical sampling, further assisted by a machine learning force field adapted for electrochemical conditions. Our work demonstrates a non-negligible impact of NQEs on PCET simulations for hydrogen evolution reaction at room temperature, and provides a physical picture that wave-like quantum characteristic of the transferring protons facilitates the particles to tunnel through classical barriers in PCET paths, leading to a remarkable activation energy reduction compared to classical simulations. Moreover, the physical insight of NQEs may reshape our fundamental understanding of other types of PCET reactions in broader scenarios of energy conversion processes.

Proton-coupled electron transfer reactions are key steps in electrocatalysis. Here the authors introduce a computational method to model such processes including nuclear quantum effects under a grand canonical constant electric potential.

Understanding and controlling energy conversion processes are the key to the development of innovative green energy technologies. Electrochemical catalysis on various electrode materials facilitates efficient conversion between transient electrical energies and stable chemical energies, for example, electrocatalytic hydrogen evolution reactions (HER)1during water splitting, oxygen reduction reactions (ORR)2in fuel cells, electrochemical CO2reduction reactions (CO2RR)3which simultaneously mitigates CO2emission and produces fuels. Proton-coupled electron transfer (PCET), an essential elementary reaction step shared by most of the electrochemical energy conversion systems, determines the reaction rates, efficiencies, and selectivity of different electrocatalytic cells. Deep insights and understanding of the proton transfer step in complex environment near the electrode/solvent interfaces thus draw great attention and interests from the community of electrochemistry and chemical physics.

For a typical PCET process in electrochemical systems of metal/aqueous solution interfaces, a proton originally from the H2O network transfers toward catalytic metal sites or a certain reactant species, accompanied by electron transfer (via electrode surfaces) under a constant potential condition. Detecting and observing these intricate and localized events at a microscopic level presents a challenge for experimental methods, across both spatial and temporal dimensions. However, atomic simulations offer a powerful alternative, allowing us to examine the kinetics and thermodynamics of elementary PCET steps. From the above conceptual description of PCET, we can obtain three key requirements that would be critical in theoretical modeling: (1) a sufficient sampling of complex electrode/solvent interfacial environment; (2) a constant potential condition corresponding to a grand canonical (GC) ensemble; (3) a physically appropriate and exact treatment for protons involved in a PCET process.

Electrochemical theorists have developed many different approaches for modeling PCET reactions in the past decades. One of the most widely used methods is the computational hydrogen electrode (CHE) model4originally proposed by Nørskov and colleagues, by which the thermodynamic reaction energies under a certain applied potential can be computed, referred to as the standard hydrogen electrode (SHE) or the reversible hydrogen electrode (RHE). Extension to kinetic barrier calculations considering a constant potential condition was achieved in 20165,6. The charge extrapolation method adjusts potential energy surfaces (PES) that are initially calculated with a constant charge model. This adjustment accounts for the electric double layer (EDL) at electrode/solvent interfaces, using a capacitor model to approximate thea posterioricorrection terms. The great advantages of low computational cost and easy implementation make the above approaches popular in the electrochemistry community of PCET simulations. However, it is widely acknowledged that there are shortcomings in the approach, which considers only the initial states (IS), final states (FS), and transition states (TS) along a specific single path of the PCET steps, leading to a lack of configurational sampling. The charge extrapolation method, although applying a constant potential correction term, is not an exact treatment for the constant potential GC ensemble, one issue is that the TS is actually optimized under a constant charge model.

Regarding the necessity of sufficient configurational sampling involving electrode surface, reactant species, and solvent (usually H2O) environment, several groups employed first-principles constrained molecular dynamics (CMD)7,8to calculate mean forces (or free energy gradients) at different reaction coordinates (RC) along a reaction path9–11, in which the RC is predefined to describe reactions’ progress. Configurational sampling is indeed performed by this method, while the expensive ab initio calculations limit the total MD steps along a trajectory (only ~ 104steps), the sufficiency of statistical sampling thus is still questionable. This limitation actually could be addressed by the employment of machine learning potentials (MLPs), which will be presented and discussed in this work. CMD itself cannot provide a constant potential GC ensemble condition, two strategies were employed by previous studies, one is addinga posterioriconstant potential correction term derived from the charge extrapolation scheme12, and the other strategy is using the so-called grand canonical density functional theory (GC-DFT) method13,14, in which the Fermi level referred to the vacuum level (or the work function) is fixed at a certain value. This can be accomplished by iteratively varying the system’s total number of electrons in self-consistent field (SCF) loops until the system’s work function is converged to the targeted value. On the basis of the GC-DFT and ab-initio-based CMD method, Liu group achieved a constant-potential condition by updatingNeevery few MD steps based on a constant-capacitance assumption15,16. Further developments of the GC-DFT method were also reported recently to achieve more efficient convergence of targeted potentials17,18. However, fixing the work function of each sampled configuration actually does not resemble the microstates’ distribution corresponding to an exact GC ensemble, which will be discussed later in this work. Moreover, this GC-DFT approach could induce an issue when dealing with quantized protons under a GC ensemble when the system’s total electron number is allowed to vary, please refer to Supplementary Note1for detailed discussion.

Proton is the key transferring species in PCET reactions. Since hydrogen is the lightest element in nature, it is well known that the nuclear quantum effects (NQEs) dominate the mechanism of proton transfers at extremely low temperatures. Most of the previous theoretical work on PCET steps in electrochemical catalysis did not consider NQEs, partially due to the relatively high temperature of a standard condition (~ 300 K) and the expensive computational cost required. However, a bunch of earlier studies have revealed that the quantum nature of protons plays an important role at room temperature in proton transfer processes in liquid water19, small organic molecules20,21, biological macro molecules22, and even crystalline oxide materials23. It is, therefore, inspiring to raise a question about the impact of NQEs in PCET steps of electrocatalysis. Hammes-Schiffer group pioneered the investigation on the quantum effect of homogeneous and heterogeneous PCET24. The computational method developed by the group provides a Fermi golden rule expression25of PCET reaction rates, in which vibronic states (the direct product of electronic states and proton vibrational states) are employed to compute the vibronic coupling term26. Both of the nonadiabatic effect and NQEs can be incorporated under this theoretical framework. The fundamental principle of this method is exact; however, certain limitations might exist when we numerically obtain the requested parameters for a realistic system or reaction process. For example, sufficient configurational sampling of the electrochemical environment at the electrode/solvent interface is lacking. Moreover, the approximated quantum treatment of protons in PCET, in which 1-D wavefunctions are solved along the oxidized and reduced diabatic PES of proton transfers24, is not fully exact to compute the vibronic coupling term. An analogous framework for addressing nuclear tunneling and non-adiabaticity under electrochemical conditions was proposed by Melander, showing how we could compute electrochemical rate under a Marcus theory-type framework in a grand canonical ensemble condition27. However, Melander currently just considered an adiabatic classical model for the acidic Volmer reaction when applying the method in this recent paper27, ignoring NQEs and non-adiabaticity (incorporation of which could still be on-going). As suggested by the Hammes-Schiffer group24and well acknowledged by the quantum dynamics community, the Feynman path integral (PI) algorithm28,29is a more exact simulation approach for proton quantization, which will be employed in this work.

Our goal is to investigate the NQEs of PCET under a constant potential electrochemical condition, which can be conducted by a unified statistical sampling framework developed by this study. We employ a grand canonical hybrid Monte Carlo (GC-HMC) algorithm to equilibrate the system with an external electronic reservoir at a certain chemical potential of electrons and combine with a path integral Monte Carlo (PIMC) method to take account of NQEs. We also develop an MLP adapted for electrochemical simulations on the basis of the Deep Potential (DP)30, in which the total electron number of the interface system can be adjusted to realize a GC sampling, and we refer to this MLP as DP-Nethroughout this paper. This DP-NeMLP significantly improves computational efficiency while maintaining a DFT level accuracy, enabling sufficient statistical sampling in our work with an affordable computational cost.

Electrocatalytic HER is a notable green-energy technology producing clean fuels31, it consists of multiple possible PCET steps, which is an ideal modeling system in electrochemistry. We thus are interested in the NQEs on the thermodynamics and kinetics of elementary PCET steps of HER in this study. The Volmer step (H+sol+ e-+ * → H*, where H+solrepresents a solvated proton in water solution, e-comes from a cathode, and “*” means a surface site at cathode surface) and the Heyrovsky step (H+sol+ e-+ H* → H2) are the two fundamental PCET steps, with another non-electrochemical Tafel step (H* + H* → H2) being investigated in this work as well (Supplementary Note10). Researchers have done extensive theoretical studies on PCET steps in HER, typically by employing the CHE model and the charge extrapolation scheme32–34. The exact mechanism and quantitative kinetic properties of the above PCET steps are still under debate, with discrepancies of activation energies between the computational predictions and experimental results35–38. A recent theoretical work using the CMD method tried to reconcile the above-mentioned discrepancies12, but there are still unresolved issues about the competitive relationship between the Volmer-Tafel and Volmer-Heyrovsky mechanisms.

With the NQEs being explicitly considered in this study, we attempt to provide new insights into the impact of this quantum effect on the PCET steps involved in electrocatalytic HER. Our simulations reveal that proton tunneling exhibits a substantial impact on the free energy profile of elementary PCET reactions in HER and, more importantly, provides new physical pictures for understanding pathways of the transferring proton overcoming kinetic barriers in the Volmer and Heyrovsky steps. We note here that we are not aiming to provide quantitatively exact reaction rate evaluations for the PCET elementary steps in this study. The major contribution of our work is the development of an integrated sampling framework for free energy calculations which can explicitly treat NQEs under an exact constant potential condition. We will first introduce the main idea and principles of our developed computational algorithm, and then present the major results elucidating the NQEs in electrocatalytic HER in the following sections.

whereβ=1kBTis the inverse temperature,Λis the prefactor generated by the integral of momenta degrees of freedom,E(R,Ne)andμeexpress the potential energy and the electrochemical potential of the external electronic reservoir in equilibrium with the system respectively, andQ(β,Ne)refers to the canonical ensemble partition function (integral in the phase space) at a specific temperatureβand with a total number of electronsNe. For the exact GC ensemble condition, the work function of an instantaneous configuration will fluctuate around -μeduring the simulation, rather than being fixed at -μewhich corresponds to the situation using the GC-DFT method.

Sufficient configurational sampling of complex electrode/solvent interfacial environment is essential for studying PCET steps. Due to the issue of particle-number variations in GC conditions, MC39,40is a more practical method for open system simulations with particle insertion/deletion compared to MD40,41. We employ the HMC42,43method to improve the sampling efficiency with multi-particle displacements. Free energy profiles provide important physical insights into the thermodynamic and kinetic properties of PCET steps. The thermodynamic integration (TI) method7,8,44is appropriate for computing the free energy profiles with constraints on a defined RC. Considering the above requirements, a constrained HMC approach proposed in our previous study45is employed in this work. The details of the constrained HMC method are shown in theMethodssection.

For the exploration of particles’ positions, we employ the constrained HMC method45at a fixedNevalue. The workflow of the GC-HMC algorithm is shown in Fig.1a. An MC sampling trajectory begins with an initial structure characterized by the composite configuration [R,Ne] of the system. Three types of degrees of freedom are considered: the total number of electrons (Ne), the centroid of atomic coordinates(R), and internal degrees of freedom within the quantized beads’ configurations(RΔk). We then randomly select which type of degrees of freedom to be perturbed by trial moves at each MC step, based on a random numberξsatisfying a uniform distribution within[0,1]. We vary the total electron numberNebased on Eq.2to achieve a GC constant potential condition or perform HMC for the centroid of atomic positions(R)to sufficiently sample the complex interfacial structure, or use the PIMC method to treat NQEs, by which we updateRΔkbased on the staging algorithm46,47. Estimators of targeted physical quantities are subsequently evaluated. We repeat the above process until reaching the required total MC step number, and finally obtain the ensemble average of interested physical quantities.

aWorkflow of the GC-(PI)HMC method. The trial moves for different types of degrees of freedom are selected based on a preset ratio using a random variableξsatisfying a uniform distribution within[0,1], and the probabilities of making trial moves for the internal degrees of freedom within the quantized beads’ configurations in PIMC(RΔk), centroid atomic coordinates (R), total number of electrons (Ne) area1,a2−a1,1−a2, respectively.bConstruction framework and training workflow of the DP-NeMLP adopted in this work. Initially, a data set is provided, followed by an iterative process which automatically goes through training, exploration, and labeling steps. The iteration is considered converged after the accurate sample percentage among the newly explored configurations is above 85%. The zoom-in schematic plot above the training workflow illustrates the construction framework of the DP-Neforce field. Atomic coordinatesRof a modeling system are inputs for the embedding network generating descriptors{Di}. The fitting network maps{Di}together with an extra degree of freedomNeto the total energyE, atomic forces {Fi}, and∂E/∂Newhich relates to the work function of this extended configuration [R,Ne] as discussed in the following sections.

In fact, a potentiostat-based constant potential MD algorithm was proposed by Bonnet, Morishita, Sugino, and Otani in 201248, which is also a sampling approach with instantaneous work function fluctuations conforming with an exact grand canonical distribution, equivalent to the GC-HMC method proposed in our study. This scheme was later performed combined with Blue Moon ensemble-constrained MD simulations to obtain free energy profiles49,50. Liu group’s recent review paper51also discussed the importance of work function fluctuation under the exact GC ensemble condition and developed a patch for VASP called CP-VASP51, which realizes a constant potential condition with the potentiostat proposed by the original work48. If we aim to accomplish a constant pH condition in the future, our GC-HMC algorithm is easier to accommodate to variable proton-number sampling than the forementioned MD algorithm48, which has to deal with the discontinuity issue of particle insertion/deletion. To fulfill a constant pH condition, the number of protons in the electrode/solvent system needs to be dynamically adjusted during sampling. This is similar to the strategy for maintaining a constant potential by varyingNeas discussed above, which could be implemented as an independent module in the computational framework (Fig.1a) in our future study.

whereQqtmβ,Nerefers to the quantum canonical ensemble partition function (its formulation is given by Eq.12in theMethodssection). The expression of the quantum GC ensemble partition functionΞqtmβ,μeis analogous to the classical one shown in Eq.1, please refer to Supplementary Note1for detailed derivation ofΞqtmβ,μe. Combining the PIMC algorithm with the GC-HMC method, the quantum effect can be taken into account together with sufficient configurational sampling of the electrode/solvent interface. The details of the PIMC algorithm implemented in this study are shown in theMethodssection. In the quantum case, the expression of the acceptance ratio of the total electron numberNetrial move is similar to Eq.2, except that the potential energyE(R,Ne)in Eq.2is replaced by the average potential energy of all beads sharing the same electron numberNein the PI formalism (refer to Supplementary Note1for detailed discussions).

where<⋅>GCdenotes the statistical GC ensemble average, details of which can be referred to the following results and Supplementary Note4. Figure1bshows the general framework of the DP-Nemodel adopted in this study. Our developed DP-NeMLP facilitates the sampling of GC ensembles with variable electron numbers. Chen et al. proposed a practical approach for machine-learning emulation derived from the GC-DFT method14, which incorporates the electrode potential as a new degree of freedom into the input parameters. However, the construction of this machine-learning force field actually encounters the same issue as the GC-DFT approach, which does not perform an exact sampling of the microstates’ distribution based on the GC partition function, but instead enforces a fixed work function constraint.

We validate the accuracy of our DP-NeMLP by comparing the inferred energies and forces with the DFT results, and a good agreement on the testing dataset is achieved as shown in Supplementary Fig.3. The total root mean square errors (RMSEs) of energies and forces on the testing dataset are 0.6 meV/atom and 57 meV/Å for configurations along the Volmer reaction path, and 1.1 meV/atom and 71 meV/Å for the Heyrovsky reaction case. Such small errors indicate the reliability of our DP-Neforce field model in describing the PES of HER steps with respect to the extended degrees of freedom [R,Ne].

We study the PCET steps involved in HER on a (5 × 5) Pt (111) surface slab composed of four atomic layers illustrated in Fig.2a. The modeled electrode surface contains 100 Pt atoms with 1 monolayer (ML) hydrogen coverage at Pt atop sites52,53. No constraints or control is exerted on the adsorbed H* atoms during our sampling, and we do see the adsorbed H* atoms migration between the atop sites and the hollow or bridge sites along our sampled MC trajectories because of similar adsorption energies among different surface sites12,54–60. We also include two water layers (36 explicit water molecules) to take account of the solvation effect and provide proton donors. Tests for the influence of water-layer numbers on the free energy results are shown in Supplementary Note11. A vacuum region of 15 Å thickness is further added above the water layers in order to decouple periodic images of the slab model. Since we adjust the total electron number of the interface system in our GC-HMC algorithm, compensating charge has to be included to maintain the overall charge neutrality of the supercell under a periodic boundary condition (PBC). We employ the scheme of placing a compensating charge plate in the vacuum region right above the water solvation layer to mimic an effective electric double layer at the electrode/solution interface, analogous strategies can be found in earlier theoretical work33,61,62. We realized the above function in the first-principles package Atomic-orbital Based Ab-initio Computation at UStc (ABACUS)63,64used in this study, consistent with the corresponding algorithm implementation in the popular DFT code Quantum ESPRESSO (QE)65,66. We further benchmark our calculated electrostatic energy profiles with the QE results on a testing interface model and discuss the potential influence caused by varying the compensating charge plate’s positions. Details can be found in Supplementary Note2.

aSide view of the simulated (5 × 5) Pt (111) surface slab composed of four atomic layers. The interface model contains a water bilayer over 1 ML of adsorbed hydrogen. A compensating charge plate is placed in the vacuum region above the water solvation layer. The Pt atoms inside the black dashed rectangle are fixed along all simulation trajectories.bSchematic diagrams of the proton transfer pathways of three elementary reactions (Volmer, Heyrovsky, Tafel) involved in HER. Illustration of the key atoms relevant to the RC definitions of the (c) Volmer and (d) Heyrovsky steps for classical (left) and quantum (right) cases. Adsorbed hydrogen atoms and water molecules not directly participating in the investigated reactions are not displayed in these schematic plots for clarity.

The HER process starts with a Volmer reaction, which is a PCET step of a proton’s adsorption forming an H*. Following this, the evolution of an H2molecule can proceed along two distinct pathways: the Volmer-Tafel or the Volmer-Heyrovsky mechanisms. The proton transfer pathways of the Volmer, Heyrovsky, and Tafel steps are illustrated in Fig.2b. We note that the Tafel step, characterized as a chemical (instead of an electrochemical) reaction with negligible charge transfer across the interface, is beyond the scope of PCET steps, thus is not extensively discussed in the main text. We present our investigation of the NQEs on the Tafel reaction in Supplementary Note10.

We need to define reasonable RCs for different types of reaction paths so that we could drive reactions and perform the mean force integration by our GC-(PI)HMC. In the present work, we employ the difference of bond distances∣rPtH∣and∣rOH∣as the RCqVolmerfor the Volmer reaction (Eq.5), in which∣rPtH∣is the distance between the Pt atom for H adsorption and the transferring proton, and∣rOH∣is the distance between the proton donating oxygen (belonging to an H2O molecule above the Pt site) and the transferring proton (illustrated in the left panel of Fig.2c). For the Heyrovsky reaction, we define the RCqHeyrovskyas the distancerHH*between the two hydrogen atoms forming the H2molecule (Eq.6), the definition is schematically depicted in the left panel of Fig.2d.

Similar types of RCs have been widely used in many previous studies on catalytic mechanisms for electrochemical systems11,12,16. In the quantum situations for studying NQEs, the transferring H in the Volmer step and the two combining H atoms in the Heyrovsky step are quantized as beads configurations isomorphic to a ring-polymer model20,21,23,67, we then treat the centroid of the corresponding ring-polymer beads (illustrated in the right panels of Fig.2c, d) as the positions of the quantized H atoms21,23. The impact of considering NQEs for more protons in the explicit water solution is discussed in Supplementary Note12.

DFT calculations in this work are utilized to train ML force fields, rather than for direct MC sampling. All DFT calculations in this work are performed using a first-principles calculation software ABACUS (version 3.4.0)63,64with a main feature of employing numerical atomic orbitals (NAO) as the basis set, which is capable of performing efficient DFT calculations for more than hundreds of atoms in a supercell. In addition, the function of an adjustable total number of electrons with a compensating charge plate, whose position is also configurable, is implemented in the ABACUS code (Supplementary Note2). We thus employ ABACUS to perform all of the ab initio calculations for labeling the DP-Netraining dataset throughout the work.

The norm-conserving pseudopotentials are adopted with the valence electron configurations: [H]1s1, [O]2s22p4, and [Pt]5s25p65d86s2. We use the generalized gradient approximation (GGA) in the form of the Perdew–Burke–Ernzerhof (PBE) version68for describing the exchange-correlation functional. Specifically, we choose 2s1p, 2s2p1d, and 4s2p2d1f NAO basis sets with radius cutoffs as 6, 7, and 7 Bohr, respectively for H, O, and Pt elements. The kinetic energy cutoff is set to 100 Ry (1360 eV). We employ the PBC for modeling the Pt/H2O interface supercell, and the k-point mesh for sampling the Brillouin zone of the slab model with dimensions of 14.06 Å × 14.06 Å × 30.89 Å is set as 2 × 2 × 1. A dipole correction69is included in our DFT calculations as well due to the net dipole of the interface model especially at charged states representing an electrochemical reducing condition. We use the Gaussian smearing method with a width of 0.02 Ry. We also apply Grimme’s D3 dispersion correction70to take account of the long-range van de Waals interaction effect.

whereemeans the unit charge, and the work functionW(R,Ne)of an instantaneous microstate, sampled in our GC-(PI)HMC trajectory within the extended [R,Ne] configurational space, can be obtained from∂ER,Ne∂Neas introduced in the above section (refer to Supplementary Note4for detailed DFT validations). We are able to achieve different electrochemical reducing conditions in the GC sampling for this open system by adjusting the electrochemical potential parameterμeof the external electronic reservoir (shown in Eq.1), equivalent to the potentiostat scheme proposed by an earlier theoretical work48. We thus can compute the free energy profiles of the investigated PCET steps at different applied potentials. Figure3ashows that the GC ensemble average<W(R,Ne)>GCequals to the controlling parameter−μe, which is consistent with Eq.4and justifies the validity of our GC sampling. The magnitude of the work function fluctuation range is also consistent with the earlier results obtained by the above-mentioned potentiostat scheme (~ ± 0.5 eV)48. The modeled system corresponds to the Volmer step withqVolmer= 0.21 Å atμe= − 3.5 eV vs vacuum (U= − 0.9 V vs SHE).

aWork function and (b) total electron number fluctuation with respect to MC steps of the Volmer reaction with an RC fixed atqVolmer= 0.21 Å. The extra electron number added/subtracted to/from the model (Neextra) is used to represent the total electron number for clarity. Blue curves show the instantaneous values, and black lines are the final averages along complete sampling trajectories.cTotal electron number (represented byNeextra) change along the reaction path from IS to FS of classical Volmer and Heyrovsky simulations. Error bars represent standard errors (refer to Supplementary Note6for the definition) from 15 (Volmer) or 10 (Heyrovsky) independent simulations. Red dashed curves are simply guidelines showing the trend of electron number variation with respect to RC.dClassical and quantum free energy profiles with respect to the defined RC of the Volmer and Heyrovsky PCET steps.eRC distribution associated with the ring-polymer beads in the PI simulations of Volmer and Heyrovsky reactions. Red dashed vertical lines are the constrained RC values defined for the proton beads’ centroid in our PIMC, which also correspond to the constrained RC values in classical simulations without RC spreading.fStructural plots explicitly showing the spreading beads of the transferring protons or hydrogen atoms atqVolmer= 0.0 Å for the Volmer reaction andqHeyrovsky= 0.95 Å for the Heyrovsky reaction. Adsorbed hydrogen atoms and Pt layers not directly participating in the studied reactions are not displayed here, and only one water molecule (the proton donor) remains in the plot for clarity. Only part of the 16 ring-polymer beads are shown. All results in this figure are obtained under a specific reduction potential ofU= − 0.9 V vs SHE (orμe= − 3.5 eV vs vacuum) atT= 300 K. Source data are provided as a Source Data file.

The modeled system’s total electron numberNealso fluctuates around an average value, as shown in Fig.3b,and exhibits a normal distribution (Supplementary Note5), satisfying the GC ensemble distribution. We use the extra electron number (Neextra) added/subtracted to/from the Pt/H2O interface model to represent the total electron number for clarity. The average value<Ne>GCcorresponds to the system’s charge state at a specific applied potential condition. We need to emphasize that an exact thermodynamic simulation of an electrochemical open system should obey the fundamental principle of the GC ensemble distribution (Eq.1), whereNeandW(R,Ne)are a pair of conjugate thermodynamic variables of a microstate. A correction formulation of GC sampling should exhibit the feature that neitherNenorWof sampled microstates is fixed along a simulation trajectory, while the ensemble average<W(R,Ne)>GCequals to the controlling parameter−μeof an external electronic reservoir. An analogous concept applies to the case of an isothermal-isobaricNPTensemble sampling, where neither volumeVnor the pressureP(R,V)of the sampled microstates is fixed, while the average pressure<P(R,V)>NPTequals to the setup external pressure. The above fundamental principle is rarely treated exactly in the electrocatalytic simulation community, where the fixed charge or fixed potential schemes were commonly adopted in the potential energy or free energy calculations for electrochemical PCET steps.

A gradual increase of total electron number is observed from the IS to the FS along the reaction pathways of both the Volmer and Heyrovsky mechanisms (shown in Fig.3c), which is as expected because the electrode slab needs to keep acquiring electrons to facilitate the progress of reduction reactions when in equilibrium with an electronic reservoir at a constant electrochemical potential. The error bars in Fig.3cdenote standard errors (SE) of averageNeextraderived from 15 (Volmer) or 10 (Heyrovsky) independent simulations for each case atU= − 0.9 V vs SHE (refer to Supplementary Note6for the definition of SE). We further conduct detailed calculations to examine the relationship of charge states of the Volmer step’s IS and FS with applied potentials (Supplementary Note6). The results exhibit a consistent trend that a more negative potential leads to larger electron numbers in the modeled system, indicating a reasonable electronic response in PCET reactions that a stronger reducing driving force requires a higher concentration of electrons in the system.

For example, atU= − 0.9 V vs. RHE, we havekTST(classical, Volmer) = 4.00 × 107/s,kTST(quantum, Volmer) = 5.67 × 109/s for the Volmer PCET step, andkTST(classical, Heyrovsky) = 3.30 × 103/s,kTST(quantum, Heyrovsky) = 1.12 × 105/s for the Heyrovsky PCET step. However, it is also well known that the TST expression is just an approximation for the rate constants due to a lack of dynamic consideration at the dividing surface of a reaction path. More rigorously, we should discuss the validity of the kBT/h pre-factor in the TST formula or the impact of the dynamic correctionκon this pre-factor (mainly caused by the re-crossing effect at the dividing surface in real dynamics). We admit that the precise calculations of the dynamic correction in the quantum case (considering NQEs)κquantumand that in the classical case (without NQEs)κclassicalare beyond the scope of our research. Many previous theoretical studies show that bothκquantumandκclassicalare not far from unity (in the range of 0.5 ~ 1), implying that it is likely to be a minor correction to the TST rate constant74–76. More importantly, if we look at the ratioκquantum/κclassical, which is actually the key quantity we are interested in (as we only focus on the qualitative NQEs influence on the rate constants), this ratio is even closer to 1 (in the range of 0.7 ~ 1)74–76. We thus can see that the exponential terme−ΔFa‡kBTlargely determines the reaction rate difference between the situations with vs without NQEs in our work, justifying the catalytic insights provided by our free energy calculations. We need to emphasize that although we provide estimated PCET reaction rates, the main goal of our work is not to pursue quantitatively exact rate constants for elementary steps in HER. We focus on statistical sampling methods development and aim to demonstrate the importance of NQEs in room-temperature electrocatalysis by employing our sampling framework.

We realize some readers may raise a question here that, since DFT calculations with different setup typically exhibit an uncertainty or deviation range of about 0.1–0.2 eV in describing energetics of electrocatalytic steps, is the reported quantitative NQEs’ impact of 0.1–0.15 eV (shown in Fig.3dand Fig.4) on PCET activation energies reliable or of physical meaning in this work? The basic logic of our response is that, as we keep all of the first-principles calculations consistent within this study and our adopted DFT setup also follows a routine of simulations in electrocatalysis, the uncertainty caused by inconsistent first-principles calculation setup can be excluded, meaning that the important qualitative impact of NQEs on HER PCET steps is expected to persist if other ab-initio setup schemes are employed. We actually find that earlier theoretical predictions (all performed in a classical situation) of the PCET activation energies in electrocatalytic HER at Pt surfaces were consistently higher than those from experimental measurements35–38. The NQEs, thus, could be a key factor for reconciling the above discrepancy, as revealed by our computational study which explicitly deals with the NQEs under an exact GC ensemble sampling.

Activation free energy results of Volmer and Heyrovsky mechanisms with respect to electrochemical potentials under classical and quantum situations atT= 300 K. Blue (Red) hollow circles and solid squares represent the Volmer (Heyrovsky) reaction for the classical and quantum cases, respectively. Solid and dashed lines derived from a linear fitting simply perform as guidelines illustrating the trend. The black dashed line represents the activation energy result (0.54 eV) of the Tafel reaction, which does not change with respect to voltage variation, and has almost identical values under classical and quantum conditions. Source data are provided as a Source Data file.

Proton tunneling originates from the intrinsic quantum nature, which is already demonstrated to be remarkable even at room temperature for the HER PCET steps. To achieve a clearer and qualitative understanding of the transferring proton’s quantum feature, we analyze the quantum beads expansion for the states at near-TS RC in the Volmer path (qVolmer= -0.21 Å) and the Heyrovsky path (qHeyrovsky= 1.01 Å) atU= − 0.9 V vs SHE in Fig.3e. Let’s first consider in a classical picture, the positions of the transferring protons or hydrogen atoms are essentially mass points obeying the constraint of a specific RC. If we plot the RC value of each sampled configuration in a GC-HMC trajectory, all of which must fall onto a single value, corresponding to the red dashed vertical lines in Fig.3e. However, the situation is quite different in the quantum case, since a proton or hydrogen atom can “split” into multiple beads in the PI algorithm, the “uncertainty” of a micro particle’s position just reflects its quantum feature. Therefore, if we do the statistics of each bead configuration’s RC value along our GC-PIHMC sampling trajectory and plot the histogram (Fig.3e), the RC distribution would spread around an average number (actually equals to the constrained RC value defined for the proton beads’ centroid). We can clearly see that the quantum-treated transferring proton exhibits an IS-TS-FS mixed feature at the TS of the Volmer or the Heyrovsky path, as illustrated by the schematic atomic structures underneath the histogram plots (Fig.3e). This observation indicates a sharp contrast with the classical deterministic understanding of transferring protons along PCET paths, and further explains the lowered activation energy due to the tunneling effect. This is because the TS in the PIMC simulations also mixes with ring-polymer beads with RCs corresponding to IS and FS, which have lower potential energies than the classical TS configurations.

A more direct configurational visualization of the spreading beads of the transferring protons or hydrogen atoms in the Volmer and Heyrovsky path are presented in Fig.3f. We conduct a quantum PI sampling at a specific near-TS configuration where the coordinates of all classical particles and the centroids of the quantized H are fixed, with the relative positions of the quantized H ring-polymer beads (or considered as the internal degrees of freedom within a quantized particle) being sufficiently sampled by the PI algorithm. We randomly choose a specific configuration of the spreading beads and show the structure plots in Fig.3f, which exhibits a considerable uncertainty in the quantized proton’s or H atom’s position and an unusual feature that IS and FS configurations are mixed in the TS sampling by the PI simulations. For example, the IS-like configuration (H+sol+ H*), denoted by the blue color, and the FS-like configuration (H2), highlighted by the yellow color, coexist in the Heyrovsky TS PIMC sampling (the right panel of Fig.3f), resulting in an emergence of the tunneling behavior (note that we only show part of the 16 ring-polymer beads for clarity). We thus can obtain a qualitative physical picture that the transferring proton or H atom exhibits wave-like quantum characteristics, facilitating the particles to tunnel through classical barriers along the PCET pathways in HER, leading to a remarkable activation energy reduction compared to the classical simulations. The NQEs revealed by our theoretical work thus contribute new physical insights into the fundamental understanding of PCET dynamics in electrocatalytic HER.

The above results reveal the exotic quantum behavior of the transferring protons during PCET processes. We are now interested in the impact of NQEs on our understanding of the electrocatalytic HER mechanism. Two well-known reaction pathways compete with each other, that is, the Volmer-Heyrovsky pathway against the Volmer-Tafel pathway. Figure4shows the activation energies of the Volmer, Heyrovsky, and Tafel elementary steps with respect to applied electrochemical potentials for both of the classical and quantum situations. We note that the activation energy of the non-electrochemical Tafel step is expected to exhibit negligible dependence on applied potentials, we thus plot its activation energy as a constant value (derived from our calculations with details shown in Supplementary Note10) in Fig.4. Our classical activation energy results are in good agreement with a recent computational work12numerically, where similar activation energies of both the Tafel step (0.53 eV) and the Volmer step (0.25–0.50 eV) were reported in their study within the relevant voltage range investigated in this work, justifying our GC-HMC calculations under the classical situation. If the transferring proton is treated as a classical particle, the Volmer-Tafel path is more likely to dominate the H2production under the electrochemical condition of voltageU≥ − 0.9 V vs SHE. However, due to the proton tunneling behavior resulting from its intrinsic quantum nature, more exact activation energies of the Heyrovsky step, considering NQEs, are ~ 0.1 eV lower than those derived from the classical cases. Since the Tafel steps are almost not affected by NQEs (discussed in Supplementary Note10), we can see from Fig.4that the transition point from the Volmer-Tafel path to the Volmer-Heyrovsky path is significantly shifted to a less reducing potential region by a difference of 0.5 V, indicating a tendency of the electrochemical Heyrovsky step suppressing the chemical Tafel step toward a smaller overpotential condition. An experimental-theoretical-joint analysis77claimed that the Volmer-Heyrovsky path is likely to dominate over the Volmer-Tafel path. While in another recent theoretical work raised by Kronberg et al.12, the authors conducted CMD simulations only for the Volmer and Tafel steps and did not perform the free energy calculations for the Heyrovsky step thus discussion on the competitive relationship between the Volmer-Tafel vs. Volmer-Heyrovsky mechanisms was incomplete. Our work investigates the free energy profiles for all three elementary steps in HER (Volmer, Heyrovsky, and Tafel), and we find that the Heyrovsky step indeed gets more favorable compared to the Tafel step upon considering NQEs by our GC-PIHMC calculations as shown in Fig.4, consistent with the statement from the previous work77. At the end, we also need to point out possible limitations inherent in the mean-force integration method for free energy profile calculations under constrained sampling algorithms. Since the solvent structures are sampled independently at each RC along the reaction pathway, our constrained HMC approach may overestimate the solvent reorganizations leading to a softened potential dependence of PCET activation energies in Fig.412. In our work, the free energy profile calculations are for the PCET elementary steps, and the IS and FS at electrode surfaces along PCET paths in our thermodynamic integration approach are not exactly consistent with the reactant state and the product state of the overall reaction (Hsol++e−→ 1/2 H2(gas)). In addition, a constant pH condition is not implemented in our current approach, meaning that a non-negligible pH change would occur along our modeled elementary PCET step (refer to the next Section for more discussions). Regarding the above limitations, our computed free energy change of the overall reaction cannot be directly compared to that of the experiments.

In this work, we employ our proposed GC-(PI)HMC sampling framework, assisted by a MLP adapted for electrochemistry, to reveal a non-negligible role of NQEs in computational work to achieve an exact quantitative description of electrochemical mechanisms, which is also consistent with earlier studies reviewed at the beginning of this article that NQEs exhibit remarkable influence in many chemical/materials systems19–23even at room temperature.

On the basis of this MC framework, we emphasize that the good expandability of our sampling workflow provides convenience for incorporating more physical factors in future code development. For example, the MC sampling for proton number variation, to achieve a constant pH condition, can be implemented as a new sampling branch in the workflow shown in Fig.1a, which is an independent module and does not affect the programs of the other sampling functions for different types of degrees of freedom.

More importantly, the physical insight of proton tunneling provided by our simulations based on an exact constant potential GC sampling can be extended to broader scenarios in electrocatalysis, including ORR, CO2RR, or nitrogen reduction reaction (NRR) systems. We may find similar qualitative NQEs impact on the kinetics of elementary PCET steps, which may reshape our fundamental understanding on electrocatalytic reactions. Our computational work thus highlights the importance of incorporating protons’ NQEs in modeling PCET steps existing ubiquitously in energy conversion systems.

At the end, we need to point out a few limitations of our current computational framework. First, the thermodynamic integration method used in our approach produces free energy profiles, which are just thermodynamic results and lack realistic dynamic information. Second, the adiabatic approximation employed in this work ignores the non-adiabatic effect for now, which could be an important factor worthy of investigation in certain PCET reactions. The non-adiabatic effect would likely increase the effective activation energy slightly in both the classical and quantum cases especially when the non-adiabatic electronic coupling is small around the dividing surface region. However, it is still an open question about the relative magnitudes of the non-adiabatic effect on the effective activation energy shifts comparing the situations with vs. without NQEs. Third, as we employ the TI method to compute the free energy profiles along a defined RC, it is important to choose an appropriate RC representing the reaction progress. We acknowledge that the current version of our program is unavailable to support certain types of PCET simulations involving concerted multiple-proton transfers, and we are working on the implementation of more types of RC in our framework now. Moreover, the MC sampling performed by our proposed workflow requires training and the construction of an ML force field. Certain complex electrochemical systems may need exploring a larger configurational space, which could increase the cost of preparing a robust ML force field.

The primitive coordinatesqprimittogether with the particle momentapprimitare combined to obtain the partial HamiltonianH(pprimit,qprimit)used in the HMC scheme42,43.

The workflow of the constrained HMC method is shown in Fig.1aand more details can be referred to our earlier theoretical work45.

where{RΔ(k)}k=1P−1are sampled via the staging transformation MC scheme46,47withqtransandqprimitfixed. The evolution ofqtransandqprimithas been discussed in the above section. We further note that the force of the centroid under theeffective potentialis just the average force of all beads at their specific configurations.

We consider two types of RCs in this study, and the specific formula of the estimator for them can be derived easily by the chain rule.

wheref⋅is used to represent the force on the corresponding particle in the above two formulas.

We apply the constrained GC-(PI)HMC method on our modeled interface system at room temperatureT= 300 K. The number of beads used in our PI calculations is 16 when we consider the NQEs of PCET steps21,60. Tests for the NQEs calculations in terms of beads number convergence and temperature effect can be found in Supplementary Note7. In order to obtain more reliable statistical results, we perform 15 times independent 300,000-step sampling trajectories at different RC values for the Volmer reaction, each time with a different initial structure. For the Heyrovsky reaction, due to its better performance in the mean force convergence compared to the Volmer case, we perform 10 times independent mean force samplings for each RC case (also consisting of 300,000 (PI)HMC steps for every sampling trajectory). Specifically, for the sensitive RC range (qHeyrovskyfrom 0.85 to 0.95 Å) corresponding to the relative sharp transition of an H2molecule formation, we run each sampling trajectory for 1,000,000 steps to ensure the reliability of the ensemble average results.

The MLP construction is conducted by the automatic configuration-exploration workflow DP-GEN78in this work. Concurrent learning processes in the DP-GEN contain a series of iterations, each of which is composed of three steps: training the neural network that describes force field models, exploring the configurational space (i.e., the extended [R,Ne] space in our work), and labeling the newly added candidate configurations by first-principles calculations, which are selected based on evaluation of the current machine learning model’s accuracy. Our DP-Nemodel is generated according to the workflow displayed in Fig.1b. We incorporate the total number of electronsNedirectly into the input layer of the neural network and use the software DeepMD-kit79–83to train the DP-NeMLP. All exploration trajectories are performed under the GC ensemble distribution using our GC-HMC methods. More details about the DP-GEN iterations can be found in Supplementary Note3.

We implement several constraints on atomic coordinates to ensure reasonable configurational sampling in our GC-(PI)HMC simulations. We place a rigid wall ~ 1.1 Å below the compensating charge plate to prevent water molecules from diffusing to the vacuum region. As we only allow the transferring proton (originally inHsol+form) to move from IS to FS along our constrained HMC samplings in PCET free energy calculations, we have to make sure that H* atoms (except for the H* involved in the Heyrovsky step) at the Pt surface would not migrate to water layers. We thus introduce another rigid barrier, specifically for the adsorbed H* atoms, to prevent them from going upwards into the explicit H2O molecule region. In addition, we place one more rigid wall, only for the solvation H2O molecules, to avoid water adsorption at Pt sites which may disturb our free energy calculations of PCET reactions.

In our GC-PIHMC sampling simulations, trial moves for different types of degrees of freedom are selected based on a preset ratio. We set the probabilities of making trial moves for the internal degrees of freedom within the quantized beads’ configurations in PIMC(RΔk),centroid atomic coordinates(R)and total number of electrons (Ne) as 0.32, 0.28, and 0.40, which corresponds toa1= 0.32 anda2=0.60 mentioned in Fig.1a.

The authors gratefully acknowledge funding support from the National Natural Science Foundation of China (grant no. 92470114, no. 52273223), Ministry of Science and Technology of the People’s Republic of China (grant no. 2021YFB3800303), DP Technology Corporation (grant no. 2021110016001141), School of Materials Science and Engineering at Peking University, and the AI for Science Institute, Beijing (AISI). The computing resource of this work was provided by the Bohrium Cloud Platform (https://bohrium.dp.tech), which was supported by DP Technology.